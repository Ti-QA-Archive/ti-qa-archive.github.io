<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Error: Assertion Failed (Titanium 3.3.0.GA) » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Error: Assertion Failed (Titanium 3.3.0.GA)</h1>
		</header>
		<section>
			<p>Hey.</p>
<p>I&#39;ve updated to the newest SDK and newest Alloy Version and I&#39;m having a couple of minor problems. But one problem really bugs me. Sometimes when i try to send a xhr request the app freezes and in the log the following line appears: </p>
<pre><code class="hljs">[<span class="hljs-type">INFO</span>] :   <span class="hljs-type">Assertion</span> failed: (self.<span class="hljs-keyword">method</span> != <span class="hljs-keyword">nil</span>), function -[<span class="hljs-type">APSHTTPRequest</span> send], file /<span class="hljs-type">Users</span>/vduggal/<span class="hljs-type">ForkedRepos</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPRequest</span>.m, line <span class="hljs-number">66</span>.
</code></pre><p>I dont find a file called APSHTTPRequest.m (there&#39;s a APSHTTPRequest.h in my XCode Project) neither is any user on my computer called &quot;vduggal&quot;. </p>
<p>Has anyone an idea how to deal with this?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 22nd 2014, 5:26:49 pm">July 22nd 2014</span>
				by <span class='authorname'>Horst Perfect</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>3.3.0</span></li>
					
						<li><span class='tagname'>apshttprequest</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I know this doesn&#39;t answer your question, however, to shed some light, vduggal is <a href="https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;secure&#x2F;ViewProfile.jspa?name=vduggal">Vishal Duggal</a>.</p>
<p>I use XHR extensively on 3.3.0 and have not seen this error. Can you share the code that is causing the error?</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 22nd 2014, 6:25:39 pm">July 22nd 2014</span>
								by <span class='authorname'>Allen Hartwig</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>i use xhr calls pretty much myself, it&#39;s quite interesting but it seems that the error just happens at pretty random times when i fetch a single model. Basically i just execute the following code:</p>
<pre><code class="hljs">this.model = Alloy.createModel(<span class="hljs-string">"Recipe"</span>, {
    id: id
});

this.model.fetch();

/<span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span> the model <span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>/
[...]
extendModel: function(Model) {
    _.extend(Model.prototype, {
        url: function() {
            return this.urlRoot + this.id;
        }
    });

    return Model;
},
[...]
</code></pre><p>I&#39;m currently trying to disable specific parts of the code to find out what&#39;s causing the error. But currently it seems like it&#39;s a pretty random bug. :(</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 22nd 2014, 8:00:43 pm">July 22nd 2014</span>
								by <span class='authorname'>Horst Perfect</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hmm.. just got another one: </p>
<pre><code class="hljs">[<span class="hljs-type">INFO</span>] :   <span class="hljs-type">Assertion</span> failed: (self.<span class="hljs-keyword">method</span> != <span class="hljs-keyword">nil</span>), function -[<span class="hljs-type">APSHTTPRequesAssertion</span> failed: (self.<span class="hljs-keyword">method</span> != <span class="hljs-keyword">nil</span>), function -[<span class="hljs-type">APSHTTPRequest</span> send], file /<span class="hljs-type">Users</span>/vduggal/<span class="hljs-type">ForkedRepos</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPRequest</span>.m, line <span class="hljs-number">66</span>.
[<span class="hljs-type">INFO</span>] :   t send], file /<span class="hljs-type">Users</span>/vduggal/<span class="hljs-type">ForkedRepos</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPRequest</span>.m, line <span class="hljs-number">66</span>.
[<span class="hljs-type">INFO</span>] :   <span class="hljs-type">Assertion</span> failed: (self.<span class="hljs-keyword">method</span> != <span class="hljs-keyword">nil</span>), function -[<span class="hljs-type">APSHTTPRequest</span> send], file /<span class="hljs-type">Users</span>/vduggal/<span class="hljs-type">ForkedRepos</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPClient</span>/<span class="hljs-type">APSHTTPRequest</span>.m, line <span class="hljs-number">66</span>.
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 22nd 2014, 8:10:38 pm">July 22nd 2014</span>
								by <span class='authorname'>Horst Perfect</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>6</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>6 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-281865">
				
						<section>
							<p>Hi,<br>I don&#39;t know if this will be a definitive solution but I am using it and I have found that this works for me and I no longer experience crashes due to this problem.<br>My app freezes (sometimes)  during images download BUT if I use .toImage and NOT .toBlob() to save data locally , my app runs.</p>
<p>Perhaps it helps……</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 22nd 2014, 12:40:19 pm">August 22nd 2014</span>
								by <span class='authorname'>Alberto Pace</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281865" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Alberto, I don&#39;t save any images locally (except the automatic remote-image-cache) i just have a couple of ImageViews loading remote images. :(</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 22nd 2014, 12:44:14 pm">August 22nd 2014</span>
											by <span class='authorname'>Horst Perfect</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hey Alberto, thanks for the tip…. that&#39;s indeed the problem in my case. I&#39;ve changed from toBlob to toImage and now the problem is gone. No need to implement the log that Larrie mentioned either. I did test that situation as well.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 22nd 2014, 1:09:48 pm">August 22nd 2014</span>
											by <span class='authorname'>Jeroen van Dijk</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;ve got this error too trying to resize image using toBlob().imageAsResized()<br>I changed toBlob() by toImage() and it is working now. Thanks for the tip Alberto.<br>iOS - Titanium sdk: 3.3.0 GA</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 26th 2014, 11:00:05 am">September 26th 2014</span>
											by <span class='authorname'>Alberto Diéguez Fernández</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281030">
				
						<section>
							<p>I&#39;ve just created a Jira ticket for it : https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-4454</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 23rd 2014, 11:49:46 am">July 23rd 2014</span>
								by <span class='authorname'>Richard Lustemberg</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281030" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>great, thx!</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2014, 11:50:55 am">July 23rd 2014</span>
											by <span class='authorname'>Horst Perfect</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>We are having the same issue :(</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2014, 12:00:05 pm">July 23rd 2014</span>
											by <span class='authorname'>Peter Ladis</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello everyone!</p>
<p>If you are having the issue, anyone has a testcase that reproduces it? If so, please add it to the bug so we can move it to Platform. TIA!</p>
<p>Best,<br>Mauro</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 31st 2014, 10:24:39 pm">July 31st 2014</span>
											by <span class='authorname'>Mauro Parra</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The bug was fixed for the next SDK Release 3.4.0 <a href="https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-17548">TIMOB-17548 iOS: APSHTTPRequest send fails with assertion on self.method</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="August 30th 2014, 6:44:13 am">August 30th 2014</span>
											by <span class='authorname'>Matthias Kroeger</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281028">
				
						<section>
							<p>I have the same issue. I&#39;ll look at the repo to see what happens</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 23rd 2014, 11:29:58 am">July 23rd 2014</span>
								by <span class='authorname'>Richard Lustemberg</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281028" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281376">
				
						<section>
							<p>I have the same issue, but I can&#39;t repeat the bug consistently.<br>Alberto</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 2nd 2014, 1:14:40 pm">August 2nd 2014</span>
								by <span class='authorname'>Alberto Pace</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281376" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>same here</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 4th 2014, 6:33:49 am">August 4th 2014</span>
											by <span class='authorname'>Horst Perfect</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281667">
				
						<section>
							<p>I have just started getting the same problem, and after half a day&#39;s digging narrowed it down to an image that I was downloading from our website using the following code:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">downloadFile</span><span class="hljs-params">(item)</span> </span>{
    <span class="hljs-keyword">var</span> that = <span class="hljs-keyword">this</span>;

    <span class="hljs-keyword">var</span> file = Ti.Filesystem.getFile(item.filePath);

    <span class="hljs-comment">//Create the HTTP Client object and send</span>
    <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();

    xhr.setTimeout(-<span class="hljs-number">1</span>);
    xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_e)</span> </span>{
        item.errorCallback({});
    };
    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_e)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readyState != <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">if</span> (!OS_IOS) {
            file.write(<span class="hljs-keyword">this</span>.responseData);
        }

        <span class="hljs-keyword">if</span> (isFileAnImage(file)) {
            item.completeCallback({ filePath: item.filePath });
            <span class="hljs-keyword">return</span>;
        }
        file.deleteFile();
        item.errorCallback({});
    };

    xhr.open(<span class="hljs-string">'GET'</span>, item.url);

    <span class="hljs-keyword">if</span> (OS_IOS) {
            xhr.setFile(file);
    }

    xhr.setRequestHeader(<span class="hljs-string">'Cache-Control'</span>,<span class="hljs-string">'no-cache'</span>);
    xhr.send();

};
</code></pre><p>The file was being created but it&#39;s size was 0kb on disk and when the isFileAnImage function was called, the following line of code was executed:</p>
<pre><code class="hljs">var blob = Ti.UI.createImageView<span class="hljs-comment">({image: imageFile.nativePath})</span>.toBlob<span class="hljs-comment">()</span>;
</code></pre><p>The imageFile.nativePath contained a valid path name:</p>
<pre><code class="hljs">file:///Users/abannanmacmini/Library/Application%20Support/iPhone%20Simulator/7.1/Applications/<span class="hljs-number">228D44B4</span>-EFE3-4E74-BEA2-6CF<span class="hljs-number">1406C6686</span>/Library/Caches/abreader/thumbs/7298cb58-b<span class="hljs-number">438-430</span>e-<span class="hljs-number">85c4-3f57</span>c<span class="hljs-number">33757f7</span>.png
</code></pre><p>So I started trawling through the obj-C code, starting with where the error was being generated APSHTTPRequest.m:</p>
<pre><code class="hljs">-(<span class="hljs-type">void</span>)send
{
    assert(self.url != <span class="hljs-keyword">nil</span>);
    assert(self.<span class="hljs-keyword">method</span> != <span class="hljs-keyword">nil</span>);
    assert(self.response != <span class="hljs-keyword">nil</span>);
    assert(self.response.readyState == <span class="hljs-type">APSHTTPResponseStateUnsent</span>);
...
</code></pre><p>So method wasn&#39;t being set. I then started looking top down, start with ImageView.toBlob() and this bit of code:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (imageValue!=nil)
{
    NSURL *url_ = [TiUtils <span class="hljs-string">toURL:</span>[TiUtils <span class="hljs-string">stringValue:</span>imageValue] <span class="hljs-string">proxy:</span>self];
    UIImage *image = [[ImageLoader sharedLoader] <span class="hljs-string">loadImmediateImage:</span>url_];

    <span class="hljs-keyword">if</span> (image!=nil)
    {
        <span class="hljs-keyword">return</span> [[[TiBlob alloc] <span class="hljs-string">initWithImage:</span>image] autorelease];
    }
    <span class="hljs-comment">// we're on the non-UI thread, we need to block to load</span>
    image = [[ImageLoader sharedLoader] <span class="hljs-string">loadRemote:</span>url_];
    <span class="hljs-keyword">return</span> [[[TiBlob alloc] <span class="hljs-string">initWithImage:</span>image] autorelease];
}
</code></pre><p>My image path should have returned a UIImage from ImageLoader, but didn&#39;t and so ImageLoader loadRemote was being called, in particular this bit of code:</p>
<pre><code class="hljs"><span class="hljs-name">APSHTTPRequest</span> *<span class="hljs-atom">req</span> = [[[<span class="hljs-name">APSHTTPRequest</span> <span class="hljs-atom">alloc</span>] <span class="hljs-atom">init</span>] <span class="hljs-atom">autorelease</span>];
[<span class="hljs-atom">req</span> <span class="hljs-atom">setUrl</span>:<span class="hljs-atom">url</span>];
[<span class="hljs-atom">req</span> <span class="hljs-atom">addRequestHeader</span>:@<span class="hljs-string">"User-Agent"</span> <span class="hljs-atom">value</span>:[[<span class="hljs-name">TiApp</span> <span class="hljs-atom">app</span>] <span class="hljs-atom">userAgent</span>]];
[<span class="hljs-atom">req</span> <span class="hljs-atom">setSynchronous</span>:<span class="hljs-name">YES</span>];
[[<span class="hljs-name">TiApp</span> <span class="hljs-atom">app</span>] <span class="hljs-atom">startNetwork</span>];
[<span class="hljs-atom">req</span> <span class="hljs-atom">send</span>];
[[<span class="hljs-name">TiApp</span> <span class="hljs-atom">app</span>] <span class="hljs-atom">stopNetwork</span>];
</code></pre><p>Which as you can see isn&#39;t setting the method, which I presume should be GET, so I added the following line after the setURL</p>
<pre><code class="hljs">[req <span class="hljs-built_in">set</span>Method: <span class="hljs-string">"GET"</span>];
</code></pre><p>and it now works:</p>
<p>Not sure if this is the same problem as other people, but it worked for me.</p>
<p>Hope it helps.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 14th 2014, 6:10:01 am">August 14th 2014</span>
								by <span class='authorname'>Larrie Wilson</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281667" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281862">
				
						<section>
							<p>I suffer from the same issue, but cannot reproduce why. In my code I was just replacing one remote image with the other and all of a sudden the problem was there. And I cannot seem the get rid of it either….</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 22nd 2014, 11:54:41 am">August 22nd 2014</span>
								by <span class='authorname'>Jeroen van Dijk</span><br>
								<a class="icon-bg icon-link" href="question/176379/error-assertion-failed-titanium-330ga#answer-281862" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
