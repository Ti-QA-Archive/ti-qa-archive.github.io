<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>App is crashing because of NS Range Exception (Array Error) Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>App is crashing because of NS Range Exception (Array Error)</h1>
		</header>
		<section>
			<p>I am trying to remove results after I do my search on my local database. Here is a little summary of what I ultimately want to do. </p>
<p>Basically show the results on the view and if I do another search, empty the view and array and show it again in the view with the new results. It keeps crashing unfortunately. Here is my code. Also, how would I position multiple results in different places on the same view? Any and all help is appreciated.</p>
<p>var dealerData = [];</p>
<p>dealerButton.addEventListener(&#39;click&#39;, function() {<br>    Ti.API.info(dealerData);<br>    if (dealerData.length &gt; 0) {<br>        Ti.API.info(&#39;test&#39;);<br>        dealerData = dealerData.splice(0,1);<br>    } else {<br>        Ti.API.info(&#39;empty&#39;);<br>    }<br>    var sql = &quot;SELECT * FROM dealers WHERE State = &#39;&quot;+stateDealer.value+&quot;&#39; ORDER BY Name ASC&quot;;<br>    var rows = db.execute(sql);<br>    var rowCount = rows.rowCount;</p>
<pre><code class="hljs">for<span class="hljs-list">(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; rowCount;i++) {</span>
    dealerData.push<span class="hljs-list">(<span class="hljs-keyword">Ti</span>.UI.createLabel<span class="hljs-list">({
        text: rows.fieldByName<span class="hljs-list">(<span class="hljs-quoted">'Name</span>')</span>,
        top: <span class="hljs-number">300</span>,
        font: {fontSize: <span class="hljs-number">20</span>, fontWeight: <span class="hljs-quoted">'normal</span>', fontFamily: <span class="hljs-quoted">'Source</span> Sans Pro'},
        color: <span class="hljs-quoted">'#000</span>'
    })</span>)</span><span class="hljs-comment">;</span>
    rows.next<span class="hljs-list">()</span><span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
dealerWin.add<span class="hljs-list">(<span class="hljs-keyword">dealerArea</span>)</span><span class="hljs-comment">;</span>
dealerArea.add<span class="hljs-list">(<span class="hljs-keyword">dealerData</span>)</span><span class="hljs-comment">;</span></span>
</code></pre><p>});</p>
<p>dealerWin.add(dealerView,dealerHead,dealerText,dealerButton,dealerArea,stateDealer,picker_view_dealer);</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 23rd 2013, 5:35:42 pm">July 23rd 2013</span>
				by <span class='authorname'>Matt Wohlstadter</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>array</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>titanium</span></li>
					
						<li><span class='tagname'>view</span></li>
					
				</ul>
			

			<section>
				<h5>9 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Thanks for the code but without the code syntax is a little hard to read.</p>
<p>Quick tip; When you add code snippets or logs always add 3 <strong>~</strong> on a blank line above your code and another 3 <strong>~</strong> below you code on another blank line - you will see the difference when you preview the comment. (you are not being told off)</p>
<p>Inserted code should look like;</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">something</span><span class="hljs-params">(obj)</span> </span>{
    <span class="hljs-comment">// do something</span>
}
alert(<span class="hljs-string">'Hello'</span>);
</code></pre><p>For further details click the captions on the mark-down bar for examples.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 5:43:50 pm">July 23rd 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Can I still edit my question?</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 5:46:03 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Nope to the editing - pain I know - might have enough see what I suggested and if not add it as a comment to the question - same place as your others.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 5:46:59 pm">July 23rd 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>My fault on that. Thanks for the tip Malcolm.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 5:47:21 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Here is the code for anyone else.</p>
<pre><code class="hljs">var dealerData = [];

dealerButton.addEventListener(<span class="hljs-string">'click'</span>, function() {
    Ti.API.info(dealerData);
    <span class="hljs-keyword">if</span> (dealerData.length &gt; <span class="hljs-number">0</span>) {
        Ti.API.info(<span class="hljs-string">'test'</span>);
        dealerData = dealerData.<span class="hljs-built_in">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
    } <span class="hljs-keyword">else</span> {
        Ti.API.info(<span class="hljs-string">'empty'</span>);
    }
    var sql = <span class="hljs-string">"SELECT * FROM dealers WHERE State = '"</span>+stateDealer.value+<span class="hljs-string">"' ORDER BY Name ASC"</span>;
    var rows = db.execute(sql);
    var rowCount = rows.rowCount;

    <span class="hljs-keyword">for</span>(var i = <span class="hljs-number">0</span>; i &lt; rowCount;i++) {
        dealerData.push(Ti.UI.createLabel({
            <span class="hljs-built_in">text</span>: rows.fieldByName(<span class="hljs-string">'Name'</span>),
            top: <span class="hljs-number">300</span>,
            font: {fontSize: <span class="hljs-number">20</span>, fontWeight: <span class="hljs-string">'normal'</span>, fontFamily: <span class="hljs-string">'Source Sans Pro'</span>},
            <span class="hljs-built_in">color</span>: <span class="hljs-string">'#000'</span>
        }));
        rows.next();
    };
    dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
    dealerArea.<span class="hljs-built_in">add</span>(dealerData);
});

dealerWin.<span class="hljs-built_in">add</span>(dealerView);
dealerWin.<span class="hljs-built_in">add</span>(dealerHead);
dealerWin.<span class="hljs-built_in">add</span>(dealerText);
dealerWin.<span class="hljs-built_in">add</span>(dealerButton);
dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
dealerWin.<span class="hljs-built_in">add</span>(stateDealer);
dealerWin.<span class="hljs-built_in">add</span>(picker_view_dealer);
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 5:55:42 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><pre><code class="hljs">The application has crashed <span class="hljs-operator">with</span> <span class="hljs-operator">an</span> uncaught exception <span class="hljs-string">'NSRangeException'</span>.
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 6:02:09 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Okay, I figured out why the NS Range Exception was happening. I replaced the array with an empty one and the error is g one. Now how do I clear the old data out?</p>
<pre><code class="hljs">f (dealerData.length &gt; <span class="hljs-number">0</span>) {
        Ti.API.info(<span class="hljs-string">'test'</span>);
        dealerData = [];
    } <span class="hljs-keyword">else</span> {
        Ti.API.info(<span class="hljs-string">'empty'</span>);
    }
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 6:07:10 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>The old data that is on the dealerArea view. I want to empty the dealerArea view and place my new data in there that I get back from my query.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 6:11:47 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I ended up having to replace my code earlier with an empty array to get rid of the NS Range Exception error and to get rid of the old data and use the new data in the view of dealerArea. I ended up using the code below.</p>
<pre><code class="hljs">    <span class="hljs-keyword">if</span> (dealerData.length &gt; <span class="hljs-number">0</span>) {
        dealerArea.removeAllChildren<span class="hljs-literal">()</span>;
        dealerData = <span class="hljs-literal">[]</span>;    
    } <span class="hljs-keyword">else</span> {

    }
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 23rd 2013, 6:47:16 pm">July 23rd 2013</span>
								by <span class='authorname'>Matt Wohlstadter</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-266281">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>Try it without this format;</p>
<pre><code class="hljs">dealerW<span class="hljs-keyword">in</span>.add(dealerView,dealerHead,dealerText,dealerButton,dealerArea,<span class="hljs-keyword">state</span>Dealer,picker_view_dealer);
</code></pre><p>And change it to;</p>
<pre><code class="hljs">dealerW<span class="hljs-keyword">in</span>.add(dealerView);
dealerW<span class="hljs-keyword">in</span>.add(dealerHead);
dealerW<span class="hljs-keyword">in</span>.add(dealerText);
dealerW<span class="hljs-keyword">in</span>.add(dealerButton);
dealerW<span class="hljs-keyword">in</span>.add(dealerArea);
dealerW<span class="hljs-keyword">in</span>.add(<span class="hljs-keyword">state</span>Dealer);
dealerW<span class="hljs-keyword">in</span>.add(picker_view_dealer);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 23rd 2013, 5:46:08 pm">July 23rd 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/155194/app-is-crashing-because-of-ns-range-exception-array-error#answer-266281" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Nope, didn&#39;t help. I am getting this error.</p>
<pre><code class="hljs">*** -[__NSArrayM objectAtIndex:]: index <span class="hljs-number">3</span> beyond bounds [<span class="hljs-number">0</span> .. <span class="hljs-number">2</span>]
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 5:54:01 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Here is my code now.</p>
<pre><code class="hljs">
var dealerData = [];

dealerButton.addEventListener(<span class="hljs-string">'click'</span>, function() {
    Ti.API.info(dealerData);
    <span class="hljs-keyword">if</span> (dealerData.length &gt; <span class="hljs-number">0</span>) {
        Ti.API.info(<span class="hljs-string">'test'</span>);
        dealerData = dealerData.<span class="hljs-built_in">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
    } <span class="hljs-keyword">else</span> {
        Ti.API.info(<span class="hljs-string">'empty'</span>);
    }
    var sql = <span class="hljs-string">"SELECT * FROM dealers WHERE State = '"</span>+stateDealer.value+<span class="hljs-string">"' ORDER BY Name ASC"</span>;
    var rows = db.execute(sql);
    var rowCount = rows.rowCount;

    <span class="hljs-keyword">for</span>(var i = <span class="hljs-number">0</span>; i &lt; rowCount;i++) {
        dealerData.push(Ti.UI.createLabel({
            <span class="hljs-built_in">text</span>: rows.fieldByName(<span class="hljs-string">'Name'</span>),
            top: <span class="hljs-number">300</span>,
            font: {fontSize: <span class="hljs-number">20</span>, fontWeight: <span class="hljs-string">'normal'</span>, fontFamily: <span class="hljs-string">'Source Sans Pro'</span>},
            <span class="hljs-built_in">color</span>: <span class="hljs-string">'#000'</span>
        }));
        rows.next();
    };
    dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
    dealerArea.<span class="hljs-built_in">add</span>(dealerData);
});

dealerWin.<span class="hljs-built_in">add</span>(dealerView);
dealerWin.<span class="hljs-built_in">add</span>(dealerHead);
dealerWin.<span class="hljs-built_in">add</span>(dealerText);
dealerWin.<span class="hljs-built_in">add</span>(dealerButton);
dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
dealerWin.<span class="hljs-built_in">add</span>(stateDealer);
dealerWin.<span class="hljs-built_in">add</span>(picker_view_dealer);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 5:55:02 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>As you appear to have no real array usages in the app I have stuffed your code with some debug lines; how far does it get down before failing?</p>
<pre><code class="hljs">var dealerData = [];

dealerButton.addEventListener(<span class="hljs-string">'click'</span>, function() {
    Ti.API.info(dealerData);
    Ti.API.info(<span class="hljs-string">'data length: '</span> + dealerData.length);
    <span class="hljs-keyword">if</span> (dealerData.length &gt; <span class="hljs-number">0</span>) {
        Ti.API.info(<span class="hljs-string">'test'</span>);
        dealerData = dealerData.<span class="hljs-built_in">splice</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
        Ti.API.info(<span class="hljs-string">'new data length: '</span> + dealerData.length);
    } <span class="hljs-keyword">else</span> {
        Ti.API.info(<span class="hljs-string">'empty'</span>);
    }
    var sql = <span class="hljs-string">"SELECT * FROM dealers WHERE State = '"</span>+stateDealer.value+<span class="hljs-string">"' ORDER BY Name ASC"</span>;
    var rows = db.execute(sql);
    var rowCount = rows.rowCount;
    Ti.API.info(<span class="hljs-string">'rowCount: '</span> + rowCount);

    <span class="hljs-keyword">for</span>(var i = <span class="hljs-number">0</span>; i &lt; rowCount;i++) {
        Ti.API.info(<span class="hljs-string">'i: '</span> + i);
        dealerData.push(Ti.UI.createLabel({
            <span class="hljs-built_in">text</span>: rows.fieldByName(<span class="hljs-string">'Name'</span>),
            top: <span class="hljs-number">300</span>,
            font: {fontSize: <span class="hljs-number">20</span>, fontWeight: <span class="hljs-string">'normal'</span>, fontFamily: <span class="hljs-string">'Source Sans Pro'</span>},
            <span class="hljs-built_in">color</span>: <span class="hljs-string">'#000'</span>
        }));
        rows.next();
    };
    Ti.API.info(<span class="hljs-string">'dealerArea'</span>);
    dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
    Ti.API.info(<span class="hljs-string">'dealerData'</span>);
    dealerArea.<span class="hljs-built_in">add</span>(dealerData);
});

dealerWin.<span class="hljs-built_in">add</span>(dealerView);
dealerWin.<span class="hljs-built_in">add</span>(dealerHead);
dealerWin.<span class="hljs-built_in">add</span>(dealerText);
dealerWin.<span class="hljs-built_in">add</span>(dealerButton);
dealerWin.<span class="hljs-built_in">add</span>(dealerArea);
dealerWin.<span class="hljs-built_in">add</span>(stateDealer);
dealerWin.<span class="hljs-built_in">add</span>(picker_view_dealer);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:05:43 pm">July 23rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Look at my last comment under my question.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:07:47 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You need something like this;</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> kids</span> = dealerData.children;
<span class="hljs-keyword">for</span>(<span class="hljs-variable"><span class="hljs-keyword">var</span> k</span> = <span class="hljs-number">0</span>; i <span class="hljs-type">&lt; kids.length; k++) {
    dealerData.remove(kids[k]);
}</span>
</code></pre><p>The idea being you can removed the previous child views from the parent.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:20:46 pm">July 23rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The variable kids is coming back undefined which causes it to crash on that same line. dealerData is an array fyi.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:36:59 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I got it. Look at my comment above.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:45:09 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Anyway I could space out my results individually so that I could see each result separate?</p>
<pre><code class="hljs"> for<span class="hljs-list">(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; rowCount;i++) {</span>
        Ti.API.info<span class="hljs-list">(<span class="hljs-quoted">'i</span>: ' + i)</span><span class="hljs-comment">;</span>
        dealerData.push<span class="hljs-list">(<span class="hljs-keyword">Ti</span>.UI.createLabel<span class="hljs-list">({
            text: rows.fieldByName<span class="hljs-list">(<span class="hljs-quoted">'Name</span>')</span>,
            top: <span class="hljs-number">300</span>,
            font: {fontSize: <span class="hljs-number">20</span>, fontWeight: <span class="hljs-quoted">'normal</span>', fontFamily: <span class="hljs-quoted">'Source</span> Sans Pro'},
            color: <span class="hljs-quoted">'#000</span>'
        })</span>)</span><span class="hljs-comment">;</span>
        rows.next<span class="hljs-list">()</span><span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span></span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:52:20 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Nevermind, I figured it out. Just set a variable to the top position and increment it by 50 or so in the loop.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 6:56:53 pm">July 23rd 2013</span>
											by <span class='authorname'>Matt Wohlstadter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Seems like a scope issue based on out of bounds error. Specially with functions inside event listeners you can use global variable(best to use js modules and not global variables)</p>
<p>Try placing dealerData inside event listener. </p>
<pre><code class="hljs">dealerButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
<span class="hljs-keyword">var</span> dealerData = [];
</code></pre><p>hopefully all should be good.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 7:08:19 pm">July 23rd 2013</span>
											by <span class='authorname'>Zeshan Bilal</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
