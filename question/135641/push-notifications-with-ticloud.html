<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Push notifications with Ti.Cloud? » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Push notifications with Ti.Cloud?</h1>
		</header>
		<section>
			<p>Hello everyone.</p>
<p>I&#39;m trying to create a test application to use the push notifications but I&#39;m having some troubles to make it run.</p>
<p>The example provided in the docs doesn&#39;t work for me.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> CloudPush = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloudpush'</span>);
CloudPush.retrieveDeviceToken({
        success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenSuccess</span>(<span class="hljs-params">e</span>) </span>{
            alert(<span class="hljs-string">'Device Token: '</span> + e.deviceToken);
        },
        error: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenError</span>(<span class="hljs-params">e</span>) </span>{
            alert(<span class="hljs-string">'Failed to register for push! '</span> + e.error);
        }
    });

<span class="hljs-keyword">var</span> enablePush = Ti.UI.createButton({
        title: <span class="hljs-string">'Enable Push Notifications'</span>
    });
    enablePush.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        CloudPush.enabled = <span class="hljs-literal">true</span>;
    });
    win.add(enablePush);
    CloudPush.addEventListener(<span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
        alert(evt.payload);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickLaunchedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
        Ti.API.info(<span class="hljs-string">'Tray Click Launched App (app was not running)'</span>);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickFocusedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
        Ti.API.info(<span class="hljs-string">'Tray Click Focused App (app was already running)'</span>);
    });
    win.open();
</code></pre><p>It gives me a device token, so it should be right at this point, but when I look at my app settings in the control panel I see 0 devices connected to receive push notifications…</p>
<p>The cloud settings are enabled in my project and also have the developer&#x2F;production keys in my tiapp.xml</p>
<p>Then I realized that maybe I need to use the Ti.Cloud module to subscribe to the service, but when I import the module It throws the next error:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">require</span><span class="hljs-params">(ti.cloud)</span></span>

Location: [<span class="hljs-number">43</span>,<span class="hljs-number">0</span>] ti<span class="hljs-class">.cloud</span><span class="hljs-class">.js</span>
Message: Too deep recursion while parsing
Source:
</code></pre><p>Had anyone</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 19th 2012, 5:23:43 am">April 19th 2012</span>
				by <span class='authorname'>Juan Manuel Pedraza</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>cloud</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Well, as people can see the problem is solved. I wont lock the question due to this module is relatively &quot;new&quot; and some users may find here a little bit of salvation.</p>
<p>Good morning and code strong :)</p>
<p>And thanks to Christopher Carranza for the help.</p>
</div>
							<div class="author">
								&mdash; commented <span title="April 25th 2012, 8:06:59 am">April 25th 2012</span>
								by <span class='authorname'>Juan Manuel Pedraza</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Glad i could help Juan! Good luck on your app.</p>
</div>
							<div class="author">
								&mdash; commented <span title="April 25th 2012, 1:02:29 pm">April 25th 2012</span>
								by <span class='authorname'>Christopher Carranza</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-237098">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I have my setup working, hopefully this will help you out. i have the app retrieve the device token and it sets a deviceToken variable. On the success i have it subscribe to a default user account, and then on the success of that, it subscribes to a generic &#39;alert&#39; channel. Then from there you can handle the various callbacks.</p>
<pre><code class="hljs">var CloudPush = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloudpush'</span>);
        CloudPush.<span class="hljs-built_in">debug</span> = <span class="hljs-keyword">true</span>;
        CloudPush.enabled = <span class="hljs-keyword">true</span>;
    var deviceToken

    var Cloud = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloud'</span>);
        Cloud.<span class="hljs-built_in">debug</span> = <span class="hljs-keyword">true</span>;

CloudPush.retrieveDeviceToken({
        success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenSuccess</span><span class="hljs-params">(e)</span></span> {
            //alert(<span class="hljs-string">'Device Token: '</span> + e.deviceToken);
            deviceToken = e.deviceToken
            loginDefault();

        },
        <span class="hljs-built_in">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenError</span><span class="hljs-params">(e)</span></span> {
            alert(<span class="hljs-string">'Failed to register for push! '</span> + e.<span class="hljs-built_in">error</span>);
        }
    });

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loginDefault</span><span class="hljs-params">(e)</span></span>{
        Cloud.Users.login({
            login: <span class="hljs-string">'default'</span>,
            password: <span class="hljs-string">'password'</span>
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
            <span class="hljs-keyword">if</span> (e.success) {
                defaultSubscribe();
            } <span class="hljs-keyword">else</span> {
                //alert(<span class="hljs-string">'Error:\\n'</span> +((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
            }
        });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultSubscribe</span><span class="hljs-params">()</span></span>{
        Cloud.PushNotifications.subscribe({
                    channel: <span class="hljs-string">'alert'</span>,
                    device_token: deviceToken,
                    <span class="hljs-built_in">type</span>: <span class="hljs-string">'android'</span>
                }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
                    <span class="hljs-keyword">if</span> (e.success) {
                       alert(<span class="hljs-string">'Subscribed!'</span>);
                    }
                    <span class="hljs-keyword">else</span> {
                        alert(<span class="hljs-string">'Error:'</span> +((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
                    }
                });
    }

CloudPush.addEventListener(<span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
        alert(evt);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickLaunchedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
        Ti.API.info(<span class="hljs-string">'Tray Click Launched App (app was not running)'</span>);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickFocusedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
        Ti.API.info(<span class="hljs-string">'Tray Click Focused App (app was already running)'</span>);
    });
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 24th 2012, 7:10:16 pm">April 24th 2012</span>
								by <span class='authorname'>Christopher Carranza</span><br>
								<a class="icon-bg icon-link" href="question/135641/push-notifications-with-ticloud.html#answer-237098" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Sorry, it logs in to a default user account, and then on the success of that, it subscribes to a generic &#39;alert&#39; channel.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 24th 2012, 7:11:51 pm">April 24th 2012</span>
											by <span class='authorname'>Christopher Carranza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Damn you! that one worked for me :D</p>
<p>The only thing is that I&#39;ve set some different things over you loginDefault function and used the property<br>&lt;property name=&quot;ti.android.threadstacksize&quot; type=&quot;int&quot;&gt;32768&lt;&#x2F;property&gt;</p>
<p>So, now the module works with rhino and I can send push notifications to android devices :)</p>
<p>Thanks for the help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 25th 2012, 8:04:37 am">April 25th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>can u share what u have modified in defaultlogin( )?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2012, 10:22:30 am">May 5th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Nothing in the login has been too much modified but for this example you need to create a &#39;default&#39; user in your ACS project.</p>
<p>Code strong! :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2012, 8:42:54 am">May 8th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So, I tried this, and it subscribes just fine, and I can see the device token in ACS. But, when I try to send a push notification, nothing comes through to the device.  Anyone ran into this issue?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 21st 2013, 2:06:20 am">January 21st 2013</span>
											by <span class='authorname'>Seth Davis</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Have you looked at the push logs to see if the notification was successfully sent?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 21st 2013, 1:29:41 pm">January 21st 2013</span>
											by <span class='authorname'>Christopher Carranza</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>4</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-237284">
				
						<section>
							<p>With this code I connect my phone to ACS to enable push notifications. Use it as you want :)</p>
<pre><code class="hljs"><span class="hljs-list">(<span class="hljs-keyword">function</span><span class="hljs-list">()</span><span class="hljs-collection">{
    var ostype = Ti.Platform.osname;
    if<span class="hljs-list">(<span class="hljs-keyword">ostype</span> == 'iphone' || ostype == 'ipad')</span>
        ostype = 'ios';
    var token;

    function defaultSubscribe<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
    <span class="hljs-collection">{
        Ti.Cloud.PushNotifications.subscribe<span class="hljs-list">(<span class="hljs-collection">{
            channel: 'test',
            device_token: <span class="hljs-list">(<span class="hljs-keyword">ostype</span> == 'ios')</span>?token <span class="hljs-attribute">:Ti.CloudPush.deviceToken</span>,
            type: ostype,
        }</span>, function<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span><span class="hljs-collection">{
            if<span class="hljs-list">(<span class="hljs-keyword">e.success</span>)</span>
            <span class="hljs-collection">{
                alert<span class="hljs-list">(<span class="hljs-keyword">'Subscribed!'</span>)</span><span class="hljs-comment">;</span>
            }</span>
            else
            <span class="hljs-collection">{
                alert<span class="hljs-list">(<span class="hljs-keyword">'Error:'</span> +<span class="hljs-list">(<span class="hljs-list">(<span class="hljs-keyword">e.error</span> &amp;&amp; e.message)</span> || JSON.stringify<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>)</span>)</span><span class="hljs-comment">;</span>
                alert<span class="hljs-list">(<span class="hljs-list">(<span class="hljs-keyword">ostype</span> == 'ios')</span>?token <span class="hljs-attribute">:Ti.CloudPush.deviceToken</span>)</span><span class="hljs-comment">;</span>
            }</span>
        }</span>)</span><span class="hljs-comment">;</span>
    }</span>

    function loginDefault<span class="hljs-list">()</span>
    <span class="hljs-collection">{
        Ti.Cloud.Users.login<span class="hljs-list">(<span class="hljs-collection">{
            login: 'default',
            password: 'password',
        }</span>, function<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span><span class="hljs-collection">{
            if<span class="hljs-list">(<span class="hljs-keyword">e.success</span>)</span>
            <span class="hljs-collection">{
                defaultSubscribe<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span><span class="hljs-comment">;</span>
            }</span>
            else
            <span class="hljs-collection">{
                alert<span class="hljs-list">(<span class="hljs-keyword">'Error:</span>\\n' +<span class="hljs-list">(<span class="hljs-list">(<span class="hljs-keyword">e.error</span> &amp;&amp; e.message)</span> || JSON.stringify<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>)</span>)</span><span class="hljs-comment">;</span>
            }</span>
        }</span>)</span><span class="hljs-comment">;</span>
    }</span>

    if<span class="hljs-list">(<span class="hljs-keyword">Ti.Platform.osname</span> == 'android')</span>
    <span class="hljs-collection">{
        Ti.CloudPush = require<span class="hljs-list">(<span class="hljs-keyword">'ti.cloudpush'</span>)</span><span class="hljs-comment">;</span>
        Ti.Cloud = require<span class="hljs-list">(<span class="hljs-keyword">'ti.cloud'</span>)</span><span class="hljs-comment">;</span>
        //Enabling push notifications in Android

        Ti.Cloud.PushNotifications.unsubscribe<span class="hljs-list">(<span class="hljs-collection">{}</span>, function<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span><span class="hljs-collection">{}</span>)</span><span class="hljs-comment">;</span>

        Ti.CloudPush.addEventListener<span class="hljs-list">(<span class="hljs-keyword">'callback'</span>, function<span class="hljs-list">(<span class="hljs-keyword">evt</span>)</span><span class="hljs-collection">{}</span>)</span><span class="hljs-comment">;</span>
        Ti.CloudPush.addEventListener<span class="hljs-list">(<span class="hljs-keyword">'trayClickLaunchedApp'</span>, function<span class="hljs-list">(<span class="hljs-keyword">evt</span>)</span><span class="hljs-collection">{}</span>)</span><span class="hljs-comment">;</span>
        Ti.CloudPush.addEventListener<span class="hljs-list">(<span class="hljs-keyword">'trayClickFocusedApp'</span>, function<span class="hljs-list">(<span class="hljs-keyword">evt</span>)</span><span class="hljs-collection">{}</span>)</span><span class="hljs-comment">;</span>

        Ti.CloudPush.debug = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
        Ti.Cloud.debug = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
        Ti.CloudPush.enabled = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>

        Ti.CloudPush.retrieveDeviceToken<span class="hljs-list">(<span class="hljs-collection">{
            success: function deviceTokenSuccess<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
            <span class="hljs-collection">{
                Ti.CloudPush.deviceToken = e.deviceToken;
                loginDefault<span class="hljs-list">()</span><span class="hljs-comment">;</span>
            }</span>,
            error: function deviceTokenError<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
            <span class="hljs-collection">{
                alert<span class="hljs-list">(<span class="hljs-keyword">'Failed</span> to register for push! ' + e.error)</span><span class="hljs-comment">;</span>
            }</span>
        }</span>)</span><span class="hljs-comment">;    </span>


    }</span>
    else
    <span class="hljs-collection">{
        Ti.Cloud = require<span class="hljs-list">(<span class="hljs-keyword">'ti.cloud'</span>)</span><span class="hljs-comment">;</span>
        Ti.Cloud.debug = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
        //Enabling push notifications in iOS

        Ti.Network.registerForPushNotifications<span class="hljs-list">(<span class="hljs-collection">{
            callback: function pushCallback<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
            <span class="hljs-collection">{}</span>,
            success: function pushSuccess<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
            <span class="hljs-collection">{
                token = e.deviceToken;
                loginDefault<span class="hljs-list">()</span><span class="hljs-comment">;</span>
            }</span>,
            error: function pushError<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>
            <span class="hljs-collection">{
                alert<span class="hljs-list">(<span class="hljs-keyword">'Error!:</span> '+JSON.stringify<span class="hljs-list">(<span class="hljs-keyword">e</span>)</span>)</span><span class="hljs-comment">;</span>
            }</span>,
            types: <span class="hljs-collection">[
              Ti.Network.NOTIFICATION_TYPE_BADGE,
              Ti.Network.NOTIFICATION_TYPE_ALERT,
              Ti.Network.NOTIFICATION_TYPE_SOUND
            ]</span>
        }</span>)</span><span class="hljs-comment">;</span>


    }</span>
}</span>)</span><span class="hljs-list">()</span><span class="hljs-comment">;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 26th 2012, 12:08:46 pm">April 26th 2012</span>
								by <span class='authorname'>Juan Manuel Pedraza</span><br>
								<a class="icon-bg icon-link" href="question/135641/push-notifications-with-ticloud.html#answer-237284" rel="permalink">permalink</a>
							</div>

							<h5>11 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>hi juan,<br>           i am using ur code but i am getting invalid email&#x2F;username and password error. how to solve this?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2012, 4:21:59 am">May 5th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>For the loginDefault function you need to pass a valid username and password to get the user logged in. The example above just has placeholder values. Create a user on titanium cloud first, then plug in the username and password.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2012, 9:58:18 am">May 5th 2012</span>
											by <span class='authorname'>Christopher Carranza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>thanks for your reply christopher, i am using my appcelerator account as login details but i got same exception, should i create any specific account for cloud?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2012, 3:51:12 am">May 7th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>What it actually wants for login details is not your appcelerator account, its a user account. You need to create a user in titaniums cloud services and login that way.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2012, 12:14:29 pm">May 7th 2012</span>
											by <span class='authorname'>Christopher Carranza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry for my late reply!</p>
<p>Also you can create users into you application from the phone, and then, manually login the new user and subscribe for push notifications.</p>
<p>In your application control panel (you should have enabled the ACS in your application). Remember that for push notifications and users the application will use the defaults properties of the project.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2012, 8:41:20 am">May 8th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi, guys!</p>
<p>I&#39;m trying to use push notification, but getting the error: &quot;Invalid email &#x2F; username or password.&quot;</p>
<p>I created a user in ACS control panel. Username and password, which I defined in the control panel, I use in the code. </p>
<p><img src="http:&#x2F;&#x2F;dl.dropbox.com&#x2F;u&#x2F;3914830&#x2F;08.05.png  &quot;Title&quot;" alt="alt text"></p>
<pre><code class="hljs">Cloud = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloud'</span>);

<span class="hljs-keyword">if</span>(Ti.Platform.osname == <span class="hljs-string">"android"</span>){
        pc = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloudpush'</span>);
        pc.enabled = <span class="hljs-keyword">true</span>;
        pc.showTrayNotificationsWhenFocused = <span class="hljs-keyword">true</span>;
        pc.focusAppOnPush = <span class="hljs-keyword">true</span>;

        pc.addEventListener(<span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
            alert(evt.payload);
        });
        pc.addEventListener(<span class="hljs-string">'trayClickLaunchedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
            Ti.API.info(<span class="hljs-string">'Tray Click Launched App (app was not running)'</span>);
        });
        pc.addEventListener(<span class="hljs-string">'trayClickFocusedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
            Ti.API.info(<span class="hljs-string">'Tray Click Focused App (app was already running)'</span>);
        });

    }



Ti.App.addEventListener(<span class="hljs-string">'deviceTokenObtained'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{                    
        Cloud.Users.login({
            login: <span class="hljs-string">'test_user@test.com'</span>,
            password: <span class="hljs-string">'test'</span>
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
            <span class="hljs-keyword">if</span> (e.success) {
                var user = e.users[<span class="hljs-number">0</span>];
                Ti.UI.ceateNotification({                                
                    message:<span class="hljs-string">'Success:\\n'</span> +
                    <span class="hljs-string">'id: '</span> + user.id + <span class="hljs-string">'\\n'</span> +
                    <span class="hljs-string">'first name: '</span> + user.first_name + <span class="hljs-string">'\\n'</span> +
                    <span class="hljs-string">'last name: '</span> + user.last_name
                    });

                    Cloud.PushNotifications.subscribe({
                        channel : <span class="hljs-string">'friend_request'</span>,
                        device_token : pc.dt,
                        <span class="hljs-built_in">type</span>: <span class="hljs-string">'android'</span>,
                    }, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span> {
                        <span class="hljs-keyword">if</span>(e.success) {
                            alert(<span class="hljs-string">'Success'</span>);
                        } <span class="hljs-keyword">else</span> {
                            alert(<span class="hljs-string">'Error:\\n'</span> + ((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
                        }
                    }); 

            } <span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">'Error:\\n'</span> +
                    ((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
            }
        });                                
    });


pc.retrieveDeviceToken({
    success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenSuccess</span><span class="hljs-params">(e)</span></span> {
                pc.dt = e.deviceToken;
                Ti.API.info(<span class="hljs-string">'Device Token: '</span> + e.deviceToken);
                Ti.App.fireEvent(<span class="hljs-string">'deviceTokenObtained'</span>)
            },
            <span class="hljs-built_in">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenError</span><span class="hljs-params">(e)</span></span> {
                alert(<span class="hljs-string">'Failed to register for push! '</span> + e.<span class="hljs-built_in">error</span>);
            }
        });
</code></pre><p>But still get this error.<br>Help me advice! where did I go wrong? Thank you!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2012, 12:35:39 pm">May 8th 2012</span>
											by <span class='authorname'>Andrew Vesel4ak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>problem is solved. Login is username, and I tried to log in with e-mail…</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2012, 12:48:20 pm">May 8th 2012</span>
											by <span class='authorname'>Andrew Vesel4ak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi, i have create username and password by using following code,</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createlogin</span>(<span class="hljs-params">e</span>)
 </span>{
 Cloud.Users.create({
    email: txtLoginID.value,
    first_name: <span class="hljs-string">'test_firstname'</span>,
    last_name: <span class="hljs-string">'test_lastname'</span>,
    password: <span class="hljs-string">'pass'</span>,
    password_confirmation: <span class="hljs-string">'pass'</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (e.success) {
        <span class="hljs-keyword">var</span> user = e.users[<span class="hljs-number">0</span>];
        alert(<span class="hljs-string">'Success:\\n'</span> +
            <span class="hljs-string">'id: '</span> + user.id + <span class="hljs-string">'\\n'</span> +
            <span class="hljs-string">'first name: '</span> + user.first_name + <span class="hljs-string">'\\n'</span> +
            <span class="hljs-string">'last name: '</span> + user.last_name);
    } <span class="hljs-keyword">else</span> {
        alert(<span class="hljs-string">'Error:\\n'</span> +
            ((e.error &amp;&amp; e.message) || <span class="hljs-built_in">JSON</span>.stringify(e)));
    }
});    
 }

then,

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loginDefault</span>(<span class="hljs-params">e</span>)</span>{
        Cloud.Users.login({
            login: txtLoginID.value,
            password: <span class="hljs-string">'pass'</span>
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (e.success) {
                defaultSubscribe();
            } <span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">'Error:\\n'</span> +((e.error &amp;&amp; e.message) || <span class="hljs-built_in">JSON</span>.stringify(e)));
            }
        });
    }
</code></pre><p> it was working with my device but if i run from another device i am getting invalid user and pass error. should i create login for each device?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 14th 2012, 5:37:13 am">May 14th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;ve tested login in other devices (real iphones and android) and simulators, everything went as expected. The only thing I can tell you is that I don&#39;t know where that &quot;txtLoginID.value&quot; comes from, so you should checked it, because all looks right. Also I had a code that looks a lot like that.</p>
<pre><code class="hljs"><span class="hljs-keyword">this</span>.btnCreateUserDialog_create.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">if</span>(that.txfCreateUserDialog_userName.value == <span class="hljs-string">""</span>)
        {
            alert(L(<span class="hljs-string">'frmUsers_blankuser'</span>, <span class="hljs-string">'User name field is empty'</span>));
        }
        <span class="hljs-keyword">if</span>(that.txfCreateUserDialog_password.value != that.txfCreateUserDialog_password2.value)
        {
            alert(L(<span class="hljs-string">'frmUsers_badpass'</span>, <span class="hljs-string">'Passwords doesn\'t match'</span>));
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">if</span>(that.txfCreateUserDialog_password.value == <span class="hljs-string">""</span> || that.txfCreateUserDialog_password2.value == <span class="hljs-string">""</span>)
        {
            alert(L(<span class="hljs-string">'frmUsers_blankpass'</span>, <span class="hljs-string">'Password field is blank'</span>));
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">//Create user</span>
        myapp.Cloud.Users.create({
            username: that.txfCreateUserDialog_userName.value,
            password: that.txfCreateUserDialog_password.value,
            password_confirmation: that.txfCreateUserDialog_password2.value,
        }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            alert(<span class="hljs-built_in">JSON</span>.stringify(e));
            <span class="hljs-keyword">if</span>(e.success)
            {
                myapp.Cloud.Users.logout({}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{

                });
            }
            that.clearFields();
        });
    });
</code></pre><p>And this is my login button.</p>
<pre><code class="hljs"><span class="hljs-keyword">this</span>.btnLoginDialog_loginbutton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-comment">//Login user</span>
        myapp.Cloud.Users.login({
            login: that.txfLoginUserDialog_userName.value,
            password: that.txfLoginUserDialog_password.value,
        }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            alert(<span class="hljs-built_in">JSON</span>.stringify(e));
            <span class="hljs-keyword">if</span>(e.success)
                that.vwmLoginDialog.animate(that.anmHideCreateUserDialogAnimation);
        });
    });
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 15th 2012, 6:39:23 am">May 15th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>so for every device i need to create new user login right?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 15th 2012, 10:12:19 am">May 15th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>When I change user and password It is totally working!!! Thank you so much!!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 1:11:22 pm">November 2nd 2012</span>
											by <span class='authorname'>Prashish Shrestha</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>4</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-236560">
				
						<section>
							<p>By the way:</p>
<ul>
<li>Titanium SDK: 2.0.1.GA2</li>
<li>Android runtime: Rhino</li>
<li>Device: Samsung Galaxy Ace (Gingerbread 2.3.4)</li>
<li>OS: Mac OsX Snow Leopard 10.6.8</li>
</ul>
<p>I have checked that the problem only occurs when I&#39;m using the rhino runtime. In v8 gives me any problem but we need Rhino in this project.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 19th 2012, 5:46:49 am">April 19th 2012</span>
								by <span class='authorname'>Juan Manuel Pedraza</span><br>
								<a class="icon-bg icon-link" href="question/135641/push-notifications-with-ticloud.html#answer-236560" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-236585">
				
						<section>
							<p>Same problem here. I hope there will be a solution very soon!</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 19th 2012, 9:20:28 am">April 19th 2012</span>
								by <span class='authorname'>Marc Galpos</span><br>
								<a class="icon-bg icon-link" href="question/135641/push-notifications-with-ticloud.html#answer-236585" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-238640">
				
						<section>
							<pre><code class="hljs">//
// create Login window
//

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HandleAlerts</span><span class="hljs-params">(varStr)</span></span>
{
   tab2.show();
}

var winLogin = Titanium.UI.createWindow({
    title:<span class="hljs-string">'Login'</span>,
    //barColor: c2cBarColor,
    backgroundColor:c2cBGColor
});
<span class="hljs-keyword">if</span>(ScreenSize == <span class="hljs-string">'medium'</span>)
{
    var lblLoginTitle = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Use your Corp-Corp login'</span>,
    top:<span class="hljs-number">10</span>,
    left:<span class="hljs-number">30</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-number">20</span>,
    font:{fontSize:<span class="hljs-number">14</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var lblLoginID = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Email ID'</span>,
    top:<span class="hljs-number">40</span>,
    left:<span class="hljs-number">30</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-string">'auto'</span>,
    font:{fontSize:<span class="hljs-number">12</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var txtLoginID = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Registered Email ID'</span>,
    top:<span class="hljs-number">70</span>,
    left:<span class="hljs-number">30</span>,
    width:intW-<span class="hljs-number">60</span>,
    height:<span class="hljs-number">50</span>,
    keyboardType:Titanium.UI.KEYBOARD_EMAIL,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
var lblPassword = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Password'</span>,
    top:<span class="hljs-number">120</span>,
    left:<span class="hljs-number">30</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-string">'auto'</span>,
    font:{fontSize:<span class="hljs-number">14</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var txtPassword = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Password'</span>,
    passwordMask:<span class="hljs-keyword">true</span>,
    top:<span class="hljs-number">150</span>,
    left:<span class="hljs-number">30</span>,
    width:intW-<span class="hljs-number">60</span>,
    height:<span class="hljs-number">50</span> //,
    //borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
var btnLogin = Titanium.UI.createButton({
    color:<span class="hljs-string">'#fff'</span>,
    title:<span class="hljs-string">'Login'</span>,
    width:intW-<span class="hljs-number">60</span>,
    height:<span class="hljs-number">35</span>,
    top:<span class="hljs-number">220</span>,
    backgroundImage:<span class="hljs-string">'images/btn_bg.png'</span>
    // borderRadius:<span class="hljs-number">10</span>,
    // backgroundGradient:{<span class="hljs-built_in">type</span>:<span class="hljs-string">'linear'</span>, colors:[<span class="hljs-string">'#333333'</span>,<span class="hljs-string">'#666666'</span>], startPoint:{x:<span class="hljs-number">0</span>,y:<span class="hljs-number">0</span>}, endPoint:{x:<span class="hljs-number">2</span>,y:<span class="hljs-number">50</span>}, backFillStart:<span class="hljs-keyword">false</span>},
    //  borderWidth:<span class="hljs-number">1</span>,
    // borderColor:<span class="hljs-string">'#666'</span>
});
var btnCancel = Titanium.UI.createButton({
    color:<span class="hljs-string">'#fff'</span>,
    title:<span class="hljs-string">'Cancel'</span>,
    top:<span class="hljs-number">270</span>,
    left:<span class="hljs-number">30</span>,
    width:intW-<span class="hljs-number">60</span>,
    height:<span class="hljs-number">35</span>,
    backgroundImage:<span class="hljs-string">'images/btn_bg.png'</span>
});
var lblInfo = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'If you are not registered with Corp-corp, please visit www.corp-corp.com and sign-up for an account.'</span>,
    top:<span class="hljs-number">320</span>,
    left:<span class="hljs-number">30</span>,
    width:<span class="hljs-number">260</span>,
    height:<span class="hljs-number">60</span>,
    font:{fontSize:<span class="hljs-number">12</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});

}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ScreenSize ==<span class="hljs-string">'low'</span>)
{
var lblLoginTitle = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Use your Corp-Corp login'</span>,
    top:<span class="hljs-number">5</span>,
    left:<span class="hljs-number">30</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-number">20</span>,
    font:{fontSize:<span class="hljs-number">14</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var lblLoginID = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Email ID'</span>,
    top:<span class="hljs-number">25</span>,
    left:<span class="hljs-number">25</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-number">25</span>,
    font:{fontSize:<span class="hljs-number">12</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var txtLoginID = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Registered Email ID'</span>,
    top:<span class="hljs-number">50</span>,
    left:<span class="hljs-number">25</span>,
    width:intW-<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span>,
    keyboardType:Titanium.UI.KEYBOARD_EMAIL,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
var lblPassword = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'Password'</span>,
    top:<span class="hljs-number">85</span>,
    left:<span class="hljs-number">25</span>,
    width:<span class="hljs-string">'auto'</span>,
    height:<span class="hljs-string">'auto'</span>,
    font:{fontSize:<span class="hljs-number">14</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});
var txtPassword = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Password'</span>,
    passwordMask:<span class="hljs-keyword">true</span>,
    top:<span class="hljs-number">105</span>,
    left:<span class="hljs-number">25</span>,
    width:intW-<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span> //,
    //borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
var btnLogin = Titanium.UI.createButton({
    title:<span class="hljs-string">'Login'</span>,
    width:intW-<span class="hljs-number">90</span>,
    height:<span class="hljs-number">30</span>,
    top:<span class="hljs-number">145</span>,
    color:<span class="hljs-string">'#fff'</span>,
  //  borderRadius:<span class="hljs-number">10</span>,
   // backgroundGradient:{<span class="hljs-built_in">type</span>:<span class="hljs-string">'linear'</span>, colors:[<span class="hljs-string">'#333333'</span>,<span class="hljs-string">'#666666'</span>], startPoint:{x:<span class="hljs-number">0</span>,y:<span class="hljs-number">0</span>}, endPoint:{x:<span class="hljs-number">2</span>,y:<span class="hljs-number">50</span>}, backFillStart:<span class="hljs-keyword">false</span>},
   // borderWidth:<span class="hljs-number">1</span>,
   // borderColor:<span class="hljs-string">'#666'</span>,
    backgroundImage:<span class="hljs-string">'images/btn_bg.png'</span>
});
var btnCancel = Titanium.UI.createButton({
    color:<span class="hljs-string">'#fff'</span>,
    title:<span class="hljs-string">'Cancel'</span>,
    top:<span class="hljs-number">180</span>,
    width:intW-<span class="hljs-number">90</span>,
    height:<span class="hljs-number">30</span>,
     backgroundImage:<span class="hljs-string">'images/btn_bg.png'</span>
});
var lblInfo = Titanium.UI.createLabel({
    color:<span class="hljs-string">'#000'</span>,
    text:<span class="hljs-string">'If you are not registered with Corp-corp, please visit www.corp-corp.com and sign-up for an account.'</span>,
    top:<span class="hljs-number">220</span>,
    left:<span class="hljs-number">30</span>,
    width:intW-<span class="hljs-number">40</span>,
    height:<span class="hljs-number">60</span>,
    font:{fontSize:<span class="hljs-number">12</span>,fontWeight:<span class="hljs-string">'bold'</span>}
});    
}

winLogin.add(lblLoginTitle);
winLogin.add(lblLoginID);
winLogin.add(txtLoginID);
winLogin.add(lblPassword);
winLogin.add(txtPassword);

btnLogin.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
{
    <span class="hljs-keyword">if</span>(!Titanium.Network.online)
    {
        alert(<span class="hljs-string">'Could not detect a network connection. This action requires a network connection'</span>);
        <span class="hljs-keyword">return</span>;
    }

    txtLoginID.blur();
    txtPassword.blur();

    <span class="hljs-keyword">if</span>(txtLoginID.value.length == <span class="hljs-number">0</span> || txtPassword.length == <span class="hljs-number">0</span>)
    {
        cAlert.message = <span class="hljs-string">'Please enter a valid Email ID and password'</span>;
        cAlert.buttonNames = [<span class="hljs-string">'Ok'</span>];
        cAlert.show();
        <span class="hljs-keyword">return</span>;
    }    

    showWait(winLogin);

    blnLogged = <span class="hljs-keyword">false</span>;

    var xhr = Ti.Network.createHTTPClient();
    xhr.timeout = <span class="hljs-number">10000</span>;

    xhr.open(<span class="hljs-string">"GET"</span>, strServer + <span class="hljs-string">"c2cm.aspx?a=1&amp;fldLog="</span> + txtLoginID.value + <span class="hljs-string">"&amp;fldPass="</span> + txtPassword.value);
   Titanium.API.info(<span class="hljs-string">"url: "</span>+strServer + <span class="hljs-string">"c2cm.aspx?a=1&amp;fldLog="</span> + txtLoginID.value + <span class="hljs-string">"&amp;fldPass="</span> + txtPassword.value);
    xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span> {
            hideWait(winLogin);

            alert(<span class="hljs-string">'C2C Mobile encountered an error'</span>);

        }; 

    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
    {
        try
        {
           hideWait(winLogin);
           var lr  = eval(<span class="hljs-string">'('</span> + this.responseText +<span class="hljs-string">')'</span>);
           <span class="hljs-keyword">if</span>(lr[<span class="hljs-number">0</span>].logged == <span class="hljs-string">'true'</span>)
           {
              InsertLogin(lr, js_notifications);
              js_id = lr[<span class="hljs-number">0</span>].js_id;
              //
              RegisterForNotifications();  // stores notification status <span class="hljs-keyword">in</span> <span class="hljs-built_in">table</span>
              //
              winLogin.close();
              //
              RefreshSettings();
           }
           <span class="hljs-keyword">else</span>
           {
                cAlert.message = <span class="hljs-string">'Invalid login information, please try again.'</span>;
                cAlert.buttonNames = [<span class="hljs-string">'Ok'</span>];
                cAlert.show();
           }
        }
        catch(E){
            cAlert.message = <span class="hljs-string">'Error contacting server, please try again.'</span>;
            Ti.API.info(E.message);
            cAlert.buttonNames = [<span class="hljs-string">'Ok'</span>];
            cAlert.show();
        }
    };

    // Get the data
    xhr.send();
});

/*<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RegisterForNotifications</span><span class="hljs-params">()</span></span>
{
    Titanium.Network.registerForPushNotifications({
    types: [
        Titanium.Network.NOTIFICATION_TYPE_BADGE,
        Titanium.Network.NOTIFICATION_TYPE_ALERT,
        Titanium.Network.NOTIFICATION_TYPE_SOUND
    ],
    success:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>
    {
        var deviceToken = e.deviceToken;
        js_notifications = <span class="hljs-number">1</span>;

        SetJSNotificationStatus(<span class="hljs-number">1</span>);

        var request = Titanium.Network.createHTTPClient();
        request.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        {
            Ti.API.info(<span class="hljs-string">'in utf-8 onload for POST'</span>);
        };
        request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        {
            Ti.API.info(<span class="hljs-string">'in utf-8 error for POST'</span>);
        };
        request.open(<span class="hljs-string">"GET"</span>, strServer + <span class="hljs-string">"c2cm.aspx?a=3&amp;js_id="</span> + js_id + <span class="hljs-string">"&amp;appname=appname&amp;appversion="</span>+escape(Titanium.App.version)+<span class="hljs-string">"&amp;deviceuid="</span>+escape(Titanium.Platform.id)+<span class="hljs-string">"&amp;devicetoken="</span>+escape(e.deviceToken)+<span class="hljs-string">"&amp;devicemodel="</span>+escape(Titanium.Platform.model)+<span class="hljs-string">"&amp;devicename=tester&amp;deviceversion="</span>+escape(Titanium.Platform.version)+<span class="hljs-string">"&amp;pushbadge=1&amp;pushalert=1&amp;pushsound=1"</span>);
        request.send();
    },
    <span class="hljs-built_in">error</span>:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>
    {
        alert(<span class="hljs-string">"Error during notification registration, please try again"</span>+e.<span class="hljs-built_in">error</span>);
    },
    callback:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>
    {
        // called when a push notification is received.
        HandleAlerts(JSON.stringify(e.data));
    }
    });
}*/
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RegisterForNotifications</span><span class="hljs-params">()</span></span>{
    var CloudPush = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloudpush'</span>);
        CloudPush.<span class="hljs-built_in">debug</span> = <span class="hljs-keyword">true</span>;
        CloudPush.enabled = <span class="hljs-keyword">true</span>;
    var deviceToken

    var Cloud = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloud'</span>);
        Cloud.<span class="hljs-built_in">debug</span> = <span class="hljs-keyword">true</span>;

CloudPush.retrieveDeviceToken({
        success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenSuccess</span><span class="hljs-params">(e)</span></span> {
            //alert(<span class="hljs-string">'Device Token: '</span> + e.deviceToken);
            deviceToken = e.deviceToken
           // createlogin();
            loginDefault();

         js_notifications = <span class="hljs-number">1</span>;

        SetJSNotificationStatus(<span class="hljs-number">1</span>);
         //alert(<span class="hljs-string">"devicetoken: "</span>+Ti.CloudPush.deviceToken);
       var request = Titanium.Network.createHTTPClient();
        request.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        {
            Ti.API.info(<span class="hljs-string">'in utf-8 onload for POST'</span>);
        };
        request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        {
            Ti.API.info(<span class="hljs-string">'in utf-8 error for POST'</span>);
        };
        request.open(<span class="hljs-string">"GET"</span>, strServer + <span class="hljs-string">"c2cm.aspx?a=3&amp;js_id="</span> + js_id + <span class="hljs-string">"&amp;appname=appname&amp;appversion="</span>+escape(Titanium.App.version)+<span class="hljs-string">"&amp;deviceuid="</span>+escape(Titanium.Platform.id)+<span class="hljs-string">"&amp;devicetoken="</span>+escape(e.deviceToken)+<span class="hljs-string">"&amp;devicemodel="</span>+escape(Titanium.Platform.model)+<span class="hljs-string">"&amp;devicename=tester&amp;deviceversion="</span>+escape(Titanium.Platform.version)+<span class="hljs-string">"&amp;pushbadge=1&amp;pushalert=1&amp;pushsound=1"</span>);
        request.send();  
        },
        <span class="hljs-built_in">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenError</span><span class="hljs-params">(e)</span></span> {
            alert(<span class="hljs-string">'Failed to register for push! '</span> + e.<span class="hljs-built_in">error</span>);
        }
    });
// i have used this method only once to create user
 /*<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createlogin</span><span class="hljs-params">(e)</span></span>
 {
 Cloud.Users.create({
    email: <span class="hljs-string">'android@ch.us'</span>,
    first_name: <span class="hljs-string">'test_firstname'</span>,
    last_name: <span class="hljs-string">'test_lastname'</span>,
    password: <span class="hljs-string">'625010'</span>,
    password_confirmation: <span class="hljs-string">'mips625010'</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
    <span class="hljs-keyword">if</span> (e.success) {
        var user = e.users[<span class="hljs-number">0</span>];
      /*  alert(<span class="hljs-string">'Success:\\n'</span> +
            <span class="hljs-string">'id: '</span> + user.id + <span class="hljs-string">'\\n'</span> +
            <span class="hljs-string">'first name: '</span> + user.first_name + <span class="hljs-string">'\\n'</span> +
            <span class="hljs-string">'last name: '</span> + user.last_name);*/
    } <span class="hljs-keyword">else</span> {
        alert(<span class="hljs-string">'Error:\\n'</span> +
            ((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
    }
});    
 }*/
//login by created user details
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loginDefault</span><span class="hljs-params">(e)</span></span>{
        Cloud.Users.login({
            login: <span class="hljs-string">'android@ch.us'</span>,
            password: <span class="hljs-string">'625010'</span>
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
            <span class="hljs-keyword">if</span> (e.success) {
                defaultSubscribe();
            } <span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">'Error:\\n'</span> +((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
            }
        });
    }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultSubscribe</span><span class="hljs-params">()</span></span>{
        Cloud.PushNotifications.subscribe({
                    channel: <span class="hljs-string">'alert'</span>,
                    device_token: deviceToken,
                    <span class="hljs-built_in">type</span>: <span class="hljs-string">'android'</span>
                }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span></span> {
                    <span class="hljs-keyword">if</span> (e.success) {
                       //alert(<span class="hljs-string">'Subscribed!'</span>);

                    }
                    <span class="hljs-keyword">else</span> {

                        alert(<span class="hljs-string">'Error:'</span> +((e.<span class="hljs-built_in">error</span> &amp;&amp; e.message) || JSON.stringify(e)));
                    }
                });
    }

CloudPush.addEventListener(<span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
       // alert(evt);
       HandleAlerts(JSON.stringify(e.data));
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickLaunchedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
        Ti.API.info(<span class="hljs-string">'Tray Click Launched App (app was not running)'</span>);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickFocusedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span></span> {
        Ti.API.info(<span class="hljs-string">'Tray Click Focused App (app was already running)'</span>);
    });

}

winLogin.add(btnLogin);
btnCancel.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
{
    winLogin.close();
});

winLogin.add(btnCancel);
winLogin.add(lblInfo);
</code></pre><p>Hi Juan,<br>this is my login page. this is how i implement push i have used user.create() at once and for every time i login by using existing login details. i am getting invalid user and password error.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 15th 2012, 11:07:41 am">May 15th 2012</span>
								by <span class='authorname'>malar prathap</span><br>
								<a class="icon-bg icon-link" href="question/135641/push-notifications-with-ticloud.html#answer-238640" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><pre><code class="hljs"><span class="hljs-keyword">var</span> winLogin = Titanium.UI.createWindow({
    title:<span class="hljs-string">'Login'</span>,
    <span class="hljs-comment">//barColor: c2cBarColor,</span>
    backgroundColor:c2cBGColor
});

<span class="hljs-keyword">var</span> txtLoginID = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Registered Email ID'</span>,
    top:<span class="hljs-number">50</span>,
    left:<span class="hljs-number">25</span>,
    width:intW-<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span>,
    keyboardType:Titanium.UI.KEYBOARD_EMAIL,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
<span class="hljs-keyword">var</span> txtPassword = Titanium.UI.createTextField({
    color:<span class="hljs-string">'#000'</span>,
    hintText:<span class="hljs-string">'Password'</span>,
    passwordMask:<span class="hljs-literal">true</span>,
    top:<span class="hljs-number">105</span>,
    left:<span class="hljs-number">25</span>,
    width:intW-<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span> <span class="hljs-comment">//,</span>
    <span class="hljs-comment">//borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED</span>
});
<span class="hljs-keyword">var</span> btnLogin = Titanium.UI.createButton({
    title:<span class="hljs-string">'Login'</span>,
    width:intW-<span class="hljs-number">90</span>,
    height:<span class="hljs-number">30</span>,
    top:<span class="hljs-number">145</span>,
    color:<span class="hljs-string">'#fff'</span>,
});

btnLogin.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-keyword">if</span>(!Titanium.Network.online)
    {
        alert(<span class="hljs-string">'Could not detect a network connection. This action requires a network connection'</span>);
        <span class="hljs-keyword">return</span>;
    }

    txtLoginID.blur();
    txtPassword.blur();

    <span class="hljs-keyword">if</span>(txtLoginID.value.length == <span class="hljs-number">0</span> || txtPassword.length == <span class="hljs-number">0</span>)
    {
        cAlert.message = <span class="hljs-string">'Please enter a valid Email ID and password'</span>;
        cAlert.buttonNames = [<span class="hljs-string">'Ok'</span>];
        cAlert.show();
        <span class="hljs-keyword">return</span>;
    }    

    showWait(winLogin);

    blnLogged = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
    xhr.timeout = <span class="hljs-number">10000</span>;
    xhr.open(<span class="hljs-string">"GET"</span>, strServer + <span class="hljs-string">"c2cm.aspx?a=1&amp;fldLog="</span> + txtLoginID.value + <span class="hljs-string">"&amp;fldPass="</span> + txtPassword.value);
   Titanium.API.info(<span class="hljs-string">"url: "</span>+strServer + <span class="hljs-string">"c2cm.aspx?a=1&amp;fldLog="</span> + txtLoginID.value + <span class="hljs-string">"&amp;fldPass="</span> + txtPassword.value);
    xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            hideWait(winLogin);
            alert(<span class="hljs-string">'C2C Mobile encountered an error'</span>);

        }; 

    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">try</span>
        {
           hideWait(winLogin);
           <span class="hljs-keyword">var</span> lr  = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span> + <span class="hljs-keyword">this</span>.responseText +<span class="hljs-string">')'</span>);
           <span class="hljs-keyword">if</span>(lr[<span class="hljs-number">0</span>].logged == <span class="hljs-string">'true'</span>)
           {
              InsertLogin(lr, js_notifications);
              js_id = lr[<span class="hljs-number">0</span>].js_id;
              <span class="hljs-comment">//</span>
              RegisterForNotifications();  <span class="hljs-comment">// stores notification status in table</span>
              <span class="hljs-comment">//</span>
              winLogin.close();
        }
           <span class="hljs-keyword">else</span>
           {
                cAlert.message = <span class="hljs-string">'Invalid login information, please try again.'</span>;
                cAlert.buttonNames = [<span class="hljs-string">'Ok'</span>];
                cAlert.show();
           }
        }
        <span class="hljs-keyword">catch</span>(E){
                }
    };

    <span class="hljs-comment">// Get the data</span>
    xhr.send();
});
</code></pre><p>and this is my registerforpush function</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RegisterForNotifications</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> CloudPush = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloudpush'</span>);
        CloudPush.debug = <span class="hljs-literal">true</span>;
        CloudPush.enabled = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> deviceToken

    <span class="hljs-keyword">var</span> Cloud = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.cloud'</span>);
        Cloud.debug = <span class="hljs-literal">true</span>;

CloudPush.retrieveDeviceToken({
        success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenSuccess</span>(<span class="hljs-params">e</span>) </span>{
           deviceToken = e.deviceToken
            createlogin();
            loginDefault();
       js_notifications = <span class="hljs-number">1</span>;
    SetJSNotificationStatus(<span class="hljs-number">1</span>);

       <span class="hljs-keyword">var</span> request = Titanium.Network.createHTTPClient();
        request.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
        </span>{
            Ti.API.info(<span class="hljs-string">'in utf-8 onload for POST'</span>);
        };
        request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
        </span>{
            Ti.API.info(<span class="hljs-string">'in utf-8 error for POST'</span>);
        };
        request.open(<span class="hljs-string">"GET"</span>, strServer + <span class="hljs-string">"c2cm.aspx?a=3&amp;js_id="</span> + js_id + <span class="hljs-string">"&amp;appname=appname&amp;appversion="</span>+<span class="hljs-built_in">escape</span>(Titanium.App.version)+<span class="hljs-string">"&amp;deviceuid="</span>+<span class="hljs-built_in">escape</span>(Titanium.Platform.id)+<span class="hljs-string">"&amp;devicetoken="</span>+<span class="hljs-built_in">escape</span>(e.deviceToken)+<span class="hljs-string">"&amp;devicemodel="</span>+<span class="hljs-built_in">escape</span>(Titanium.Platform.model)+<span class="hljs-string">"&amp;devicename=tester&amp;deviceversion="</span>+<span class="hljs-built_in">escape</span>(Titanium.Platform.version)+<span class="hljs-string">"&amp;pushbadge=1&amp;pushalert=1&amp;pushsound=1"</span>);
        request.send();  
        },
        error: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deviceTokenError</span>(<span class="hljs-params">e</span>) </span>{
            alert(<span class="hljs-string">'Failed to register for push! '</span> + e.error);
        }
    });
 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createlogin</span>(<span class="hljs-params">e</span>)
 </span>{
 Cloud.Users.create({
    email: <span class="hljs-string">'android@qfetch.us'</span>,
    first_name: <span class="hljs-string">'test_firstname'</span>,
    last_name: <span class="hljs-string">'test_lastname'</span>,
    password: <span class="hljs-string">'mips625010'</span>,
    password_confirmation: <span class="hljs-string">'mips625010'</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (e.success) {
        <span class="hljs-keyword">var</span> user = e.users[<span class="hljs-number">0</span>];
      <span class="hljs-comment">/*  alert('Success:\\n' +
            'id: ' + user.id + '\\n' +
            'first name: ' + user.first_name + '\\n' +
            'last name: ' + user.last_name);*/</span>
    } <span class="hljs-keyword">else</span> {
        alert(<span class="hljs-string">'Error:\\n'</span> +
            ((e.error &amp;&amp; e.message) || <span class="hljs-built_in">JSON</span>.stringify(e)));
    }
});    
 }
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loginDefault</span>(<span class="hljs-params">e</span>)</span>{
        Cloud.Users.login({
            login: <span class="hljs-string">'android@qfetch.us'</span>,
            password: <span class="hljs-string">'mips625010'</span>
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (e.success) {
                defaultSubscribe();
            } <span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">'Error:\\n'</span> +((e.error &amp;&amp; e.message) || <span class="hljs-built_in">JSON</span>.stringify(e)));
            }
        });
    }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultSubscribe</span>(<span class="hljs-params"></span>)</span>{
        Cloud.PushNotifications.subscribe({
                    channel: <span class="hljs-string">'alert'</span>,
                    device_token: deviceToken,
                    type: <span class="hljs-string">'android'</span>
                }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                    <span class="hljs-keyword">if</span> (e.success) {
                      }
                    <span class="hljs-keyword">else</span> {

                        alert(<span class="hljs-string">'Error:'</span> +((e.error &amp;&amp; e.message) || <span class="hljs-built_in">JSON</span>.stringify(e)));
                    }
                });
    }

CloudPush.addEventListener(<span class="hljs-string">'callback'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
       <span class="hljs-comment">// alert(evt);</span>
       HandleAlerts(<span class="hljs-built_in">JSON</span>.stringify(e.data));
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickLaunchedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
        Ti.API.info(<span class="hljs-string">'Tray Click Launched App (app was not running)'</span>);
    });
    CloudPush.addEventListener(<span class="hljs-string">'trayClickFocusedApp'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) </span>{
        Ti.API.info(<span class="hljs-string">'Tray Click Focused App (app was already running)'</span>);
    });

}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 15th 2012, 11:22:42 am">May 15th 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Maybe there is something wrong here. There is a possibility but I&#39;m not sure why or how could happen.</p>
<p>The possibility is that one of your devices is using the development ACS key and the other is using the production ACS key (this is all hypothetical).</p>
<p>Try to create the default user in the production branch of your application (in your application settings) with the same parameters that the one you created in the development one.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 17th 2012, 7:15:17 am">May 17th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>how to create default user in cloud service?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 31st 2012, 9:53:59 am">May 31st 2012</span>
											by <span class='authorname'>malar prathap</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Go to you application panel -&gt; manage ACS -&gt; Users and there you can set up both branches: development and production.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 7th 2012, 5:18:46 am">June 7th 2012</span>
											by <span class='authorname'>Juan Manuel Pedraza</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
