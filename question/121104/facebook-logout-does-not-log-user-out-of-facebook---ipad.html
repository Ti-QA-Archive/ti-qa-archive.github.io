<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Facebook Logout does not log user out of facebook - iPad » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Facebook Logout does not log user out of facebook - iPad</h1>
		</header>
		<section>
			<p>[Using Ti SDK 1.6.2, iOs SDK 4.3]</p>
<p>I&#39;ve been struggling with a strange issue for over a week now. Searched everywhere and can&#39;t find an answer. </p>
<p>I&#39;m building an iPad app that allows a user to post a pre-canned message on their wall from the app. When they click the &quot;Post Status&quot; button in my app, they are taken to safari to log in to facebook and then authorize the app. Then they are brought back to the app at which point they get a confirmation message that their post was posted to their wall, and then i call Titanium.Facebook.logout() to automatically log the user out. This is necessary as another person will use that same iPad to do the same thing. I can&#39;t have the previous user still logged in. </p>
<p>Unfortunately, although all alerts i&#39;ve set confirm that the previous user is logged out, when the next user clicks &quot;Post Status&quot; and are brought to safari to log in, instead of the FB login screen, i get the &quot;You&#39;ve already authorized this app. Click Okay below to continue.&quot; along with the message at bottom that says &quot;You&#39;re logged in as John Doe. (Not You?)&quot;</p>
<p>I&#39;ve also tried placing a facebook login button on the page for testing. I get the same results. Even though when i click the FB logout button it switches to it&#39;s &quot;login&quot; state, indicating that i&#39;ve been logged out. When the next user clicks FB &quot;Login&quot;, same results as above. </p>
<p>One thing i&#39;ve noticed. In Titanium, if i run the simulator with iOS SDK 4.1, i get the old in-app facebook dialog window (instead of redirect to safari) and log in&#x2F;logout work perfectly. Unfortunately, even if i package for 4.1, if the physical iPad the app is running on has 4.2 or 4.3 installed, all of the above issues come back. </p>
<p>I&#39;ve tried the kitchen sink example, and I&#39;m having the same issues. So wondering if it has something to do with iOS 4.2&#x2F;4.3.</p>
<p>Help?</p>
<p>Thanks!</p>
<p>Michael</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 15th 2011, 12:34:24 pm">June 15th 2011</span>
				by <span class='authorname'>Michael Trettewick</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>facebook</span></li>
					
						<li><span class='tagname'>ios4</span></li>
					
						<li><span class='tagname'>ipad</span></li>
					
						<li><span class='tagname'>logout</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>7</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>7 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-210390">
				
						<section>
							<p>I figured it out. It was an issue with Ti SDK 1.6.x. (http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-3169) I upgraded to 1.7 and i&#39;m now able to pop up the FB dialog box within the app. This gives the app true control over the authentication, so when I log out, it actually fully logs me out of FB. Thanks everyone for the help!</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 6:13:35 pm">June 15th 2011</span>
								by <span class='authorname'>Michael Trettewick</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210390" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210357">
				
						<section>
							<p>You&#39;ve cleared your iphone build folder?  Reset content+settings on the simulator?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 1:21:28 pm">June 15th 2011</span>
								by <span class='authorname'>Anthony Sosso</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210357" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210361">
				
						<section>
							<p>On the FB logout event I would also explicitly set Ti.Facebook.uid to null too. </p>
<p>Also, if you want to make sure the app doesn&#39;t have to keep re-authorizing, you need to also request the &#39;offline_access&#39; permission. This will provide your app user with an access token which ever expires.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 1:31:09 pm">June 15th 2011</span>
								by <span class='authorname'>Kosso</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210361" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I tried adding Ti.Facebook.uid = null to the logout event handler and getting the same issue. Instead of logging the user out, it just keeps the same user logged in and says already authorized. </p>
<p>Regarding your second point, i do NOT want the access token to persist. Again, different people will be taking turns using the app in order to post the canned message on their individual walls. So I need the previous user completely logged out so that the next user can log in (without having to click the &quot;(Not you?)&quot; link to log out the previous user. The previous user should be cleared and the next user should be presented with the Facebook login screen.</p>
<p>Thanks for the help!</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 1:53:28 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210367">
				
						<section>
							<p>OK. I see what you mean now:</p>
<p>To make sure the user is logged out then, how about using an App.Property to save the current user&#39;s access_token and login details&#x2F;name&#x2F;picture_url etc and then making sure that all your FB function calls use your saved version, rather than what the Ti FB login results provide?</p>
<p>eg: on the Ti.Facebook login event: </p>
<pre><code class="hljs">Ti.App.<span class="hljs-keyword">Properties</span>.setString(<span class="hljs-string">'fb_access_token'</span>,Ti.Facebook.accessToken);
</code></pre><p>etc..</p>
<p>Then, when your user leaves the app &#x2F; logs out, simply clear the Property out</p>
<pre><code class="hljs">Ti.App.Properties.setString(<span class="hljs-string">'fb_access_token'</span>,<span class="hljs-literal">null</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 2:03:17 pm">June 15th 2011</span>
								by <span class='authorname'>Kosso</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210367" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I added the code above to the login and log out even handlers, respectively, and still getting the same issue. I tested the kitchen sink version and it does the same thing, so i wonder if this is a bug. Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 2:45:31 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210378">
				
						<section>
							<p>Yeah this is pretty much how it works. .logout() turns off the app&#39;s connection to facebook, but Safari is still logged in to facebook.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 4:05:03 pm">June 15th 2011</span>
								by <span class='authorname'>Todd Wade</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210378" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>So then there is no way around it? It&#39;s an issue with Safari, not the IDE or SDK?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:06:44 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You could probably do something like:</p>
<pre><code class="hljs"><span class="hljs-tag">Titanium</span><span class="hljs-class">.Platform</span><span class="hljs-class">.openURL</span>(<span class="hljs-tag">url</span>);
</code></pre><p>where url is the facebook logout url</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:07:13 pm">June 15th 2011</span>
											by <span class='authorname'>Todd Wade</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Are you definitely logged out of Safari before launching the app and logging in through that? </p>
<p>Also, why not use the &#39;old&#39; popup&#x2F;bounce webview instead of opening Safari?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:08:56 pm">June 15th 2011</span>
											by <span class='authorname'>Kosso</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well, in 4.1, the in-app facebook dialog appears. But in 4.2 or higher, it redirects to safari. I will look around for code to force the old method. Not familiar with it… Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:10:36 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think it&#39;s …</p>
<pre><code class="hljs"><span class="hljs-constant">Ti.Facebook.forceDialog</span> = <span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:15:35 pm">June 15th 2011</span>
											by <span class='authorname'>Kosso</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>or even…</p>
<pre><code class="hljs"><span class="hljs-constant">Ti.Facebook.forceDialogAuth</span> = <span class="hljs-literal">true</span>|<span class="hljs-literal">false</span>;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:16:42 pm">June 15th 2011</span>
											by <span class='authorname'>Kosso</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The Kitchen Sink example uses this, and it doesn&#39;t work there either. I tried in my code, and it doesn&#39;t change anything. Thanks, though.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:37:37 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Weird. It works in my iPhone apps.<br>Do you also have your appid in the tiapp.xml ?</p>
<pre><code class="hljs">&lt;<span class="hljs-keyword">property</span> <span class="hljs-property">name</span>=<span class="hljs-string">"ti.facebook.appid"</span>&gt;<span class="hljs-number">0000000000000</span>&lt;/<span class="hljs-keyword">property</span>&gt;
</code></pre><p>(above guid)</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:43:06 pm">June 15th 2011</span>
											by <span class='authorname'>Kosso</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yep. Have that.  The app basically works fine. It posts the canned message to the logged in user&#39;s FB wall. It&#39;s just not logging out properly. In the app, when i click the FB logout button, my test alerts and the FB button state both indicate that the user is logged out. Then when i click login, safari still has the user logged in. I&#39;m not installing Ti Studio with the 1.7 sdk and see if that solves the issue. Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 4:46:36 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hm. Installing Studio with 1.7 didn&#39;t change anything. Ti.Facebook.forceDialog or Ti.Facebook.forceDialogAuth refuses to change anything. Still using safari.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 5:21:42 pm">June 15th 2011</span>
											by <span class='authorname'>Michael Trettewick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210391">
				
						<section>
							<p>Result! Solved! ;) </p>
<p>See above…</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 6:20:10 pm">June 15th 2011</span>
								by <span class='authorname'>Kosso</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-210391" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-249965">
				
						<section>
							<p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;138407&#x2F;fix-titaniumfacebooklogout-actually-working">see there</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 25th 2012, 11:38:33 am">October 25th 2012</span>
								by <span class='authorname'>max process</span><br>
								<a class="icon-bg icon-link" href="question/121104/facebook-logout-does-not-log-user-out-of-facebook---ipad.html#answer-249965" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
