<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Formatting JSON response Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Formatting JSON response</h1>
		</header>
		<section>
			<p>I am attempting to retrieve data in JSON format from a MySQL database with a PHP file. Then have my app go get the contents of the file and display it in a tableview. Here is part of my PHP file:</p>
<pre><code class="hljs"><span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-string">"SELECT * from cms_testevents"</span>) or die(<span class="hljs-string">'Could not query'</span>);


    <span class="hljs-variable">$rows</span> = <span class="hljs-keyword">array</span>();
        <span class="hljs-keyword">if</span>      (mysql_num_rows(<span class="hljs-variable">$result</span>)) {
                while (<span class="hljs-variable">$row</span> = mysql_fetch_assoc(<span class="hljs-variable">$result</span>)) {
                        <span class="hljs-variable">$rows</span>[] = <span class="hljs-variable">$row</span>;
                }      
        }
        echo json_encode(<span class="hljs-variable">$rows</span>);

mysql_close(<span class="hljs-variable">$db</span>);
</code></pre><p>When I go to a browser and look at the output, I get something like this:</p>
<pre><code class="hljs"><span class="hljs-collection">[<span class="hljs-collection">{<span class="hljs-string">"num"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-string">"createdDate"</span>:<span class="hljs-string">"2013-01-14 16:42:23"</span>,<span class="hljs-string">"createdByUserNum"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-string">"updatedDate"</span>:<span class="hljs-string">"2013-01-14 16:42:23"</span>,<span class="hljs-string">"updatedByUserNum"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-string">"dragSortOrder"</span>:<span class="hljs-string">"1358181743"</span>,<span class="hljs-string">"title"</span>:<span class="hljs-string">"1st event"</span>,<span class="hljs-string">"content"</span>:<span class="hljs-string">"
This is the first test event&lt;\/p&gt;"</span>,<span class="hljs-string">"event_date"</span>:<span class="hljs-string">"2013-01-15 08:00:00"</span>}</span>,<span class="hljs-collection">{<span class="hljs-string">"num"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-string">"createdDate"</span>:<span class="hljs-string">"2013-01-14 16:43:24"</span>,<span class="hljs-string">"createdByUserNum"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-string">"updatedDate"</span>:<span class="hljs-string">"2013-01-14 16:43:24"</span>,<span class="hljs-string">"updatedByUserNum"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-string">"dragSortOrder"</span>:<span class="hljs-string">"1358181804"</span>,<span class="hljs-string">"title"</span>:<span class="hljs-string">"2nd event"</span>,<span class="hljs-string">"content"</span>:<span class="hljs-string">"

This is the second event&lt;\/p&gt;"</span>,<span class="hljs-string">"event_date"</span>:<span class="hljs-string">"2013-01-13 17:00:00"</span>}</span>]</span>
</code></pre><p>The example .js file used a text file that had, (I am not sure what to call it) the table name?? at the beginning of the JSON output. Like this:</p>
<pre><code class="hljs">{"<span class="hljs-attribute">testevents</span>":<span class="hljs-value">[{"<span class="hljs-attribute">num</span>":<span class="hljs-value"><span class="hljs-string">"1"</span></span>,"<span class="hljs-attribute">createdDate</span>":<span class="hljs-value"><span class="hljs-string">"2013-01-14 16:42:23"</span></span>,"<span class="hljs-attribute">createdByUserNum</span>":<span class="hljs-value"><span class="hljs-string">"2"</span></span>,"<span class="hljs-attribute">updatedDate</span>":<span class="hljs-value"><span class="hljs-string">"2013-01-14 16:42:23"</span></span>,"<span class="hljs-attribute">updatedByUserNum</span>":<span class="hljs-value"><span class="hljs-string">"2"</span></span>,"<span class="hljs-attribute">dragSortOrder</span>":<span class="hljs-value"><span class="hljs-string">"1358181743"</span></span>,"<span class="hljs-attribute">title</span>":<span class="hljs-value"><span class="hljs-string">"1st event"</span></span>,"<span class="hljs-attribute">content</span>":<span class="hljs-value"><span class="hljs-string">"This is the first test event&lt;\/p&gt;"</span></span>,"<span class="hljs-attribute">event_date</span>":<span class="hljs-value"><span class="hljs-string">"2013-01-15 08:00:00"</span></span>}</span>
</code></pre><p>I am having a lot of trouble figuring out what to put in my PHP file and where to put it to get this additional output. Would someone please show me what needs to be done?</p>
<p>This app is iOS 6.0 mobile, Titanium Command-Line Interface, CLI version 3.0.23, Titanium SDK version 3.0.0.GA, iOS simulator, OS X 10.7.5, Titanium Studio, build: 3.0.2.201301251115.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 30th 2013, 4:14:33 pm">January 30th 2013</span>
				by <span class='authorname'>David Nevels</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>php</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-255800">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>Try this;</p>
<pre><code class="hljs"><span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-string">"SELECT * from cms_testevents"</span>) or die(<span class="hljs-string">'Could not query'</span>);

<span class="hljs-variable">$rows</span> = <span class="hljs-keyword">array</span>();
<span class="hljs-keyword">if</span> (mysql_num_rows(<span class="hljs-variable">$result</span>)) {
    while (<span class="hljs-variable">$row</span> = mysql_fetch_assoc(<span class="hljs-variable">$result</span>)) {
        <span class="hljs-variable">$rows</span>[] = <span class="hljs-variable">$row</span>;
    }      
}
<span class="hljs-variable">$parcel</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">'testevents'</span> =&gt; <span class="hljs-variable">$rows</span>);
echo json_encode(<span class="hljs-variable">$parcel</span>);
mysql_close(<span class="hljs-variable">$db</span>);
</code></pre><p>This is the line of interest;</p>
<pre><code class="hljs"><span class="hljs-variable">$parcel</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">'testevents'</span> =&gt; <span class="hljs-variable">$rows</span>);
</code></pre><p>This creates a node with the array coming of it.</p>
<p>Let me know how it goes.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 30th 2013, 5:02:25 pm">January 30th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="../../question/147645/formatting-json-response.html#answer-255800" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for answering Malcolm, but when I go to the file in a browser, I get:</p>
<p>HTTP Error 500 (Internal Server Error): An unexpected condition was encountered while the server was attempting to fulfill the request.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 30th 2013, 5:09:40 pm">January 30th 2013</span>
											by <span class='authorname'>David Nevels</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Malcolm, in just that one line of code, I managed to make a syntax error. The file appears as desired now. Thank you. Now I will see if my .js file grabs and displays the data.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 30th 2013, 5:14:04 pm">January 30th 2013</span>
											by <span class='authorname'>David Nevels</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The full code I provided was based on your snippet so if you used that it would not work as you did not provide the entire file.</p>
<p>Did you try JUST using the single line version, just to confirm and a second line so you know where to put it.;</p>
<pre><code class="hljs">echo json_encode(<span class="hljs-variable">$rows</span>);
</code></pre><p>Change to this;</p>
<pre><code class="hljs"><span class="hljs-variable">$parcel</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">'testevents'</span> =&gt; <span class="hljs-variable">$rows</span>);
echo json_encode(<span class="hljs-variable">$parcel</span>);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 30th 2013, 5:15:44 pm">January 30th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Excellent</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 30th 2013, 5:16:04 pm">January 30th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
