<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>how can I prevent crashes? Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>how can I prevent crashes?</h1>
		</header>
		<section>
			<p>I know that this question has been asked tons of times, and I&#39;ve even given suggestions to those people wondering the same thing, but I&#39;m just stuck after a week of looking into my bugs and I&#39;m banging my head against the wall.</p>
<p>Simple as it is, my app crashes.</p>
<p>iOS: 5.0.1 </p>
<p>TiSDK: 1.7.<em> (I&#39;ve tried them all) ( I can&#39;t move to 1.8.</em> as now. )</p>
<p>Device: iPad&#x2F;iPad 2</p>
<p>I&#39;ve been working with Titanium for over an year now, so I think I know most of the tricks to avoid leaks and stuff like that.</p>
<p>I can list few of the crashes that happen quite often:</p>
<ul>
<li><p>populating a tableview after an http call : doing that time after time makes my app crash.</p>
</li>
<li><p>Opening a new window (the basic Ti.UI.currentTab.open(mywin) ), can make my app crash.</p>
</li>
<li><p>If you click too many times on the screen while a window is closing, the app will crash. (No buttons present whatsoever).</p>
</li>
</ul>
<p>I&#39;ve tried to put timers so that actions happen one after another, same thing.<br>I&#39;ve tried to set to null every singles view&#x2F;data I don&#39;t need any longer, same thing.<br>Any suggestions are welcome. Just really discouraged, I have plenty of customers complaining.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 27th 2012, 1:56:55 pm">January 27th 2012</span>
				by <span class='authorname'>Alberto Marcone</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>memory leak</span></li>
					
				</ul>
			

			<section>
				<h5>6 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>You dont happen to be using separate contexts with windows by any chance ?  </p>
<p>ie created by;</p>
<pre><code class="hljs">

<span class="css">
<span class="hljs-tag">Ti</span><span class="hljs-class">.UI</span><span class="hljs-class">.createWindow</span>(<span class="hljs-rules">{
<span class="hljs-rule"><span class="hljs-attribute">url</span>:<span class="hljs-value"><span class="hljs-string">'/mywin.js'</span></span></span></span>});</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 2:16:54 pm">January 27th 2012</span>
								by <span class='authorname'>Nick Milner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Yes, I actually open separate windows, but for a maximum of 1 or 2.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 2:43:32 pm">January 27th 2012</span>
								by <span class='authorname'>Alberto Marcone</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I only ask because the stability of multi-context apps got significantly worse after 1.6 IMHO and you comment about crashes in TableViews is exactly what I got more and more. Going single context got rid of all my issues</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 2:51:08 pm">January 27th 2012</span>
								by <span class='authorname'>Nick Milner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Going single context AND beginning to use commonjs approach for EVERYTHING seemed to eliminate any&#x2F;all problems for me.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 3:25:57 pm">January 27th 2012</span>
								by <span class='authorname'>Ray Belisle</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>single context would be just painful and impossible to manage. My application got really complex, so now it&#39;s impossible to just hide and show views.</p>
<p>I will have to convert the whole app in commonjs, if that make things better.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 3:43:09 pm">January 27th 2012</span>
								by <span class='authorname'>Alberto Marcone</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>so, question: how can I move to single context with multiple windows? just transform them to views? what about memory leaks?</p>
<p>do you have any example on an application developed in commonjs?</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 27th 2012, 3:56:18 pm">January 27th 2012</span>
								by <span class='authorname'>Alberto Marcone</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-228788">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>To go off of what Nick said, use a single context approach such as <a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator-titans&#x2F;tweetanium">Tweetanium</a>, this really makes a huge difference in terms of stability. The original Tweetanium example is a bit too simple and doesn&#39;t work for most real world situations, I&#39;ve found, however you can modify it to use windows instead of views and still have the single master context.</p>
<p>Here is my ui.js class that I use to handle navigation:</p>
<pre><code class="hljs"><span class="hljs-comment">//Use the UI namespace for all UI component creation.  A few common components will be defined in this file,</span>
<span class="hljs-comment">//but the bigger ones get their own file (along with styles)</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    tt.ui = {};
    tt.ui.windows = [];

    tt.ui.createWindow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">title, loadFunction, exitOnClose</span>) </span>{

        tt.ui.hideNotify();
        tt.ui.loadedWindow = <span class="hljs-literal">false</span>;
        tt.ui.Win = tt.ui.View = tt.ui.windows[tt.ui.windows.length] = Ti.UI.createWindow(tt.combine($$.Window, { title: title, 
            exitOnClose: (exitOnClose ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>), index: tt.ui.windows.length - <span class="hljs-number">1</span> }));
        tt.ui.Win.addEventListener(<span class="hljs-string">"focus"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (!tt.ui.loadedWindow) {
                tt.ui.loadedWindow = <span class="hljs-literal">true</span>;
                loadFunction();
            }
        });
        <span class="hljs-keyword">return</span> tt.ui.Win;

    };

    tt.ui.closeWindow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">closeCallback</span>) </span>{

        <span class="hljs-comment">//Ti.API.info("in closeWindow: " + tt.ui.showActiveWindows());</span>
        tt.ui.hideNotify();
        <span class="hljs-keyword">if</span>(tt.ui.windows.length &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">var</span> win = tt.ui.windows[tt.ui.windows.length - <span class="hljs-number">1</span>];<span class="hljs-comment">//Ti.UI.currentWindow;</span>
            <span class="hljs-comment">//win.addEventListener("close", function() { </span>
            <span class="hljs-comment">//setTimeout(function() { </span>
                   tt.ui.windows.splice(tt.ui.windows.length - <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
                tt.ui.Win = tt.ui.View = Ti.UI.currentWindow; 
                <span class="hljs-comment">//Ti.API.info("active windows after closeWindow: " + tt.ui.showActiveWindows());</span>
                <span class="hljs-keyword">if</span>(closeCallback &amp;&amp; <span class="hljs-keyword">typeof</span> closeCallback === <span class="hljs-string">'function'</span>)
                    closeCallback();
            <span class="hljs-comment">//}, 100);</span>
            <span class="hljs-keyword">if</span>(win)
                   win.close();
           }

    };


    tt.ui.closeAllChildWindows = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>) </span>{

        <span class="hljs-keyword">if</span>(tt.ui.windows.length &gt; <span class="hljs-number">1</span>)
            tt.ui.closeWindow(tt.ui.closeAllChildWindows);
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span>(callback &amp;&amp; <span class="hljs-keyword">typeof</span> callback === <span class="hljs-string">'function'</span>)
                callback();
        }

    };

    tt.ui.showActiveWindows = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">var</span> windowNames = <span class="hljs-string">""</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k=<span class="hljs-number">0</span>;k&lt;tt.ui.windows.length;k++) {
            windowNames += tt.ui.windows[k].title + <span class="hljs-string">", "</span>;
        }
        <span class="hljs-keyword">return</span> windowNames;

    };

    tt.ui.alert = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">title, message</span>) </span>{

        Ti.UI.createAlertDialog({
            title: title,
            message: message ? message : title,
            buttonNames: [<span class="hljs-string">'OK'</span>]
        }).show();

    };

    tt.ui.notify = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) </span>{

        <span class="hljs-keyword">if</span>(!tt.ui.showingNotifyBox &amp;&amp; tt.ui.View) {

            <span class="hljs-comment">//Ti.API.info("Showing message '" + message + "'");</span>
            tt.ui.showingNotifyBox = <span class="hljs-literal">true</span>;
            <span class="hljs-comment">//create notify box.</span>
            tt.ui.notifyBox = Ti.UI.createView(tt.combine($$.notifyBox, { bottom: (utils.isAndroid ? <span class="hljs-number">0</span> : <span class="hljs-number">40</span>), left: <span class="hljs-number">0</span>, right: <span class="hljs-number">0</span>}));
            tt.ui.notifyBox.add(Ti.UI.createImageView(tt.combine($$.notifyIcon, { top: <span class="hljs-number">2</span>, left: <span class="hljs-number">5</span> })));
            tt.ui.notifyBox.add(Ti.UI.createLabel(tt.combine($$.notifyLabel, { width: <span class="hljs-string">"auto"</span>, text: message })));
            tt.ui.View.add(tt.ui.notifyBox);

            <span class="hljs-comment">//remove notify box after timeout.</span>
            setTimeout(tt.ui.hideNotify, <span class="hljs-number">8000</span>);
        }
        <span class="hljs-keyword">else</span>
            Ti.API.info(<span class="hljs-string">"Can't show message '"</span> + message + <span class="hljs-string">"' b/c notify box is already showing"</span>);

    };

    tt.ui.hideNotify = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">if</span>(tt.ui.showingNotifyBox) {
            <span class="hljs-keyword">if</span>(tt.ui.View)
                tt.ui.View.remove(tt.ui.notifyBox);
            tt.ui.showingNotifyBox = <span class="hljs-literal">false</span>;
        }

    };

})();

<span class="hljs-comment">//Include major UI components and styling properties</span>
Ti.include(
    <span class="hljs-string">'/tweetanium/ui/styles.js'</span>,

    <span class="hljs-string">'/tweetanium/ui/shared/layout/LogoStrip.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/layout/JobInfo.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/menu/Menu.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/menu/OptionsMenu.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/popup/Dialog.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/popup/MessagePopup.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/popup/SearchPopup.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/shared/Map.js'</span>,

    <span class="hljs-string">'/tweetanium/ui/ApplicationWindow.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/LoginView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/DashboardView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/JobListView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/JobDetailsView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/MessageListView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/MessageDetailsView.js'</span>,
    <span class="hljs-string">'/tweetanium/ui/NavigationView.js'</span>
);
</code></pre><p>And then here is a sample &quot;window&quot; class:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDashboardView</span>(<span class="hljs-params">exitOnClose</span>) </span>{
    <span class="hljs-keyword">return</span> tt.ui.createWindow(<span class="hljs-string">"Dashboard"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ dashboard.init(exitOnClose); }, exitOnClose);
}

<span class="hljs-keyword">var</span> dashboard = {

    init: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">exitOnClose</span>) </span>{

        <span class="hljs-keyword">if</span> (!exitOnClose)
            dashboard.createEvents();
        dashboard.display();
        dashboard.createMenu();
        <span class="hljs-comment">//start sending timed reports.</span>
        reporting.start();

    },

    createEvents: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        tt.ui.Win.addEventListener(<span class="hljs-string">'android:back'</span>, dashboard.close);

    },

    display: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-comment">//logo strip.</span>
        <span class="hljs-keyword">var</span> logoStrip = <span class="hljs-keyword">new</span> LogoStrip().create();
        tt.ui.View.add(logoStrip);

        <span class="hljs-keyword">var</span> top = (logoStrip.size.height &gt; <span class="hljs-number">0</span> ? logoStrip.size.height : <span class="hljs-number">30</span>) + <span class="hljs-number">20</span>;
        <span class="hljs-comment">//label.</span>
        tt.ui.View.add(Ti.UI.createLabel(tt.combine($$.welcome, { top: top, text: <span class="hljs-string">"Welcome to Navtrak Driver"</span> })));
        top += <span class="hljs-number">60</span>;

        <span class="hljs-comment">//buttons.</span>
        <span class="hljs-keyword">var</span> size = utils.width / <span class="hljs-number">6</span>;
        <span class="hljs-keyword">var</span> jobsButton = Ti.UI.createImageView({ image: <span class="hljs-string">"/images/buttons/jobs.gif"</span>, width: size, height: size, top: top, left: <span class="hljs-number">30</span> });
        jobsButton.addEventListener(<span class="hljs-string">"click"</span>, dashboard.navigateToJobs);
        tt.ui.View.add(jobsButton);

        <span class="hljs-keyword">var</span> messagingButton = Ti.UI.createImageView({ image: <span class="hljs-string">"/images/buttons/messaging.gif"</span>, width: size, height: size, top: top });
        messagingButton.addEventListener(<span class="hljs-string">"click"</span>, dashboard.navigateToMessaging);
        tt.ui.View.add(messagingButton);

        <span class="hljs-keyword">var</span> navigationButton = Ti.UI.createImageView({ image: <span class="hljs-string">"/images/buttons/navigation.gif"</span>, width: size, height: size, top: top, right: <span class="hljs-number">30</span> });
        navigationButton.addEventListener(<span class="hljs-string">"click"</span>, dashboard.navigateToNavigation);
        tt.ui.View.add(navigationButton);

    },

    navigateToJobs: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        createJobListView().open();

    },

    navigateToMessaging: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        createMessageListView().open();

    },

    navigateToNavigation: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">var</span> destinationAddress = <span class="hljs-string">"2000 Northwood Drive, Salisbury, MD"</span>;
        <span class="hljs-keyword">if</span>(utils.isAndroid) {
            <span class="hljs-keyword">var</span> sygic = <span class="hljs-built_in">require</span>(<span class="hljs-string">'org.appcelerator.sygic'</span>);
            sygic.launchNavigationActivity(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        }
        <span class="hljs-keyword">else</span>
            utils.info(<span class="hljs-string">"Sygic navigation not supported on ios"</span>);

    },

    createMenu: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-comment">//create menu.</span>
        <span class="hljs-keyword">new</span> Menu().init({
            buttons: [
            {
                title: <span class="hljs-string">"Logout"</span>,
                clickevent: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">var</span> userStatus = <span class="hljs-keyword">new</span> UserStatus();
                    userStatus.CurrentDate = dateutils.getUTCNow();
                    userStatus.Status = tt.enums.DriverStatus.LoggedOut;
                    MessageGateway.sendMessage(userStatus, tt.enums.ParameterId.GeneralACK, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                        utils.userId = <span class="hljs-literal">null</span>;
                        Ti.App.Properties.setString(<span class="hljs-string">"UserId"</span>, <span class="hljs-literal">null</span>);
                        <span class="hljs-comment">//go back to login window.</span>
                        tt.ui.closeWindow();
                        <span class="hljs-comment">//notify.</span>
                        tt.ui.notify(<span class="hljs-string">"You have been signed out"</span>);
                        <span class="hljs-comment">//stop sending timed reports.</span>
                        reporting.stop();
                        <span class="hljs-comment">//allow app to go to sleep.</span>
                        Ti.App.idleTimerDisabled = <span class="hljs-literal">false</span>;
                    });
                }
            }
        ]
        });

    },

    close: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        tt.ui.closeWindow();

    }

};
</code></pre><p>In this way you still have your separate windows, but can load all of your js files all at once on app load and access them globally.</p>
<p>Another tip, based on what you said above, is to make sure you only run 1 xhr call at a time, and always use the same xhr object instead of creating new ones for each request.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 27th 2012, 8:50:06 pm">January 27th 2012</span>
								by <span class='authorname'>Justin Toth</span><br>
								<a class="icon-bg icon-link" href="../../question/131275/how-can-i-prevent-crashes.html#answer-228788" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>this is great, so far the best answer. I was looking into tweetanium, but I think that with your example it&#39;ll be easier to manage windows.</p>
<p>I already fixed the xhr problem long ago, but I still have different xhr objects according to the class I use them in (maybe 3 or 4). In any case, they never fire at the same time. I have to use different objects because I had some weird behavior when assigning different onload responders from time to time to the same object.<br> Thank you so much anyways!!</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 28th 2012, 6:29:19 am">January 28th 2012</span>
											by <span class='authorname'>Alberto Marcone</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
