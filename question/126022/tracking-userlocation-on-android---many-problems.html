<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Tracking userlocation on Android - MANY PROBLEMS Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Tracking userlocation on Android - MANY PROBLEMS</h1>
		</header>
		<section>
			<p>Im currently building an app that calculates the distance you travel and displays your location in a mapview. One feature that would be realy nice is to use the addRoute function to show the route you traveled, but of course Titanium does not have that feature for Android yet. The second thing is that the userlocation marker disappears whenever the window loses focus.<br>The third and perhapps the most important thing: When you have closed the geolocation window and open the window a second time the getCurrentPosition returns the error message &quot;location is currently unavailable&quot;. Then you have to force the app to close for it to run again. </p>
<p>Im very skeptic that what Im trying to do is something that Titanium is ready for, or does anybody have a solution for all these bugs?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 26th 2011, 7:02:30 am">September 26th 2011</span>
				by <span class='authorname'>Johan Nilsson</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>bugs</span></li>
					
						<li><span class='tagname'>geolocation</span></li>
					
						<li><span class='tagname'>getcurrentposition</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Using Titanium SDK 1.7.2 and testing on Android device with SDK 2.2.2</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 26th 2011, 7:05:29 am">September 26th 2011</span>
								by <span class='authorname'>Johan Nilsson</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-219514">
				
						<section>
							<p>On the android platform the geolocation is &quot;glued&quot; to the current activity. That means that you have to make the geocode stuff in the current heavyweighted window.<br>When you switch to another activity (another heavyweight window) the Os stops the geolocation to preserve battery.</p>
<p>Here you&#39;ll find examples and explanations on why it behaves like this:</p>
<p>http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;blog&#x2F;2011&#x2F;02&#x2F;android-geolocation-changes-for-1-6-0.html</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 26th 2011, 10:07:47 am">September 26th 2011</span>
								by <span class='authorname'>Dan Tamas</span><br>
								<a class="icon-bg icon-link" href="../../question/126022/tracking-userlocation-on-android---many-problems.html#answer-219514" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-219584">
				
						<section>
							<p>Thanks for your answer Dan, but that is exactly what Im doing. I have all my geolocation-code in a separate js-file and if I have understand it correctly you can force a heavyweight window by adding a value to navBarHidden, fullscreen, or modal when you define your window?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 27th 2011, 8:11:50 am">September 27th 2011</span>
								by <span class='authorname'>Johan Nilsson</span><br>
								<a class="icon-bg icon-link" href="../../question/126022/tracking-userlocation-on-android---many-problems.html#answer-219584" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Dan, I solved this problem. I had put an eventlistener to the back-button that just closed the window and didnt stop the activity.<br>But do you have a solution for my other problems?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 27th 2011, 8:29:41 am">September 27th 2011</span>
											by <span class='authorname'>Johan Nilsson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-219592">
				
						<section>
							<p>Are you using only <strong>getCurrentPosition</strong> or you also put a listener to the <strong>location</strong> event?<br>The getCurrentPosition function is only taking a cached result without actually forcing the GPS module in your device to finding the new location.<br>This is why you get sometimes results and sometimes not.</p>
<p>You have to listen to the location event to make the device tracking your present position. This will take some time until it locks the gps signal and finds it so you will have to think on doing everything async.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 27th 2011, 9:40:14 am">September 27th 2011</span>
								by <span class='authorname'>Dan Tamas</span><br>
								<a class="icon-bg icon-link" href="../../question/126022/tracking-userlocation-on-android---many-problems.html#answer-219592" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Yes I am using both the <strong>getCurrenPosition</strong> and the <strong>location event</strong>. Yes I know that it is my cached position that will appear, and thats why I wait for the location event to trigger before I start calculating the distance.<br>The <strong>locationCallback</strong>-listner is first added when the user presses a startbutton thats on top of the mapView.</p>
<p>But what I dont understand by your post is wich of my problem its focused on?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 27th 2011, 9:51:13 am">September 27th 2011</span>
											by <span class='authorname'>Johan Nilsson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I was speaking in general. Don&#39;t know how to fix the specific problems because I would have to see the code. Android id pretty idiot (imho) so you might have done something it doesn&#39;t like, or indeed you&#39;ve found a bug (or more) :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 27th 2011, 9:55:25 am">September 27th 2011</span>
											by <span class='authorname'>Dan Tamas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok, first of I must thank you for taking the time to answer. The code isnt that special, the geolocation part of the code is basically a copy of the kitchensink-example. And by solving the problem with the activity issue my two remaining problem is the userLocation marker and the addRoute function. You dont happen to have a fix for these?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 27th 2011, 10:07:25 am">September 27th 2011</span>
											by <span class='authorname'>Johan Nilsson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
