<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Not getting Row data from DB - Maybe bad syntax? Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Not getting Row data from DB - Maybe bad syntax?</h1>
		</header>
		<section>
			<pre><code class="hljs">Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'Running Refresh'</span>);
    <span class="hljs-built_in">var</span> db = Ti<span class="hljs-built_in">.</span>Database<span class="hljs-built_in">.</span>open(<span class="hljs-string">'inboxdatabase'</span>);
    Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'Open DB'</span>);
    <span class="hljs-built_in">var</span> <span class="hljs-keyword">rows</span> = db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'SELECT inboxid,title FROM inbox'</span>);
    Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'Fetch Rows'</span>);
    db<span class="hljs-built_in">.</span>close();
    Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'Alert Row Count'</span>);
    alert(<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>fieldCount());
    alert(<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>isValidRow());
    <span class="hljs-keyword">while</span>(<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>isValidRow()){
        Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'This is a test'</span>);
        Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'Showing Rowid'</span>+ <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>field(<span class="hljs-number">0</span>));
        <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>next();
    }
    <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>close();
</code></pre><p>So, the field count alerts 3. The validRow alerts 1. The rows affected displays 0. But during my insert statement I checked and there are now 84 records in the table. Here is the previous insert:</p>
<pre><code class="hljs">var sql = '<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> inbox (title,description,<span class="hljs-keyword">link</span>,<span class="hljs-built_in">date</span>,viewed,searchid) <span class="hljs-keyword">VALUES</span><span class="hljs-string">';
sql += "('</span><span class="hljs-string">"+escape(row.title)+"</span><span class="hljs-string">','</span><span class="hljs-string">"+escape(row.description)+"</span><span class="hljs-string">','</span><span class="hljs-string">"+row.link+"</span><span class="hljs-string">','</span><span class="hljs-string">"+row.pubDate+"</span><span class="hljs-string">',0,"+data[0].searchid+")";
db.execute(sql);</span></span>
</code></pre><p>So, what gives. There are records there. How can a select with no conditionals return 0 rows. Why am I not getting any rows back? And if I am getting no rows, why does isValidRow() return true. Seems like it should be false with no results.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 23rd 2012, 3:34:49 am">October 23rd 2012</span>
				by <span class='authorname'>Lee Bartelme</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-249800">
				
						<section>
							<p>Maybe I&#39;m reading this wrong, but you are using <code>fieldCount</code> and not <code>rowCount</code>.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 23rd 2012, 7:12:49 am">October 23rd 2012</span>
								by <span class='authorname'>Christian Brousseau</span><br>
								<a class="icon-bg icon-link" href="question/143829/not-getting-row-data-from-db---maybe-bad-syntax.html#answer-249800" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I don&#39;t see rowCount in the docs. I do see rowsAffected which I didn&#39;t show above, but that is returtning 0.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 23rd 2012, 11:50:16 pm">October 23rd 2012</span>
											by <span class='authorname'>Lee Bartelme</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I was actually doing db.rowsAffected and not rows.rowsAffected, either way no go. With rows.rowsAffected I don&#39;t get anything back, empty string I guess.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 23rd 2012, 11:52:29 pm">October 23rd 2012</span>
											by <span class='authorname'>Lee Bartelme</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well I got it working if I parse the row data BEFORE I run the db.close() method. Strange that the docs show the user closeing the db object then parsing the row data and then closing the row object.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:01:38 am">October 24th 2012</span>
											by <span class='authorname'>Lee Bartelme</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>True, db.close() must be the very last statement when interacting with a database.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 6:23:47 am">October 24th 2012</span>
											by <span class='authorname'>Christian Brousseau</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m fine with that I guess. Though the docs have a crucial error in them as they show that you can still interact with the rows after you close the db, which makes sense because the rows are assigned before closing the db. This leads me to believe the rows are assigned by reference.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:46:40 pm">October 24th 2012</span>
											by <span class='authorname'>Lee Bartelme</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
