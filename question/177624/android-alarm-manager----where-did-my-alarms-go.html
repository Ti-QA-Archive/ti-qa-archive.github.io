<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android Alarm Manager -- Where Did My Alarms Go? Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android Alarm Manager -- Where Did My Alarms Go?</h1>
		</header>
		<section>
			<p>I am using Ben Behrenburg&#39;s alarm module for Android, and I am noticing some funky behavior.  My code to set the alarm is:</p>
<pre><code class="hljs">var alarmMgr = <span class="hljs-keyword">null</span>
            , alarmModule = <span class="hljs-keyword">null</span>
            , delta = -<span class="hljs-number">1</span>
            , now = <span class="hljs-keyword">new</span> Date().getTime();

        alarmModule = require( <span class="hljs-string">"bencoding.alarmmanager"</span> );
        alarmModule.enableLogging();
        alarmMgr = alarmModule.createAlarmManager();
                alarmMgr.setRootActivityClassName( <span class="hljs-string">"com.mycompany.myapp"</span> );

        delta = Math.ceil( ( ( <span class="hljs-keyword">task</span>.DueDate - now ) <span class="hljs-regexp">/ 1000 ) /</span> <span class="hljs-number">60</span> );

        var props = {
            requestCode: <span class="hljs-keyword">task</span>.TaskID
            , minute: delta
            , contentTitle: <span class="hljs-keyword">task</span>.AlarmText
            , contentText: <span class="hljs-keyword">task</span>.AlarmText
            , playSound: <span class="hljs-keyword">false</span>
            , vibrate: <span class="hljs-keyword">true</span>
            , showLights: <span class="hljs-keyword">true</span>
        };

        <span class="hljs-keyword">if</span>( <span class="hljs-keyword">task</span>.repeat !== <span class="hljs-string">"undefined"</span> &amp;&amp; <span class="hljs-keyword">task</span>.repeat !== <span class="hljs-keyword">null</span> )
        {
            props.repeat = <span class="hljs-keyword">task</span>.repeat;
        }


    alarmMgr.addAlarmNotification( props );

        alarmMgr = <span class="hljs-keyword">null</span>;
        alarmModule = <span class="hljs-keyword">null</span>;
</code></pre><p>This code is working as I would expect, and the alarm fires if the device does not go to sleep.  What&#39;s tryly curious is that if I run <code>adb shell dumpsys alarm</code> after the device wakes up, all of the pending intents that were created by the module have been removed.  What would cause this issue?  The pending intents exist before the device sleeps (checked via adb), but then after the device wakes, those intents are gone.  Am I missing some critical bit of code that will cause those intents to persist across a device sleep?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 11th 2014, 6:54:17 pm">September 11th 2014</span>
				by <span class='authorname'>brian janaszek</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alarm</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>notification</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
