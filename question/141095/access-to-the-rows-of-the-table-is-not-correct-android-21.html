<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Access to the rows of the table is not correct. Android 2.1 » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Access to the rows of the table is not correct. Android 2.1</h1>
		</header>
		<section>
			<p>Good day!!!</p>
<p>I have:</p>
<ul>
<li>Application type: mobile</li>
<li>Titanium SDK: 2.1.1GA</li>
<li>Platform &amp; version: Android 2.1,</li>
<li>Device: Android emulator, Motorola Xoom and couple android devices</li>
<li>Host Operating System: Windows 7</li>
<li>Titanium Studio: Titanium Studio, build: 2.1.1.201207271312</li>
</ul>
<p>I have a table. In the rows of the table are some data. The structure of a table row:</p>
<p>row(Ti.UI.TableViewRow) &gt; wrapperViw(Ti.UI.View) &gt; leftText(Ti.UI.Label) + rightText(Ti.UI.Label)</p>
<p>from time to time text in the rows of the table should be changed.</p>
<p>When clicking on the row I need to change the color in leftText(Ti.UI.Label) and rightText(Ti.UI.Label)</p>
<p>I&#39;m doing it this way:</p>
<pre><code class="hljs"><span class="hljs-comment">//create table</span>
var listOfAnswers = Ti.UI.createTableView({
   <span class="hljs-comment">//some staff</span>
});

listOfAnswers.addEventListener('click', markRowAsSelected);

<span class="hljs-comment">//Click handler</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">markRowAsSelected</span><span class="hljs-params">(e)</span>{</span>    
    e.row.selected = e.row.selected?<span class="hljs-literal">false</span>:<span class="hljs-literal">true</span>;
    e.row.<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">color</span> = e.row.selected?'<span class="hljs-built_in">#</span><span class="hljs-number">9608</span>a3':'<span class="hljs-built_in">#</span><span class="hljs-number">000000</span>';
    e.row.<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">1</span>].<span class="hljs-built_in">color</span> = e.row.selected?'<span class="hljs-built_in">#</span><span class="hljs-number">9608</span>a3':'<span class="hljs-built_in">#</span><span class="hljs-number">000000</span>';    
}

<span class="hljs-comment">//create data for the table. return array of Ti.UI.tableViewRow</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createListOfAnswersData</span><span class="hljs-params">(/*array*/answers)</span>{</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">!</span><span class="hljs-built_in">!</span>app.game.listOfAnswers &amp;&amp; app.game.listOfAnswers.length<span class="hljs-built_in">!</span>==<span class="hljs-number">0</span>){
        <span class="hljs-comment">// If we have a ready-made UI items, then simply update the text in them</span>
        refreshListOfAnswersUI(answers);
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-comment">// If we do not - they are creating</span>
        createListOfAnswersUI(answers);
    }        
    return app.game.listOfAnswers
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshListOfAnswersUI</span><span class="hljs-params">(/*array*/answers)</span>{</span>
   <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>, j = app.game.listOfAnswers.length; i &lt; j; i++) {
        app.game.listOfAnswers[i].selected = <span class="hljs-literal">false</span>;
        app.game.listOfAnswers[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">text</span> = answers[i].<span class="hljs-built_in">text</span>;
        app.game.listOfAnswers[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">1</span>].<span class="hljs-built_in">text</span> = answers[i].points;
        app.game.listOfAnswers[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">color</span> = '<span class="hljs-built_in">#</span><span class="hljs-number">000000</span>';
        app.game.listOfAnswers[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>].<span class="hljs-built_in">children</span>[<span class="hljs-number">1</span>].<span class="hljs-built_in">color</span> = '<span class="hljs-built_in">#</span><span class="hljs-number">000000</span>';
   }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createListOfAnswersUI</span><span class="hljs-params">(/*array*/answers)</span>{</span>
    app.game.listOfAnswers = [];    
    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=answers.length; i&lt;j; i++){
        app.game.listOfAnswers.push(
                createAnswerRow()
        );       
    }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAnswerRow</span><span class="hljs-params">(answerData, bgIndex, answerWidth, answerLeft, index)</span>{</span>    
    var answerWrapper = Ti.UI.createView({
   <span class="hljs-comment">//some staff</span>
   });
var answerText = Ti.UI.createLabel({
   <span class="hljs-comment">//some staff</span>
   <span class="hljs-built_in">text</span>:answerData.<span class="hljs-built_in">text</span>
});
var answerPoints = Ti.UI.createLabel({
   <span class="hljs-comment">//some staff</span>
   <span class="hljs-built_in">text</span>:answerData.points
});

var row = Ti.UI.createTableViewRow({
    <span class="hljs-comment">//some staff    </span>
    className:'answerRow'
});        
    answerWrapper.add(answerText);
    answerWrapper.add(answerPoints);
    row.add(answerWrapper);
    return row
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshListOfAnswers</span><span class="hljs-params">(data)</span>{</span>
    listOfAnswers.setData(data)
}

refreshListOfAnswers(createListOfAnswersData(currentQuestion.answers));
</code></pre><p>On android 2.2 and above its work perfect, but on 2.1 i have the problem. </p>
<p>For the first time everything works fine. The second time the function <code>markRowAsSelected</code> is executed, but strange.<br><strong>If you click on the first row of the table, the text color will change in the tenth row. If you click on the second row of the table, the text color will change in the ninth row. And so on. That is, there is an impression that the list of table rows reversed.</strong> And this applies only to change the text color, becose when I click on the first row of the table in the debugger I see <code>e.index == 0</code>, but the text color change in the tenth row of the table.</p>
<p>The third time, again, the function <code>markRowAsSelected</code> works fine, for the fourth time she is not working properly. I have now is a strange alternation.</p>
<p>In what may be the problem?</p>
<p>Regards, Andrew.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 16th 2012, 12:44:30 pm">August 16th 2012</span>
				by <span class='authorname'>Andrew Vesel4ak</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>2.1</span></li>
					
						<li><span class='tagname'>access</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>children</span></li>
					
						<li><span class='tagname'>row</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-245499">
				
						<section>
							<p>try this so you are accessing the row objects directly</p>
<pre><code class="hljs">var row = Ti.UI.createTableViewRow({
    <span class="hljs-comment">//some staff    </span>
    className:<span class="hljs-string">'answerRow'</span>
});        
answerWrapper.<span class="hljs-built_in">add</span>(answerText);
answerWrapper.<span class="hljs-built_in">add</span>(answerPoints);


<span class="hljs-comment">// associate objects directly to row so you dont have to look for them later</span>
row.answerText = answerText;
row.answerPoints = answerPoints;

row.<span class="hljs-built_in">add</span>(answerWrapper);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 16th 2012, 9:29:35 pm">August 16th 2012</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/141095/access-to-the-rows-of-the-table-is-not-correct-android-21#answer-245499" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi, Aaron!<br>Thank you for your response.<br>It works exactly the same as my code. The text color is changed, but in the wrong rows.<br>If you click on the first row of the table, the text color will change in the tenth row. If you click on the second row of the table, the text color will change in the ninth row. And so on.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 17th 2012, 4:45:09 am">August 17th 2012</span>
											by <span class='authorname'>Andrew Vesel4ak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I tried this way:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAnswerRow</span><span class="hljs-params">(answerData)</span></span>{

       <span class="hljs-keyword">var</span> answerWrapper = Ti.UI.createView({
              <span class="hljs-comment">//some staff</span>
       });
       <span class="hljs-keyword">var</span> answerText = Ti.UI.createLabel({
              <span class="hljs-comment">//some staff</span>
              text:answerData.text
       });
       <span class="hljs-keyword">var</span> answerPoints = Ti.UI.createLabel({
              <span class="hljs-comment">//some staff</span>
              text:answerData.points
       });

       <span class="hljs-keyword">var</span> row = Ti.UI.createTableViewRow({
              <span class="hljs-comment">//some staff    </span>
              className:<span class="hljs-string">'answerRow'</span>
       });        


        row.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
            row.selected = row.selected?<span class="hljs-literal">false</span>:<span class="hljs-literal">true</span>;
            answerText.color = row.selected?<span class="hljs-string">'#9608a3'</span>:<span class="hljs-string">'#000000'</span>;
            answerPoints.color = row.selected?<span class="hljs-string">'#9608a3'</span>:<span class="hljs-string">'#000000'</span>;
        });        
        answerWrapper.add(answerText);
        answerWrapper.add(answerPoints);
        row.add(answerWrapper);

        <span class="hljs-keyword">return</span> row
    }
</code></pre><p>The same result</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 17th 2012, 5:26:27 am">August 17th 2012</span>
											by <span class='authorname'>Andrew Vesel4ak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the eventListener should be on the <code>table</code> not the <code>row</code></p>
</p>
										<div class="author">
											&mdash; commented <span title="August 17th 2012, 10:28:55 am">August 17th 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you for your reply!<br>I tried to add a handler to the table. Anyway, it did not work correctly.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 17th 2012, 11:16:31 am">August 17th 2012</span>
											by <span class='authorname'>Andrew Vesel4ak</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
