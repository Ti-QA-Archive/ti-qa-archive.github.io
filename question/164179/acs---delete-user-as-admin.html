<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>ACS - Delete user as admin » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>ACS - Delete user as admin</h1>
		</header>
		<section>
			<p>Is there currently any way to login as an admin user and delete another user? The PHP system I have creates a new ACS user when a user is created on the site, but when they are deleted from the site they need to also be deleted from ACS as the usernames could sometimes be duplicates, preventing any subsequent user with that username from logging in.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 2nd 2014, 11:24:26 pm">April 2nd 2014</span>
				by <span class='authorname'>Robert Gillman</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>acs</span></li>
					
						<li><span class='tagname'>php</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-277343">
				
						<section>
							<p>Yes I am sure there is a login as admin feature in there iirc - have a good look through the ACS docs…</p>
<p>Sorry if I&#39;m misunderstanding your question but have you tried simply deleting the user from the ACS cloud web console?</p>
<p>Maybe this has what you&#39;re looking for?</p>
<p><a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;cloud&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;admin_access">http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;cloud&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;admin_access</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 3rd 2014, 5:04:31 am">April 3rd 2014</span>
								by <span class='authorname'>Robin Williams</span><br>
								<a class="icon-bg icon-link" href="question/164179/acs---delete-user-as-admin#answer-277343" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I could delete the user from the web console, but the point is to automate the process.</p>
<p>I&#39;ve looked through that section of the docs, but the &quot;API Calls on Behalf of Another User&quot; do not work for User objects and the <code>admin_batch_delete</code> method is apparently not a valid API endpoint.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 3rd 2014, 5:08:36 am">April 3rd 2014</span>
											by <span class='authorname'>Robert Gillman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-277373">
				
						<section>
							<p>You can create an user and set that user as admin(which need to be done from the website).<br>And then login with that admin user, and do admin_batch_delete.</p>
<p>Here&#39;s an example.</p>
<pre><code class="hljs"># login <span class="hljs-keyword">as</span> admin user
$ curl -<span class="hljs-keyword">d</span> <span class="hljs-string">"login=admin&amp;password=pass"</span> <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/login.json?key=ALYLOWcSE543aYC6fcEDrmHFSnwGmYFX"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"code"</span>: 200,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"loginUser"</span>,
    <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"nd-0xVS0tX2YjMVAMEozRNyQNEQ"</span>
  },
  <span class="hljs-string">"response"</span>: {
    <span class="hljs-string">"users"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"533d825e15d8270b6320dcd6"</span>,
        <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2014-04-03T15:46:38+0000"</span>,
        <span class="hljs-string">"updated_at"</span>: <span class="hljs-string">"2014-04-03T15:47:50+0000"</span>,
        <span class="hljs-string">"external_accounts"</span>: [

        ],
        <span class="hljs-string">"confirmed_at"</span>: <span class="hljs-string">"2014-04-03T15:46:38+0000"</span>,
        <span class="hljs-string">"username"</span>: <span class="hljs-string">"admin"</span>,
        <span class="hljs-string">"admin"</span>: <span class="hljs-string">"true"</span>,
        <span class="hljs-string">"stats"</span>: {
          <span class="hljs-string">"photos"</span>: {
            <span class="hljs-string">"total_count"</span>: 0
          },
          <span class="hljs-string">"storage"</span>: {
            <span class="hljs-string">"used"</span>: 0
          }
        }
      }
    ]
  }
}%

# admin batch delete <span class="hljs-keyword">on</span> username=<span class="hljs-keyword">test</span>
$ curl -X DELETE -F 'where={<span class="hljs-string">"username"</span>:<span class="hljs-string">"test"</span>}' <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/admin_batch_delete.json?key=ALYLOWcSE543aYC6fcEDrmHFSnwGmYFX&amp;_session_id=nd-0xVS0tX2YjMVAMEozRNyQNEQ"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"code"</span>: 200,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"adminBatchDelete"</span>
  }
}%
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 3rd 2014, 1:52:54 pm">April 3rd 2014</span>
								by <span class='authorname'>peter lee</span><br>
								<a class="icon-bg icon-link" href="question/164179/acs---delete-user-as-admin#answer-277373" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I have an admin user, but like I said in the other comment it just returns with an invalid endpoint error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 3rd 2014, 10:41:28 pm">April 3rd 2014</span>
											by <span class='authorname'>Robert Gillman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>example would be great.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 3rd 2014, 10:42:14 pm">April 3rd 2014</span>
											by <span class='authorname'>peter lee</span>
										</div>
									</li>
								
									<li class="comment">
										<p><pre><code class="hljs">// Called <span class="hljs-keyword">in</span> class constructor
<span class="hljs-keyword">function</span> login() {

        <span class="hljs-variable">$url</span> = <span class="hljs-string">'https://api.cloud.appcelerator.com/v1/users/login.json?key=&lt;MY_APP_KEY&gt;'</span>;

        <span class="hljs-variable">$options</span> = array(
            CURLOPT_RETURNTRANSFER =&gt; TRUE,
            CURLOPT_POST =&gt; TRUE,
            CURLOPT_POSTFIELDS =&gt; array(
                <span class="hljs-string">'login'</span> =&gt; <span class="hljs-string">'&lt;MY_ADMIN_USERNAME&gt;'</span>,
                <span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">'&lt;MY_ADMIN_PASSWORD&gt;'</span>
            )
        );

        <span class="hljs-variable">$curl</span>_session = curl_init(<span class="hljs-variable">$url</span>);

        curl_setopt_array(<span class="hljs-variable">$curl</span>_session, <span class="hljs-variable">$options</span>);

        <span class="hljs-variable">$res</span> = curl_exec(<span class="hljs-variable">$curl</span>_session);

        curl_close(<span class="hljs-variable">$curl</span>_session);

        <span class="hljs-variable">$this-</span>&gt;session_id = json_decode(<span class="hljs-variable">$res</span>)-&gt;meta-&gt;session_id;

    }

<span class="hljs-keyword">function</span> delete_user(<span class="hljs-variable">$username</span>) {

        <span class="hljs-variable">$url</span> = <span class="hljs-string">'https://api.cloud.appcelerator.com/v1/users/admin_batch_delete.json?key=&lt;MY_APP_KEY&gt;'</span>;

        <span class="hljs-variable">$options</span> = array(
            CURLOPT_RETURNTRANSFER =&gt; TRUE,
            CURLOPT_POST =&gt; TRUE,
            CURLOPT_POSTFIELDS =&gt; array(
                // Actually not sure if this is the correct syntax
                <span class="hljs-string">'where'</span> =&gt; <span class="hljs-string">'{username:'</span>.<span class="hljs-variable">$username</span>.<span class="hljs-string">'}'</span>
            )
        );

        <span class="hljs-variable">$curl</span>_session = curl_init(<span class="hljs-variable">$url</span>);

        curl_setopt_array(<span class="hljs-variable">$curl</span>_session, <span class="hljs-variable">$options</span>);

        <span class="hljs-variable">$res</span> = curl_exec(<span class="hljs-variable">$curl</span>_session);

        curl_close(<span class="hljs-variable">$curl</span>_session);

        return json_decode(<span class="hljs-variable">$res</span>)-&gt;meta-&gt;status == <span class="hljs-string">'ok'</span> ? TRUE : FALSE;

    }
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="April 3rd 2014, 10:49:23 pm">April 3rd 2014</span>
											by <span class='authorname'>Robert Gillman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Looks like you are sending request via POST, <code>CURLOPT_POST =&amp;gt; TRUE,</code>.<br>You should try with DELETE.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 4th 2014, 4:32:27 pm">April 4th 2014</span>
											by <span class='authorname'>peter lee</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m not quite sure what you mean by &quot;try with DELETE&quot;. Are you referring to the users&#x2F;delete.json method? As far as I understand that only deletes the currently logged in user.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 27th 2014, 11:22:43 pm">April 27th 2014</span>
											by <span class='authorname'>Robert Gillman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
