<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Can&#39;t make a button change after a sound has stopped » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Can&#39;t make a button change after a sound has stopped</h1>
		</header>
		<section>
			<p>Hi!<br>I am making an iPhone-app and have the following issue:<br>I have a short sound that is playing when the app launches, and added a simple button that can stop or play the sound that changes between a stop and a play symbol when clicked, with different background images. So far all good, but my problem is to make the button change when the sound has finished playing if you let the whole sound play to the end… I think I have tried everything, but just can&#39;t make it work, and cant fint the answer in the forum or in the documentation or kitchen sink either… I need the button to work like on a video player or the music player controls where the button changes to the play symbol when the video&#x2F;song is finished…<br>This is the code as it looks like now, and I have tried to put the last few lines within the first event listener as well, and now I am just confused… (Can add that I am pretty new with the whole app-making thing :))</p>
<pre><code class="hljs"><span class="hljs-comment">//play sound</span>
<span class="hljs-keyword">var</span> sound = Titanium.Media.createSound();
sound.url=<span class="hljs-string">'/sounds/scarysound.aiff'</span>;

sound.play();
sound.looping = <span class="hljs-literal">false</span>;

<span class="hljs-comment">//create sound buttons</span>
<span class="hljs-keyword">var</span> stopbutton = Titanium.UI.createButton({
    width:<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span>,
    top:<span class="hljs-number">5</span>,
    right:<span class="hljs-number">5</span>,
    backgroundImage:<span class="hljs-string">'images/volumestop.png'</span>
});

win1.add(stopbutton);

stopbutton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">if</span> (sound.isPlaying())
    {
        sound.stop();
        stopbutton.backgroundImage=<span class="hljs-string">'images/volumeplay.png'</span>;
        isPlaying=<span class="hljs-literal">true</span>;

    } <span class="hljs-keyword">else</span> {
        sound.play();
        stopbutton.backgroundImage=<span class="hljs-string">'images/volumestop.png'</span>;
        isPlaying=<span class="hljs-literal">false</span>;
    } 
});

stopbutton.addEventListener(<span class="hljs-string">'listen'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">if</span> (sound.isStopped())
    {
        stopbutton.backgroundImage=<span class="hljs-string">'images/volumeplay.png'</span>;
    }
});
</code></pre><p>Everything works except that detail… If someone could please help me to figure out how to make the button listen for if the sound is playing or not I would be very very grateful!!!<br>Kind regards,<br>Camilla</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 25th 2012, 9:21:12 pm">April 25th 2012</span>
				by <span class='authorname'>Camilla Pergelius</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>button</span></li>
					
						<li><span class='tagname'>event listener</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>sound</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Tried this now, since I made up the last few rows in the code above myself, but this doesnt work either, cant find the right variable….:</p>
<pre><code class="hljs"><span class="hljs-comment">//play sound</span>
var <span class="hljs-keyword">sound</span> = Titanium.Media.createSound();
<span class="hljs-keyword">sound</span>.url=<span class="hljs-string">'/sounds/scarysound.aiff'</span>;

<span class="hljs-keyword">sound</span>.<span class="hljs-keyword">play</span>();
<span class="hljs-keyword">sound</span>.looping = false;

<span class="hljs-comment">//create sound buttons</span>
var playbutton = Titanium.UI.createButton({
    width:<span class="hljs-number">50</span>,
    height:<span class="hljs-number">35</span>,
    top:<span class="hljs-number">5</span>,
    right:<span class="hljs-number">5</span>,
    backgroundImage:<span class="hljs-string">'images/volumeplay.png'</span>
});

win1.add(playbutton);

<span class="hljs-comment">// change playbutton if item is playing already</span>
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">sound</span>.isPlaying()){
    playbutton.backgroundImage=<span class="hljs-string">'images/volumestop.png'</span>;
    isPlaying = false;
}

playbutton.addEventListener(<span class="hljs-string">'click'</span>, function()
{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">sound</span>.isPlaying())
    {
        <span class="hljs-keyword">sound</span>.stop();
        playbutton.backgroundImage=<span class="hljs-string">'images/volumeplay.png'</span>;
        isPlaying=true;

    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">sound</span>.<span class="hljs-keyword">play</span>();
        playbutton.backgroundImage=<span class="hljs-string">'images/volumestop.png'</span>;
        isPlaying=false;
    } 
});
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="April 25th 2012, 10:02:39 pm">April 25th 2012</span>
								by <span class='authorname'>Camilla Pergelius</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-237304">
				
						<section>
							<p>Solved it by using a timer that changes the button-background after 10 seconds (same length as sound) instead.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 26th 2012, 3:03:47 pm">April 26th 2012</span>
								by <span class='authorname'>Camilla Pergelius</span><br>
								<a class="icon-bg icon-link" href="question/136047/cant-make-a-button-change-after-a-sound-has-stopped#answer-237304" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
