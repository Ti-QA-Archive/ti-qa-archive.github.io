<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Section titles not visible after search Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Section titles not visible after search</h1>
		</header>
		<section>
			<p>Hello everyone,<br>I was trying to make an app that can get search results using JSON. When I tried to sort the results using sections I noticed that the search results did not have the sections. When I pressed cancel, the sections did show in the right way as I intended.</p>
<p>To make sure that you can try an example of what I mean, I found this example on github that has exactly the same problem as I have in my app.</p>
<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;3778685">Github example</a></p>
<p>To replicate: Do as in the github is explained to create the projects. Then type two letters for example &quot;ma&quot;. Pressing the search button or scrolling after that, shows no sections. Pressing cancel does show the sections.</p>
<p>My question to you would of course be: How can I show the sections when typing in the search bar?</p>
<p>My platform information:<br>Titanium SDK: 2.1.4<br>iOS simulator: 4.3 Linked iOS Version 6.0<br>Operating System: OS X Lion 10.7.5<br>Titanium Studio, build: 2.1.2.201208301612</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 18th 2012, 12:37:13 pm">November 18th 2012</span>
				by <span class='authorname'>Thom Overhof</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>appcelerator</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>searchbar</span></li>
					
						<li><span class='tagname'>sections</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-251289">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi Thom</p>
<p>As you have not supplied your own code for us to review we are left to guess.</p>
<p>If you mean when you have a table with a <code>searchBar</code> linked directly and you are using the built in <strong>filtering</strong> that the combination brings (you are NOT providing any code to filter or search the results yourself), then this behaviour is to be expected.</p>
<p>The issue you are reporting is not a bug - but rather a feature.  Take a look at the <strong>contact</strong> app on the iPhone and perform the same steps.  The results are the same as the search feature is acting as a filter to the results you have already added to the table, those results are essentially a single separate section containing ONLY those matched results.</p>
<p>If you want to achieve a search that reduces the results but maintains the exact same layout as you have in the main table, then you have to separate the table and search and manage the display of the results manually.  Still easy but you have to use <code>table.setData(revisedArrayOfRows);</code> for each <code>change</code> event or on any <code>return</code> events of the <code>searchBar</code>.</p>
<p>Keep in mind the behaviour you are observing is standard and expected by users of iOS, so whilst you can change it to suit your needs, balance this with the anticipated behaviour the user will expect.  Basically only &#39;improve&#39; things if there is a genuine improvement at the end.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 18th 2012, 1:12:34 pm">November 18th 2012</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/144830/section-titles-not-visible-after-search.html#answer-251289" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>You are absolutely right that this is the standard behavior of the search bar. I want to implement the feature because my json results are going to be divided into two sections, one having cities that are most related to the search query and the other section with names that are most related to the search.</p>
<p>The code below is what I use to display the search bar and get search data in json. </p>
<p>The json data is build in like this:</p>
<pre><code class="hljs">{"<span class="hljs-attribute">posts</span>":<span class="hljs-value">[{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"City1"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"881"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"1"</span></span>}</span>},{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"Name1"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"828"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"0"</span></span>}</span>},{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"Name2"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"908"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"0"</span></span>}</span>},{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"Name3"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"1011"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"0"</span></span>}</span>},{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"Name4"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"1122"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"0"</span></span>}</span>},{"<span class="hljs-attribute">post</span>":<span class="hljs-value">{"<span class="hljs-attribute">Naam</span>":<span class="hljs-value"><span class="hljs-string">"Name5"</span></span>,"<span class="hljs-attribute">id</span>":<span class="hljs-value"><span class="hljs-string">"1204"</span></span>,"<span class="hljs-attribute">flag</span>":<span class="hljs-value"><span class="hljs-string">"0"</span></span>}</span>}]</span>}
</code></pre><pre><code class="hljs">
<span class="hljs-keyword">var</span> win = Ti.UI.createWindow({
    <span class="hljs-comment">//backgroundColor : 'white'</span>
    navBarHidden: <span class="hljs-literal">true</span>,

});


<span class="hljs-keyword">var</span> tableData = [];
<span class="hljs-keyword">var</span> json, fighters, fighter, i, row, nameLabel, nickLabel;
<span class="hljs-keyword">var</span> lastSearchTerm = <span class="hljs-string">''</span>; 
<span class="hljs-keyword">var</span> searchbar = Titanium.UI.createSearchBar({
   hintText:<span class="hljs-string">'Type a city name'</span>,
   showCancel:<span class="hljs-literal">true</span>,
   top:<span class="hljs-number">0</span>
});

<span class="hljs-comment">//AUTOCOMPLETE TABLE</span>
<span class="hljs-keyword">var</span> tableSection = Ti.UI.createTableViewSection({});
        tableSection.headerTitle = <span class="hljs-string">'cities'</span>;

<span class="hljs-keyword">var</span> tableSection2 = Ti.UI.createTableViewSection({});
        tableSection2.headerTitle = <span class="hljs-string">'names'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doSearch</span>(<span class="hljs-params">search</span>) </span>{
  <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
  xhr.setTimeout(<span class="hljs-number">60000</span>);

  xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{ 
    Ti.API.info(e); 
  };

  xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{

    Ti.API.info(<span class="hljs-string">"fetching"</span>);
    Ti.API.info(search);
    <span class="hljs-comment">//tableData = [];</span>
    <span class="hljs-keyword">var</span> rowHeight = <span class="hljs-number">50</span>;

    json = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);

    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; json.posts.length; i++) {
        fighter = json.posts[i];
        row = Ti.UI.createTableViewRow({
            hasChild:<span class="hljs-literal">true</span>,
            widgetname:fighter.post.Naam,
            title:<span class="hljs-string">'hello'</span>

        });

        <span class="hljs-keyword">if</span>(fighter.post.flag == <span class="hljs-number">1</span>){
            tableSection.add(row);
        }
        <span class="hljs-keyword">else</span>{
            tableSection2.add(row);
        }
    }  
  }
  tableData.push(tableSection);
        tableData.push(tableSection2);
  autocomplete_table.setData(tableData);

  autocomplete_table.setHeight(<span class="hljs-string">'auto'</span>);



  xhr.open(<span class="hljs-string">'POST'</span>, url <span class="hljs-comment">/* this is your url that would respond with search data */</span>);
  xhr.send();

 }

<span class="hljs-comment">// This gets called when a key was pressed or enter or blur</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">searchChanged</span>(<span class="hljs-params">search</span>) </span>{
    doSearch(search);

}

<span class="hljs-comment">// These are your listeners with a change to call the search</span>
searchbar.addEventListener(<span class="hljs-string">'change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
</span>{
    doSearch(searchbar.getValue())
    <span class="hljs-comment">//searchChanged(searchbar.getValue());</span>
});


<span class="hljs-keyword">var</span> autocomplete_table = Titanium.UI.createTableView({
   data:[tableSection,tableSection2],
   filterAttribute:<span class="hljs-string">'widgetname'</span>,
   search: searchbar,
   scrollable: <span class="hljs-literal">true</span>,
   layout:<span class="hljs-string">'vertical'</span>,
   height: <span class="hljs-string">'43dp'</span>,
   top:<span class="hljs-number">0</span>
});
win.add(autocomplete_table);

win.open();
</code></pre><p>Now from what you posted, I can&#39;t see how I should implement the separate table for the results.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2012, 1:40:32 pm">November 18th 2012</span>
											by <span class='authorname'>Thom Overhof</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi</p>
<p>Depending on how many results your XHR returns consider caching the results locally so the user does not have to call the server every time a key is pressed and your server does not have to be called on the same frequency.</p>
<p>If you have too many records to cache, then consider only filtering the responses after &#39;x&#39; characters have been typed.</p>
<p>To separate the <code>searchBar</code> remove the lines;</p>
<pre><code class="hljs"><span class="hljs-string">filterAttribute:</span><span class="hljs-string">'widgetname'</span>,
<span class="hljs-string">search:</span> searchbar,
</code></pre><p>Manually add the <code>searchBar</code> to the same level as your table <code>win</code> in your case.</p>
<p>Make sure to add the property <code>top: 0</code> so it appears at the top.</p>
<p>I notice you have tried to compensate for the solution you are after by setting the height to the search bar to start, don&#39;t, it will not to as you want.</p>
<p>Add &amp; change the following parameters to the table code;</p>
<pre><code class="hljs"><span class="hljs-attribute">top</span>: <span class="hljs-number">44</span>, <span class="hljs-comment">// actual height of the search bar</span>
<span class="hljs-attribute">height</span>: Ti<span class="hljs-class">.UI</span><span class="hljs-class">.FILL</span>, <span class="hljs-comment">// will use the entire height minus any top and bottom values</span>
</code></pre><p>If your dataset is small enough to cache, only call the XHR method once and then handle the filtering of the array in a different function looping the results creating a subset, then set using;</p>
<pre><code class="hljs"><span class="hljs-tag">autocomplete_table</span><span class="hljs-class">.setData</span>(<span class="hljs-tag">subset</span>);
</code></pre><p>If your data needs to come from the server each time, filter the results on the server so you are only passes matching results - this will reduce the load on the server and amount data for the user, using;</p>
<pre><code class="hljs"><span class="hljs-tag">xhr</span><span class="hljs-class">.send</span>(<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">filter</span>:<span class="hljs-value"> searchbar.<span class="hljs-function">getValue</span>() </span></span></span>});
</code></pre><p>This should help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2012, 2:12:21 pm">November 18th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you for your answers. I was already working on something based on your answer and it is exactly what I meant. So thank you for your time and effort!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2012, 2:21:21 pm">November 18th 2012</span>
											by <span class='authorname'>Thom Overhof</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
