<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Bad request on Android when accessing web service call Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Bad request on Android when accessing web service call</h1>
		</header>
		<section>
			<p>Hi All,<br>I am just sending 2 values via POST method to server, And will got the response as user_id,</p>
<p>Unfortunately,  I am getting below error while clicking on LOGIN button from Android, </p>
<p>But that web service call is working fine with iOS and From web browser</p>
<pre><code class="hljs">[ERROR] :  TiHttpClient: (TiHttpClient-<span class="hljs-number">1</span>) [<span class="hljs-number">132111</span>,<span class="hljs-number">132640</span>] HTTP Error (org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.client</span><span class="hljs-class">.HttpResponseException</span>): Bad Request
[ERROR] :  TiHttpClient: org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.client</span><span class="hljs-class">.HttpResponseException</span>: Bad Request
[ERROR] :  TiHttpClient:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">275</span>)</span></span>
[ERROR] :  TiHttpClient:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">219</span>)</span></span>
[ERROR] :  TiHttpClient:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">677</span>)
[ERROR] :  TiHttpClient:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">657</span>)
[ERROR] :  TiHttpClient:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$ClientRunnable</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">1328</span>)</span></span>
[ERROR] :  TiHttpClient:     at java<span class="hljs-class">.lang</span><span class="hljs-class">.Thread</span><span class="hljs-class">.run</span>(Thread<span class="hljs-class">.java</span>:<span class="hljs-number">841</span>)
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 9th 2014, 10:41:26 am">December 9th 2014</span>
				by <span class='authorname'>Silambarasan Raman</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>bad request</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>xhr</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you provide some sample code? Also what version of sdk you are using? is it alloy project or normal? How are you calling webservice?</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 9th 2014, 2:27:03 pm">December 9th 2014</span>
								by <span class='authorname'>Narendra Raorane</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Narendra,</p>
<p>I am using commonJS, and using Ti SDK 3.4.0 GA,</p>
<p>Please let me know if you need anything</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> Data = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lib/http'</span>); <span class="hljs-comment">// I have exported the global http module here</span>
 <span class="hljs-keyword">var</span> mmuser_id=    Titanium.Platform.id;
 <span class="hljs-keyword">var</span> EmailView = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">status, locationHeader, data</span>) </span>{    
                <span class="hljs-keyword">var</span> arrData = data;                
                  Ti.API.info(arrData);              
                  <span class="hljs-keyword">if</span>(arrData.result ===<span class="hljs-literal">true</span>){    
                 Ti.App.Properties.setString(<span class="hljs-string">"userId"</span>, arrData.userid);                 
                  }
                  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(arrData.result ===<span class="hljs-literal">false</span>){
                      alert(<span class="hljs-string">"Please check your email address because its not a registered with our server"</span>);
                  }             
 };
<span class="hljs-keyword">var</span> loadErrorCallback = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">status, locationHeader, data</span>) </span>{                 
                                 alert(VARS.global_alert);                  
};
<span class="hljs-keyword">var</span> urlLogin = VARS.global_remote_url+<span class="hljs-string">"mobile.php?action=login&amp;email="</span>+EmailTF.value+<span class="hljs-string">"&amp;user_name="</span>+mmuser_id;
                Data.xhr(urlLogin, <span class="hljs-string">'POST'</span>, <span class="hljs-string">'Content-Type", "application/json; charset=utf-8'</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>, EmailView, loadErrorCallback, <span class="hljs-literal">true</span>);
    }
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="December 10th 2014, 2:35:34 am">December 10th 2014</span>
								by <span class='authorname'>Silambarasan Raman</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Narendra,</p>
<p>Any updates with the above?</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2014, 6:42:12 am">December 16th 2014</span>
								by <span class='authorname'>Silambarasan Raman</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-284364">
				
						<section>
							<p>Hi Silambarasan,</p>
<p>Bad Request error messages are sometimes customized by website owners so keep in mind that this error may present itself in more ways than the common ones listed below:</p>
<ul>
<li>&quot;400 Bad Request&quot;</li>
<li>&quot;Bad Request. Your browser sent a request that this server could not understand.&quot;</li>
<li>&quot;Bad Request - Invalid URL&quot;</li>
<li>&quot;HTTP Error 400 - Bad Request&quot;</li>
<li>&quot;Bad Request: Error 400&quot;</li>
<li>&quot;HTTP Error 400. The request hostname is invalid.&quot;</li>
<li>&quot;400 - Bad request. The request could not be understood by the server due to malformed syntax. The client should not repeat the request without modifications.&quot;</li>
</ul>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 9th 2014, 11:18:35 am">December 9th 2014</span>
								by <span class='authorname'>Nilesh Patel</span><br>
								<a class="icon-bg icon-link" href="question/179537/bad-request-on-android-when-accessing-web-service-call.html#answer-284364" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Nilesh,</p>
<p>Thanks FYI, Can yoy tell why i am getting that error in Android only, iOS is working fine.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 9th 2014, 11:28:44 am">December 9th 2014</span>
											by <span class='authorname'>Silambarasan Raman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Silambarasan,</p>
<p>Can you provide us codes.?</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 10th 2014, 5:29:21 am">December 10th 2014</span>
											by <span class='authorname'>Nilesh Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Nilesh, </p>
<p>I have posted my code above, Please look</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2014, 3:17:22 am">December 11th 2014</span>
											by <span class='authorname'>Silambarasan Raman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Silambarasan,</p>
<p>Have you tried with <code>Titanium.Network.createHTTPClient</code>. ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2014, 7:12:45 am">December 16th 2014</span>
											by <span class='authorname'>Nilesh Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Nilesh,</p>
<p>Yes , i do worked with Ti.Network.createHTTPClient, And it was working fine.</p>
<p>But later i had to use Many Web service calls, so i have created the Module for HTTP Call<br>And facing an issue with Android, But iOS is working fine</p>
<p>BELOW is http.js file</p>
<pre><code class="hljs">exports.xhr = function(url, <span class="hljs-keyword">method</span>, headers, queryArgs, data, callback, errorCallback, suppressLogging,readyState) {


    <span class="hljs-keyword">if</span> (!headers) {
        headers = exports.getAPIHeaders();
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">method</span> === '<span class="hljs-type">GET</span>' &amp;&amp; data) {
        <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.warn('<span class="hljs-type">Did</span> you mean to specify data on a <span class="hljs-type">GET</span> request? <span class="hljs-type">It</span> will be sent <span class="hljs-keyword">as</span> <span class="hljs-type">POST</span>!');
    }

    <span class="hljs-keyword">var</span> expectedStatus = '<span class="hljs-number">200</span>';
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">method</span> == '<span class="hljs-type">PUT</span>' || <span class="hljs-keyword">method</span> == '<span class="hljs-type">DELETE</span>') {
        expectedStatus = '<span class="hljs-number">204</span>';
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">method</span> == '<span class="hljs-type">POST</span>') {
        expectedStatus = '<span class="hljs-number">201</span>';
    }

    // was initial <span class="hljs-type">set</span> to <span class="hljs-number">5000</span>
    <span class="hljs-keyword">var</span> client = <span class="hljs-type">Ti</span>.<span class="hljs-type">Network</span>.createHTTPClient({
        autoEncodeUrl:<span class="hljs-literal">true</span>,
        timeout : <span class="hljs-number">35000</span> //<span class="hljs-number">30000</span>
    });

    <span class="hljs-keyword">var</span> queryList = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; queryArgs.length; i++) {
        queryList.push(queryArgs[i][<span class="hljs-number">0</span>] + '=' + queryArgs[i][<span class="hljs-number">1</span>]);
    }
    <span class="hljs-keyword">if</span> (queryList.length &gt; <span class="hljs-number">0</span>) {
        url += '?' + queryList.join('&amp;');
    }

    client.onload = function() {
       <span class="hljs-keyword">if</span> (this.status &lt; <span class="hljs-number">299</span>) {
            <span class="hljs-keyword">if</span> (this.readyState == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">var</span> response = this.responseText;

                <span class="hljs-keyword">if</span> (this.responseText) {

                    <span class="hljs-keyword">try</span> {
                        response = <span class="hljs-type">JSON</span>.parse(this.responseText);                        
                    } 
                    catch (e) {    
                        <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.info(e);                                
//globalVariables.<span class="hljs-type">ServerError</span>(<span class="hljs-string">"OMG"</span>,<span class="hljs-string">"Refresh"</span>);        // <span class="hljs-type">Function</span> <span class="hljs-keyword">for</span> <span class="hljs-type">Error</span> page                                
                    }
                }

                <span class="hljs-keyword">if</span> (callback) {
                    //callback(this.status, this.getResponseHeader('<span class="hljs-type">Location</span>'), response);
                    callback(null, null, response);
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.error('onload: unexpected response, readyState=' + this.readyState);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.error('onload: unexpected response, status=' + this.status);
        }
    };

    client.onerror = function() {

        <span class="hljs-keyword">if</span> (errorCallback &amp;&amp; this.status &gt; <span class="hljs-number">299</span>) {
            errorCallback(this.status, '', this.responseText);
        }
    };

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; headers.length; i++) {
        client.setRequestHeader(headers[i][<span class="hljs-number">0</span>], headers[i][<span class="hljs-number">1</span>]);
    }

    // <span class="hljs-type">Adding</span> data <span class="hljs-keyword">in</span> send will <span class="hljs-type">set</span> <span class="hljs-keyword">method</span> to <span class="hljs-string">"POST"</span>, overriding this parameter
    client.open(<span class="hljs-keyword">method</span>, url);
    client.begin_time = new <span class="hljs-type">Date</span>().getTime();
    client.send(data);


    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
};
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 16th 2014, 7:31:33 am">December 16th 2014</span>
											by <span class='authorname'>Silambarasan Raman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
