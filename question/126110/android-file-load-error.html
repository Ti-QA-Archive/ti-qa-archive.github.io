<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android File Load Error... » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android File Load Error...</h1>
		</header>
		<section>
			<p>Hi</p>
<p>I have an issue with an app I am developing.</p>
<p>I am using a Mac OSX Lion Latest release of Titanium Studio and last nights 1.8 SDK</p>
<p>I have also tried this with 1.7.2 and 1.7.3</p>
<p>The app works perfectly on the iPhone.</p>
<p>What I am doing is producing a basic MVC architecture this is done by separating the code into separate file and using namespaces and anonymous functions architecture. I do not have another framework involved it uses Titanium and Javascript only.</p>
<p>The issue is rather than loading all the files in the app.js file I have a function which loads each file at the time it is required, based on the screen or data call.</p>
<p>This on the iPhone works really well, I keep a trace of the files loaded so that if they have already been loaded they are not loaded again.</p>
<p>On Android I get an error saying FSAP is not defined. But it is the first definition in the app.js file. This happens when loading any js file.</p>
<p>I have posted some code here https:&#x2F;&#x2F;gist.github.com&#x2F;gists&#x2F;1246133</p>
<p>The complete app.js file and the code which calls the file loading routine.</p>
<p>I hope somebody can help here as I have no idea where to start looking to resolve.</p>
<p>Thanks</p>
<p>T.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 27th 2011, 6:35:35 pm">September 27th 2011</span>
				by <span class='authorname'>Trevor Ward</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>file load</span></li>
					
						<li><span class='tagname'>namespace</span></li>
					
				</ul>
			

			<section>
				<h5>12 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you list the specific error you are getting, everything from your log? Also, that gist is formatted in a way that is very hard to read. It might be easier to help if it was formatted better.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 7:26:50 pm">September 27th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Thanks Tony, I have formatted the code. Hopefully much more readable. Sorry I format code in a very specific way which does not transfer to the gist paste well. I have also removed a load of irrelevant comments.</p>
<p>I tried to use the code formatter in Studio but it failed saying please raise a bug, but I think one is already raised :).</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 8:23:56 pm">September 27th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Thanks for updating the formatting, a lot easier to read. Can you post up a full log of the error you are encountering? Given the amount of includes I don&#39;t think I&#39;ll be able to test your app myself. The error logs are all I have to go on. Also, if possible, have you identified which line of your code causes the error?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 8:30:07 pm">September 27th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>It is the first line of code in any file which has to be loaded saying FSAP is not found…</p>
<p>(function()<br>{<br>  FSAP.VW.scapeLoad  = function()<br>  {<br>      &#x2F;&#x2F;The code<br>   };<br>})();</p>
<p>So basically the error on the phone is that..</p>
<p>I will try and get the error log posted shortly, it maybe tomorrow now (12.15am well ok later today).</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:15:03 pm">September 27th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>OK, I think I&#39;m following you now. You are declaring the namespaces globally, and when you try to reference them in your included files, you are getting an error that says the namespaces don&#39;t exist? Is this correct? </p>
<p>I&#39;ll see if I can recreate this issue with a simpler example until you can get me the error log from your execution.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:24:53 pm">September 27th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Thanks</p>
<p>Being thick here which error log ?….. (where do I find it). The titanium log or the android log.</p>
<p>T</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:35:40 pm">September 27th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Both please. You should be able to grab both from Titanium Studio. You can also get the android log from the <code>ddms</code> tool that comes with your android sdk.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:38:11 pm">September 27th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Again being really thick. I can get the build log, and can view the error log, but not sure how to get the error log as a fie ..</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:47:15 pm">September 27th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Can you not just copy and paste the log out? </p>
<p>I&#39;ve tried to mimic your issue with my own code and unable to reproduce the problem. This is the extremely basic example:</p>
<h3 id="app-js">app.js</h3>
<pre><code class="hljs">Ti.UI.backgroundColor = '#000';

<span class="hljs-keyword">var</span> <span class="hljs-keyword">win</span> = Ti.UI.createWindow();

<span class="hljs-keyword">var</span> <span class="hljs-keyword">TEST</span> = {};
    <span class="hljs-keyword">TEST</span>.JUNE = {};

Ti.<span class="hljs-keyword">include</span>('<span class="hljs-keyword">test</span>/another/<span class="hljs-keyword">file</span>.js');

<span class="hljs-keyword">win</span>.<span class="hljs-keyword">open</span>();

<span class="hljs-keyword">TEST</span>.JUNE.myfunc();
</code></pre><h3 id="test-x2f-another-x2f-file-js">test&#x2F;another&#x2F;file.js</h3>
<pre><code class="hljs"><span class="hljs-list">(<span class="hljs-keyword">function</span><span class="hljs-list">()</span> <span class="hljs-collection">{
    TEST.JUNE.myfunc = function<span class="hljs-list">()</span> <span class="hljs-collection">{
        alert<span class="hljs-list">(<span class="hljs-keyword">'it</span> works!')</span><span class="hljs-comment">;    </span>
    }</span><span class="hljs-comment">;</span>
}</span>)</span><span class="hljs-list">()</span><span class="hljs-comment">;</span>
</code></pre><p>This creates an alert just like I would expect. Is there something more to your problem that I missing? Can you possibly to try to recreate it with a simpler example on your side?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 27th 2011, 9:57:16 pm">September 27th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Tony, Thanks so much for the help. Back awake now will be looking at it shortly. Tried cutting and pasting the logs HUGE…….. So I will try and initialise them and then run the Android again… But a thought has occurred during my sleeping hours which I will look at first. Again thank you.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 28th 2011, 6:21:06 am">September 28th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Tony</p>
<p>OK traced further. If I include the file in the app.js file then everything works well…. So it is when loading the file after the app has loaded initially. So My initial screen loads first time no issues, when I try to login which then loads the data model js file required for the data call I get the FSAP error. </p>
<p>This is the same for all files which are loaded at time of requirement as opposed to at runtime.</p>
<p>Again this is only happening on Android, works really well on iPhone. As you have mentioned there are a lot of files to include, which is why I try and load them at time required rather than at initial run time.</p>
<p>going to post the log to paste bin…</p>
<p>https:&#x2F;&#x2F;gist.github.com&#x2F;1247463</p>
<p>Thanks</p>
<p>T.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 28th 2011, 7:29:45 am">September 28th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Oh I wonder if the load file while the app is running is overwriting the already loaded files which is causing the issue… Memory management ???.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 28th 2011, 7:31:01 am">September 28th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-219704">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Trevor,</p>
<p>This previous question from Q&amp;A cites a workaround to your issue: <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;123045&#x2F;tiinclude-on-android-after-main-load-does-not-have-global-scope">http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;123045&#x2F;tiinclude-on-android-after-main-load-does-not-have-global-scope</a></p>
<p>I know, it&#39;s not ideal, but it should let you continue your work for the time being. One other thing you might want to try is giving your runtime includes a full path in the Ti.include(). For example, instead of </p>
<pre><code class="hljs"><span class="hljs-type">Ti</span>.<span class="hljs-keyword">include</span>(<span class="hljs-symbol">'FSUT</span>/<span class="hljs-type">GS</span>/<span class="hljs-type">FSUT</span>-<span class="hljs-type">GS</span>-<span class="hljs-type">PI</span>.js');
</code></pre><p>try </p>
<pre><code class="hljs">Ti.<span class="hljs-keyword">include</span>(Ti.FileSystem.resourceDirectory + <span class="hljs-string">'/FSUT/GS/FSUT-GS-PI.js'</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 28th 2011, 10:52:53 am">September 28th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span><br>
								<a class="icon-bg icon-link" href="question/126110/android-file-load-error.html#answer-219704" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks Tony, that lazy load was the solution, put the veal commands in and it all works …..</p>
<p>Any objections to me raising a bug report for this ?… will do a use case (obviously cannot be one file)..</p>
<p>The full path actually made no difference to the load.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 28th 2011, 12:08:12 pm">September 28th 2011</span>
											by <span class='authorname'>Trevor Ward</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Please do raise a bug for it. Use the <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC">Titanium Community</a> reporting system.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 28th 2011, 12:10:31 pm">September 28th 2011</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>3</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
