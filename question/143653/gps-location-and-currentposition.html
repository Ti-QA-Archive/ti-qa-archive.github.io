<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>GPS Location and CurrentPosition » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>GPS Location and CurrentPosition</h1>
		</header>
		<section>
			<p>Hi Everyone</p>
<p>I know this has been discussed a million times but im going nuts at how to get this right. All my researchhas bought me to the following code.</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNewPosition</span>(<span class="hljs-params"></span>)</span>{

      Ti.Geolocation.distanceFilter = <span class="hljs-number">10</span>;
      Ti.Geolocation.preferredProvider = <span class="hljs-string">"gps"</span>;
      Titanium.Geolocation.accuracy = Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS;
      Titanium.Geolocation.getCurrentPosition(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{});

        <span class="hljs-keyword">var</span> locationCallback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{

        <span class="hljs-keyword">if</span> (!e.success || e.error) {
                       <span class="hljs-comment">// do error processing</span>
            <span class="hljs-keyword">return</span>;
        }

        Titanium.Geolocation.removeEventListener(<span class="hljs-string">'location'</span>, locationCallback);

        <span class="hljs-keyword">var</span> longitude = e.coords.longitude;
        <span class="hljs-keyword">var</span> latitude = e.coords.latitude;
        <span class="hljs-comment">//var timestamp = e.coords.timestamp;</span>

        ReturnDatabasePosition(latitude,longitude);  

    }

     Titanium.Geolocation.addEventListener(<span class="hljs-string">'location'</span>, locationCallback);  
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ReturnDatabasePosition</span>(<span class="hljs-params">nLat,nLon</span>)
    </span>{
        Connecting to database

        Return results

        Ti.App.Properties.setString

        open <span class="hljs-keyword">new</span> <span class="hljs-built_in">window</span>
    }
</code></pre><p>I am managing the users UI by not allowing the to use the button when no signal. However, if the signal is really weak or going on and off, it just returns the last know latitude and Longitude which is cached by currentPosition.</p>
<p>I have it working really well but its just the handling of the not updated latitude and longitude. </p>
<p>Ideally i would stop them using it when a weak signal is present but i can&#39;t detect that as far as I know.</p>
<p>Any thoughts or suggestion would be great.  Also should I be using try&#x2F;catch when working with ?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 18th 2012, 11:09:39 am">October 18th 2012</span>
				by <span class='authorname'>Mark Pierce</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>currentposition</span></li>
					
						<li><span class='tagname'>gps</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>location</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>which sdk are you using?<br>i have a geolocation function that runs permanently, and it only works with 2.1.1 GA and not with 2.1.3</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 18th 2012, 1:27:38 pm">October 18th 2012</span>
								by <span class='authorname'>Majid Mazinani</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Majid</p>
<p>Live app is on 2.1.1 working with 2.1.3 currently. Can your issue be resolved on 2.1.3? </p>
<p>Any good learnings or advice about Geolocation?</p>
<p>Thanks in advance</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 19th 2012, 4:53:57 am">October 19th 2012</span>
								by <span class='authorname'>Mark Pierce</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>still doesnt work on 2.1.3… i read some issues related to Geoloc are solved in the comin 3.0 version.<br>By the way i only use the &quot;location&quot; listener event like you do here &quot;Titanium.Geolocation.addEventListener(&#39;location&#39;, locationCallback);&quot;… if i want to switch off the service..I just remove the listener..<br>There is a property called:<br>trackSignificantLocationChange : Boolean<br>That can be useful too</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 29th 2012, 9:11:02 pm">October 29th 2012</span>
								by <span class='authorname'>Majid Mazinani</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-249536">
				
						<section>
							<p>Hi,</p>
<p>you process is asynchron. Thatswhy you have to communicate with caller at 2 ways:</p>
<ul>
<li>events</li>
<li>callbacks </li>
</ul>
<p>Do you need more help?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 18th 2012, 11:41:19 am">October 18th 2012</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="question/143653/gps-location-and-currentposition.html#answer-249536" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I think I do need more help. So is the above code on the right lines? Im not able to test it without going out in the car and getting my wife to test it. </p>
<p>When I test it on the simulator and I change the location its not recognising the update when i hit the switch again. Is that a simulator issue? or is the issue with me ;)</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 18th 2012, 11:51:00 am">October 18th 2012</span>
											by <span class='authorname'>Mark Pierce</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
