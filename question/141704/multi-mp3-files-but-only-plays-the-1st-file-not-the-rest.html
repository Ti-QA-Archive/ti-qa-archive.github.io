<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Multi MP3 files, but only plays the 1st file, not the rest.... » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Multi MP3 files, but only plays the 1st file, not the rest....</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I have 5 mp3 files, and need to play them one after another in one click. But the code only plays the 1st mp3 but not the rest. Please see the code below…Thank you for your help.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win_main = Titanium.UI.currentWindow;

<span class="hljs-keyword">var</span> x = Ti.Platform.displayCaps.platformWidth;
<span class="hljs-keyword">var</span> y = Ti.Platform.displayCaps.platformHeight;

<span class="hljs-comment">//WINDOW CLOSE BUTTON</span>
<span class="hljs-keyword">var</span> closeButton = Titanium.UI.createButton({
    title:<span class="hljs-string">'Close'</span>,
    backgroundImage: <span class="hljs-string">'none'</span>,
    backgroundColor:<span class="hljs-string">'black'</span>,
    top:<span class="hljs-number">0</span>,
    right:<span class="hljs-number">0</span>
});

closeButton.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
    </span>{
        win_main.close({transition:Ti.UI.iPhone.AnimationStyle.CURL_DOWN});
    });

win_main.add(closeButton);

<span class="hljs-comment">//audio</span>

<span class="hljs-keyword">if</span> (Titanium.Media.audioPlaying) {
    Titanium.Media.audioSessionMode = Titanium.Media.AUDIO_SESSION_MODE_AMBIENT;
}

<span class="hljs-comment">//</span>
<span class="hljs-comment">// PLAY BUTTON</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">var</span> play = Titanium.UI.createButton({
    title:<span class="hljs-string">'Play'</span>,
    backgroundImage: <span class="hljs-string">'none'</span>,
    backgroundColor:<span class="hljs-string">'black'</span>,
    bottom:<span class="hljs-number">11</span>
});

win_main.add(play);

<span class="hljs-comment">//</span>
<span class="hljs-comment">// PAUSE BUTTON</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">var</span> pause = Titanium.UI.createButton({
    title: <span class="hljs-string">'Pause'</span>,
    backgroundImage: <span class="hljs-string">'none'</span>,
    backgroundColor:<span class="hljs-string">'black'</span>,
    left:(x/<span class="hljs-number">2</span>)-<span class="hljs-number">90</span>,
    bottom:<span class="hljs-number">11</span>,
    zIndex: <span class="hljs-number">1</span>,
});

win_main.add(pause);

<span class="hljs-comment">//</span>
<span class="hljs-comment">// STOP BUTTON</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">var</span> stop = Titanium.UI.createButton({
    title:<span class="hljs-string">'Stop'</span>,
    backgroundImage: <span class="hljs-string">'none'</span>,
    backgroundColor:<span class="hljs-string">'black'</span>,
    right:(x/<span class="hljs-number">2</span>)-<span class="hljs-number">90</span>,
    bottom:<span class="hljs-number">11</span>
});

win_main.add(stop);

<span class="hljs-comment">// sound functions</span>

<span class="hljs-keyword">var</span> soundCounter=<span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> sound = Ti.Media.createSound();

play.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{

    sound.url=<span class="hljs-string">'audio/'</span>+soundCounter+<span class="hljs-string">'.mp3'</span>,
    sound.addEventListener(<span class="hljs-string">'complete'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        soundCounter++;
        <span class="hljs-keyword">if</span>(soundCounter!==<span class="hljs-number">3</span>)
            play.fireEvent(<span class="hljs-string">'click'</span>);
        <span class="hljs-keyword">else</span>
            soundCounter = <span class="hljs-number">0</span>;
    });
    sound.play();    
    });

    pause.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
            </span>{
                sound.pause();
            });

    stop.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
            </span>{
                sound.stop();
            });
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 30th 2012, 10:55:22 pm">August 30th 2012</span>
				by <span class='authorname'>Rishi Marc</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>loop</span></li>
					
						<li><span class='tagname'>mp3</span></li>
					
						<li><span class='tagname'>multiple mp3 play</span></li>
					
						<li><span class='tagname'>sound</span></li>
					
						<li><span class='tagname'>ti.media.createsound</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-246405">
				
						<section>
							<p>try this refactoring</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> soundCounter=<span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> sound = Ti.Media.createSound();

<span class="hljs-comment">// ONLY add the event listener once</span>
sound.addEventListener(<span class="hljs-string">'complete'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
    soundCounter++;
    <span class="hljs-keyword">if</span>(soundCounter!==<span class="hljs-number">3</span>) {
        playMusic();
    } <span class="hljs-keyword">else</span> {
        soundCounter = <span class="hljs-number">0</span>;
    }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">playMusic</span><span class="hljs-params">()</span> </span>{

    sound.url=<span class="hljs-string">'audio/'</span>+soundCounter+<span class="hljs-string">'.mp3'</span>,

    sound.play();  
}
play.addEventListener(<span class="hljs-string">'click'</span>,playMusic());
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 30th 2012, 11:05:29 pm">August 30th 2012</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/141704/multi-mp3-files-but-only-plays-the-1st-file-not-the-rest#answer-246405" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246408">
				
						<section>
							<p>Aaron, somehow the solution is not working…</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 30th 2012, 11:17:23 pm">August 30th 2012</span>
								by <span class='authorname'>Rishi Marc</span><br>
								<a class="icon-bg icon-link" href="question/141704/multi-mp3-files-but-only-plays-the-1st-file-not-the-rest#answer-246408" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I will take a look in a bit… running out the door, can you please provide more information on what is going wrong? Is it still the same behavior as before?</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 30th 2012, 11:21:02 pm">August 30th 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Still the same behaviour as before, plays the 1st mp3 and also some error messages…</p>
<pre><code class="hljs">[ERROR] Invalid <span class="hljs-keyword">type</span> passed <span class="hljs-keyword">to</span> <span class="hljs-function"><span class="hljs-keyword">function</span>. <span class="hljs-title">expected</span>:</span> KrollCallback, was: NSNull  <span class="hljs-keyword">in</span> -[TiProxy addEventListener:] (TiProxy.m:<span class="hljs-number">764</span>)
</code></pre><pre><code class="hljs">[<span class="hljs-keyword">ERROR</span>] Script <span class="hljs-keyword">Error</span> = Invalid <span class="hljs-keyword">type</span> passed to function. expected: KrollCallback, was: NSNull  <span class="hljs-keyword">in</span> -[TiProxy addEventListener:] (TiProxy.<span class="hljs-keyword">m</span>:764) at <span class="hljs-keyword">app</span>.js (<span class="hljs-keyword">line</span> 88).
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 30th 2012, 11:33:12 pm">August 30th 2012</span>
											by <span class='authorname'>Rishi Marc</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry, need to move the playmusic function to before the event listener is defined</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 30th 2012, 11:41:04 pm">August 30th 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><pre><code class="hljs"><span class="hljs-keyword">var</span> soundCounter=<span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> sound = Ti.Media.createSound();

<span class="hljs-comment">// ONLY add the event listener once</span>
sound.addEventListener(<span class="hljs-string">'complete'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
    soundCounter++;
    <span class="hljs-keyword">if</span>(soundCounter!==<span class="hljs-number">3</span>) {
        playMusic();
    } <span class="hljs-keyword">else</span> {
        soundCounter = <span class="hljs-number">0</span>;
    }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">playMusic</span><span class="hljs-params">()</span> </span>{

    sound.url=<span class="hljs-string">'audio/'</span>+soundCounter+<span class="hljs-string">'.mp3'</span>,

    sound.play();  
}

<span class="hljs-comment">// NO parenthesis on the function</span>
play.addEventListener(<span class="hljs-string">'click'</span>,playMusic);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 31st 2012, 4:07:14 am">August 31st 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246438">
				
						<section>
							<p>Look at <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;141023&#x2F;go-to-next-song">this</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 31st 2012, 10:04:34 am">August 31st 2012</span>
								by <span class='authorname'>alessandro la rocca</span><br>
								<a class="icon-bg icon-link" href="question/141704/multi-mp3-files-but-only-plays-the-1st-file-not-the-rest#answer-246438" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I tired it, but it has some bugs…. pause doesn&#39;t work. if you click play while the audio is playing, it will overlap and play again… not a very good solution for me… thanks anyway….. hope someone would be able to help me out with sample code i posted above which is trying to have the following….able to play multiple mp3s and able to pause, stop the audio. thanks……</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 1st 2012, 4:47:35 am">September 1st 2012</span>
											by <span class='authorname'>Rishi Marc</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>IMHO the idea here is to help you not write all the code for you. The problems you mentioned are logic errors which you should probably try and figure out yourself not just expect someone to do it all for you.</p>
<p>Try to address the errors and then post the new problems</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 1st 2012, 12:24:02 pm">September 1st 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Aaron, I am not expecting all the code… just some examples…thats all…. thanks for your advise.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 1st 2012, 12:36:53 pm">September 1st 2012</span>
											by <span class='authorname'>Rishi Marc</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
