<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Alloy exporting function problem Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Alloy exporting function problem</h1>
		</header>
		<section>
			<p>Hi Everyone,<br>I am posting this question after spending (actually wasting ) two days of trying to solve the issue.<br>I am making a chat application with XMPP. My problem is the UI(message box) is not created . I need to create this box for two occasions :</p>
<ul>
<li>1st When sending message.</li>
<li>2nd when receiving message.</li>
</ul>
<p>Now the box is created when I send message. But It is not created when I receive the message. The same Alloy controller is called in both the situations both codes are described below:</p>
<p><strong>MessageDetalsVC.js</strong></p>
<pre><code class="hljs">
<span class="hljs-comment">//This is the function to create the message box</span>
exports.chatafzal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msgss</span>) </span>{
    <span class="hljs-keyword">var</span> row = Alloy.createController(<span class="hljs-string">"chatui"</span>, {
        delegate : $,
        <span class="hljs-comment">//MessageType : args.conversation.MessageType,</span>
        controller : args.controller,
        litsPeople : litsPeople,
        massege : msgss
    });
    $.scrollview_secondary.add(row.getView());

};

<span class="hljs-comment">// Called when try to send the message and everything goes perfectly fine message is sent UI created</span>

$.btnSendComment.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">//chatrecevier($.txtMsg.value, 0);</span>
    JXMPP1.sendMsg(args.conversation.userid + <span class="hljs-string">"@*********"</span>, $.txtMsg.value);

    <span class="hljs-keyword">var</span> row = Alloy.createController(<span class="hljs-string">"chatui"</span>, {
        <span class="hljs-comment">//contact : contact,</span>
        delegate : $,
        <span class="hljs-comment">//MessageType : args.conversation.MessageType,</span>
        controller : args.controller,
        litsPeople : litsPeople,
        massege : $.txtMsg.value
    });
    $.scrollview_secondary.add(row.getView());
    $.txtMsg.value = <span class="hljs-string">""</span>;
});
</code></pre><p>Now let&#39;s come to when I try to call this function for receiving message</p>
<p><strong>newfile.js</strong>   This is a commonJS file</p>
<pre><code class="hljs">
<span class="hljs-comment">// This is function which gets the message and now I am passing the message to the above mentioned function. </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessage</span><span class="hljs-params">(message)</span> </span>{

    <span class="hljs-keyword">var</span> receviermsg = Alloy.createController(<span class="hljs-string">'MessageDetalsVC'</span>);
    <span class="hljs-keyword">var</span> msg = message.getBody();

<span class="hljs-comment">// This where I call the function to create the message box of received message</span>
    receviermsg.chatafzal(msg);

}
</code></pre><p>This is so frustrating The <strong>chatafzal</strong> function is called I have displayed the alerts at different positions to see if the function is executed fully and it does. The message from handleMessage function is also passed in Alloy controller but no <strong>UI</strong>  seems ridiculous to me. Please Anyone&#39;s help would be appreciated Thanks in Advance.<br>Please help me out.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 13th 2015, 10:55:22 am">January 13th 2015</span>
				by <span class='authorname'>Nabeel  Munawar</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>commonjs</span></li>
					
						<li><span class='tagname'>export</span></li>
					
						<li><span class='tagname'>ui</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I forgot to mention That I build this App for Android 4.4.2 . Working on Mac. Titanium SDK 3.4.1 also tried changing SDK but no result.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 13th 2015, 10:55:32 am">January 13th 2015</span>
								by <span class='authorname'>Nabeel  Munawar</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-285106">
				
						<section>
							<p>I have doubt on below 2 variables which are used to create <strong>row</strong> object in <strong>chatafzal</strong> fuinction.</p>
<pre><code class="hljs"><span class="hljs-string">controller :</span> args.controller,
<span class="hljs-string">litsPeople :</span> litsPeople,
</code></pre><p>so first check that do you get the value of above variables when you call it from <strong>handleMessage</strong> function?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 13th 2015, 12:22:03 pm">January 13th 2015</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="../../question/180197/alloy-exporting-function-problem.html#answer-285106" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thank you for your response Mitul. But, No That&#39;s not the issue .. Because I have also tested without passing simple strings instead of these variables.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 13th 2015, 12:28:41 pm">January 13th 2015</span>
											by <span class='authorname'>Nabeel  Munawar</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285109">
				
						<section>
							<p>You should be able to use exports.chatafzal = function, but try changing MessgeDetailsVC to</p>
<pre><code class="hljs">$.chatafzal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msgss</span>) </span>{
   ...
};
</code></pre><p>Can&#39;t you simply pass the details to the child controller and handle it without calling an exported method?</p>
<pre><code class="hljs"><span class="hljs-comment">// eg. instantiating the controller</span>
Alloy.createController(<span class="hljs-string">'MessageDetalsVC'</span>, {msgs: message.getBody()} );

<span class="hljs-comment">// handling it within MessgeDetailsVC</span>
<span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>] || {};
<span class="hljs-keyword">if</span>(args.msgs) {
  ...
} <span class="hljs-keyword">else</span> {
  ...
}
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 13th 2015, 3:20:03 pm">January 13th 2015</span>
								by <span class='authorname'>Tim Poulsen</span><br>
								<a class="icon-bg icon-link" href="../../question/180197/alloy-exporting-function-problem.html#answer-285109" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Tim,<br>Thank you for the Reply I really appreciate it. Both the ways didn&#39;t work. When I change function through export to via <strong>$</strong> function is called successfully but the UI is not created (same issue).<br>And via second method  Also Tried that but same results code runs even <strong>chatui</strong> controller&#39;s code is executed but ui is not created. </p>
<p>The only way I was able to create ui was when I export the function as a module..<br>Like below : </p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chatafzal</span><span class="hljs-params">(msgss)</span> {</span>
   ...
};

<span class="hljs-function"><span class="hljs-keyword">module</span>.<span class="hljs-title">exports</span> =</span> chatafzal;
</code></pre><p>But in this way more issues arise. Like whenever this controller is called. It can&#39;t handle the whole controller. E.g </p>
<p>I have called it in another file like below : </p>
<pre><code class="hljs">    var login = Alloy.createController(<span class="hljs-string">"MessageDetalsVC"</span>, {
        <span class="hljs-keyword">delegate</span> : $,
        <span class="hljs-class"><span class="hljs-keyword">type</span> : <span class="hljs-title">MessageType</span>,</span>
        conversation : conversation,
        controller : controller
    });
    login.getView().<span class="hljs-keyword">open</span>();
</code></pre><p>and it says <strong>login has no method getView()</strong> something like this. I am really upset with Titanium especially Alloy in this case.  :-(</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 13th 2015, 5:11:11 pm">January 13th 2015</span>
											by <span class='authorname'>Nabeel  Munawar</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285142">
				
						<section>
							<p>At Last I have solved it by myself. I would Like to post it here So, that People could get help from it if needed. </p>
<p>What I did was created a commonJS module in lib folder <strong>msgUI.js</strong> in my case. And exported it via module like this :</p>
<pre><code class="hljs">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chatafzal</span><span class="hljs-params">(msgss)</span> {</span>
   ...


    <span class="hljs-comment">// I added this UI here in the scrollView instead of Alloy Controller. By</span>
      Alloy.Globals.msgBox.add(msgmain);   <span class="hljs-comment">// Here Alloy.Globals.msgBox is a variable in which I have saved the scrollView object in Controller. </span>
};

<span class="hljs-function"><span class="hljs-keyword">module</span>.<span class="hljs-title">exports</span> =</span> chatafzal;
</code></pre><p>I hope this may help somebody.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 14th 2015, 5:25:52 pm">January 14th 2015</span>
								by <span class='authorname'>Nabeel  Munawar</span><br>
								<a class="icon-bg icon-link" href="../../question/180197/alloy-exporting-function-problem.html#answer-285142" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>And Thank you #Mitul and #Tim for trying to help me.  Really appreciate it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 14th 2015, 5:28:43 pm">January 14th 2015</span>
											by <span class='authorname'>Nabeel  Munawar</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
