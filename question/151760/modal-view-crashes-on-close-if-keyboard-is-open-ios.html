<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>modal view crashes on close if keyboard is open (iOS) » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>modal view crashes on close if keyboard is open (iOS)</h1>
		</header>
		<section>
			<p>Alloy App, Titanium SDK 3.1, iOS 6.1, latest xCode:</p>
<p>I have a view that opens another modal view (settings view) that contains some labels and textfields.<br>When the cursor is in one of the textfields (i.e. the keyboard is shown) and I close the window (win.close()), then the app crashes after a short moment (without any error information in the console).<br>If I blur the textfield first, then the app does not crash!<br>Can anybody reproduce this error???</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 30th 2013, 7:56:32 am">April 30th 2013</span>
				by <span class='authorname'>Mirco Vitr</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>keyboard</span></li>
					
						<li><span class='tagname'>modal view</span></li>
					
						<li><span class='tagname'>window.close</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hi Mirco,</p>
<p>Please provide some code snippet, so we can help you.</p>
<p>Thanks SP</p>
</div>
							<div class="author">
								&mdash; commented <span title="April 30th 2013, 8:03:11 am">April 30th 2013</span>
								by <span class='authorname'>Sunny Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I have the exact same problem. I create a simple form in a modal window. If I close the window while the keyboard is up, the application crashes.</p>
<p>If I hide the keyboard manually then close the window, no crash.<br>If I create the same form in a non-modal window, no crash.</p>
<p>The behaviour occurs only on iPhone physical device. No crash on the simulator.</p>
<p>I have isolated the problem in a small app that just creates the form. I can mail it to anyone interested to look at this issue.</p>
<p>PS: I am using a derivative of the forms.js module provided by Appcelerator here: http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;blog&#x2F;2011&#x2F;10&#x2F;forging-titanium-episode-10-forms.html</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 1st 2013, 2:03:36 pm">May 1st 2013</span>
								by <span class='authorname'>Walid Saliba</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>sorry for my late answer, but I think with the other answers, I do not have to provide some code any more!?</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 2nd 2013, 5:37:14 pm">May 2nd 2013</span>
								by <span class='authorname'>Mirco Vitr</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-261889">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>This could be a bug in the platform. If you can reproduce the crash outside of your existing app (create just a minimal app, with just the modal window &amp; text field and problem still happens), then please file a ticket at <a href="https:&#x2F;&#x2F;jira.appcelerator.org">jira.appcelerator.org</a>.</p>
<p>You might try blurring all the text fields before closing the window. You haven&#39;t provided code. So, just taking a guess: I assume you have a close button in your navbar. In its click handler, call textfield.blur() for each of the fields before calling win.close()</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 30th 2013, 11:31:25 am">April 30th 2013</span>
								by <span class='authorname'>Tim Poulsen</span><br>
								<a class="icon-bg icon-link" href="question/151760/modal-view-crashes-on-close-if-keyboard-is-open-ios.html#answer-261889" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>My name is Tony Lukasavage and I approve this message.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 30th 2013, 11:53:47 am">April 30th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>+1 Tony</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 30th 2013, 2:55:12 pm">April 30th 2013</span>
											by <span class='authorname'>Mauro Parra</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you for your answer. Yes, the workaround works. However, the bug remains. I&#39;ve never posted to JIRA yet - I&#39;ll try… :-)</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 2nd 2013, 5:41:50 pm">May 2nd 2013</span>
											by <span class='authorname'>Mirco Vitr</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Great! If you post the jira ticket, please post the link to it here so that others who read this question later will be able to reference the ticket and check its status. Also, if my answer got your app working, please mark it as the best answer. Again, so other readers know what worked.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 2nd 2013, 5:59:51 pm">May 2nd 2013</span>
											by <span class='authorname'>Tim Poulsen</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>3</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-261905">
				
						<section>
							<p>Hello, I just recently (about 30 min ago) encountered this issue and found my other modal windows with the keyboard up working just fine. But the window I&#39;m working on now has an iOS iMessage type look and feel, with the toolbar that has a text field and send button. I couldn&#39;t figure out why closing the window with the keyboard up kept crashing the app until the &quot;ah-ha&quot; moment. Its not the keyboard, it was the toolbar which is on a separate View that kept crashing it. So I remove the &quot;toolbar view&quot; before closing the window and &quot;voila&quot;, no more crashing……I do set a value on the textfield:win_close so I know whether to remove the toolbar from the window during the blur event. </p>
<p>The key is to remove all items before closing the window as stated by Tim above….<br>Hope this helps…</p>
<pre><code class="hljs">tf.addEventListener(<span class="hljs-string">'blur'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{

        Ti.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">'tf.winclose: '</span> + tf.win_close);
        <span class="hljs-keyword">if</span>(!tf.win_close){
            tableViewSmack.animate({
                bottom:<span class="hljs-number">50</span>,
                duration:<span class="hljs-number">170</span>
            });
        } <span class="hljs-keyword">else</span> {
            _self.remove(tableViewToolBar);
        }
    });

    tableViewSmack.addEventListener(<span class="hljs-string">'tf:blur'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        tf.win_close = <span class="hljs-keyword">true</span>;
        tf.blur();

        // tableViewSmack.removeEventListener(<span class="hljs-string">'tf:blur'</span>, smackVw);
    });
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 30th 2013, 2:16:28 pm">April 30th 2013</span>
								by <span class='authorname'>Tracy Hayman</span><br>
								<a class="icon-bg icon-link" href="question/151760/modal-view-crashes-on-close-if-keyboard-is-open-ios.html#answer-261905" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>ooops, sorry…just noticed the Alloy reference at the top….. ;P</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 30th 2013, 9:20:17 pm">April 30th 2013</span>
											by <span class='authorname'>Tracy Hayman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-262086">
				
						<section>
							<p>I filed this as a Jira ticket here: </p>
<p>https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2234</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 3rd 2013, 9:45:33 am">May 3rd 2013</span>
								by <span class='authorname'>Mirco Vitr</span><br>
								<a class="icon-bg icon-link" href="question/151760/modal-view-crashes-on-close-if-keyboard-is-open-ios.html#answer-262086" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
