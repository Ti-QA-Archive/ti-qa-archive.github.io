<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Invalid SQL statements since 3.5.0.GA - iOS app stops working » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Invalid SQL statements since 3.5.0.GA - iOS app stops working</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>we are about to make our iOS app ready for the Apple 64-bit requirements. After updating our used modules the build works fine, but when we test the app on 3.5.0GA, we receive several <strong>Invalid SQL statements</strong> errors and the app is not working anymore.  The app running on 3.4.1GA works fine.</p>
<p>Error stack:</p>
<pre><code class="hljs">[ERROR] :  Script Error {
[ERROR] :      column = 30<span class="hljs-comment">;</span>
[ERROR] :      line = 622<span class="hljs-comment">;</span>
[ERROR] :      message = "invalid SQL statement"<span class="hljs-comment">;</span>
[ERROR] :      nativeLocation = "-[TiDatabaseProxy execute:] (TiDatabaseProxy.m:191)"<span class="hljs-comment">;</span>
[ERROR] :      nativeReason = "Error Domain=com.plausiblelabs.pldatabase Code=3 \"An error occured parsing the provided SQL statement.\" UserInfo=<span class="hljs-number">0x7949a66</span>0 {com.plausiblelabs.pldatabase.error.vendor.code=1, NSLocalizedDescription=An error occured parsing the provided SQL statement., com.plausiblelabs.pldatabase.error.query.string=SELECT id, titel, urlLink, WebLinkType_ID FROM WebLink WHERE WebLinkType_ID=6, com.plausiblelabs.pldatabase.error.vendor.string=no such table: WebLink}"<span class="hljs-comment">;</span>
[ERROR] :      sourceURL = "file:///Users/sandra/Library/Developer/CoreSimulator/Devices/BEAA<span class="hljs-number">62D3-087</span>E-<span class="hljs-number">4365-822</span>E-5DA9E004FE3A/data/Containers/Bundle/Application/0DD6100C-0B4D-4C40-B<span class="hljs-number">6F3-87432</span>7003DA7/test.app/ui/common/DBUtil.js"<span class="hljs-comment">;</span>
[ERROR] :      stack = "[native code]\nloadLiveCashData@file:///Users/sandra/Library/Developer/CoreSimulator/Devices/BEAA<span class="hljs-number">62D3-087</span>E-<span class="hljs-number">4365-822</span>E-5DA9E004FE3A/data/Containers/Bundle/Application/0DD6100C-0B4D-4C40-B<span class="hljs-number">6F3-87432</span>7003DA7/test.app/ui/common/DBUtil.js:622:30\nloadTableData@file:///Users/sandra/Library/Developer/CoreSimulator/Devices/BEAA<span class="hljs-number">62D3-087</span>E-<span class="hljs-number">4365-822</span>E-5DA9E004FE3A/data/Containers/Bundle/Application/0DD6100C-0B4D-4C40-B<span class="hljs-number">6F3-87432</span>7003DA7/test.app/ui/settings/SettingsView.js:71:45\nSettingsView@file:///Users/sandra/Library/Developer/CoreSimulator/Devices/BEAA<span class="hljs-number">62D3-087</span>E-<span class="hljs-number">4365-822</span>E-5DA9E004FE3A/data/Containers/Bundle/Application/0DD6100C-0B4D-4C40-B<span class="hljs-number">6F3-87432</span>7003DA7/test.app/ui/settings/SettingsView.js:29:15\nfile:///Users/sandra/Library/Developer/CoreSimulator/Devices/BEAA<span class="hljs-number">62D3-087</span>E-<span class="hljs-number">4365-822</span>E-5DA9E004FE3A/data/Containers/Bundle/Application/0DD6100C-0B4D-4C40-B<span class="hljs-number">6F3-87432</span>7003DA7/test.app/ui/general/MasterView.js:270:38"<span class="hljs-comment">;</span>
[ERROR] :  }
</code></pre><p>Any help greatly appreciated.<br>Thanks</p>
<p>Application type: mobile</p>
<p>Titanium SDK: 3.5.0GA</p>
<p>Platform &amp; version: iOS 8.1</p>
<p>Device: iOS Simulator</p>
<p>Host Operating System: OSX 10.10.1</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 22nd 2015, 6:59:43 pm">January 22nd 2015</span>
				by <span class='authorname'>Sandra Ka</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>3.5.0.ga</span></li>
					
						<li><span class='tagname'>64bit</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>sqlite</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you post your database structure. ie. fieldnames, types, length, etc…</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 22nd 2015, 8:03:17 pm">January 22nd 2015</span>
								by <span class='authorname'>Ray Belisle</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Please see my answer below.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 23rd 2015, 10:10:47 am">January 23rd 2015</span>
								by <span class='authorname'>Sandra Ka</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>The following code from the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Working_with_a_SQLite_Database-section-29004901_WorkingwithaSQLiteDatabase-Creatingadatabase">Database guide</a> works fine for me with 3.5.0.GA on iOS Simulator 8.1.3 (verified by looking up the .sql file via Simpholders2 and opening it in SQLitebrower)</p>
<pre><code class="hljs">var db = Ti.Database.open('TiBountyHunter');
db.execute('<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> fugitives(<span class="hljs-keyword">id</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span>, <span class="hljs-keyword">name</span> <span class="hljs-built_in">TEXT</span>, captured <span class="hljs-built_in">INTEGER</span>, <span class="hljs-keyword">url</span> <span class="hljs-built_in">TEXT</span>, capturedLat <span class="hljs-built_in">REAL</span>, capturedLong <span class="hljs-built_in">REAL</span>);</span>');
db.close();
</code></pre><p>I also tried with your query:</p>
<pre><code class="hljs">var db = Ti.Database.open('Test');
db.execute('<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">"WebLink"</span> ( <span class="hljs-string">"ID"</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,  <span class="hljs-string">"titel"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, <span class="hljs-string">"urlLink"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, <span class="hljs-string">"WebLinkType_ID"</span> <span class="hljs-built_in">INT</span>  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>);</span>');
db.close();
</code></pre><p>And this works as well.</p>
<p>Try with a new project to see if the problem is your environment or project.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 5th 2015, 9:49:30 am">March 5th 2015</span>
								by <span class='authorname'>Fokke Zandbergen</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>8</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>8 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-285694">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I have found a solution for this:</p>
<p>in 3.50.GA&#x2F;iphone&#x2F;classes&#x2F;PlausibleDatabase&#x2F;PLSqliteDatabase.m<br>they changed the database open call.</p>
<p>so in the function openAndReturnError<br>you find the line:</p>
<p>err = sqlite3_open_v2([_path fileSystemRepresentation], &amp;_sqlite, SQLITE_OPEN_SHAREDCACHE | SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE, NULL);</p>
<p>change it to the old one from 3.4.1.GA:</p>
<p>err = sqlite3_open([_path fileSystemRepresentation], &amp;_sqlite);</p>
<p>this solved my problems.</p>
<p>Michael</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 9th 2015, 6:38:57 am">February 9th 2015</span>
								by <span class='authorname'>Michael Landeck</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285694" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This works perfect. Thank your very much!</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 21st 2015, 12:44:03 pm">April 21st 2015</span>
											by <span class='authorname'>Sandra Ka</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285356">
				
						<section>
							<p>From the message provided, it is reporting that the table WebLink doesnt exist in the database - can you confirm that your code creates it and it does exists?</p>
<pre><code class="hljs"><span class="hljs-keyword">no</span> such <span class="hljs-keyword">table</span>: WebLink
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 23rd 2015, 7:09:35 am">January 23rd 2015</span>
								by <span class='authorname'>Larrie Wilson</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285356" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>According to the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;release-notes&#x2F;?version=3.5.0.GA">release notes</a> there were no changes to the DB handling.</p>
<p>Was the 3.5.0.GA code run and a new app created? Have you checked that the code to created the table is being run? Try removing the app from the 3.4.1.GA version and running again seeing if you get the same error.</p>
<p>Take a look in the app folder, which would be:</p>
<pre><code class="hljs">Library<span class="hljs-regexp">/Developer/</span>CoreSimulator<span class="hljs-regexp">/Devices/</span>{device id}<span class="hljs-regexp">/data/</span>Containers<span class="hljs-regexp">/Data/</span>Application<span class="hljs-regexp">/{app id}/</span>Library<span class="hljs-regexp">/Private Documents/</span>_alloy_.sql
</code></pre><p>replace _alloy_sql with your DB name if you haven&#39;t used the default. Open up that SQL database file and check that the WebLink table exists, if not then the code to create it isn&#39;t being reached.</p>
<p>Hope this helps</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2015, 6:06:50 am">January 26th 2015</span>
											by <span class='authorname'>Larrie Wilson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285362">
				
						<section>
							<p>We didn&#39;t change any sourcecode. Building and running the app with 3.4.1GA works fine. Doing the same with 3.5.0GA causes the different <strong>Invalid SQL statements</strong> errors. Did the database handling in the Titanium SDK change from 3.4.1GA to 3.5.0GA?</p>
<p>As an example I post the structure for the WebLink table:</p>
<pre><code class="hljs"><span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">"WebLink"</span> ( <span class="hljs-string">"ID"</span> <span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,  <span class="hljs-string">"titel"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, <span class="hljs-string">"urlLink"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, <span class="hljs-string">"WebLinkType_ID"</span> <span class="hljs-built_in">INT</span>  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>);</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 23rd 2015, 10:10:01 am">January 23rd 2015</span>
								by <span class='authorname'>Sandra Ka</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285362" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285447">
				
						<section>
							<p>Please try to  test my query: </p>
<pre><code class="hljs"><span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> WebLink(<span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, titel <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, urlLink <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, WebLinkType_ID NT  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>)</span>
</code></pre><p>Before run other your query</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 28th 2015, 6:37:58 am">January 28th 2015</span>
								by <span class='authorname'>Giang Nam Tran</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285447" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>So i&#39;m sorry, i lost for copy your code, this is exactly:</p>
<pre><code class="hljs"><span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> WebLink(<span class="hljs-built_in">INTEGER</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, titel <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, urlLink <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, WebLinkType_ID <span class="hljs-built_in">INT</span>  <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>)</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 28th 2015, 6:40:38 am">January 28th 2015</span>
											by <span class='authorname'>Giang Nam Tran</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285560">
				
						<section>
							<p>I have the same Problem.<br>Since 3.5.0 all my create table statements don&#39;t work.<br> When I change to 3.4.1 it works fine (without changing any code).<br>All the  statements are reached and executed for sure. </p>
<p>Application Type: Mobile, iPad</p>
<p>Titanium SDK: 3.5.0GA</p>
<p>Platform &amp; version: iOS 8.1.3</p>
<p>Device: iOS Simulator, iPad</p>
<p>Host Operating System: OSX 10.10.2</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 2nd 2015, 11:47:49 am">February 2nd 2015</span>
								by <span class='authorname'>Michael Landeck</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285560" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-285680">
				
						<section>
							<p>Im also having the same exact issue.   I&#39;ve tried downloading the latest 3.5X (3.51) build from the continuous builds and the problem still persists.  App is currently unusable :(</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 8th 2015, 10:21:32 pm">February 8th 2015</span>
								by <span class='authorname'>C H</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-285680" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-286281">
				
						<section>
							<p>Or you can use SQLITE_OPEN_PRIVATECACHE instead of SQLITE_OPEN_SHAREDCACHE</p>
<p>file: &#x2F;3.5.0.GA&#x2F;iphone&#x2F;Classes&#x2F;PlausibleDatabase&#x2F;PLSqliteDatabase.m</p>
<pre><code class="hljs">    err = sqlite3_open_v2<span class="hljs-list">([_path fileSystemRepresentation], <span class="hljs-keyword">&amp;_sqlite</span>, SQLITE_OPEN_PRIVATECACHE | SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE, NULL)</span><span class="hljs-comment">;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 5th 2015, 9:25:03 am">March 5th 2015</span>
								by <span class='authorname'>Jeroen Aartse</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-286281" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-286287">
				
						<section>
							<p>I just found the cause.<br>This occurs when you don&#39;t close and reopen (or installing) the database after removing.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 5th 2015, 12:14:00 pm">March 5th 2015</span>
								by <span class='authorname'>Jeroen Aartse</span><br>
								<a class="icon-bg icon-link" href="question/180385/invalid-sql-statements-since-350ga---ios-app-stops-working#answer-286287" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
