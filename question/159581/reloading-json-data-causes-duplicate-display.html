<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Reloading Json Data Causes Duplicate Display » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Reloading Json Data Causes Duplicate Display</h1>
		</header>
		<section>
			<p>below is my code.when the window reloads after 10 sec the next question displays on the previous one.how can i remove the previous question and then display the new one.thanks in advance.</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">QA</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> win=Ti.UI.createWindow({
        backgroundColor:<span class="hljs-string">"white"</span>
    });

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetch</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> url=<span class="hljs-string">""</span>;

        <span class="hljs-comment">//xhr starts</span>
        <span class="hljs-keyword">var</span> xhr=Ti.Network.createHTTPClient({
        onload:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> json=<span class="hljs-keyword">this</span>.responseText;
        <span class="hljs-keyword">var</span> response=<span class="hljs-built_in">JSON</span>.parse(json);
    <span class="hljs-comment">//alert(response);</span>

        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;response.length;i++){
        <span class="hljs-keyword">if</span>(response[i].quest!=<span class="hljs-string">''</span> &amp;&amp; response[i].option1!=<span class="hljs-string">''</span> &amp;&amp; response[i].option2!=<span class="hljs-string">''</span> &amp;&amp; response[i].option3!=<span class="hljs-string">''</span>&amp;&amp; response[i].option4!=<span class="hljs-string">''</span>)

        <span class="hljs-comment">//question from backend</span>
        <span class="hljs-keyword">var</span> Questions=Ti.UI.createLabel({
        text:response[i].quest,
        font:{
            fontSize:<span class="hljs-string">"20dp"</span>,
            fontFamily:<span class="hljs-string">"Arial"</span>
            },
        height:<span class="hljs-string">'auto'</span>,
        left:<span class="hljs-string">"15dp"</span>,
        top:<span class="hljs-string">'15dp'</span>,
        color:<span class="hljs-string">'black'</span>
        });
        win.add(Questions);



        <span class="hljs-comment">//options parameter</span>
        <span class="hljs-keyword">var</span> option1=Ti.UI.createLabel({
        text:response[i].option1,
        font:{
            fontSize:<span class="hljs-string">"20dp"</span>,
            fontFamily:<span class="hljs-string">"Arial"</span>
            },
        height:<span class="hljs-string">"auto"</span>,
        left:<span class="hljs-string">"30dp"</span>,
        top:<span class="hljs-string">'100dp'</span>,
        color:<span class="hljs-string">"#666"</span>,

        });
        win.add(option1);


        <span class="hljs-keyword">var</span> option2=Ti.UI.createLabel({
        text:response[i].option2,
        font:{
            fontSize:<span class="hljs-string">"20dp"</span>,
            fontFamily:<span class="hljs-string">"Arial"</span>
            },
        height:<span class="hljs-string">"auto"</span>,
        left:<span class="hljs-string">"30dp"</span>,
        top:<span class="hljs-string">'130dp'</span>,
        color:<span class="hljs-string">"#666"</span>
        });
        win.add(option2);

        <span class="hljs-keyword">var</span> option3=Ti.UI.createLabel({
        text:response[i].option3,
        font:{
            fontSize:<span class="hljs-string">"20dp"</span>,
            fontFamily:<span class="hljs-string">"Arial"</span>
            },
        height:<span class="hljs-string">"auto"</span>,
        left:<span class="hljs-string">"30dp"</span>,
        top:<span class="hljs-string">'160dp'</span>,
        color:<span class="hljs-string">"#666"</span>
        });
        win.add(option3);

        <span class="hljs-keyword">var</span> option4=Ti.UI.createLabel({
        text:response[i].option4,
        font:{
            fontSize:<span class="hljs-string">"20dp"</span>,
            fontFamily:<span class="hljs-string">"Arial"</span>
            },
        height:<span class="hljs-string">"auto"</span>,
        left:<span class="hljs-string">"30dp"</span>,
        top:<span class="hljs-string">'190dp'</span>,
        color:<span class="hljs-string">"#666"</span>
        });
        win.add(option4);
        }
        }
        });


        xhr.open(<span class="hljs-string">"GET"</span>,url);
        xhr.send();
    }
        setInterval(fetch,<span class="hljs-number">1000</span>);
        <span class="hljs-comment">//network ends here</span>
                <span class="hljs-keyword">return</span> win;
        }
        <span class="hljs-built_in">module</span>.exports=QA;
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 18th 2013, 7:10:08 am">November 18th 2013</span>
				by <span class='authorname'>devyani p</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>reloading</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-271428">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>The problem has a simple answer; separate the creation of the window and the labels displayed on it from the loading of new information.  When you load the first question SET the values into the labels already created, next time the interval comes round again SET the values - do not create new labels each time.</p>
<p>You code suggests that you receive more than one question each time the api is called, but your question implies you only receive one each time.  Which one is it?</p>
<ul>
<li>One question and answer set each time the network api is called?</li>
<li>All question and answer sets each time the network api is called?</li>
</ul>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 18th 2013, 11:19:42 am">November 18th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/159581/reloading-json-data-causes-duplicate-display.html#answer-271428" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I was hoping for your answer sir.thanku for your reply.<br>We have created a backened all users will get only one question at a time.<br>I partially understood your answer can you give a code snippet I am not able to frame your answer into code.thanks In advance.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 12:54:54 pm">November 18th 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>This is based on what I know so far.  I have separated the creation of the window and the labels from the updating of those labels.  This way you only ever create the labels once, but when the data is returned you then only update the existing labels.</p>
<p>You will need to tweak this so that your response works correctly - that part of your code was confusing - not sure why you look an array if only one entry is returned.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win, question, option1, option2, option3, option4;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetch</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> url = <span class="hljs-string">""</span>;

    <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient({
        onload: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText || {});
            question.setText(json[<span class="hljs-number">0</span>].quest || <span class="hljs-string">''</span>);
            option1.setText(json[<span class="hljs-number">0</span>].option1 || <span class="hljs-string">''</span>);
            option2.setText(json[<span class="hljs-number">0</span>].option2 || <span class="hljs-string">''</span>);
            option3.setText(json[<span class="hljs-number">0</span>].option3 || <span class="hljs-string">''</span>);
            option4.setText(json[<span class="hljs-number">0</span>].option4 || <span class="hljs-string">''</span>);
            setTimeout(fetch, <span class="hljs-number">1000</span>);
        },
        onerror: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        }
    });
    xhr.open(<span class="hljs-string">"GET"</span>, url);
    xhr.send();
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">QA</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> win = Ti.UI.createWindow({
        backgroundColor:<span class="hljs-string">"white"</span>
    });
    <span class="hljs-keyword">var</span> question = Ti.UI.createLabel({
        color: <span class="hljs-string">'black'</span>,
        font: {
            fontFamily: <span class="hljs-string">"Arial"</span>,
            fontSize: <span class="hljs-string">"20dp"</span>
        },
        height: Ti.UI.SIZE,
        left: <span class="hljs-string">"15dp"</span>,
        text: <span class="hljs-string">'Waiting'</span>,
        top: <span class="hljs-string">'15dp'</span>
    });
    win.add(question);

    <span class="hljs-keyword">var</span> option1 = Ti.UI.createLabel({
        color: <span class="hljs-string">'black'</span>,
        font: {
            fontFamily: <span class="hljs-string">"Arial"</span>,
            fontSize: <span class="hljs-string">"20dp"</span>
        },
        height: Ti.UI.SIZE,
        left: <span class="hljs-string">"15dp"</span>,
        text: <span class="hljs-string">'Waiting'</span>,
        top: <span class="hljs-string">'100dp'</span>
    });
    win.add(option1);
    <span class="hljs-keyword">var</span> option2 = Ti.UI.createLabel({
        color: <span class="hljs-string">'black'</span>,
        font: {
            fontFamily: <span class="hljs-string">"Arial"</span>,
            fontSize: <span class="hljs-string">"20dp"</span>
        },
        height: Ti.UI.SIZE,
        left: <span class="hljs-string">"15dp"</span>,
        text: <span class="hljs-string">'Waiting'</span>,
        top: <span class="hljs-string">'130dp'</span>
    });
    win.add(option2);
    <span class="hljs-keyword">var</span> option3 = Ti.UI.createLabel({
        color: <span class="hljs-string">'black'</span>,
        font: {
            fontFamily: <span class="hljs-string">"Arial"</span>,
            fontSize: <span class="hljs-string">"20dp"</span>
        },
        height: Ti.UI.SIZE,
        left: <span class="hljs-string">"15dp"</span>,
        text: <span class="hljs-string">'Waiting'</span>,
        top: <span class="hljs-string">'160dp'</span>
    });
    win.add(option3);
    <span class="hljs-keyword">var</span> option4 = Ti.UI.createLabel({
        color: <span class="hljs-string">'black'</span>,
        font: {
            fontFamily: <span class="hljs-string">"Arial"</span>,
            fontSize: <span class="hljs-string">"20dp"</span>
        },
        height: Ti.UI.SIZE,
        left: <span class="hljs-string">"15dp"</span>,
        text: <span class="hljs-string">'Waiting'</span>,
        top: <span class="hljs-string">'190dp'</span>
    });
    win.add(option4);
    fetch();
    <span class="hljs-keyword">return</span> win;
}

<span class="hljs-built_in">module</span>.exports = QA;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 1:57:40 pm">November 18th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>thanks a lot ..with a small change it worked….</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 19th 2013, 2:38:21 am">November 19th 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are welcome, not bad for being typed on an iPad.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 19th 2013, 5:39:37 am">November 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-271412">
				
						<section>
							<p>Either change the window layout property to vertical or calculate a new top value based on the position within the array.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 18th 2013, 7:40:26 am">November 18th 2013</span>
								by <span class='authorname'>Larrie Wilson</span><br>
								<a class="icon-bg icon-link" href="question/159581/reloading-json-data-causes-duplicate-display.html#answer-271412" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>sir but the problem is the new question is displayed on the previous question.i want  only one question to be  visible at one time..</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 8:00:37 am">November 18th 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>In that case you need to remove the fetching the data logic and the UI logic, and code it so that only one question is displayed at a time, eg using an interval or a timeout. What you are asking for is a solution to functionality not a problem.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 8:35:08 am">November 18th 2013</span>
											by <span class='authorname'>Larrie Wilson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i have already used setinterval for fetching data still its not helping</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 8:43:55 am">November 18th 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-271417">
				
						<section>
							<p>Hello Devyani,</p>
<p>Try something like this :</p>
<pre><code class="hljs">
var arrQue = <span class="hljs-literal">null</span>, counter = <span class="hljs-number">0</span>, Questions, option1, option2, option3, option4;

function fetch() {
    var url = <span class="hljs-string">""</span>;

    <span class="hljs-comment">//xhr starts</span>
    var xhr = Ti.Network.createHTTPClient({
        <span class="hljs-string">onload :</span> function() {
            var json = <span class="hljs-keyword">this</span>.arrQueText;
            var arrQue = JSON.parse(json);

            reloadQue();

        }
    });

    xhr.open(<span class="hljs-string">"GET"</span>, url);
    xhr.send();
}

fetch();
<span class="hljs-comment">//network ends here</span>

function reloadQue() {
    <span class="hljs-keyword">if</span> (arrQue[counter].quest != <span class="hljs-string">''</span> &amp;&amp; arrQue[counter].option1 != <span class="hljs-string">''</span> &amp;&amp; arrQue[counter].option2 != <span class="hljs-string">''</span> &amp;&amp; arrQue[counter].option3 != <span class="hljs-string">''</span> &amp;&amp; arrQue[counter].option4 != <span class="hljs-string">''</span>) {
        <span class="hljs-comment">//question from backend</span>
        Questions = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> arrQue[counter].quest,
            <span class="hljs-string">font :</span> {
                <span class="hljs-string">fontSize :</span> <span class="hljs-string">"20dp"</span>,
                <span class="hljs-string">fontFamily :</span> <span class="hljs-string">"Arial"</span>
            },
            <span class="hljs-string">height :</span> <span class="hljs-string">'auto'</span>,
            <span class="hljs-string">left :</span> <span class="hljs-string">"15dp"</span>,
            <span class="hljs-string">top :</span> <span class="hljs-string">'15dp'</span>,
            <span class="hljs-string">color :</span> <span class="hljs-string">'black'</span>
        });
        win.add(Questions);

        <span class="hljs-comment">//options parameter</span>
        option1 = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> arrQue[counter].option1,
            <span class="hljs-string">font :</span> {
                <span class="hljs-string">fontSize :</span> <span class="hljs-string">"20dp"</span>,
                <span class="hljs-string">fontFamily :</span> <span class="hljs-string">"Arial"</span>
            },
            <span class="hljs-string">height :</span> <span class="hljs-string">"auto"</span>,
            <span class="hljs-string">left :</span> <span class="hljs-string">"30dp"</span>,
            <span class="hljs-string">top :</span> <span class="hljs-string">'100dp'</span>,
            <span class="hljs-string">color :</span> <span class="hljs-string">"#666"</span>,

        });
        win.add(option1);

        var option2 = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> arrQue[counter].option2,
            <span class="hljs-string">font :</span> {
                <span class="hljs-string">fontSize :</span> <span class="hljs-string">"20dp"</span>,
                <span class="hljs-string">fontFamily :</span> <span class="hljs-string">"Arial"</span>
            },
            <span class="hljs-string">height :</span> <span class="hljs-string">"auto"</span>,
            <span class="hljs-string">left :</span> <span class="hljs-string">"30dp"</span>,
            <span class="hljs-string">top :</span> <span class="hljs-string">'130dp'</span>,
            <span class="hljs-string">color :</span> <span class="hljs-string">"#666"</span>
        });
        win.add(option2);

        option3 = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> arrQue[counter].option3,
            <span class="hljs-string">font :</span> {
                <span class="hljs-string">fontSize :</span> <span class="hljs-string">"20dp"</span>,
                <span class="hljs-string">fontFamily :</span> <span class="hljs-string">"Arial"</span>
            },
            <span class="hljs-string">height :</span> <span class="hljs-string">"auto"</span>,
            <span class="hljs-string">left :</span> <span class="hljs-string">"30dp"</span>,
            <span class="hljs-string">top :</span> <span class="hljs-string">'160dp'</span>,
            <span class="hljs-string">color :</span> <span class="hljs-string">"#666"</span>
        });
        win.add(option3);

        option4 = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> arrQue[counter].option4,
            <span class="hljs-string">font :</span> {
                <span class="hljs-string">fontSize :</span> <span class="hljs-string">"20dp"</span>,
                <span class="hljs-string">fontFamily :</span> <span class="hljs-string">"Arial"</span>
            },
            <span class="hljs-string">height :</span> <span class="hljs-string">"auto"</span>,
            <span class="hljs-string">left :</span> <span class="hljs-string">"30dp"</span>,
            <span class="hljs-string">top :</span> <span class="hljs-string">'190dp'</span>,
            <span class="hljs-string">color :</span> <span class="hljs-string">"#666"</span>
        });
        win.add(option4);
    }
}

setInterval(function() {
    <span class="hljs-keyword">if</span> ((counter+<span class="hljs-number">1</span>) &gt; arrQue.length) {
        <span class="hljs-keyword">return</span>;
    } <span class="hljs-keyword">else</span> {
        counter++;
        reloadQue();
    }
}, <span class="hljs-number">10000</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 18th 2013, 9:09:01 am">November 18th 2013</span>
								by <span class='authorname'>Sanat Mamtora</span><br>
								<a class="icon-bg icon-link" href="question/159581/reloading-json-data-causes-duplicate-display.html#answer-271417" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>getting the following error</p>
<pre><code class="hljs">message = "'undefined' is not a function (evaluating 'Ti.Network.HTTPClient(<span class="hljs-special">{</span><span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\tonload</span>:function()<span class="hljs-special">{</span><span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-command">\tvar</span> json=this.responseText;<span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-command">\tvar</span> response=JSON.parse(json);<span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-special">}</span><span class="hljs-command">\n</span><span class="hljs-command">\t</span><span class="hljs-command">\t</span><span class="hljs-special">}</span>)')";
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="November 18th 2013, 10:16:45 am">November 18th 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
