<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>iPad issue with a webform hosted from an SQL database » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>iPad issue with a webform hosted from an SQL database</h1>
		</header>
		<section>
			<p>I have an app in the app store right now, and created it in Xcode.  However, there is a serious deal breaker problem with it and after weeks of trying, I realized there is no way around it in iOS5 and the Apple developers told me its fixed in iOS6. Well I cant wait for 6 to come out so I am rebuilding my app in Appcelerator, figuring I need to build the Android version anyway so might as well build an iPhone&#x2F;iPad version along side it.</p>
<p>The issue is this.  So we have an SQL database with a Drupal front end. There is a webform created in Drupal and the idea is teachers fill out the form each day and attach images and&#x2F;or videos to it and send it off to the parents device.  We are trying to eliminate the use of paper and teachers having to manually write a daily report for each child every day.</p>
<p>Well my app got approved and was launched in the store and all of the teachers downloaded it. Each classroom has an iPad.  We quickly learned that when they go to fill out the daily report, the buttons for attaching images or videos are greyed out.  I got on the Apple Dev. forums and asked for guidance and was quickly bombarded with many responses stating that its not possible in the current version of iOS5. Its an issue with Safari.  Many people gave me some possible work around solutions, none of which worked. I tried everything I could. I implemented the iOSDrupalSDK from GitHub hoping that by getting iOS and Drupal talking to each other it would fix, but no. I downloaded and installed 3 different network solutions that were presented to me like MKNetworkKit, AFNetworking, an independent solution for AFHTTPClient, and all attempts failed.</p>
<p>I had Appcelerator sitting and ready for me to start building the Android app so I figured since I have to build it anyway, I will go ahead and create it such that Im creating an iPhone and iPad version also.  I was told by one Appcelerator developer who makes youtube tutorials that I would not have this problem and those buttons would be live and allow me to attach images and videos.</p>
<p>Well Im at the point of the app almost being finished, barring some navigation hurdles Im working through, and have one of you guys giving me some amazing help (nudge nudge) and need to start reading up on how Im going to get the iPhone and iPad version ready to handle this task.  I have some tutorials bookmarked for connecting your Titanium Mobile app to an SQL database through HTTPClient, but as I have watched them, I realize they are mostly for sending stuff up to the server, and not necessarily addressing exactly what I need.</p>
<p>I guess my point with this post is to get any feedback I can on this issue and also ask if I need to be looking at this in reverse? In other words, maybe I need to be designing this such that when the iPad takes a photo or video, it sends a copy to the server so there is a version on both the device and the portal.</p>
<p>Ideally, once I get this fixed, Im going to start the next day in a complete redesign with a cloud solution so that whether your on a phone, a tablet, a MAC, a Windows machine, a Blackberry, etc..  you can access the Daily reports with the images and videos because they are all saved up in the cloud.  It seems that is the most ideal way to do this, but I would love to hear from experienced Appcelerator developers how you would handle this. I need an immediate fix by tomorrow that will work fine until iOS6 is out because I have heard that the issue is solved with Safari in iOS6. Then of course will be working on a long term solution that will be permanent for the future.</p>
<p>Any advice, feedback, comments, suggestions, warnings, etc.. that you have for me will be appreciated.</p>
<p>Many thanks<br>John</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 12th 2012, 2:56:46 pm">August 12th 2012</span>
				by <span class='authorname'>John Bergman</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>drupal, networking,</span></li>
					
						<li><span class='tagname'>ios5 and ios6</span></li>
					
						<li><span class='tagname'>networking</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hi John - again :)</p>
<p>Can we summarise your detailed (verbose) question down to something simpler?</p>
<p>&quot;How do I either take an image from the devices photo library or using the camera to take a photo and then upload it, hopefully with a few extras fields of data so my web server can store it (or a record of it) in sql server as well as the image itself?&quot;</p>
<p>If this is close, do you already know how to receive an image upload and handle the processing IF it was posted via a web form on the same website? </p>
<p>Cheers</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 12th 2012, 3:04:31 pm">August 12th 2012</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I glazed over around &#39;The issue is this&#39;. I&#39;m going to grab a cup of coffee and re-read.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 12th 2012, 3:19:00 pm">August 12th 2012</span>
								by <span class='authorname'>Stephen Feather</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-245105">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi John</p>
<p>Your problem is two fold, the first is how you upload photos from the device to a webserver, the second is how you link your web form to an action that will let you initiate the action.</p>
<p>The answer to the first can be found here - this is a POC (porrof of concept) app I created a while ago that will allow you to take a photo or choose an image and then upload it.  You will get the basic idea when you run it.  You can split it up to your needs, it relies on event handling (success, error) functions to respond to the actions.</p>
<p>Part 1 of 2</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> app = {};
<span class="hljs-comment">// media</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(app.media) === <span class="hljs-string">'undefined'</span>) { app.media = {}; }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(app.media.gallery) === <span class="hljs-string">'undefined'</span>) { app.media.gallery = {}; }
    app.media.gallery.open = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">var</span> mediaTypes = [];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.video) === <span class="hljs-string">'boolean'</span> &amp;&amp; obj.video === <span class="hljs-literal">true</span>) {
            mediaTypes.push(Ti.Media.MEDIA_TYPE_VIDEO);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.photo) === <span class="hljs-string">'boolean'</span> &amp;&amp; obj.photo === <span class="hljs-literal">true</span>) {
            mediaTypes.push(Ti.Media.MEDIA_TYPE_PHOTO);
        }
        <span class="hljs-keyword">if</span> (mediaTypes.length === <span class="hljs-number">0</span>) {
            mediaTypes.push(Ti.Media.MEDIA_TYPE_PHOTO);
        }
        Ti.Media.openPhotoGallery({
            success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                Ti.API.info(<span class="hljs-string">'Gallery.Open: '</span> + <span class="hljs-string">'Success'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.success) !== <span class="hljs-string">'undefined'</span>) {
                    obj.success({
                        media: e.media
                    });
                }
            },
            cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                Ti.API.info(<span class="hljs-string">'Gallery.Open: '</span> + <span class="hljs-string">'Cancelled'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.cancel) !== <span class="hljs-string">'undefined'</span>) {
                    obj.cancel();
                }
            },
            error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                Ti.API.info(<span class="hljs-string">'Gallery.Open: '</span> + <span class="hljs-string">'Error'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.error) !== <span class="hljs-string">'undefined'</span>) {
                    obj.error({
                        error: e
                    });
                }
            },
            mediaTypes: mediaTypes
        });
    };
    app.media.gallery.save = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
        Ti.Media.saveToPhotoGallery(obj.file, {
            success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                Ti.API.info(<span class="hljs-string">'Gallery.Save: '</span> + <span class="hljs-string">'Success'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.success) !== <span class="hljs-string">'undefined'</span>) {
                    obj.success({
                        media: e.media
                    });
                }
            },
            error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                Ti.API.info(<span class="hljs-string">'Gallery.Save: '</span> + <span class="hljs-string">'Error'</span>);
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.error) !== <span class="hljs-string">'undefined'</span>) {
                    obj.error({
                        error: e
                    });
                }
            }
        });
    };
    app.media.photo = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
        Ti.Media.showCamera({
            success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                <span class="hljs-keyword">if</span> (event.mediaType === Ti.Media.MEDIA_TYPE_PHOTO) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.success) !== <span class="hljs-string">'undefined'</span>) {
                        obj.success({
                            image: event.media
                        });
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.error) !== <span class="hljs-string">'undefined'</span>) {
                        obj.error({
                            error: <span class="hljs-string">'Wrong Media Type'</span>
                        });
                    }
                }
            },
            cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.cancel) !== <span class="hljs-string">'undefined'</span>) {
                    obj.cancel();
                }
            },
            error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.error) !== <span class="hljs-string">'undefined'</span>) {
                    <span class="hljs-keyword">if</span> (error.code === Ti.Media.NO_CAMERA) {
                        obj.error({
                            error: <span class="hljs-string">'Not support on simulator'</span>
                        });
                    } <span class="hljs-keyword">else</span> {
                        obj.error({
                            error: <span class="hljs-string">'Unexpected Error'</span>,
                            code: error.code
                        });
                    }
                }
            },
            saveToPhotoGallery: <span class="hljs-literal">false</span>,
            allowEditing: <span class="hljs-literal">false</span>,
            mediaTypes: [
                Ti.Media.MEDIA_TYPE_PHOTO
            ]
        });
    };
})();
<span class="hljs-comment">// file</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(app.net) === <span class="hljs-string">'undefined'</span>) { app.net = {}; }
    app.net.upload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
        <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
        xhr.setRequestHeader(<span class="hljs-string">"Content-type"</span>, <span class="hljs-string">"multipart/form-data;"</span>);
        xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            Ti.API.info(<span class="hljs-string">'Error: '</span> + xhr.status);
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.error) !== <span class="hljs-string">'undefined'</span>) {
                obj.error({
                    status: xhr.status
                });
            }
        };
        xhr.setTimeout(<span class="hljs-number">20000</span>);
        xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            Ti.API.info(<span class="hljs-string">'Success: '</span> + xhr.status);
            Ti.API.info(<span class="hljs-string">'Response: '</span> + xhr.getResponseText());
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.success) !== <span class="hljs-string">'undefined'</span>) {
                obj.success({
                    data: xhr.getResponseText(),
                    status: xhr.status
                });
            }
        };
        xhr.onsendstream = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.progress) !== <span class="hljs-string">'undefined'</span>) {
                obj.progress({
                    progress: <span class="hljs-built_in">parseFloat</span>((e.progress * <span class="hljs-number">100</span>), <span class="hljs-number">10</span>)
                });
            }
        };
        xhr.open(<span class="hljs-string">'POST'</span>, obj.url);

        <span class="hljs-keyword">var</span> param = {}, intFiles = <span class="hljs-number">0</span>, intFile = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.data) !== <span class="hljs-string">'undefined'</span>) {
            param = obj.data;
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(obj.files) !== <span class="hljs-string">'undefined'</span>) {
            intFiles = obj.files.length
            <span class="hljs-keyword">for</span> (intFile = <span class="hljs-number">0</span>; intFile &lt; intFiles; intFile++) {
                param[obj.files[intFile].name] = obj.files[intFile].file;                
            }
        }
        Ti.API.info(<span class="hljs-string">'Param: '</span> + <span class="hljs-built_in">JSON</span>.stringify(param));
        xhr.send(param);
    };
})();
</code></pre><p>Part 2 of 2</p>
<pre><code class="hljs">Ti.UI.setBackgroundColor(<span class="hljs-string">'#000'</span>);
<span class="hljs-keyword">var</span> tab1, tab2, tab3;
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> win1 = Ti.UI.createWindow({  
        title: <span class="hljs-string">'Tab 1'</span>,
        backgroundColor: <span class="hljs-string">'#fff'</span>
    });
    tab1 = Ti.UI.createTab({  
        icon: <span class="hljs-string">'KS_nav_views.png'</span>,
        title: <span class="hljs-string">'Tab 1'</span>,
        <span class="hljs-built_in">window</span>: win1
    });

    <span class="hljs-keyword">var</span> image = Ti.UI.createImageView({
        image: <span class="hljs-string">'default_app_logo.png'</span>
    });
    win1.add(image);

    <span class="hljs-keyword">var</span> label1 = Ti.UI.createLabel({
        color: <span class="hljs-string">'#000'</span>,
        text: <span class="hljs-string">'%'</span>,
        font: {
            fontSize: <span class="hljs-number">36</span>,
            fontFamily: <span class="hljs-string">'Helvetica Neue'</span>
        },
        shadowColor: <span class="hljs-string">'#ddd'</span>,
        shadowOffset: {
            x: <span class="hljs-number">1</span>,
            y: <span class="hljs-number">1</span>
        },
        textAlign: <span class="hljs-string">'center'</span>,
        top: <span class="hljs-number">10</span>,
        width: <span class="hljs-number">320</span>,
        height: <span class="hljs-number">30</span>
    });
    win1.add(label1);

    <span class="hljs-keyword">var</span> btn = Ti.UI.createButton({
        title: <span class="hljs-string">'Photo'</span>
    });
    win1.setLeftNavButton(btn);
    btn.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> choose = Ti.UI.createOptionDialog({
            title: <span class="hljs-string">''</span>,
            options: [
                <span class="hljs-string">'Take Photo'</span>,
                <span class="hljs-string">'Choose Existing'</span>,
                <span class="hljs-string">'Cancel'</span>
            ],
            cancel: <span class="hljs-number">2</span>
        });
        choose.show();
        choose.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">switch</span> (e.index) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// camera</span>
                app.media.photo({
                    success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                        image.setImage(e.media);
                    },
                    error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                        alert(<span class="hljs-built_in">JSON</span>.stringify(e));
                    },
                    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                        alert(<span class="hljs-string">'cancel'</span>);
                    }
                });
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// gallery</span>
                app.media.gallery.open({
                    photo: <span class="hljs-literal">true</span>,
                    video: <span class="hljs-literal">false</span>,
                    success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                        image.setImage(e.media);
                    },
                    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ },
                    error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{ }
                });
                <span class="hljs-keyword">break</span>;
            }
        });
    });
    <span class="hljs-keyword">var</span> btn2 = Ti.UI.createButton({
        title: <span class="hljs-string">'Upload'</span>
    });
    win1.setRightNavButton(btn2);
    btn2.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        app.net.upload({
            url: <span class="hljs-string">'http://test.web.com/camera/'</span>,
            data: {
                firstname: <span class="hljs-string">'Test'</span>,
                lastname: <span class="hljs-string">'User'</span>
            },
            files: [
                { name: <span class="hljs-string">'photo'</span>, file: image.getImage() }
            ],
            success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                alert(<span class="hljs-string">'success: '</span> + e.status);
            },
            error: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                alert(<span class="hljs-string">'error: '</span> + e.status);
            },
            progress: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                label1.setText(e.progress + <span class="hljs-string">'%'</span>);
                Ti.API.info(<span class="hljs-string">'Progress: '</span> + e.progress + <span class="hljs-string">'%'</span>);
            }
        });
    });
})();


<span class="hljs-keyword">var</span> tabGroup = Ti.UI.createTabGroup();
tabGroup.addTab(tab1);  
tabGroup.open();
</code></pre><p>Now to the second part, how will you get the users to upload the image?</p>
<p>This is possible because you can have the web page talk directly to the app and then respond to that interaction.</p>
<p>In fact I have just used this very same code within the last hour to another question asker.</p>
<p>HTML page part</p>
<pre><code class="hljs"><span class="hljs-doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span> <span class="hljs-attribute">lang</span>=<span class="hljs-value">"en-US"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"viewport"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"width=320, initial-scale=1.0"</span>/&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"format-detection"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"telephone=no"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Web Page<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"styles.css"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span>&gt;</span><span class="actionscript">
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">agree</span><span class="hljs-params">(boolAgreement)</span> </span>{
        Ti.App.fireEvent(<span class="hljs-string">'agreeterms'</span>, { agree: <span class="hljs-literal">true</span> });
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"text-decoration: underline; font-weight: bold"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"agree(true);"</span>&gt;</span>Yes I agree to these Terms of Service<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre><p>Example handler with the app</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">agreeTerms</span><span class="hljs-params">(e)</span> </span>{
    Ti.App.removeEventListener(<span class="hljs-string">'agreeterms'</span>, agreeTerms);
    winTerms.close();
    Ti.App.Properties.setBool(<span class="hljs-string">'Terms.Agreed'</span>, e.agree);
    Ti.App.fireEvent(<span class="hljs-string">'profile'</span>, {
        terms: <span class="hljs-string">'Yes'</span>
    });
}
Ti.App.addEventListener(<span class="hljs-string">'agreeterms'</span>, agreeTerms);
</code></pre><p>The idea will be that your users fill in the web form as normal, they click a button (nothing to do with a file input) and that tells the app to start the take&#x2F;choose photo process, when that finishes the upload part takes over.  Provided your <code>fireEvent</code> in the web page includes a DB row ID (or something unique) then you can pass that at the same time to the web server, process the image and update the row.</p>
<p>From these you should be able tie things together.  I have given you a lot of code, I am hoping you do not get overwhelmed.  I suggest you run the first part on a device and see what it does, then read through the code to see how.</p>
<p>The app model simplifies things a bit, it is one a few techniques out there that can help you manage things, CommonJS is now considered better and what I do not use, but get the basics right first, then stitch everything together.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 12th 2012, 3:47:05 pm">August 12th 2012</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/140910/ipad-issue-with-a-webform-hosted-from-an-sql-database#answer-245105" rel="permalink">permalink</a>
							</div>

							<h5>13 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>BTW you will need to have a working script on your web server for the upload.</p>
<p>Change this line, to a suitable URL</p>
<pre><code class="hljs"><span class="hljs-string">url:</span> <span class="hljs-string">'http://test.web.com/camera/'</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 3:49:11 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>At the risk of looking stupid and going under the assumption that you appreciate that Im new to Ti, I have to ask this to make sure I make the most out of what you have given me.  In summary, I need to make sure I understand where each of these go. So let me ask and hope that I understood you correctly:</p>
<ol>
<li>Start a new app</li>
<li>Put Part 1 on app.js</li>
<li>Put Part 2 on a new .js page</li>
<li>Run this on a device</li>
<li><p>Go back and analyze the code to understand what and how it performed.</p>
</li>
<li><p>Put the HTML on a page on the website.</p>
</li>
<li>Put the &quot;Example handler&quot; at the bottom of app.js??</li>
</ol>
<p>You asked &quot;how will you get the users to upload the image?&quot; If you are referring to the webform, there is a button at the bottom they press and then navigate through the gallery to the intended image.</p>
<p>I see that you have the upload option in the last section of code you provided.  That is to upload the image to the server&#x2F;database right?</p>
<ol>
<li>Verify that the DB includes a DB row ID</li>
</ol>
<p>This is really great and so appreciated. I have to ask though, because on the Apple forums I got this to…is it necessary to upload the image directly to the database if it is going to be uploaded to the daily report that will go out to the parents?  The Daily Report is saved and archived on the server so I just need&#x2F;want to understand the need for the image to reside on the server by itself if its attached to the Daily Report.  It seems that this is redundant but maybe that is more I need to learn.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 4:19:57 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Almost right - I had to split the main code in two as <code>part1</code> and <code>part2</code> because the code was too long, replace the entire contents of the created <code>app.js</code> with part 1 and part 2 underneath.</p>
<p>The question &quot;…how will you get the users to upload the image?&quot; was actually a mis-typed statement.  &quot;how <strong>you will</strong> get the users to upload the image?&quot; - Trying to say the next section of code is all about how you would initiate the process of your users uploading the image.</p>
<p>You do not have to upload the image directly to the database, you can store it anywhere you like on the server when you upload it.  I was imagining you have a row entry with a unique id that you could mark as having had an image upload.  That way you would know if the image had been successful or not.</p>
<p>I suppose this really depends on what you mean by the &#39;daily report&#39; has an image attached, where currently is the image in relation to the &#39;daily report&#39;?</p>
<p>I would assume you have either a file residing in a specific folder with a filename or id for a filename that it references in the database row for the daily report, or you store the image as ablob in the database row.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 4:31:01 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK Im going to get to work on it. Ideally, I would rather not have to upload the image at all because the webform (Daily Report) is supposed to pick it up from the app.  The Daily Report is a webform of 10 questions that the teacher answers for each child…did they eat well, did they nap well, did they have any issues, etc.. and then at the bottom is where there are two fields with buttons next to them for image or video.  So, the original goal is for the image to be attached to the daily report and then the daily report is saved in the students file online.  If we upload the image to the database, server, website, etc.. it will sit there and do nothing, there is no need unless we redesign the webform to grab it from there, which is not in the plan in the short term.  In version 2 as I said before I want it to be all cloud based so all student files are saved in the cloud, all images and videos taken, all daily reports completed for each student, etc..</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 4:42:26 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Then the question is - what is the image for, I thought (possibly assumed) you need an image to be upload from the device.</p>
<p>If this is not the case, can you outline again what role the &#39;image&#39; takes.</p>
<p>Cheers</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 5:05:30 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes and Im not sure if I should continue here in the comments section or should jump out in the main section, but here is the philosophy.  </p>
<p>Each day teachers are required to complete a written daily report for the parents when they pick up their child. We are trying to eliminate the paper trail and increase communication between teachers and parents.  Lets suppose the kids are doing an art project and little Joey is doing something cute or funny. The teacher thinks his parent would love to see it so she takes a picture of him covered in paint.  Later that day she is completing the daily reports, only now she is doing it on her iPad and submitting them. When they hit submit, its saved on the server, and a notification goes out to the parent that &quot;your child&#39;s daily report is ready for review&quot;.</p>
<p>Well, an added feature is that the parents can read the report, but at the bottom of it is that picture of little Joey covered in paint.  The parent laughs and loves the fact that the teachers are so in tune with each kid and actually takes the time to photograph &quot;Kodak moments&quot; and sends them to the parents.  Ideally, we want the daily report to be able to include multiple images or videos. Right now, one is sufficient, if we can even get that.</p>
<p>On a personal note, if I would have started this project from the beginning, I would have never built the daily report (webform) from Drupal. I would have created it from the app side.  We want the parents to be able to view their childs report from a computer, a phone, a tablet, etc.. and the images should be able to be seen at the bottm of the the report no matter where they are looking from.</p>
<p>So I think the most important thing is that the image is attached to the daily report, not necessarily loaded on the website&#x2F; server.</p>
<p>Does that make sense?  Does it change anything?  BTW, I ran that on my iPad and the camera function is fantastic.  The whole thing is actually, but again Im not sure that it has to be uploaded to the server.  What are your thoughts and have they changed at all knowing the details I just explained?</p>
<p>On a side note, what does that orange triangle mean beside your name?  Why do some have a blue one, a green one, etc..</p>
<p>Thank you,<br>John</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 5:27:40 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi John</p>
<p>If you are processing the data in a web-form and that is stored on your server, I am assuming the email sent to the parent is sent from the server.  Which is why I am suggesting you send the image to the server so it can be attached.</p>
<p>If you have no need to keep the image once the it has been attached and sent then you do not have to upload the image to the server.  But you will have to take the answered fields from the web-form and pass them to the app before you start the picture process, then you can tel lit to send an email - attaching the image at the same time.</p>
<p>Either way the photo and the data need to be in the same place, with the web-form not actually being on the device they are technically in two places.  But as with all things that is not a problem if you tackle it the right way.</p>
<p>So this is an example flow;</p>
<ul>
<li>Teacher fills in the form and submits it</li>
<li>The existing facility stores the data in the same way it does right now.</li>
<li>The &quot;thank you&quot; page would then have a button (standard html one) that says &quot;Send to Parent&quot;</li>
<li>This button uses the code example above (talking between web-page and ap) to send a message to the app</li>
<li>This message contains the fields from the submitted form</li>
<li>The app listens for this event and triggers the camera&#x2F;image code from above</li>
<li>The teacher then creates an email on the device and attaches the picture (easy we can discuss later)</li>
</ul>
<p>Provided the logic of this is sound then the rest is actually rather easy (with a little help).</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 5:49:41 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Forgot your side note;</p>
<p>The icons simply denote the type of account people have; if you have one you have a paid account, the colour and letter on it denote the type of paid account.</p>
<p>Orange with i = Indy account this is no longer available - it is for us old folk (been here a long time)<br>Blue with p = Pro account<br>Green with e = Enterprise account<br>Blue&#x2F;Grey shield with t = Titan - is designed to denote that person has indicated they wish to aid the community.</p>
<p>Account type is unrelated to being a Titan.</p>
<p>To be a titan you have to apply and have met certain pre-requisites, to be a paid account holder - you need to hand over cash (sorry probably obvious).</p>
<p>I do not know how long it takes to be approved to be a titan, as I personally only applied a few days ago.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 6:08:41 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That makes sense. Its a little daunting to me, being honest with you, because of my newness, but sensible.  I have to add this, and tell me if it would change the flow, or make you think down a different path.  Im not sure how our database guy did it, but he set it up so that when the teacher hits submit, an email is automatically generated to go out to the parent to let them know they have a daily report waiting to be viewed.  In addition to that, I am supposed to have a notification on the app. that goes out every weekday at 5pm, that says &quot;if your child was in school today, then your daily report should be ready for viewing&quot;. (This part is a little hairy for me because there are so many what-if&#39;s like suppose they are on vacation, suppose the teacher is late and does not have them done by 5pm, and so on and so on) but this is what the CEO wants so we do.</p>
<p>First I have to admit something, you know by now this is my first appcelerator app..  Well I have not taken the time to get my iPad configured as development device for Appcelerator. When I put your code in a new project and ran it on the device, it acted just as it does when I test apps from Xcode, so I sat and waited for it to come up. Well it never did, so obviously there is some tweaking I have to do (right?) to get my iPad to be able to test apps from Appcelerator. When I stated I had run your code, I ran it in the simulator and ran it several times up to where it would error out and give me the &quot;cant run on simulator&quot; error msg.  But, I assume that its the same inside as, for example, the kitchen sink camera feature or other sample apps camera features.  Im sorry if I was misleading when I said I ran it but I either was too impatient and did not wait long enough for it to load on my iPad, or there is some tweaking to do for apps on Appcelerator versus apps on Xcode.  It located my ID, my dev. keychain, etc.. and ran very similar to Xcode so I assumed it would eventually get there.</p>
<p>Im sorry to be so long winded Malcolm, but I guess I just am as I try to learn this.  With the flow above, I have to ask first, how much different will this be for teachers.  If I understand it right, basically you are saying that we will not attach images to the daily report, but the teacher will be asked if she wants to email the images to the parent. If that is the case, I can tell you that the CEO is not going to like it. She is really finicky; a great gal but man she wants things the way she wants them and that is the cause of a few gray hairs on my head.  If I have to tell her tomorrow that the daily report will not include any images and we will have to email images and video to the user, she will not like it because its not utilizing the app. The parent will have to go to their inbox.  Her big hang up is that the daily report will be very pretty and colorful with images and video.  HOWEVER, if you are telling me that there is no other way, then OK.  Its taken me 3 weeks to make her realize that Apple is the issue and not John…I have had to send her quotes from Apple directly or from articles in technology blogs&#x2F;forums&#x2F;sites that state that the idea is not possible but yet will be in iOS6.  I think she still in the back of her mind is thinking that &quot;John is just being lazy and does not want to do the extra work involved in getting this fixed&quot; even though I have shown her proof that iOS5 will not allow it to happen.</p>
<p>Sorry for the novel but tell me your thoughts on this.  If your example flow is the only option, then I can explain that and it will be more of a motivator to let me get the cloud version done.</p>
<p>Regards,<br>John</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 6:14:54 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi John</p>
<p>As I mentioned in the previous comment;</p>
<p><em>&quot;If you are processing the data in a web-form and that is stored on your server, I am assuming the email sent to the parent is sent from the server. Which is why I am suggesting you send the image to the server so it can be attached.&quot;</em></p>
<p>Your latest comment seems to confirm that fact.  So you will need to upload the image to the server so the current email process can email it.  Once the email is sent then the server can delete the image in the same script.</p>
<p>It is more complicated than it should be but only because you are using a web-form (for good reasons I know).  Normally you would ask the questions on the app the user would choose the picture, you would then &#39;post&#39; these to the server in a parcel of data only - a web API as they are called.</p>
<p>Once you deal with each part in turn it will be easy, stop thinking of it as one big problem, think of it as a series of many small processes.  Then solve each one in turn - not even in the normal flow of an app - just solve each one.  At the end of solving all of these little processes, start stitching them together.</p>
<p>I think many of your confusions during our MANY communications is that you are worried about the whole - that appears at the end, just solve each problem in turn.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 6:29:15 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You have me pegged already.  I worry too much and when I stress out I admittedly struggle to break things down in my head and tend to stand back and go &quot;Good lord its all messed up.&quot;  There is nothing worse than working your tail off and then being given a deadline to fix something that they knew all along was wrong but never told me that the old developer was fired over this problem because he could not resolve it.  Anyway onward and upward- not going to turn this into a gripe session.</p>
<p>So, break it down by process and get each one completed and then it will be easy to stitch them all together at the end and it will work great.</p>
<p>First off, can I just ask you, because I know Im going to be drilled tomorrow on this topic when I explain that the daily report is not going to be all pretty and colorful with nice pics or videos, is it not possible to do, for the same reasons its not possible to do in Xcode until iOS6 comes out?  Again I am thinking ahead of how Im going to answer the questions tomorrow when they ask why the images are not sitting in the daily report. I wont bring it up again after this- I just have to think how I&#39;m going to handle my customer when its brought up.</p>
<p>Ok so the code that I put into the new sample app to see run…that would not go on my app.js page in the real app right?  Would it go on a completely new page that does not have an existing window thereby creating a window when one of the buttons is depressed? </p>
<p>You have given me a huge amount of your weekend- I just want you to know I recognize that and sincerely appreciate it Malcolm.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 7:05:12 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi John</p>
<p>I have not told you that the &#39;daily report&#39; cannot have pics&#x2F;videos etc, just that you are going to have to work out which method you will use to get there.</p>
<p>In answer to your question about where the code should go, yes most likely a new window - so the process can be sectioned off.</p>
<p>Finally you are welcome, most people here (myself included) are just trying to help others.  In doing so I have learnt lots, as people have some very interesting questions that stretches my own knowledge and exposes me to situations I may not have got to on my own or until time was a serious factor.</p>
<p>BTW a serious tip, everyone likes bit sized questions, with bite sized points - you will find more people jumping in to help, detail is great - but start with enough information to give people the  basic idea.  Break bigger questions into several smaller questions and answer them as they come up rather than all at once - this works out great as you should be breaking your project into lots of smaller chunks.  Newbies get a pass.</p>
<p>I think we have answered this main point some time ago, so mark this one off and then start a new one when you have one.  As you can probably guess I am here a lot.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 7:23:19 pm">August 12th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK I understand and thank you for that tip as well.  I can relate to that fully.  I will check this one off and look forward to learning more from you, as well as, meeting other professionals on this forum&#x2F;board.</p>
<p>Regards,<br>John</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 12th 2012, 7:29:05 pm">August 12th 2012</span>
											by <span class='authorname'>John Bergman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-245103">
				
						<section>
							<p>I understand, that was alot of info.  </p>
<p>The bottom line is the buttons are greyed out on the webform so I need to be able to attach images, that are taken on the iPad, to the webform that is coming from Drupal&#x2F;SQL.  The reason for all of the background info. is because that may not be possible, as I learned already in iOS5.  So if its not possible, Im asking the best plan B option?</p>
<p>Yes I can handle the website receiving the image, but then I have to ask the question…if a teacher is using an iPad to complete the webform (99% of the time), and only needs to attach images that are residing on the iPad, then the webform needs to recognize the device so those buttons become live.  If this helps, the form they fill out was written in PHP and once it is submitted, it and its attachments are saved on the server in that students file.</p>
<p>I&#39;m sorry, but with this issue I struggle to narrow it down to a single question.</p>
<p>Thank you for your patience.</p>
<p>Frustrated,<br>John</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 12th 2012, 3:29:07 pm">August 12th 2012</span>
								by <span class='authorname'>John Bergman</span><br>
								<a class="icon-bg icon-link" href="question/140910/ipad-issue-with-a-webform-hosted-from-an-sql-database#answer-245103" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
