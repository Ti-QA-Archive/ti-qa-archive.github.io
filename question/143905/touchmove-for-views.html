<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>touchMove for Views » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>touchMove for Views</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I am trying to do a pull-up slider view(something similar to the iOS and Android notification bar). Here I am using the <strong>touchMove</strong> event to change the top of the view as per the <strong>event.y</strong>. </p>
<p>But the here I am not getting the smooth sliding effect(<a href="http:&#x2F;&#x2F;screencast.com&#x2F;t&#x2F;MLrhmP9cfs9">please refer the demo video</a>). How can I get the smooth sliding effect similar to iOS and Android notification bar.</p>
<p>Note: I cant use <strong>event.globalPoint.y</strong>, because I need it for both iOS and Android. I have already seen <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;136535&#x2F;pull-down-notification-bar-mobile">this post</a>, but still I can&#39;t get sooth sliding effect.</p>
<p>My Sample code</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">win</span> = Titanium.UI.createWindow({  
    backgroundColor:'#fff'
});

<span class="hljs-keyword">var</span> sliderView = Titanium.UI.createView({
   width: Ti.Platform.displayCaps.platformWidth - 20,
   height:400,
   bottom:-350
});
<span class="hljs-keyword">win</span>.add(sliderView);

<span class="hljs-keyword">var</span> arrow = Titanium.UI.createView({
   top:0,
   width: 72,
   height: 72,
   isArrow:true,
   backgroundImage:<span class="hljs-string">"arrow-up-icon.png"</span>,
});
sliderView.add(arrow);

<span class="hljs-keyword">var</span> cardView = Titanium.UI.createView({
   top:52,
   height:340,
   backgroundColor: '#2B892B'
});
sliderView.add(cardView);

<span class="hljs-keyword">win</span>.addEventListener(<span class="hljs-string">"touchmove"</span>, function(<span class="hljs-keyword">e</span>){
      Ti.API.info(<span class="hljs-string">"touchmove x = "</span>+<span class="hljs-keyword">e</span>.x+<span class="hljs-string">" ,y = "</span>+<span class="hljs-keyword">e</span>.y+<span class="hljs-string">", global y = "</span>+<span class="hljs-keyword">e</span>.globalPoint.y+<span class="hljs-string">" ,source = "</span>+<span class="hljs-keyword">e</span>.source.isArrow);
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">e</span>.source.isArrow){
          <span class="hljs-keyword">var</span> newY = 400+<span class="hljs-keyword">e</span>.y; <span class="hljs-comment">// 400 is sliderView height</span>
          sliderView.top = newY;
      }
});

<span class="hljs-keyword">win</span>.<span class="hljs-keyword">open</span>();
</code></pre><p>Thanks in Advance.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 24th 2012, 10:41:06 am">October 24th 2012</span>
				by <span class='authorname'>prabu durai</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>animation</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>touchmove</span></li>
					
						<li><span class='tagname'>view</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-249886">
				
						<section>
							<p>Try maybe to animate a little the view</p>
<pre><code class="hljs"> <span class="hljs-tag">sliderView</span><span class="hljs-class">.animate</span>({<span class="hljs-attribute">top</span>: newY, <span class="hljs-attribute">duration</span>:<span class="hljs-number">50</span>}); <span class="hljs-comment">// play with duration to get the right timing, but use small values</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 24th 2012, 11:22:43 am">October 24th 2012</span>
								by <span class='authorname'>Dan Tamas</span><br>
								<a class="icon-bg icon-link" href="../../question/143905/touchmove-for-views.html#answer-249886" rel="permalink">permalink</a>
							</div>

							<h5>12 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Dan,</p>
<p>Even though If I used animation, the sliding is not smooth, but If I use  <strong> e.globalPoint.y</strong>,</p>
<p> <code>sliderView.top = e.globalPoint.y-40;</code> </p>
<p>It was bit smoother. Is there any chance to calculate the globalPoint from the <strong>e.y</strong></p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:02:35 pm">October 24th 2012</span>
											by <span class='authorname'>prabu durai</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Try this module and let me know how it works, I might need it too soon ;)</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:08:21 pm">October 24th 2012</span>
											by <span class='authorname'>Dan Tamas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Which module?</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:28:31 pm">October 24th 2012</span>
											by <span class='authorname'>Miguel Ángel Castaño Fajardo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ups<br>https:&#x2F;&#x2F;github.com&#x2F;pec1985&#x2F;TiDraggable</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 24th 2012, 12:32:16 pm">October 24th 2012</span>
											by <span class='authorname'>Dan Tamas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>touchmove is still interrupted by touchcancel with the TiDraggable module. Also, once the touchcancel event has fired, the touchend event never gets fired either (which is the correct behavior - assuming the touch cancel event is being fired correctly).</p>
<p>The interesting thing is that iOS also fires the touchcancel event prematurely, however, it seems iOS is clever enough to realise that the user is still moving on the screen and it keeps firing the touchmove event regardless of whether or not the touchcancel event was fired. This is the reason it works on iOS.</p>
<p>Also, with regards to the TiDraggable module, on Android, it is not compensating for the device notification bar at the top of the screen (which works out to 20 pixels on a 320 x 480 screen), so when the touch start event is fired, the draggable object jumps up 20 pixels (on my 320 x 480 screen) before the drag movement starts in the touchmove event.</p>
<p>I&#39;m using Ti Studio with 2.1.3.GA SDK</p>
<p>I&#39;ve tested this on both the V8 and Rhino Android Runtimes (as seen in the tiapp.xml editor)</p>
<p>I must say, this is really disappointing. One would think that for touch enabled devices, getting the touchmove&#x2F;touchcancel events working properly would be one of the core issues to deal with?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 9:40:08 am">November 2nd 2012</span>
											by <span class='authorname'>Robin Stoker</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Robin,</p>
<p>Thanks for your info, What would be the solution for this one?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 9:49:32 am">November 2nd 2012</span>
											by <span class='authorname'>prabu durai</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>LOL, if I knew I would have posted it :)</p>
<p>What I did find is that it is because of a couple factors …</p>
<ol>
<li>In JavaScript, events bubble up. This means, the touchmove event is being fired on all the draggable object&#39;s parents - not just on the draggable object itself.</li>
<li>If you have a draggable object inside a ScrollView, then when you move the draggable object, the touchmove event is going to be fired on the ScrollView too … as soon as focus returns to the draggable object, the ScrollView fires it&#39;s own touchcancel event, which in Android cancels ALL touch events and ultimately interferes with the touchmove event on the draggable object.</li>
</ol>
<p>The only way to fix this issue (that I know of) is to put the draggable object inside a normal View object (not a ScrollView object) and then add the normal View object directly to the window or tab group. That way, the touchmove&#x2F;touchcancel events from the various parent objects won&#39;t interfere with your draggable object because those parent objects don&#39;t have touchmove&#x2F;touchcancel events …</p>
<p>PS. The TiDraggable module actually works very well within a normal View object.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 12:16:26 pm">November 2nd 2012</span>
											by <span class='authorname'>Robin Stoker</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Damn it! I found a bug with the TiDraggable module regarding multiple windows in iOS. If you have a draggable object in your main window and you open another window, then when the second window closes the draggable object will be reset to it&#39;s original position. I suspect the draggable object has a postlayout event that sets the position … perhaps this postlayout event is being fired when the second window closes and the user returns to the main window. Not sure if this bug applies to tab groups.</p>
<p>This leaves us with three options:</p>
<ol>
<li>Modify the TiDraggable module to correct this issue</li>
<li>Stick to one main window with no &quot;sub-windows&quot; - seriously? this is not an option!</li>
<li>Write your own draggable object</li>
</ol>
<p>This does not appear to be an issue on Android.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 12:50:38 pm">November 2nd 2012</span>
											by <span class='authorname'>Robin Stoker</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think I found the solution for ScrollViews. The ScrollView object has a property called &quot;canCancelEvents&quot;. It&#39;s getting late in the day and almost time to leave the office so I have not tested it yet, but before you do anything else, try setting this property to false on your ScrollView object. This may be just what we have been looking for!</p>
<p>Here it is in the docs:</p>
<p>http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.UI.ScrollView-property-canCancelEvents</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 2nd 2012, 12:59:47 pm">November 2nd 2012</span>
											by <span class='authorname'>Robin Stoker</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So there is really no answer as to why we cannot achieve smooth dragging on views for iOS? As you said, one would think touchmove would be a priority for touch enabled devices.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 9th 2012, 3:14:05 am">November 9th 2012</span>
											by <span class='authorname'>Sergio Trevino</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m trying to figure out exactly what questions are unanswered here. I have been able to achieve a nice smooth motion of the window. But I am having a problem with touch events, and I am about to try Robin&#39;s suggestion. I&#39;ll get back to you all soon, let me know if anyone has questions about achieving a smooth scroll.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 15th 2012, 1:37:07 pm">November 15th 2012</span>
											by <span class='authorname'>Aaron Sumsky</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Robin Stoker, you were right on man! Set the canCancelEvents property to false on your ScrollView object. For me, everything works smooth as butter :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 15th 2012, 2:26:43 pm">November 15th 2012</span>
											by <span class='authorname'>Aaron Sumsky</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
