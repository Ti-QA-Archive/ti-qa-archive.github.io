<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Ti.include() in CommonJS style » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Ti.include() in CommonJS style</h1>
		</header>
		<section>
			<p>I&#39;m trying to replicate a similar approach to including files as in CommonJS - in the sense I want to be able to assign things to custom named variables.</p>
<p>The API docs say that Ti.include takes &quot;one or more filenames to include as if the Javascript code was written in place&quot;.</p>
<p>This would imply we could do the following:</p>
<pre><code class="hljs"><span class="hljs-comment">//include.js</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">return</span> { foo: <span class="hljs-string">'bar'</span> };
})();
</code></pre><pre><code class="hljs"><span class="hljs-comment">//app.js</span>
<span class="hljs-keyword">var</span> included = Ti.<span class="hljs-keyword">include</span>('<span class="hljs-keyword">include</span>.js');

Ti.<span class="hljs-keyword">App</span>.<span class="hljs-literal">log</span>(included); <span class="hljs-comment">// Should be: {foo: 'bar'} Actually is: &lt;null&gt;</span>
</code></pre><p>But included in the case above is always null.</p>
<p>Are there any ways around this?  It&#39;s starting to get a bit unmanageable having to assign objects to variables within the include files.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 14th 2011, 11:07:25 am">June 14th 2011</span>
				by <span class='authorname'>Charles Davison</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>commonjs</span></li>
					
						<li><span class='tagname'>file</span></li>
					
						<li><span class='tagname'>include</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-210307">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Sorry my bad - when using require you don&#39;t add the .js in the name, soo it becomes</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lib/module'</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 8:27:19 am">June 15th 2011</span>
								by <span class='authorname'>Rasmus Andersen</span><br>
								<a class="icon-bg icon-link" href="../../question/121012/tiinclude-in-commonjs-style.html#answer-210307" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks, works great in Ti Mobile 1.6 on Titanium Developer but didn&#39;t seem to work in 1.7 on Ti Studio.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 10:00:10 am">June 15th 2011</span>
											by <span class='authorname'>Charles Davison</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>4</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210291">
				
						<section>
							<p>the commonJS function require is surpported in Titanium</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'include.js'</span>);

<span class="hljs-built_in">module</span>.myFunction();
</code></pre><p>and in include.js</p>
<pre><code class="hljs">exports.myFunction = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">//do your thing</span>
};
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 15th 2011, 5:54:49 am">June 15th 2011</span>
								by <span class='authorname'>Rasmus Andersen</span><br>
								<a class="icon-bg icon-link" href="../../question/121012/tiinclude-in-commonjs-style.html#answer-210291" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Sounds great - is there any documentation on this?</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 7:34:01 am">June 15th 2011</span>
											by <span class='authorname'>Charles Davison</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>If I try these I get module not found:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lib/module.js'</span>);
<span class="hljs-comment">//or</span>
<span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/module.js'</span>);
</code></pre><p>And if I try this I get <em>*</em> -[NSCFString substringFromIndex:]: Range or index out of bounds.:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/module.js'</span>);
</code></pre><p>Any idea what I&#39;m doing wrong here?  I thought require() was just for Titanium&#39;s addon modules, part of the professional edition?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 15th 2011, 7:52:28 am">June 15th 2011</span>
											by <span class='authorname'>Charles Davison</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You don&#39;t need the &#39;.js&#39; extension, the following should work:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lib/module'</span>);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="September 1st 2011, 11:19:39 am">September 1st 2011</span>
											by <span class='authorname'>Ahmed BOUSSADIA</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210172">
				
						<section>
							<p>in your include.js, create a class, do the include, then call the class and assign the returned value to your variable.</p>
<p>This way your include wont start untill you call the class, the class can be used multiple times, just include it in your app.js and you can acces it through your entire app.</p>
<p>Code example will come in a comment below</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 14th 2011, 11:12:14 am">June 14th 2011</span>
								by <span class='authorname'>Kami -</span><br>
								<a class="icon-bg icon-link" href="../../question/121012/tiinclude-in-commonjs-style.html#answer-210172" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;120765&#x2F;opening-a-new-page-from-multiple-buttons.html#answer-209699">Link to code</a></p>
<p>Different question but same awnser, works great.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 14th 2011, 11:14:18 am">June 14th 2011</span>
											by <span class='authorname'>Kami -</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210175">
				
						<section>
							<p>Hi Charles.</p>
<p>I think that this:</p>
<pre><code class="hljs"><span class="hljs-list">(<span class="hljs-keyword">function</span><span class="hljs-list">()</span> <span class="hljs-collection">{
  return <span class="hljs-collection">{ foo: 'bar' }</span><span class="hljs-comment">;</span>
}</span>)</span><span class="hljs-list">()</span><span class="hljs-comment">;</span>
</code></pre><p>won&#39;t do anything (smart). It will return object from function closure, but it&#39;s not stored in any variable so it will be lost.</p>
<p>Maybe you could do something like this:</p>
<pre><code class="hljs"><span class="hljs-comment">//actually, closure is not necessary</span>
<span class="hljs-keyword">var</span> included = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">return</span> { foo: <span class="hljs-string">'bar'</span> };
})();
</code></pre><p>And then in app.js:</p>
<pre><code class="hljs">Ti.<span class="hljs-keyword">include</span>('<span class="hljs-keyword">include</span>.js');
Ti.<span class="hljs-keyword">App</span>.<span class="hljs-literal">log</span>(included);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 14th 2011, 11:33:46 am">June 14th 2011</span>
								by <span class='authorname'>Ivan Škugor</span><br>
								<a class="icon-bg icon-link" href="../../question/121012/tiinclude-in-commonjs-style.html#answer-210175" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Sorry, it should be:</p>
<pre><code class="hljs">Ti.<span class="hljs-keyword">include</span>('<span class="hljs-keyword">include</span>.js');
Ti.<span class="hljs-keyword">App</span>.<span class="hljs-literal">log</span>(<span class="hljs-keyword">typeof</span> included);
</code></pre><p>because if variable &quot;included&quot; is not defined, &quot;ReferenceException&quot; will be raised, so it&#39;s safer to use &quot;typeof&quot; operator.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 14th 2011, 11:35:44 am">June 14th 2011</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The closure was mostly there as an example of what I needed for more complex setup, private vars etc.</p>
<p>But what I wanted to do was avoid having the name the variable in the include file as it&#39;s more flexible if you can assign it to something in the controller.  I came up with a solution you can see in my separate comment.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 14th 2011, 1:00:06 pm">June 14th 2011</span>
											by <span class='authorname'>Charles Davison</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210179">
				
						<section>
							<p>After some more thinking I came up with a very simple solution to this, which loosely follows the CommonJS standard.</p>
<p>Basically I created a minimal loader function which does the loading for me.  Included files just need to stick to the CommonJS standard of assigning the public return variables to &#39;exports&#39;.</p>
<pre><code class="hljs"><span class="hljs-comment">//utils.js</span>
<span class="hljs-keyword">var</span> utils = {
  <span class="hljs-keyword">require</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(filename)</span> </span>{
    Ti.<span class="hljs-keyword">include</span>(filename);

    <span class="hljs-keyword">return</span> exports;
  };
};
</code></pre><pre><code class="hljs"><span class="hljs-comment">//include.js</span>
<span class="hljs-keyword">var</span> privateVar = <span class="hljs-string">'something'</span>; <span class="hljs-comment">//Won't be exported</span>

<span class="hljs-keyword">var</span> exports = { foo: <span class="hljs-string">'bar'</span> }; <span class="hljs-comment">//Will be exported</span>
</code></pre><p>Now in app.js or wherever else you can do:</p>
<pre><code class="hljs"><span class="hljs-built_in">var</span> included = utils<span class="hljs-built_in">.</span><span class="hljs-keyword">require</span>(<span class="hljs-string">'include.js'</span>);

Ti<span class="hljs-built_in">.</span>App<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span>(included); <span class="hljs-comment">//{foo: 'bar'}</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 14th 2011, 11:43:50 am">June 14th 2011</span>
								by <span class='authorname'>Charles Davison</span><br>
								<a class="icon-bg icon-link" href="../../question/121012/tiinclude-in-commonjs-style.html#answer-210179" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
