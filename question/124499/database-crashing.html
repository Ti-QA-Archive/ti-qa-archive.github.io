<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Database Crashing » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Database Crashing</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>What&#39;s wrong with the following code? It keeps crashing my app…</p>
<pre><code class="hljs">

<span class="lasso"><span class="hljs-built_in">var</span> <span class="hljs-keyword">rows</span> = db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'SELECT * FROM mytable'</span>);


<span class="hljs-built_in">var</span> rowCount;
<span class="hljs-keyword">while</span> (<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>isValidRow())
{
    rowCount++;
    <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>next();
}
<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>close();
Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(rowCount);
<span class="hljs-keyword">if</span>(rowCount &lt; <span class="hljs-number">5</span>){
    f<span class="hljs-subst">or</span> (<span class="hljs-built_in">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">21</span>;i++)
    {
        db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'INSERT INTO mytable (column1) VALUES(?)'</span>,<span class="hljs-built_in">array</span><span class="hljs-preprocessor">[</span>i<span class="hljs-preprocessor">]</span><span class="hljs-markup">);    
    }
}</span></span>
</code></pre><p>Thanks! I cannot for the life of me figure out what is wrong. All I&#39;m trying to do is count the rows and if there&#39;s nothing in the table, add some rows.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 19th 2011, 1:06:41 pm">August 19th 2011</span>
				by <span class='authorname'>Connor Zwick</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>database</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you post the entire example?</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 19th 2011, 1:13:45 pm">August 19th 2011</span>
								by <span class='authorname'>Kevin Whinnery</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Is the section below enough, otherwise I can. The only code missing is that I open and close the database above and below this.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 19th 2011, 1:40:43 pm">August 19th 2011</span>
								by <span class='authorname'>Connor Zwick</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>And then I include this database file, in my main file.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 19th 2011, 1:41:05 pm">August 19th 2011</span>
								by <span class='authorname'>Connor Zwick</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-216950">
				
						<section>
							<p>I am not so sure but I want to ask something.Why you write <strong>rows.close();</strong> because normally I don&#39;t use that one. Then you may need to check what is error log also.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 19th 2011, 1:15:32 pm">August 19th 2011</span>
								by <span class='authorname'>Pye Phyo Han</span><br>
								<a class="icon-bg icon-link" href="question/124499/database-crashing#answer-216950" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-216952">
				
						<section>
							<p>It would be helpful if you said what OS and SDK level you are using.  From the information posted, we can&#39;t even tell if it is a desktop or mobile project.  Secondly, it would help to say more than &quot;crashing&quot; – can you elaborate on what happens?  Have you narrowed down where in the code it happens?</p>
<p>Also, you don&#39;t need to count the rows yourself.  You can simply use:</p>
<pre><code class="hljs"><span class="hljs-built_in">var</span> <span class="hljs-keyword">rows</span> = db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'SELECT * FROM mytable'</span>); 
<span class="hljs-built_in">var</span> rowCount = <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>rowCount;
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 19th 2011, 1:19:09 pm">August 19th 2011</span>
								by <span class='authorname'>Doug Handy</span><br>
								<a class="icon-bg icon-link" href="question/124499/database-crashing#answer-216952" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I&#39;m developing for iOS with the latest SDK version. An excerpt of the error it gives me is this:</p>
<pre><code class="hljs">

<span class="sql">com.plausiblelabs.pldatabase.error.query.string=<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mytable <span class="hljs-keyword">WHERE</span> column1 = ?, com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.vendor.<span class="hljs-keyword">string</span>=<span class="hljs-keyword">no</span> such <span class="hljs-keyword">column</span>: purchaseID}  <span class="hljs-keyword">in</span> -[TiDatabaseProxy <span class="hljs-keyword">execute</span>:] (TiDatabaseProxy.<span class="hljs-keyword">m</span>:<span class="hljs-number">136</span>)<span class="hljs-string">'</span></span></span>
</code></pre><p>This is weird because that code only occurs in a window that is deeply tucked away in the app and has not been opened yet. I&#39;ve tried cleaning the project, but it still happens. I am having tons of database issues throughout the project, which leads me to think I might be doing something wrong in general?</p>
<p>Is there a way to view the database and its entries in real time to debug? </p>
<p>Here are some code samples, perhaps you guys could tell me if they are correct? </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Titanium.Database.<span class="hljs-keyword">open</span>('database');
    purchaseStat = <span class="hljs-keyword">db</span>.execute('SELECT * FROM <span class="hljs-keyword">table</span> WHERE purchaseID = ?',deckLanguage);
    purchaseStatus = purchaseStat.fieldByName('status');
    purchaseStat.<span class="hljs-keyword">close</span>();
    <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
</code></pre><p>or here&#39;s another one that gave me an error saying deckInfo isn&#39;t defined:</p>
<pre><code class="hljs">    var db = Titanium.Database.<span class="hljs-keyword">open</span>(<span class="hljs-string">'cards'</span>);
    deckInfo = db.<span class="hljs-keyword">execute</span>(<span class="hljs-string">'SELECT * FROM decks WHERE id = ?'</span>,win.deckID);
    deckAuthor = deckInfo.fieldByName(<span class="hljs-string">'author'</span>);
    deckCardCount = deckInfo.fieldByName(<span class="hljs-string">'term_count'</span>);
    deckTitle = deckInfo.fieldByName(<span class="hljs-string">'name'</span>);
    deckLanguage = deckInfo.fieldByName(<span class="hljs-string">'subject'</span>);


    deckCardCount = parseFloat(deckCardCount);
    deckInfo.<span class="hljs-keyword">close</span>();
    db.<span class="hljs-keyword">close</span>();
</code></pre><p>Thanks guys, I&#39;ve been having issues with this for a while and I haven&#39;t been able to explain them. Hopefully, I&#39;m just fundamentally wrong about something and there will be an easy fix, otherwise I don&#39;t know.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 19th 2011, 1:40:02 pm">August 19th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-216966">
				
						<section>
							<p>Hi</p>
<p>In your code </p>
<pre><code class="hljs">  db.execute('<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> mytable (column1) <span class="hljs-keyword">VALUES</span>(?)<span class="hljs-string">',array[i]);</span></span>
</code></pre><p>Where is array[i]??</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 19th 2011, 3:24:31 pm">August 19th 2011</span>
								by <span class='authorname'>Alessandro Tom</span><br>
								<a class="icon-bg icon-link" href="question/124499/database-crashing#answer-216966" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>the array is defined earlier in the file too.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 19th 2011, 6:02:25 pm">August 19th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-216971">
				
						<section>
							<p>The first error (on purchaseID) says that column does not exist.  Since you had done SELECT * instead of a field list where I name could have been omitted or misspelled, that suggests the database is not the copy you think it is.</p>
<p>Is this a database you had included in your resources folder with a predefined schema of tables?  If so, did you ever use Ti.Database.install instead of Ti.Database.open?  Do you understand the install method will not replace an existing copy of the database on the device&#x2F;simulator?</p>
<p>On the surface, this sounds like it is opening a copy of the database where the table exists but the column purchaseID does not.  Otherwise I would expect you to first get a message about the table not existing, instead of the column purchaseID.</p>
<p>If using the simulator I suggest you clear all previous data using menu iOS Simulator &gt; Reset Content and Settings.  Then reinstall and run your project again.  Make sure you use Ti.Database.install instead of open, if you are trying to use a predefined database from your resources folder.</p>
<p>If you are creating the table in your code, make sure you are adding the purchaseID column with the exact same spelling.</p>
<p>The last error (deckInfo) suggests you are not getting a result set at all (even an empty one) which leads me to believe the table called &quot;decks&quot; does not exist in the database.  This could again be attributed to using an old version of your database and not the one you think you are using.</p>
<p>You also asked if you can view the database in real time.  Yes and no.  Sqlite is not renowned for handling concurrent users well.  So when I want to do this, I get a program to a breakpoint (or at least a pause in activity) I open the database using the Firefox SQLite Manager, examine or change what I want, then close it again before resuming activity in the simulator.</p>
<p>Whatever tool you use (I use Firefox SQLite Manager plugin), the database will be located at a path similar to:</p>
<p>&#x2F;Users&#x2F;(username)&#x2F;Library&#x2F;Application Support&#x2F;iPhone Simulator&#x2F;(4.x.x)&#x2F;Applications&#x2F;<br>(app id)&#x2F;Library&#x2F;Application Support&#x2F;database&#x2F;dbname.sql</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 19th 2011, 4:02:35 pm">August 19th 2011</span>
								by <span class='authorname'>Doug Handy</span><br>
								<a class="icon-bg icon-link" href="question/124499/database-crashing#answer-216971" rel="permalink">permalink</a>
							</div>

							<h5>15 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for the tip about reading the database. That told me that my database is being structured perfectly. I cleared all the data and tried again, and I&#39;m still getting an error with deckInfo. I am calling it correct too in the database. </p>
<p>If I have a complicated app, and I make a lot of db queries throughout the app, is it best practice to wrap each request in an opening and closing of the database? Or should I open at the top and close at the bottom of the page?</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 2:41:21 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>This is part of the error I am now getting that I open and close the db with every query:</p>
<pre><code class="hljs">* <span class="hljs-type">Terminating</span> app due to uncaught exception '<span class="hljs-type">PLSqliteException</span>', reason: '<span class="hljs-type">Attempt</span> to access already-closed <span class="hljs-literal">result</span> <span class="hljs-type">set</span>.'

*** <span class="hljs-type">Call</span> stack at first throw:

(

    <span class="hljs-number">0</span>   <span class="hljs-type">CoreFoundation</span>                      <span class="hljs-number">0x022cf5a9</span> __exceptionPreprocess + <span class="hljs-number">185</span>

    <span class="hljs-number">1</span>   libobjc.A.dylib                     <span class="hljs-number">0x02423313</span> objc_exception_throw + <span class="hljs-number">44</span>

    <span class="hljs-number">2</span>   <span class="hljs-type">CoreFoundation</span>                      <span class="hljs-number">0x02287ef8</span> +[<span class="hljs-type">NSException</span> <span class="hljs-keyword">raise</span>:format:arguments:] + <span class="hljs-number">136</span>

    <span class="hljs-number">3</span>   <span class="hljs-type">CoreFoundation</span>                      <span class="hljs-number">0x02287e6a</span> +[<span class="hljs-type">NSException</span> <span class="hljs-keyword">raise</span>:format:] + <span class="hljs-number">58</span>

    <span class="hljs-number">4</span>   <span class="hljs-type">Flashcards</span>+                         <span class="hljs-number">0x00031c05</span> -[<span class="hljs-type">PLSqliteResultSet</span> assertNotClosed] + <span class="hljs-number">101</span>

    <span class="hljs-number">5</span>   <span class="hljs-type">Flashcards</span>+                         <span class="hljs-number">0x00031e8f</span> -[<span class="hljs-type">PLSqliteResultSet</span> columnIndexForName:] + <span class="hljs-number">63</span>
</code></pre><p>Does that mean I&#39;m closing something too early, or not closing it? I see both…</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 2:46:06 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think &quot;best practice&quot; is dependent on the application, logic, and frequency of use.  In my database-intensive applications where there is near constant use of the databases, I open them once and leave them open until I close the app.  The exception being databases that I refresh from a server.  In that case, I close the database prior to my XHR download so that I can replace the database when the download &#x2F; unzip is complete, and open the database again.</p>
<p>In less database centric apps, I may opt to open and close a DB as needed.</p>
<p>Unlike some database systems, in SQLite, the open&#x2F;close operations don&#39;t seem very &quot;expensive&quot; from a performance standpoint.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 2:50:45 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That error means your <strong>result set</strong> has been closed and should no longer be accessed.  That is different than the <strong>database</strong> being closed.  In your original post, it is the lines such as <code>rows.close()</code> and <code>deckInfo.close()</code>.</p>
<p>Once you have closed a <strong>result set</strong>, you should never reference it again until you do another SELECT.</p>
<p>If this isn&#39;t enough to help you isolate the problem, we should really have more complete code.  If it is too long to post inline, push it out to another site and provide a link for us.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 2:54:41 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks!</p>
<p>Alright, here is a more complete code segment. If I remove the function&#39;s contents, it works:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func1</span>(<span class="hljs-params">e</span>)</span>{
    <span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> data = [];
    cardSet = e;




    <span class="hljs-keyword">while</span> (cardSet.isValidRow()) {






        <span class="hljs-keyword">var</span> row = Ti.UI.createTableViewRow({
            height: <span class="hljs-number">45</span>,
            side1:cardSet.fieldByName(<span class="hljs-string">'first'</span>),
            id:cardSet.fieldByName(<span class="hljs-string">'id'</span>),
            deckID:cardSet.fieldByName(<span class="hljs-string">'deckID'</span>),
            cardNumb: c,
            hasChild: <span class="hljs-literal">true</span>
        });




        data.push(row);

    c++;

        cardSet.next();
    }
    deckCardCount = c;
    deckCardCount = <span class="hljs-built_in">parseFloat</span>(deckCardCount);
    card_list.setData(data,{animated:<span class="hljs-literal">true</span>});
}

btn.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{

        <span class="hljs-keyword">var</span> db = Titanium.Database.open(<span class="hljs-string">'database'</span>);
        <span class="hljs-keyword">var</span> knownSet = execute(<span class="hljs-string">'SELECT * FROM cards WHERE know = ? AND deckID = ?'</span>,<span class="hljs-string">'true'</span>,win.deckID);
        func1(knownSet);
        knownSet.close();
        db.close();
});
</code></pre><p>I pass knownSet to cardSet. I tried putting in a cardSet close thing, but this doesn&#39;t work either. Is it because I close KnownSet the line after?</p>
<p>Please let me know if you need more, I really appreciate your help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 3:09:16 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It still isn&#39;t clear (to me) when which error you are talking about (the &quot;Attempt to access already-closed result set&quot; perhaps?) or on which line of code it occurs.  On the <code>while (cardSet.isValidRow()) {</code> line??</p>
<p>If you set a breakpoint on the <code>cardSet = e;</code> line of code, what does the debugger list as the value or object type of e?</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 4:12:42 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It&#39;s an [Object TiDatabaseResultSet].</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 4:38:40 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That is good.  Then if you step through the code, at what point do you get the error message about the result set being closed?  If that is the error message we are even talking about here…</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 4:40:52 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think it is, but I think with my app it&#39;s a lot easier just to open the database and then close it when the app is exited. Does that mean that I just have a db open function in my app.js file? Do I need to close it somewhere?</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:21:37 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes, you should close it using something like this (in this example, &quot;db&quot; would be the name of your global variable from the database open):</p>
<pre><code class="hljs">Ti.<span class="hljs-keyword">App</span>.addEventListener('<span class="hljs-keyword">close</span>', function(<span class="hljs-keyword">e</span>) {
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">db</span> ) {
        <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
    }
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:32:15 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>All right, I tried opening the database via app.js, but then it can&#39;t find the variable db anywhere in the app when I use it. Do I have to open it some special way?</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:33:27 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Because right now, I have it being opened in my app.js file then I load everything else in a new window.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:45:13 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Are you using a single context style application (where windows are opened withOUT the url property), or a multiple context style (where windows are opened WITH the url property).</p>
<p>When using the url property, each window runs in its own thread and does not have direct access to globals from the app.js context.  So I am guessing you are using the url property based on your new question?</p>
<p>If you are, then you will either need to open and close the db in each window (e.g. with window &#39;open&#39; and &#39;close&#39; event listeners), or you need to pass the app.js db property to each window as a custom property when you create the window itself:</p>
<pre><code class="hljs"><span class="hljs-comment">// in app.js:</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Ti.Database.<span class="hljs-keyword">open</span>('database');

<span class="hljs-comment">// when creating new windows:</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> newWin</span> = Ti.UI.createWindow({
    (all the other properties you want),
    myDB: db
});

<span class="hljs-comment">// in all your other *.js files:</span>
<span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Ti.UI.currentWindow.myDB;
</code></pre><p>I third option that &quot;works&quot; for now is to pollute the Ti.App namespace:</p>
<pre><code class="hljs"><span class="hljs-comment">// in app.js</span>
<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.<span class="hljs-keyword">open</span>('database');
Ti.<span class="hljs-keyword">App</span>.myDB = <span class="hljs-keyword">db</span>;

<span class="hljs-comment">// in other contexts:</span>
<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.<span class="hljs-keyword">App</span>.myDB;
</code></pre><p>However, I discourage this method because:</p>
<ul>
<li>If you use a name (myDB here) which gets used by Titanium in a later SDK you will run into problems</li>
<li>Polluting the Ti.App namespace is frowned upon in general</li>
<li>Appcelerator has warned this technique is likely to break in a future SDK even if you don&#39;t have a name collision</li>
</ul>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:50:35 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Actually, not sure you can use <code>currentWindow.myDB</code> it may need to be:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">win</span> = Ti.UI.currentWindow();
<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = <span class="hljs-keyword">win</span>.myDB;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:53:03 pm">August 20th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That&#39;s the method I&#39;m using. All right, let me try that and see if it makes the application work again. Thanks!</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 20th 2011, 5:57:02 pm">August 20th 2011</span>
											by <span class='authorname'>Connor Zwick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
