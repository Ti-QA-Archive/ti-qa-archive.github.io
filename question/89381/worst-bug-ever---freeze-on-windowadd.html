<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Worst bug ever - Freeze on window.add » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Worst bug ever - Freeze on window.add</h1>
		</header>
		<section>
			<p>Hello,</p>
<p>First, I&#39;d like to say Titanium IS great stuff to develop mobile app.</p>
<p>However, after 2 weeks spend on a big project, I am now stuck on a dangerous bug.</p>
<p>Basically, I am doing this :<br>a tabgroup with 5 windows<br>first window : I add a view</p>
<p>this.myView = Titanium.UI.createView({<br>        width:600,<br>        height:480,<br>        right:180,<br>        left:100,<br>        zIndex:0<br>        });</p>
<p>I call a webservice, get objects (using javascript prototype to create inheritance).<br>I populate an array with 5 elements.</p>
<p>And here comes the bug in the callback function after my webservice :</p>
<p>for (i = 0; i &lt; this.myArray.length; i++)<br>{<br>  this.myView.add(this.myArray[i].imageView);<br>}</p>
<p>This codes works the 2 or 3 first time I call the webservice, max 10 times, but it freezes my app (on Simulator). On the device it happens randomly but only when I open other views in my app and toy a bit with it.</p>
<p>I tried to put Ti.API.info(&quot;WTF is happening&quot;) ?<br>And I found this &quot;add&quot; is the problem.<br>Try catch doesn&#39;t work.<br>I can&#39;t understand what&#39;s happening.</p>
<p>When I display the freememory, I get :<br>between 9.xxxx and 30.xxxx</p>
<p>Thanks for reading this !<br>Any help is welcome.<br>Best regards.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 14th 2010, 2:13:27 pm">December 14th 2010</span>
				by <span class='authorname'>Thomas Bullier</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>add</span></li>
					
						<li><span class='tagname'>freeze</span></li>
					
						<li><span class='tagname'>window</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I meant view.add ofc.</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 14th 2010, 2:14:39 pm">December 14th 2010</span>
								by <span class='authorname'>Thomas Bullier</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Same bug happens using instead of my objects :</p>
<p>var newImageView = Titanium.UI.createImageView({<br>            image:null,<br>            height:120,<br>            width:120,<br>            left:250,<br>            top:200<br>        });</p>
<p>After 10 or 15 or so, the following code stops at ADD BEFORE :<br>Ti.API.info(&quot;ADD BEFORE&quot;);<br>this.myView.add(newImageView);<br>Ti.API.info(&quot;ADD OK AFTER&quot;);</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 14th 2010, 2:22:34 pm">December 14th 2010</span>
								by <span class='authorname'>Thomas Bullier</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>8</span> Votes</div>
			<div class="answers"><span>8</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>8 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-160631">
				
						<section>
							<p>any update on solution?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 14th 2010, 2:26:25 pm">December 14th 2010</span>
								by <span class='authorname'>Peter Lum</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-160631" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>The more I use variables, the sooner the freeze comes …<br>I believe I am using too much memory and eventlisteners for the app to run smoothly.<br>Or it is just because I use &quot;add&quot; more times in subviews …<br>I&#39;ll try to google for best practice about javascript…<br>Still no idea at all …</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2010, 2:42:31 pm">December 14th 2010</span>
											by <span class='authorname'>Thomas Bullier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>same Problem here ! sometimes it works and sometimes it does not work (Strange!)</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2010, 2:50:17 pm">December 14th 2010</span>
											by <span class='authorname'>Hansjuerg Wuethrich</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Its not strange, its A-W-F-U-L … I hate those kind of bugs when you can&#39;t know how to reproduce it, and why it happens …</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2010, 2:59:22 pm">December 14th 2010</span>
											by <span class='authorname'>Thomas Bullier</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-163061">
				
						<section>
							<p>this.myView.open() was called before some add() … thus the freeze.</p>
<p>My bad.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 16th 2010, 10:07:03 am">December 16th 2010</span>
								by <span class='authorname'>Thomas Bullier</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-163061" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-163521">
				
						<section>
							<p>Hey guys,</p>
<p>Sorry this is not an answer, but I want to make sure you get the mail.  We&#39;ll need more information and a test case to reproduce before we can help - from the code fragments here it&#39;s unclear what is happening.  Shoot a mail to community@appcelerator.com with a test case we can run to reproduce.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 16th 2010, 4:22:37 pm">December 16th 2010</span>
								by <span class='authorname'>Kevin Whinnery</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-163521" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for the response.</p>
<p>I&#39;ll try to make a short test to reproduce this freeze.</p>
<p>You can try the following :<br>Make a view<br>Make an ImageView (or a label …)<br>Open the view<br>Add the imageView to the view</p>
<p>Whereas :<br>Make a view<br>Make an ImageView<br>Add the imageView to the view<br>Open the view<br>&gt;&gt;&gt; works fine.</p>
<p>I&#39;m not sure that this simple test would fail. I&#39;ll try it tomorrow.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2010, 4:49:57 pm">December 16th 2010</span>
											by <span class='authorname'>Thomas Bullier</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-165871">
				
						<section>
							<p>I&#39;m having the same issue with my mobile application on iPhone Simulator.<br>I just stripped everything out and created a sample here: http:&#x2F;&#x2F;dl.dropbox.com&#x2F;u&#x2F;13696999&#x2F;freeze-test.zip</p>
<p>It will start adding views and you can click on them and hide them. After a while the app will just freeze before doing a: win.add(view);</p>
<p>I&#39;m using Titanium Developer 1.2.2 with SDK 1.5.1<br>Mac OSX 10.6.5</p>
<p>Last message I get before it freezes:<br>before memory : 1387.8515625 - total: 131 - clicked: 68<br>Sometimes it freezes before that, but usually it freezes around 120.</p>
<p>Try clicking quickly on the blocks too.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 20th 2010, 1:04:09 pm">December 20th 2010</span>
								by <span class='authorname'>Daniel Tome</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-165871" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I <a href="https:&#x2F;&#x2F;appcelerator.lighthouseapp.com&#x2F;projects&#x2F;32238-titanium-mobile&#x2F;tickets&#x2F;2630-iphone-freeze-after-a-certain-number-of-child-views-added">filed a ticket here</a> to gain some clarification on whether or not this is a bug that can be addressed, or if we need to educate folks on what is allowed WRT to maximum number of child views added, memory management, etc.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 2:11:00 pm">December 20th 2010</span>
											by <span class='authorname'>Kevin Whinnery</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-223127">
				
						<section>
							<p>Have you checked the length of your array before it hits the for loop? If your array length is NaN you&#39;ll go into a bit of an endless loop.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 11th 2011, 3:10:39 pm">November 11th 2011</span>
								by <span class='authorname'>Boydlee Pollentine</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-223127" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-228249">
				
						<section>
							<p>Is there any solution to this problem? I&#39;m having problem when I add labels and buttons dynamic to a scrollview like this.</p>
<pre><code class="hljs"><span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">artNoLabel</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">prodTitleLabel</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">priceLabel</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">amountLabel</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">sumLabel</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">changeButton</span><span class="hljs-attr_selector">[id]</span>);
<span class="hljs-tag">scrollView</span><span class="hljs-class">.add</span>(<span class="hljs-tag">deleteButton</span><span class="hljs-attr_selector">[id]</span>);
</code></pre><p>Sometimes, not always, it just freeze in one of those lines. No error message what so ever.</p>
<p>&#x2F;&#x2F;Henrik</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 23rd 2012, 5:20:13 am">January 23rd 2012</span>
								by <span class='authorname'>Henrik Andersson</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-228249" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-162011">
				
						<section>
							<p>this.acceptButton = Ti.UI.createButton({<br>        backgroundImage: this.acceptButtonImage,<br>        bottom:90,<br>        width:220,<br>        height:29<br>            });<br>        Ti.API.info(&quot;before accept button &quot; + this.acceptButton);<br>            this.myWindow.add(this.acceptButton);<br>        Ti.API.info(&quot;add accept button&quot;);</p>
<p>Same freeze at add …</p>
<p>I start my app, get to this code, and nothing, just a freeze and no &quot;add accept button&quot; … -_-</p>
<p>I&#39;m crying :&#39;&#x2F;</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 15th 2010, 1:27:58 pm">December 15th 2010</span>
								by <span class='authorname'>Thomas Bullier</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-162011" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I&#39;m sure the guys from Appcelerator Titanium will fix it ! The support is one of the best i ever seen ! Thank you !! btw: i have the same problem :-&#x2F;</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2010, 4:40:22 pm">December 16th 2010</span>
											by <span class='authorname'>Hansjuerg Wuethrich</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-166001">
				
						<section>
							<p>I had the same problem looping adding images to a view that had already been opened.</p>
<p>I solved this by defering the .add() untill after the loop had finished using a library called Underscore.js You could also ues a simple setInterval(); </p>
<p>The Underscore.js library works well with Titanium as it has no DOM calls.</p>
<p><strong>_.defer(function)</strong><br>Defers invoking the function until the current call stack has cleared, similar to using setTimeout with a delay of 0. Useful for performing expensive computations or HTML rendering in chunks without blocking the UI thread from updating.</p>
<pre><code class="hljs">Titanium.<span class="hljs-keyword">include</span>(<span class="hljs-string">'Underscore.js'</span>);

<span class="hljs-comment">// ... </span>

<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">this</span>; 
<span class="hljs-keyword">var</span> len = obj.myArray.length;

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) { 
    _.defer(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{ obj.myView.add(obj.myArray[i].imageView; });
}

<span class="hljs-comment">// ...</span>
</code></pre><p>note &#39;i&#39; is diffrent for each deffered call and each value of i is remembered until the calls return using javascript <a href="http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;111102&#x2F;how-does-a-javascript-closure-work">closures</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 20th 2010, 3:49:35 pm">December 20th 2010</span>
								by <span class='authorname'>Tom Campbell</span><br>
								<a class="icon-bg icon-link" href="question/89381/worst-bug-ever---freeze-on-windowadd.html#answer-166001" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Useful link http:&#x2F;&#x2F;documentcloud.github.com&#x2F;underscore&#x2F;</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 3:51:37 pm">December 20th 2010</span>
											by <span class='authorname'>Tom Campbell</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Your i variable is in the global scope, not a closure, so you will have an issue.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 22nd 2011, 2:35:14 am">November 22nd 2011</span>
											by <span class='authorname'>g b</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
