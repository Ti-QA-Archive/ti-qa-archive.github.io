<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>gps is not working » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>gps is not working</h1>
		</header>
		<section>
			<p>The code i am writing for the geolocation is same as given in the kitchen sink example. But i can not get the output on my android phone. Can any buddy help me??</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 16th 2011, 6:42:51 am">November 16th 2011</span>
				by <span class='authorname'>mayuri vaidya</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>gps</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>There is very large scope here to know what is actually the issue.</p>
<p>From what you have put it will be very difficult to gain an insight into the problem.</p>
<p>Can you please post some code if it is a lot use gitpaste …</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 16th 2011, 7:55:14 am">November 16th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-223486">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi<br>First of all I hope you not trying to get the GPS location from the emulator if yes then try to set it from the DDMS tool for the android.<br>Well let me share my all time favorite code which works for both Iphone and android.<br>Write this code on app.js or any window which you open first.</p>
<pre><code class="hljs"><span class="hljs-comment">//Global variables for geolocation data.</span>
Ti.<span class="hljs-keyword">App</span>.glbGeoData = {
    _curLatitude:<span class="hljs-string">"1"</span>,
    _curLongitude:<span class="hljs-string">"1"</span>
};

<span class="hljs-comment">//GPS settings</span>
Titanium.Geolocation.purpose = <span class="hljs-string">"For GPS Application"</span>;
Titanium.Geolocation.distanceFilter = 100; <span class="hljs-comment">// set the granularity of the location event</span>

Titanium.Geolocation.getCurrentPosition(function(<span class="hljs-keyword">e</span>)
{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>)
    {
        <span class="hljs-comment">// manage the error</span>
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">var</span> longitude = <span class="hljs-keyword">e</span>.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = <span class="hljs-keyword">e</span>.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = <span class="hljs-keyword">e</span>.coords.altitude;
    <span class="hljs-keyword">var</span> heading = <span class="hljs-keyword">e</span>.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = <span class="hljs-keyword">e</span>.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = <span class="hljs-keyword">e</span>.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = <span class="hljs-keyword">e</span>.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = <span class="hljs-keyword">e</span>.coords.altitudeAccuracy;

<span class="hljs-comment">//     Ti.API.info("$$$ current positin -- - - - - -- - - -" + latitude);</span>

    <span class="hljs-comment">// we use the above data the way we need it</span>
    Ti.<span class="hljs-keyword">App</span>.glbGeoData = {_curLatitude:latitude, _curLongitude:longitude};
});

Titanium.Geolocation.addEventListener('location',function(<span class="hljs-keyword">e</span>)
{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>)
    {
        <span class="hljs-comment">// manage the error</span>
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">var</span> longitude = <span class="hljs-keyword">e</span>.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = <span class="hljs-keyword">e</span>.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = <span class="hljs-keyword">e</span>.coords.altitude;
    <span class="hljs-keyword">var</span> heading = <span class="hljs-keyword">e</span>.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = <span class="hljs-keyword">e</span>.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = <span class="hljs-keyword">e</span>.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = <span class="hljs-keyword">e</span>.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = <span class="hljs-keyword">e</span>.coords.altitudeAccuracy;

    <span class="hljs-comment">// again we use the gathered data.</span>
    Ti.<span class="hljs-keyword">App</span>.glbGeoData = {_curLatitude:latitude, _curLongitude:longitude};
});
</code></pre><p>This will save the GPS co-ordinates then to get access to co-ordinate you can use this below line of code.</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> latitude</span> = Ti.App.glbGeoData._curLatitude;
<span class="hljs-variable"><span class="hljs-keyword">var</span> longitude</span> = Ti.App.glbGeoData._curLongitude;
<span class="hljs-variable"><span class="hljs-keyword">var</span> uDistance</span> = Titanium.Geolocation.distanceFilter;

Ti.API.info(<span class="hljs-string">"latitude - "</span> + latitude);
Ti.API.info(<span class="hljs-string">"longitude - "</span> + longitude);
Ti.API.info(<span class="hljs-string">"uDistance - "</span> + uDistance);
</code></pre><p>If you still face the problem then share with us.</p>
<p>Regards<br>Nikunj sakhrelia</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 16th 2011, 8:44:45 am">November 16th 2011</span>
								by <span class='authorname'>Nikunj Sakhrelia</span><br>
								<a class="icon-bg icon-link" href="question/128285/gps-is-not-working#answer-223486" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thank you Nikunj. I will try this.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2011, 3:17:50 am">November 18th 2011</span>
											by <span class='authorname'>mayuri vaidya</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi nikunj, i have used this code but do not get any result. whai i want to do is, get the current location of the user and give the distance of nearest hospital and cinema and garden. would you please help me?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2011, 3:48:34 am">November 18th 2011</span>
											by <span class='authorname'>mayuri vaidya</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi </p>
<p>Can you share what you getting in the response, and are you testing the code on emulator. I have worked the similar kind of many app so this code works on all so you better tell me what you get in the logs.</p>
<p>Regards</p>
<p>Nikunj</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2011, 4:29:08 am">November 18th 2011</span>
											by <span class='authorname'>Nikunj Sakhrelia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi nikunj,<br>I am testing this code on emulator and my android phone too.<br>My mobile&#39;s screen is blank when i run this code on it.<br>can u tell me which kind of output may i get?<br>this is my first app. :-)</p>
<p>thank you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2011, 5:08:17 am">November 18th 2011</span>
											by <span class='authorname'>mayuri vaidya</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi</p>
<p>As we are not displaying any thing on label or text so you may not able to see it on screen, Check in your logs from the titanium studio </p>
<p>I have used the below line of code to display that in the log.</p>
<pre><code class="hljs"><span class="hljs-tag">Ti</span><span class="hljs-class">.API</span><span class="hljs-class">.info</span>("<span class="hljs-tag">latitude</span> <span class="hljs-tag">-</span> " + <span class="hljs-tag">latitude</span>);
<span class="hljs-tag">Ti</span><span class="hljs-class">.API</span><span class="hljs-class">.info</span>("<span class="hljs-tag">longitude</span> <span class="hljs-tag">-</span> " + <span class="hljs-tag">longitude</span>);
<span class="hljs-tag">Ti</span><span class="hljs-class">.API</span><span class="hljs-class">.info</span>("<span class="hljs-tag">uDistance</span> <span class="hljs-tag">-</span> " + <span class="hljs-tag">uDistance</span>);
</code></pre><p>the variable latitude, longitude and UDistance has the value in it so you can use that variable in your app where you want to display it, Try to show this field any label.</p>
<p>Regards</p>
<p>Nikunj</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 18th 2011, 5:28:33 am">November 18th 2011</span>
											by <span class='authorname'>Nikunj Sakhrelia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-223484">
				
						<section>
							<p>hi trevor</p>
<p>here i am giving the code. i just dont understand what to do.</p>
<p>var win = Ti.UI.createWindow();</p>
<p>Ti.include(&quot;version.js&quot;);</p>
<p>Ti.Geolocation.preferredProvider = &quot;gps&quot;;</p>
<p>if (isIPhone3_2_Plus())<br>{<br>    &#x2F;&#x2F;NOTE: starting in 3.2+, you&#39;ll need to set the applications<br>    &#x2F;&#x2F;purpose property for using Location services on iPhone<br>    Ti.Geolocation.purpose = &quot;GPS demo&quot;;<br>}</p>
<p>function translateErrorCode(code) {<br>    if (code == null) {<br>        return null;<br>    }<br>    switch (code) {<br>        case Ti.Geolocation.ERROR_LOCATION_UNKNOWN:<br>            return &quot;Location unknown&quot;;<br>        case Ti.Geolocation.ERROR_DENIED:<br>            return &quot;Access denied&quot;;<br>        case Ti.Geolocation.ERROR_NETWORK:<br>            return &quot;Network error&quot;;<br>        case Ti.Geolocation.ERROR_HEADING_FAILURE:<br>            return &quot;Failure to detect heading&quot;;<br>        case Ti.Geolocation.ERROR_REGION_MONITORING_DENIED:<br>            return &quot;Region monitoring access denied&quot;;<br>        case Ti.Geolocation.ERROR_REGION_MONITORING_FAILURE:<br>            return &quot;Region monitoring access failure&quot;;<br>        case Ti.Geolocation.ERROR_REGION_MONITORING_DELAYED:<br>            return &quot;Region monitoring setup delayed&quot;;<br>    }<br>}</p>
<p>var currentHeadingLabel = Titanium.UI.createLabel({<br>    text:&#39;Current Heading (One Shot)&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:10,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(currentHeadingLabel);<br>var currentHeading = Titanium.UI.createLabel({<br>    text:&#39;Updated Heading not fired&#39;,<br>    font:{fontSize:12},<br>    color:&#39;#444&#39;,<br>    top:30,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(currentHeading);</p>
<p>var updatedHeadingLabel = Titanium.UI.createLabel({<br>    text:&#39;Updated Heading&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:50,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedHeadingLabel);</p>
<p>var updatedHeading = Titanium.UI.createLabel({<br>    text:&#39;Updated Heading not fired&#39;,<br>    font:{fontSize:12},<br>    color:&#39;#444&#39;,<br>    top:70,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedHeading);</p>
<p>var updatedHeadingTime = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:90,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedHeadingTime);</p>
<p>var currentLocationLabel = Titanium.UI.createLabel({<br>    text:&#39;Current Location (One Shot)&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:110,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(currentLocationLabel);</p>
<p>var currentLocation = Titanium.UI.createLabel({<br>    text:&#39;Current Location not fired&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:130,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(currentLocation);</p>
<p>var updatedLocationLabel = Titanium.UI.createLabel({<br>    text:&#39;Updated Location&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:150,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedLocationLabel);</p>
<p>var updatedLocation = Titanium.UI.createLabel({<br>    text:&#39;Updated Location not fired&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:170,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedLocation);</p>
<p>var updatedLatitude = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:190,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedLatitude);</p>
<p>var updatedLocationAccuracy = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:210,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedLocationAccuracy);</p>
<p>var updatedLocationTime = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:230,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(updatedLocationTime);</p>
<p>var forwardGeoLabel = Titanium.UI.createLabel({<br>    text:&#39;Forward Geo (Addr-&gt;Coords)&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:250,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(forwardGeoLabel);</p>
<p>var forwardGeo = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:270,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(forwardGeo);</p>
<p>var reverseGeoLabel = Titanium.UI.createLabel({<br>    text:&#39;Reverse Geo (Coords-&gt;Addr)&#39;,<br>    font:{fontSize:12, fontWeight:&#39;bold&#39;},<br>    color:&#39;#111&#39;,<br>    top:290,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(reverseGeoLabel);</p>
<p>var reverseGeo = Titanium.UI.createLabel({<br>    text:&#39;&#39;,<br>    font:{fontSize:11},<br>    color:&#39;#444&#39;,<br>    top:310,<br>    left:10,<br>    height:15,<br>    width:300<br>});<br>win.add(reverseGeo);</p>
<p>&#x2F;&#x2F; state vars used by resume&#x2F;pause<br>var headingAdded = false;<br>var locationAdded = false;</p>
<p>&#x2F;&#x2F;<br>&#x2F;&#x2F;  SHOW CUSTOM ALERT IF DEVICE HAS GEO TURNED OFF<br>&#x2F;&#x2F;<br>if (Titanium.Geolocation.locationServicesEnabled === false)<br>{<br>    Titanium.UI.createAlertDialog({title:&#39;Kitchen Sink&#39;, message:&#39;Your device has geo turned off - turn it on.&#39;}).show();<br>}<br>else<br>{<br>    if (Titanium.Platform.name != &#39;android&#39;) {<br>        var authorization = Titanium.Geolocation.locationServicesAuthorization;<br>        Ti.API.info(&#39;Authorization: &#39;+authorization);<br>        if (authorization == Titanium.Geolocation.AUTHORIZATION_DENIED) {<br>            Ti.UI.createAlertDialog({<br>                title:&#39;Kitchen Sink&#39;,<br>                message:&#39;You have disallowed Titanium from running geolocation services.&#39;<br>            }).show();<br>        }<br>        else if (authorization == Titanium.Geolocation.AUTHORIZATION_RESTRICTED) {<br>            Ti.UI.createAlertDialog({<br>                title:&#39;Kitchen Sink&#39;,<br>                message:&#39;Your system has disallowed Titanium from running geolocation services.&#39;<br>            }).show();<br>        }<br>    }</p>
<pre><code class="hljs"><span class="hljs-comment">//</span>
<span class="hljs-comment">// IF WE HAVE COMPASS GET THE HEADING</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">if</span> (Titanium.Geolocation.hasCompass)
{
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">//  TURN OFF ANNOYING COMPASS INTERFERENCE MESSAGE</span>
    <span class="hljs-comment">//</span>
    Titanium.Geolocation.showCalibration = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// SET THE HEADING FILTER (THIS IS IN DEGREES OF ANGLE CHANGE)</span>
    <span class="hljs-comment">// EVENT WON'T FIRE UNLESS ANGLE CHANGE EXCEEDS THIS VALUE</span>
    Titanium.Geolocation.headingFilter = <span class="hljs-number">90</span>;

    <span class="hljs-comment">//</span>
    <span class="hljs-comment">//  GET CURRENT HEADING - THIS FIRES ONCE</span>
    <span class="hljs-comment">//</span>
    Ti.Geolocation.getCurrentHeading(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
    </span>{
        <span class="hljs-keyword">if</span> (e.error)
        {
            currentHeading.text = <span class="hljs-string">'error: '</span> + e.error;
            Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(e.code));
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">var</span> x = e.heading.x;
        <span class="hljs-keyword">var</span> y = e.heading.y;
        <span class="hljs-keyword">var</span> z = e.heading.z;
        <span class="hljs-keyword">var</span> magneticHeading = e.heading.magneticHeading;
        <span class="hljs-keyword">var</span> accuracy = e.heading.accuracy;
        <span class="hljs-keyword">var</span> trueHeading = e.heading.trueHeading;
        <span class="hljs-keyword">var</span> timestamp = e.heading.timestamp;

        currentHeading.text = <span class="hljs-string">'x:'</span> + x + <span class="hljs-string">' y: '</span> + y + <span class="hljs-string">' z:'</span> + z;
        Titanium.API.info(<span class="hljs-string">'geo - current heading: '</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp) + <span class="hljs-string">' x '</span> + x + <span class="hljs-string">' y '</span> + y + <span class="hljs-string">' z '</span> + z);
    });

    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// EVENT LISTENER FOR COMPASS EVENTS - THIS WILL FIRE REPEATEDLY (BASED ON HEADING FILTER)</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-keyword">var</span> headingCallback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
    </span>{
        <span class="hljs-keyword">if</span> (e.error)
        {
            updatedHeading.text = <span class="hljs-string">'error: '</span> + e.error;
            Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(e.code));
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">var</span> x = e.heading.x;
        <span class="hljs-keyword">var</span> y = e.heading.y;
        <span class="hljs-keyword">var</span> z = e.heading.z;
        <span class="hljs-keyword">var</span> magneticHeading = e.heading.magneticHeading;
        <span class="hljs-keyword">var</span> accuracy = e.heading.accuracy;
        <span class="hljs-keyword">var</span> trueHeading = e.heading.trueHeading;
        <span class="hljs-keyword">var</span> timestamp = e.heading.timestamp;

        updatedHeading.text = <span class="hljs-string">'x:'</span> + x + <span class="hljs-string">' y: '</span> + y + <span class="hljs-string">' z:'</span> + z;
        updatedHeadingTime.text = <span class="hljs-string">'timestamp:'</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp);
        updatedHeading.color = <span class="hljs-string">'red'</span>;
        updatedHeadingTime.color = <span class="hljs-string">'red'</span>;
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
        </span>{
            updatedHeading.color = <span class="hljs-string">'#444'</span>;
            updatedHeadingTime.color = <span class="hljs-string">'#444'</span>;

        },<span class="hljs-number">100</span>);

        Titanium.API.info(<span class="hljs-string">'geo - heading updated: '</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp) + <span class="hljs-string">' x '</span> + x + <span class="hljs-string">' y '</span> + y + <span class="hljs-string">' z '</span> + z);
    };
    Titanium.Geolocation.addEventListener(<span class="hljs-string">'heading'</span>, headingCallback);
    headingAdded = <span class="hljs-literal">true</span>;
}
<span class="hljs-keyword">else</span>
{
    Titanium.API.info(<span class="hljs-string">"No Compass on device"</span>);
    currentHeading.text = <span class="hljs-string">'No compass available'</span>;
    updatedHeading.text = <span class="hljs-string">'No compass available'</span>;
}

<span class="hljs-comment">//</span>
<span class="hljs-comment">//  SET ACCURACY - THE FOLLOWING VALUES ARE SUPPORTED</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// Titanium.Geolocation.ACCURACY_BEST</span>
<span class="hljs-comment">// Titanium.Geolocation.ACCURACY_NEAREST_TEN_METERS</span>
<span class="hljs-comment">// Titanium.Geolocation.ACCURACY_HUNDRED_METERS</span>
<span class="hljs-comment">// Titanium.Geolocation.ACCURACY_KILOMETER</span>
<span class="hljs-comment">// Titanium.Geolocation.ACCURACY_THREE_KILOMETERS</span>
<span class="hljs-comment">//</span>
Titanium.Geolocation.accuracy = Titanium.Geolocation.ACCURACY_BEST;

<span class="hljs-comment">//</span>
<span class="hljs-comment">//  SET DISTANCE FILTER.  THIS DICTATES HOW OFTEN AN EVENT FIRES BASED ON THE DISTANCE THE DEVICE MOVES</span>
<span class="hljs-comment">//  THIS VALUE IS IN METERS</span>
<span class="hljs-comment">//</span>
Titanium.Geolocation.distanceFilter = <span class="hljs-number">10</span>;

<span class="hljs-comment">//</span>
<span class="hljs-comment">// GET CURRENT POSITION - THIS FIRES ONCE</span>
<span class="hljs-comment">//</span>
Titanium.Geolocation.getCurrentPosition(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
</span>{
    <span class="hljs-keyword">if</span> (!e.success || e.error)
    {
        currentLocation.text = <span class="hljs-string">'error: '</span> + <span class="hljs-built_in">JSON</span>.stringify(e.error);
        Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(e.code));
        alert(<span class="hljs-string">'error '</span> + <span class="hljs-built_in">JSON</span>.stringify(e.error));
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">var</span> longitude = e.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = e.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = e.coords.altitude;
    <span class="hljs-keyword">var</span> heading = e.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = e.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = e.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = e.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = e.coords.altitudeAccuracy;
    Ti.API.info(<span class="hljs-string">'speed '</span> + speed);
    currentLocation.text = <span class="hljs-string">'long:'</span> + longitude + <span class="hljs-string">' lat: '</span> + latitude;

    Titanium.API.info(<span class="hljs-string">'geo - current location: '</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp) + <span class="hljs-string">' long '</span> + longitude + <span class="hljs-string">' lat '</span> + latitude + <span class="hljs-string">' accuracy '</span> + accuracy);
});

<span class="hljs-comment">//</span>
<span class="hljs-comment">// EVENT LISTENER FOR GEO EVENTS - THIS WILL FIRE REPEATEDLY (BASED ON DISTANCE FILTER)</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">var</span> locationCallback = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
</span>{
    <span class="hljs-keyword">if</span> (!e.success || e.error)
    {
        updatedLocation.text = <span class="hljs-string">'error:'</span> + <span class="hljs-built_in">JSON</span>.stringify(e.error);
        updatedLatitude.text = <span class="hljs-string">''</span>;
        updatedLocationAccuracy.text = <span class="hljs-string">''</span>;
        updatedLocationTime.text = <span class="hljs-string">''</span>;
        Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(e.code));
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">var</span> longitude = e.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = e.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = e.coords.altitude;
    <span class="hljs-keyword">var</span> heading = e.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = e.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = e.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = e.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = e.coords.altitudeAccuracy;

    <span class="hljs-comment">//Titanium.Geolocation.distanceFilter = 100; //changed after first location event</span>

    updatedLocation.text = <span class="hljs-string">'long:'</span> + longitude;
    updatedLatitude.text = <span class="hljs-string">'lat: '</span>+ latitude;
    updatedLocationAccuracy.text = <span class="hljs-string">'accuracy:'</span> + accuracy;
    updatedLocationTime.text = <span class="hljs-string">'timestamp:'</span> +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp);

    updatedLatitude.color = <span class="hljs-string">'red'</span>;
    updatedLocation.color = <span class="hljs-string">'red'</span>;
    updatedLocationAccuracy.color = <span class="hljs-string">'red'</span>;
    updatedLocationTime.color = <span class="hljs-string">'red'</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{
        updatedLatitude.color = <span class="hljs-string">'#444'</span>;
        updatedLocation.color = <span class="hljs-string">'#444'</span>;
        updatedLocationAccuracy.color = <span class="hljs-string">'#444'</span>;
        updatedLocationTime.color = <span class="hljs-string">'#444'</span>;

    },<span class="hljs-number">100</span>);
    <span class="hljs-comment">// reverse geo</span>
    Titanium.Geolocation.reverseGeocoder(latitude,longitude,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>)
    </span>{
        <span class="hljs-keyword">if</span> (evt.success) {
            <span class="hljs-keyword">var</span> places = evt.places;
            <span class="hljs-keyword">if</span> (places &amp;&amp; places.length) {
                reverseGeo.text = places[<span class="hljs-number">0</span>].address;
            } <span class="hljs-keyword">else</span> {
                reverseGeo.text = <span class="hljs-string">"No address found"</span>;
            }
            Ti.API.debug(<span class="hljs-string">"reverse geolocation result = "</span>+<span class="hljs-built_in">JSON</span>.stringify(evt));
        }
        <span class="hljs-keyword">else</span> {
            Ti.UI.createAlertDialog({
                title:<span class="hljs-string">'Reverse geo error'</span>,
                message:evt.error
            }).show();
            Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(e.code));
        }
    });


    Titanium.API.info(<span class="hljs-string">'geo - location updated: '</span> + <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp) + <span class="hljs-string">' long '</span> + longitude + <span class="hljs-string">' lat '</span> + latitude + <span class="hljs-string">' accuracy '</span> + accuracy);
};
Titanium.Geolocation.addEventListener(<span class="hljs-string">'location'</span>, locationCallback);
locationAdded = <span class="hljs-literal">true</span>;
</code></pre><p>}<br>var addr = &quot;2065 Hamilton Avenue San Jose California 95125&quot;;</p>
<p>Titanium.Geolocation.forwardGeocoder(addr,function(evt)<br>{<br>    Ti.API.info(&#39;in forward &#39;);<br>    forwardGeo.text = &quot;lat:&quot;+evt.latitude+&quot;, long:&quot;+evt.longitude;<br>    Titanium.Geolocation.reverseGeocoder(evt.latitude,evt.longitude,function(evt)<br>    {<br>        if (evt.success) {<br>            var text = &quot;&quot;;<br>            for (var i = 0; i &lt; evt.places.length; i++) {<br>                text += &quot;&quot; + i + &quot;) &quot; + evt.places[i].address + &quot;\n&quot;;<br>            }<br>            Ti.API.info(&#39;Reversed forward: &#39;+text);<br>        }<br>        else {<br>            Ti.UI.createAlertDialog({<br>                title:&#39;Forward geo error&#39;,<br>                message:evt.error<br>            }).show();<br>            Ti.API.info(&quot;Code translation: &quot;+translateErrorCode(e.code));<br>        }<br>    });<br>});</p>
<p>if (Titanium.Platform.name == &#39;android&#39;)<br>{<br>    &#x2F;&#x2F;  as the destroy handler will remove the listener, only set the pause handler to remove if you need battery savings<br>    Ti.Android.currentActivity.addEventListener(&#39;pause&#39;, function(e) {<br>        Ti.API.info(&quot;pause event received&quot;);<br>        if (headingAdded) {<br>            Ti.API.info(&quot;removing heading callback on pause&quot;);<br>            Titanium.Geolocation.removeEventListener(&#39;heading&#39;, headingCallback);<br>            headingAdded = false;<br>        }<br>        if (locationAdded) {<br>            Ti.API.info(&quot;removing location callback on pause&quot;);<br>            Titanium.Geolocation.removeEventListener(&#39;location&#39;, locationCallback);<br>            locationAdded = false;<br>        }<br>    });<br>    Ti.Android.currentActivity.addEventListener(&#39;destroy&#39;, function(e) {<br>        Ti.API.info(&quot;destroy event received&quot;);<br>        if (headingAdded) {<br>            Ti.API.info(&quot;removing heading callback on destroy&quot;);<br>            Titanium.Geolocation.removeEventListener(&#39;heading&#39;, headingCallback);<br>            headingAdded = false;<br>        }<br>        if (locationAdded) {<br>            Ti.API.info(&quot;removing location callback on destroy&quot;);<br>            Titanium.Geolocation.removeEventListener(&#39;location&#39;, locationCallback);<br>            locationAdded = false;<br>        }<br>    });<br>    Ti.Android.currentActivity.addEventListener(&#39;resume&#39;, function(e) {<br>        Ti.API.info(&quot;resume event received&quot;);<br>        if (!headingAdded) {<br>            Ti.API.info(&quot;adding heading callback on resume&quot;);<br>            Titanium.Geolocation.addEventListener(&#39;heading&#39;, headingCallback);<br>            headingAdded = true;<br>        }<br>        if (!locationAdded) {<br>            Ti.API.info(&quot;adding location callback on resume&quot;);<br>            Titanium.Geolocation.addEventListener(&#39;location&#39;, locationCallback);<br>            locationAdded = true;<br>        }<br>    });<br>}</p>
<p>win.open();</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 16th 2011, 8:36:11 am">November 16th 2011</span>
								by <span class='authorname'>mayuri vaidya</span><br>
								<a class="icon-bg icon-link" href="question/128285/gps-is-not-working#answer-223484" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
