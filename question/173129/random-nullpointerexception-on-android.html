<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Random nullpointerexception on android » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Random nullpointerexception on android</h1>
		</header>
		<section>
			<p>I have an application which uses scrollable views practically in every windows. At times however the whole app crashes with a null pointer exception in a random sequence. I believe it happens more often when<br>1 click on an tableviewrow in one of the scrollable views.<br>2.the app opens a new window with a scrollable view.</p>
<ol>
<li>I scroll a bit there</li>
<li>close window and back in original scrolable view</li>
<li>scroll here </li>
</ol>
<pre><code class="hljs"><span class="hljs-label"> TiApplication:</span> (main) [<span class="hljs-number">169</span>,<span class="hljs-number">36386</span>] Sending <span class="hljs-string">event:</span> exception on <span class="hljs-string">thread:</span> main <span class="hljs-string">msg:</span>java.lang.NullPointerException; Titanium <span class="hljs-number">3.2</span><span class="hljs-number">.2</span>,<span class="hljs-number">2014</span><span class="hljs-regexp">/03/</span><span class="hljs-number">05</span> <span class="hljs-number">12</span>:<span class="hljs-number">22</span>,<span class="hljs-number">96e9</span>a07
[ERROR] :  <span class="hljs-string">TiApplication:</span> java.lang.NullPointerException
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.view.ViewConfiguration.get(ViewConfiguration.<span class="hljs-string">java:</span><span class="hljs-number">313</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.view.View.&lt;init&gt;(View.<span class="hljs-string">java:</span><span class="hljs-number">3448</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.view.ViewGroup.&lt;init&gt;(ViewGroup.<span class="hljs-string">java:</span><span class="hljs-number">459</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.support.v4.view.ViewPager.&lt;init&gt;(ViewPager.<span class="hljs-string">java:</span><span class="hljs-number">296</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at ti.modules.titanium.ui.widget.TiUIScrollableView$<span class="hljs-number">1.</span>&lt;init&gt;(TiUIScrollableView.<span class="hljs-string">java:</span><span class="hljs-number">77</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at ti.modules.titanium.ui.widget.TiUIScrollableView.buildViewPager(TiUIScrollableView.<span class="hljs-string">java:</span><span class="hljs-number">76</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at ti.modules.titanium.ui.widget.TiUIScrollableView.&lt;init&gt;(TiUIScrollableView.<span class="hljs-string">java:</span><span class="hljs-number">63</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at ti.modules.titanium.ui.ScrollableViewProxy.createView(ScrollableViewProxy.<span class="hljs-string">java:</span><span class="hljs-number">68</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at org.appcelerator.titanium.proxy.TiViewProxy.handleGetView(TiViewProxy.<span class="hljs-string">java:</span><span class="hljs-number">463</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at org.appcelerator.titanium.proxy.TiViewProxy.handleMessage(TiViewProxy.<span class="hljs-string">java:</span><span class="hljs-number">213</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at ti.modules.titanium.ui.ScrollableViewProxy.handleMessage(ScrollableViewProxy.<span class="hljs-string">java:</span><span class="hljs-number">145</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.os.Handler.dispatchMessage(Handler.<span class="hljs-string">java:</span><span class="hljs-number">98</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.os.Looper.loop(Looper.<span class="hljs-string">java:</span><span class="hljs-number">136</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at android.app.ActivityThread.main(ActivityThread.<span class="hljs-string">java:</span><span class="hljs-number">5116</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at java.lang.reflect.Method.invokeNative(Native Method)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at java.lang.reflect.Method.invoke(Method.<span class="hljs-string">java:</span><span class="hljs-number">515</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.<span class="hljs-string">java:</span><span class="hljs-number">789</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at com.android.internal.os.ZygoteInit.main(ZygoteInit.<span class="hljs-string">java:</span><span class="hljs-number">605</span>)
[ERROR] :  <span class="hljs-string">TiApplication:</span>     at dalvik.system.NativeStart.main(Native Method)
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 26th 2014, 1:15:06 pm">April 26th 2014</span>
				by <span class='authorname'>Michael DeGiovanni</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>nullpointerexception</span></li>
					
						<li><span class='tagname'>scrollableview</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-278142">
				
						<section>
							<p>Hi</p>
<p>You are breaking one of the great rules of Android development - never put a scrollable on a scrollable.</p>
<p>OK so less scary now.  You say you have a tableView added as a child view of a scroll view.  As a tableView scrolls and a scrollView scrolls Android can and often does have issues with this sort of situation.  Many times this is usually manifested as very poor control over each scrolling.  Sometimes it can be more complicated. Sometimes you have managed to code things and place things so well it is not an issue.</p>
<p>It is possible to add something that scrolls as a child of something that also scrolls - but those combinations are not always how you want them to be.  The problem is getting better - but with newer versions of Android - so older versions suffer the problem still.  Testing is the key.</p>
<p>Unfortunately this issue may not be the problem here.  What you need to do now is create a test app (separate from your real app) and include some basic functionality to replicate the tableView, scrollView and windows being opened.</p>
<p>If this fails then the problem exists in those interactions, if not it is likely something else in the code.  We will need to see a reproducible set of code to check - this has to be a small snippet that will let us try and repeat the problem.  Do NOT send the entire app.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 26th 2014, 3:19:45 pm">April 26th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/173129/random-nullpointerexception-on-android#answer-278142" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I don&#39;t think you have understood the structure :) this is kind of a basic view</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;window&gt;</span>
    <span class="hljs-tag">&lt;ScrollableView&gt;</span>
        <span class="hljs-tag">&lt;View id="page1"&gt;</span>
            <span class="hljs-tag">&lt;TableView&gt;</span>
                <span class="hljs-tag">&lt;TableViewRow /&gt;</span> <span class="hljs-tag">&lt;!--has click event&gt;</span>
            <span class="hljs-tag">&lt;/TableVie&gt;</span>
        <span class="hljs-tag">&lt;/View&gt;</span>
        <span class="hljs-tag">&lt;View id="page2"&gt;</span>
            <span class="hljs-tag">&lt;TableView&gt;</span>
                <span class="hljs-tag">&lt;TableViewRow /&gt;</span> <span class="hljs-tag">&lt;!--has click event&gt;</span>
            <span class="hljs-tag">&lt;/TableVie&gt;</span>
        <span class="hljs-tag">&lt;/View&gt;</span>
    <span class="hljs-tag">&lt;/ScrollableView&gt;</span>
<span class="hljs-tag">&lt;/window&gt;</span>
</code></pre><p>when a click happens on the tableviewrow a new window opens having something as follows</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">window</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">ScrollableView</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">ScrollView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"secrtion1"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollView</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollableView</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">window</span>&gt;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="April 26th 2014, 3:25:33 pm">April 26th 2014</span>
											by <span class='authorname'>Michael DeGiovanni</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>and the crash seems to happens many a times on an orientation change, when the elements are being layed out again</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 26th 2014, 3:27:32 pm">April 26th 2014</span>
											by <span class='authorname'>Michael DeGiovanni</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are correct I thought you were talking about something like this;</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;window&gt;</span>
    <span class="hljs-tag">&lt;ScrollView&gt;</span>
        <span class="hljs-tag">&lt;TableView&gt;</span>
            <span class="hljs-tag">&lt;TableViewRow /&gt;</span> <span class="hljs-tag">&lt;!--has click event&gt;</span>
        <span class="hljs-tag">&lt;/TableVie&gt;</span>
    <span class="hljs-tag">&lt;/ScrollView&gt;</span>
<span class="hljs-tag">&lt;/window&gt;</span>
</code></pre><p>This would be scroll on scroll.</p>
<p>Your code is technically scroll on scroll as the TableViews scrolls and the parent they are added to also scrolls (albeit in a different way).  The problem is usually related to a ScrollView parent rather than the paging bases of the ScrollableView.  I would not expect to see the scroll on scroll problem here.</p>
<p>This is also perfectly valid I use this all the time;</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">window</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">ScrollableView</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">ScrollView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"secrtion1"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollView</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollableView</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">window</span>&gt;</span>
</code></pre><p>BTW as a TableView is a View you can do this if you wish;</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;window&gt;</span>
    <span class="hljs-tag">&lt;ScrollableView&gt;</span>
        <span class="hljs-tag">&lt;TableView id="page1"&gt;</span>
            <span class="hljs-tag">&lt;TableViewRow /&gt;</span> <span class="hljs-tag">&lt;!--has click event&gt;</span>
        <span class="hljs-tag">&lt;/TableVie&gt;</span>
        <span class="hljs-tag">&lt;TableView id="page2"&gt;</span>
            <span class="hljs-tag">&lt;TableViewRow /&gt;</span> <span class="hljs-tag">&lt;!--has click event&gt;</span>
        <span class="hljs-tag">&lt;/TableVie&gt;</span>
    <span class="hljs-tag">&lt;/ScrollableView&gt;</span>
<span class="hljs-tag">&lt;/window&gt;</span>
</code></pre><p>Simplifies things and removes a View that unless you have a specific need for is actually redundant - again your needs may require it though.</p>
<p>Back to the problem;</p>
<p>So you are getting crashes which are seemingly random but often when there is an orientation change involved - but assuming not always.</p>
<p>So testing time;</p>
<ul>
<li>Often crashes occur because events are fired too soon between an event listener starting and another being triggered to quickly soon afterwards.  Use the app again but make a significant delay between moving from section to section.  Does the problem persist? Classic examples would be;<ul>
<li>press a TableViewRow to open a Window, window opens and you close it straight away, another tableViewRow is quickly selected and fires the same listener - delaying these touch events can sometimes show a problem up.</li>
<li>Press a button on a window and before the window is launched the button is pressed again</li>
</ul>
</li>
<li>With orientation it could be a related event listener; turn off any orientation listener and see if the problem is improved.</li>
<li>Again orientation can be confused by too many elements trying to auto size themselves, backup the TSS files related and then empty the files - so nothing has any styles; try your less attractive app now - any improvement?</li>
<li>Whilst a TableView can have an event listener on each row, it is now recommended to have ONE event listener on the table and respond to data coming in - so one per table not one each per row.</li>
<li>If your TableViews have lots of other things that can be pressed and each has its own event listener - these can also be listened to in the single tableView event listener.  Removing all of these event listeners makes an app significantly more stable even with out this specific problem.</li>
</ul>
<p>Try these and see what happens.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 26th 2014, 3:55:03 pm">April 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It seem to be linked with the orientation event , as I&#39;ve disabled it completely and have been rotating the last 15 minutes without getting the crash.<br>What I cant understand is that I have ,if statements through out the whole thing just in case it been closed or doesnt exist any more. I&#39;ve even wrapped everything with a try catch and its still giving me the same error. Here is the orientation function</p>
<pre><code class="hljs">
<span class="hljs-comment">//N.B. ads is defined further up </span>
<span class="hljs-keyword">var</span> platform = (Alloy.isTablet) ? <span class="hljs-string">"tablet"</span> :<span class="hljs-string">"mobile"</span>;
function orient(<span class="hljs-keyword">e</span>){
    try {

        <span class="hljs-keyword">if</span> (Ti.Platform.name ==<span class="hljs-string">"android"</span>){
            <span class="hljs-keyword">var</span> orient = (Ti.Gesture.landscape) ? <span class="hljs-string">"landscape"</span> :<span class="hljs-string">"portrait"</span>;    
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> orient = (Ti.Gesture.isLandscape()) ? <span class="hljs-string">"landscape"</span> :<span class="hljs-string">"portrait"</span>;
        }

        <span class="hljs-keyword">var</span> articlesAds = ads.articles[platform][orient];

        <span class="hljs-keyword">if</span> ($.articleViews &amp;&amp; $.articleViews.views){
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = 0; i&lt;$.articleViews.views.length;i++){
                <span class="hljs-keyword">var</span> <span class="hljs-keyword">view</span> = $.articleViews.views[i];
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">view</span> &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.spacer &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.cover &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.coverDimensions){
                    <span class="hljs-keyword">var</span> dimensions = <span class="hljs-keyword">view</span>.articleContainer.coverDimensions;
                    <span class="hljs-keyword">var</span> coverHeight = (dimensions[1]*Ti.Platform.displayCaps.platformWidth)/dimensions[0];
                    <span class="hljs-keyword">if</span> (coverHeight){
                        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">view</span> &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.cover){
                            <span class="hljs-keyword">view</span>.articleContainer.cover.height= coverHeight;    
                        }
                    }
                    <span class="hljs-keyword">var</span> spacerHeight = (Ti.Platform.displayCaps.platformHeight*0.9 &gt;= coverHeight) ? coverHeight : Ti.Platform.displayCaps.platformHeight*0.8;
                    <span class="hljs-keyword">if</span> (spacerHeight){
                        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">view</span> &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.cover){
                            <span class="hljs-keyword">view</span>.articleContainer.spacer.height=spacerHeight;
                        }    
                    }
                }

                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">view</span> &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer &amp;&amp; <span class="hljs-keyword">view</span>.articleContainer.authorLabel){
                    <span class="hljs-keyword">if</span> (Alloy.isTablet){
                        <span class="hljs-keyword">var</span> authorDimensions = [80,100]; 
                    } <span class="hljs-keyword">else</span>{
                        <span class="hljs-keyword">var</span> authorDimensions = [40,50];
                    }

                }    
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">view</span> &amp;&amp; <span class="hljs-keyword">view</span>.advert){
                    <span class="hljs-keyword">var</span> adNum = Math.<span class="hljs-literal">floor</span>(Math.random() * articlesAds.length);
                    <span class="hljs-keyword">view</span>.advert.image = articlesAds[adNum].image;
                    <span class="hljs-keyword">view</span>.advert.link = articlesAds[adNum].link;
                }    
            }
        }
    } catch(<span class="hljs-keyword">e</span>){

    }
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="April 28th 2014, 5:54:43 pm">April 28th 2014</span>
											by <span class='authorname'>Michael DeGiovanni</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
