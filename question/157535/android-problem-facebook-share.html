<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>[android] Problem facebook share » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>[android] Problem facebook share</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I have a problem, if I load sharing in facebook eventListener, the application crashes while if I load it directly without eventListener, it works correctly but suddenly no click …</p>
<pre><code class="hljs">
fb.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

<span class="hljs-keyword">var</span> fbapp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'facebook'</span>);
fbapp.appid = Ti.App.Properties.getString(<span class="hljs-string">'ti.facebook.appid'</span>);
fbapp.permissions = [<span class="hljs-string">'email'</span>, <span class="hljs-string">'publish_stream'</span>];

<span class="hljs-comment">// CREATE THE FACEBOOK MESSAGE</span>
<span class="hljs-keyword">var</span> data = {
    name:<span class="hljs-string">'my name'</span>,
    link:<span class="hljs-string">"http://google.com"</span>,
    description: <span class="hljs-string">"description"</span>
};



<span class="hljs-keyword">if</span>(fbapp.loggedIn){
    fbapp.dialog(
        <span class="hljs-string">"feed"</span>, 
        data, 
        showRequestResult
    ); 
} <span class="hljs-keyword">else</span> {
    fbapp.authorize();
    fbapp.addEventListener(<span class="hljs-string">'login'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        fbapp.dialog(
            <span class="hljs-string">"feed"</span>, 
            data, 
            showRequestResult
        ); 
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showRequestResult</span>(<span class="hljs-params">r</span>) </span>{
    <span class="hljs-keyword">if</span> (r.result) {
        facebook_response = Ti.UI.createAlertDialog({
            title:<span class="hljs-string">'Facebook Shared!'</span>,
            message:<span class="hljs-string">'Your stream was published'</span>
        });
    }<span class="hljs-keyword">else</span>{    
        facebook_response = Ti.UI.createAlertDialog({
            title:<span class="hljs-string">'Facebook Stream was cancelled'</span>,  
            message:<span class="hljs-string">'Nothing was published.'</span>
        });
    }
    facebook_response.show();
    <span class="hljs-keyword">var</span> fb_resp_timeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        facebook_response.hide();
    }, <span class="hljs-number">2000</span>);
}
});
</code></pre><p>You have an idea ?<br>Cordialy</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 23rd 2013, 10:37:44 pm">September 23rd 2013</span>
				by <span class='authorname'>sebastien bramille</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>eventlistener</span></li>
					
						<li><span class='tagname'>facebook</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>@sebastien bramille : Try to run your app in 3.0.2.GA .</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 24th 2013, 12:52:04 am">September 24th 2013</span>
								by <span class='authorname'>Dharmik Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>@sebastien bramille : Note some other(main) information like Ti.SDK ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 24th 2013, 12:53:07 am">September 24th 2013</span>
								by <span class='authorname'>Dharmik Patel</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-269042">
				
						<section>
							<p>Hello Sebastien bramille,</p>
<p>Here is my test code. i test on android emulator. i post 10+ in my FB timeline. </p>
<p><strong>My testing environment</strong></p>
<p>OS: MAC OS X version 10.8.5, Ti SDK 3.1.3 and Android SDK 2.3.3 </p>
<p>Please check this and let me know if have any problem.</p>
<pre><code class="hljs">
<span class="hljs-keyword">var</span> win = Ti.UI.createWindow({
    backgroundColor : <span class="hljs-string">'blue'</span>,
    barColor : <span class="hljs-string">'red'</span>,
    titleControl : Ti.UI.createLabel({
        text : <span class="hljs-string">'Enable feature?'</span>,
        shadowColor : <span class="hljs-string">'gray'</span>,
        shadowOffset : {
            x : <span class="hljs-number">2</span>,
            y : <span class="hljs-number">2</span>
        }
    })
});

<span class="hljs-comment">// Create a Button.</span>
<span class="hljs-keyword">var</span> fb = Ti.UI.createButton({
    title : <span class="hljs-string">'fb'</span>,

});

win.add(fb);

fb.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> fbapp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'facebook'</span>);
    fbapp.appid = xxxxxxxxxxxxxxxx;
    <span class="hljs-comment">//Ti.App.Properties.getString('ti.facebook.appid');</span>
    fbapp.permissions = [<span class="hljs-string">'email'</span>, <span class="hljs-string">'publish_stream'</span>];

    <span class="hljs-comment">// CREATE THE FACEBOOK MESSAGE</span>
    <span class="hljs-keyword">var</span> data = {
        name : <span class="hljs-string">'my name'</span>,
        link : <span class="hljs-string">"http://google.com"</span>,
        description : <span class="hljs-string">"description"</span>
    };

    <span class="hljs-keyword">if</span> (fbapp.loggedIn) {
        fbapp.dialog(<span class="hljs-string">"feed"</span>, data, showRequestResult);
    } <span class="hljs-keyword">else</span> {
        fbapp.authorize();
        fbapp.addEventListener(<span class="hljs-string">'login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
            fbapp.dialog(<span class="hljs-string">"feed"</span>, data, showRequestResult);
        });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showRequestResult</span>(<span class="hljs-params">r</span>) </span>{
        <span class="hljs-keyword">if</span> (r.result) {
            facebook_response = Ti.UI.createAlertDialog({
                title : <span class="hljs-string">'Facebook Shared!'</span>,
                message : <span class="hljs-string">'Your stream was published'</span>
            });
        } <span class="hljs-keyword">else</span> {
            facebook_response = Ti.UI.createAlertDialog({
                title : <span class="hljs-string">'Facebook Stream was cancelled'</span>,
                message : <span class="hljs-string">'Nothing was published.'</span>
            });
        }
        facebook_response.show();
        <span class="hljs-keyword">var</span> fb_resp_timeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            facebook_response.hide();
        }, <span class="hljs-number">2000</span>);
    }

});
win.open();
</code></pre><p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 24th 2013, 6:28:47 am">September 24th 2013</span>
								by <span class='authorname'>Md. Mostafizur Rahman</span><br>
								<a class="icon-bg icon-link" href="question/157535/android-problem-facebook-share.html#answer-269042" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-269041">
				
						<section>
							<p>Hi sebastien bramille</p>
<p>You can follow this code for facebook share, feed , login and logout and choose your correct portion of this code which you want. </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win = Ti.UI.createWindow({
    backgroundColor: <span class="hljs-string">'white'</span>,
    layout :<span class="hljs-string">'vertical'</span>});

<span class="hljs-keyword">var</span> fb = <span class="hljs-built_in">require</span>(<span class="hljs-string">'facebook'</span>);
fb.appid = APP_ID;
fb.permissions = [<span class="hljs-string">'publish_stream'</span>];
fb.addEventListener(<span class="hljs-string">'login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    <span class="hljs-keyword">if</span> (e.success) {
        alert(<span class="hljs-string">'Logged in'</span>);
    }
});
fb.addEventListener(<span class="hljs-string">'logout'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    alert(<span class="hljs-string">'Logged out'</span>);
});

<span class="hljs-comment">// Add the button.  Note that it doesn't need a click event listener.</span>
win.add(fb.createLoginButton({
    top : <span class="hljs-number">50</span>,
    style : fb.BUTTON_STYLE_WIDE
}));


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showRequestResult</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> s = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (e.success) {
            s = <span class="hljs-string">"SUCCESS"</span>;
            <span class="hljs-keyword">if</span> (e.result) {
                s += <span class="hljs-string">"; "</span> + e.result;
            }
            <span class="hljs-keyword">if</span> (e.data) {
                s += <span class="hljs-string">"; "</span> + e.data;
            }
            <span class="hljs-keyword">if</span> (!e.result &amp;&amp; !e.data) {
                s = <span class="hljs-string">'"success", but no data from FB.  I am guessing you cancelled the dialog.'</span>;
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.cancelled) {
            s = <span class="hljs-string">"CANCELLED"</span>;
        } <span class="hljs-keyword">else</span> {
            s = <span class="hljs-string">"FAIL"</span>;
            <span class="hljs-keyword">if</span> (e.error) {
                s += <span class="hljs-string">"; "</span> + e.error;
            }
        }
        alert(s);
    }



    <span class="hljs-keyword">var</span> statusText = Ti.UI.createTextField({
        top: <span class="hljs-number">10</span>, left: <span class="hljs-number">10</span>, right: <span class="hljs-number">10</span>, height: Titanium.UI.SIZE,
        hintText: <span class="hljs-string">'Enter your FB status'</span>
    });
    win.add(statusText);
    <span class="hljs-keyword">var</span> statusBtn = Ti.UI.createButton({
        title: <span class="hljs-string">'Publish status with GRAPH API'</span>,
        top: <span class="hljs-number">10</span>, left: <span class="hljs-number">10</span>, right: <span class="hljs-number">10</span>, height:Titanium.UI.SIZE
    });
    statusBtn.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> text = statusText.value;
        <span class="hljs-keyword">if</span>( (text === <span class="hljs-string">''</span>)){
            Ti.UI.createAlertDialog({ tile:<span class="hljs-string">'ERROR'</span>, message:<span class="hljs-string">'No text to Publish !! '</span>}).show();
        }<span class="hljs-keyword">else</span> {
            fb.requestWithGraphPath(<span class="hljs-string">'me/feed'</span>, {message: text}, <span class="hljs-string">"POST"</span>,showRequestResult);
        }    
    });
    win.add(statusBtn);

    <span class="hljs-keyword">var</span> wall = Ti.UI.createButton({
        title: <span class="hljs-string">'Publish wall post with GRAPH API'</span>,
        top: <span class="hljs-number">10</span>, left: <span class="hljs-number">10</span>, right: <span class="hljs-number">10</span>, height: Titanium.UI.SIZE
    });
    wall.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> data = {
            link: <span class="hljs-string">"https://developer.mozilla.org/en/JavaScript"</span>,
            name: <span class="hljs-string">"Best online Javascript reference"</span>,
            message: <span class="hljs-string">"Use Mozilla's online Javascript reference"</span>,
            caption: <span class="hljs-string">"MDN Javascript Reference"</span>,
            picture: <span class="hljs-string">"https://developer.mozilla.org/media/img/mdn-logo.png"</span>,
            description: <span class="hljs-string">"This section of the site is dedicated to JavaScript-the-language, the parts that are not specific to web pages or other host environments..."</span>,
            test: [ {foo:<span class="hljs-string">'Encoding test'</span>, bar:<span class="hljs-string">'Durp durp'</span>}, <span class="hljs-string">'test'</span> ]
        };
        fb.requestWithGraphPath(<span class="hljs-string">'me/feed'</span>, data, <span class="hljs-string">'POST'</span>,showRequestResult);
    });
    win.add(wall);

    <span class="hljs-keyword">var</span> wallDialog = Ti.UI.createButton({
        title: <span class="hljs-string">'Publish wall post with DIALOG'</span>,
        top: <span class="hljs-number">10</span>, left: <span class="hljs-number">10</span>, right: <span class="hljs-number">10</span>, height: Titanium.UI.SIZE
    });
    <span class="hljs-keyword">var</span> iter = <span class="hljs-number">0</span>;
    wallDialog.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        iter++;
        <span class="hljs-keyword">var</span> data = {
            link: <span class="hljs-string">"http://www.appcelerator.com"</span>,
            name: <span class="hljs-string">"Appcelerator Titanium (iteration "</span> + iter + <span class="hljs-string">")"</span>,
            message: <span class="hljs-string">"Awesome SDKs for building desktop and mobile apps"</span>,
            caption: <span class="hljs-string">"Appcelerator Titanium (iteration "</span> + iter + <span class="hljs-string">")"</span>,
            picture: <span class="hljs-string">"http://developer.appcelerator.com/assets/img/DEV_titmobile_image.png"</span>,
            description: <span class="hljs-string">"You've got the ideas, now you've got the power. Titanium translates your hard won web skills..."</span>
        };
        fb.dialog(<span class="hljs-string">"feed"</span>, data,showRequestResult);
    });
    win.add(wallDialog);


    win.open();
</code></pre><p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 24th 2013, 6:05:24 am">September 24th 2013</span>
								by <span class='authorname'>Motiur Rahman</span><br>
								<a class="icon-bg icon-link" href="question/157535/android-problem-facebook-share.html#answer-269041" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-269056">
				
						<section>
							<p>Thnaks for your response, but if i add the container fb.addEventListener(&quot;click&quot;, function() {, </p>
<p>My app crash see on the screenshot :<br><img src="http:&#x2F;&#x2F;img4.hostingpics.net&#x2F;pics&#x2F;39279320130924131052DebugstandpriveResourcesmainwindowshomestep2jsTitaniumStudio.png &quot;img screenshot&quot;" alt="alt test"></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 24th 2013, 9:16:48 am">September 24th 2013</span>
								by <span class='authorname'>sebastien bramille</span><br>
								<a class="icon-bg icon-link" href="question/157535/android-problem-facebook-share.html#answer-269056" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
