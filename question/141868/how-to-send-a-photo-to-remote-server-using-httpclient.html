<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>How to send a photo to remote server using HTTPClient? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>How to send a photo to remote server using HTTPClient?</h1>
		</header>
		<section>
			<p>I&#39;m working on an application for iOS and I&#39;m trying to upload a photo to a remote server, said remote server has its own API and I&#39;m trying to use HTTPClient to send the request to upload the photo. I&#39;ve tried the following code:</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> photo = imageView.toBlob();
        <span class="hljs-keyword">var</span> boundary = <span class="hljs-string">'-_1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>;
        <span class="hljs-keyword">var</span> args = {
            file : photo,
            description : descriptionText
        };

        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Info received: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">"multipart/form-data; boundary=\""</span> + boundary + <span class="hljs-string">"\""</span>);
        client.setRequestHeader(<span class="hljs-string">'Connection'</span>, <span class="hljs-string">'close'</span>);
        client.send(args);
</code></pre><p>This code creates the post in the photo album but the image isn&#39;t being uploaded properly. What it&#39;s shown in the website is a blank image that can&#39;t be opened in the browser, so I&#39;m guessing the blob image is being sent corrupted. The guy in charge of the API is telling me the blob object is being sent as a String and I don&#39;t know why is that happening.</p>
<p>How can I solve this issue?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 4th 2012, 1:29:18 pm">September 4th 2012</span>
				by <span class='authorname'>Nenvo Software</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>blob</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>image-upload</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I&#39;m putting more info for this question:</p>
<p>I forgot to explain but when posting a photo the arguments sent must be:</p>
<ul>
<li>file : multipart photo</li>
<li>description : string</li>
</ul>
<p>I put a <code>Ti.API.info(args);</code> to see the content of my args object and I got the following:</p>
<pre><code class="hljs"><span class="hljs-collection">[INFO]</span> <span class="hljs-collection">{
    description = These;
    file = <span class="hljs-string">"[object TiBlob]"</span><span class="hljs-comment">;</span>
}</span>
</code></pre><p>So the Blob object is being sent, but the order of the properties inside of my args object are changed, they should be:</p>
<pre><code class="hljs"><span class="hljs-collection">[INFO]</span> <span class="hljs-collection">{
    file = <span class="hljs-string">"[object TiBlob]"</span><span class="hljs-comment">;</span>
    description = These;
}</span>
</code></pre><p>I&#39;m only guessing, since other company is developing the API, but I&#39;m guessing they&#39;re accessing to the objects&#39; properties in the order they&#39;re sent, instead of just accesing to them through the property name. I&#39;m just wild guessing in that, another guessing is that the </p>
<p><code>&amp;#39;&amp;#39; &amp;#39;&amp;#39;</code> </p>
<p>that surround the <code>[object TiBlob]</code> are the ones giving the problem, if so, how can I remove them?</p>
<p>Another theory I have is that perhaps I may have to pass the Blob object to an object array, if so how can I do that?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 4th 2012, 3:06:28 pm">September 4th 2012</span>
								by <span class='authorname'>Nenvo Software</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>6</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>6 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-246687">
				
						<section>
							<p>According to my understanding,if you want to send both an image and text data like description then in that case,you have to use multipart data format in body.means there would be two body parts,part1 for your description,and part 2 for your image and then do part1+part and send that in body.that would work for you.</p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 4th 2012, 5:40:49 pm">September 4th 2012</span>
								by <span class='authorname'>pankaj Goyal</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-246687" rel="permalink">permalink</a>
							</div>

							<h5>8 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>and if it does not work then Please tell me what Error You are getting.</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 5:42:08 pm">September 4th 2012</span>
											by <span class='authorname'>pankaj Goyal</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m using this code:</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Se recibio de la subida: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'multipart/form-data'</span>);
        client.send({file : photo, description : descriptionText});
         <span class="hljs-comment">// photo is a variable that contains event.media</span>
    });
</code></pre><p>This creates the post but the photo isn&#39;t being sent correctly. I just got word that the log output the API is making is something like this:</p>
<p><code>{&amp;#39;&amp;#39;file&amp;#39;&amp;#39;=&amp;gt;&amp;#39;&amp;#39;&amp;#39;&amp;#39;, &amp;#39;&amp;#39;description&amp;#39;&amp;#39;=&amp;gt;&amp;#39;&amp;#39;Trent&amp;#39;&amp;#39;, &amp;#39;&amp;#39;album_id&amp;#39;&amp;#39;=&amp;gt;&amp;#39;&amp;#39;605366&amp;#39;&amp;#39;}</code></p>
<p>The file property is empty, but that shouldn&#39;t be the case since I&#39;m making sure the photo property has a value with a </p>
<p><code>Ti.API.info({file : photo, description : descriptionText.value});</code></p>
<p>which gives me the following output:</p>
<p><code>[INFO] {
    description = Fear;
    file = &amp;#39;&amp;#39;[object TiBlob]&amp;#39;&amp;#39;;
}</code></p>
<p>I&#39;m really lost as to why Titanium isn&#39;t sending the photo properly.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 6:22:13 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello,<br>              I dont think that you can send a json directly in your body,I am not sure on which API you are working on.If Possible,can you share that,so that can help you accordingly.</p>
<p>Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 2:48:20 pm">September 5th 2012</span>
											by <span class='authorname'>pankaj Goyal</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>it&#39;s a private API called veramiko, the server is expecting any image mime (typeimage&#x2F;gif, image&#x2F;jpeg, image&#x2F;png) when receiving an upload photo request. So far I have sent all of the requests in JSON objects and there haven&#39;t been any problems, the problem is sending the photo file. </p>
<p>As I&#39;ve said in other comments, for some reason Titanium doesn&#39;t send the photo file in my object, the server receives an empty file property like this:</p>
<pre><code class="hljs">{<span class="hljs-string">''</span>file<span class="hljs-string">''</span>=&gt;<span class="hljs-string">''</span><span class="hljs-string">''</span>, <span class="hljs-string">''</span>description<span class="hljs-string">''</span>=&gt;<span class="hljs-string">''</span>Trent<span class="hljs-string">''</span>, <span class="hljs-string">''</span>album_id<span class="hljs-string">''</span>=&gt;<span class="hljs-string">''</span><span class="hljs-number">605366</span><span class="hljs-string">''</span>}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 3:10:33 pm">September 5th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You need to write the code something like this.that type of code should work in your case.I had use this type of code in many api hit that uses image&#x2F;document uploading as well.So,Try your work in this way.and let me know if you still have issue.Happy to help.             :)</p>
<pre><code class="hljs"> <span class="hljs-keyword">var</span> url = 'your url value';
    <span class="hljs-keyword">var</span> boundary = '-_1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    <span class="hljs-keyword">var</span> photo = Ti Blob Object;

    <span class="hljs-keyword">var</span> <span class="hljs-keyword">args</span> = {
        <span class="hljs-keyword">file</span> : photo,
        description : descriptionText.value
    };      

     <span class="hljs-keyword">var</span> contentDisposition1 = <span class="hljs-string">"--"</span> + boundary + <span class="hljs-string">"\r\n"</span>; 
    contentDisposition1 += <span class="hljs-string">"Content-Disposition: form-data; name=\"</span><span class="hljs-keyword">file</span>\<span class="hljs-string">";"</span>;
    contentDisposition1 += <span class="hljs-string">"filename=\"</span><span class="hljs-string">" + imageView.image + "</span>\<span class="hljs-string">"\r\n\"</span>;";
    contentDisposition1+= <span class="hljs-string">"Content-Type: application/octet-stream\r\n\r\n"</span>;


    <span class="hljs-keyword">var</span> contentDisposition2 = <span class="hljs-string">"--"</span> + boundary + <span class="hljs-string">"\r\n"</span>; 
    contentDisposition2 += <span class="hljs-string">"Content-Disposition: form-data; name=\"</span><span class="hljs-keyword">file</span>\<span class="hljs-string">";"</span>;
    contentDisposition2 += <span class="hljs-string">"filename=\"</span><span class="hljs-string">" + imageView.image + "</span>\<span class="hljs-string">"\r\n\"</span>;";
    contentDisposition2 += <span class="hljs-string">"Content-Type: application/octet-stream\r\n\r\n"</span>;

    <span class="hljs-keyword">var</span> body1= contentDisposition1 + <span class="hljs-keyword">args</span>.photo  + <span class="hljs-string">"\r\n--"</span> + boundary + <span class="hljs-string">"--"</span>;
     <span class="hljs-keyword">var</span> body2= contentDisposition + <span class="hljs-keyword">args</span>.description  + <span class="hljs-string">"\r\n--"</span> + boundary + <span class="hljs-string">"--"</span>;
<span class="hljs-keyword">var</span> fullContent = body1+body2;



    <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
        onload : function(<span class="hljs-keyword">e</span>){
            Ti.API.info(this.responseText); <span class="hljs-comment">//Print the result</span>
        },
        onerror : function(<span class="hljs-keyword">e</span>){
            Ti.API.<span class="hljs-keyword">error</span>(this.responseText); <span class="hljs-comment">//Print the result</span>
        },
        timeout : 60000
    });
    client.<span class="hljs-keyword">open</span>('<span class="hljs-keyword">POST</span>', url);
    client.setRequestHeader('Authorization', 'Bearer ' + <span class="hljs-keyword">token</span>);
    client.setRequestHeader('Content-<span class="hljs-keyword">Type</span>', <span class="hljs-string">"multipart/form-data; boundary=\"</span><span class="hljs-string">" + boundary + "</span>\<span class="hljs-string">""</span>);
    client.setRequestHeader('Connection', '<span class="hljs-keyword">close</span>');
    client.send(fullContent);
</code></pre><p>CodeStrong</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 3:22:30 pm">September 5th 2012</span>
											by <span class='authorname'>pankaj Goyal</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I tried it and returned error from the server. Why does it have to be sent with two Content-Disposition headers? Also shouldn&#39;t the second Content-Disposition header for sending description have in name the value description and ommit filename since description y only a string? Thanks for your help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 3:54:42 pm">September 5th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yup,I agree to you,this is not the exact code that you can do copy-paste,and it will execute,No!!</p>
<p>It is just a way how you should build your request from my prior experience in uploading the image with some description.But Actually,It depends on your API,In which format ,Your  API is accepting your request.SO Obviously,You need to do changes,If  still you are not able to do this,If possible,Pass me all the documentation,and let me try to solve this for you.</p>
<p>CodeStrong.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 4:25:35 pm">September 5th 2012</span>
											by <span class='authorname'>pankaj Goyal</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeah I realized I had to make some changes, I modified it like this with no success:</p>
<pre><code class="hljs">    <span class="hljs-keyword">var</span> url = 'http:<span class="hljs-comment">//api.veramiko.com/albums/' + album.veramiko_id + '/photos';</span>
    <span class="hljs-keyword">var</span> boundary = '-_1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    <span class="hljs-keyword">var</span> photo = imageView.toBlob();

    <span class="hljs-keyword">var</span> <span class="hljs-keyword">args</span> = {
        <span class="hljs-keyword">file</span> : photo,
        description : descriptionText.value
    };      

    <span class="hljs-keyword">var</span> contentDisposition1 = <span class="hljs-string">"--"</span> + boundary + <span class="hljs-string">"\r\n"</span>; 
    contentDisposition1 += <span class="hljs-string">"Content-Disposition: form-data; name=\"</span><span class="hljs-keyword">file</span>\<span class="hljs-string">";"</span>;
    contentDisposition1 += <span class="hljs-string">"filename=\"</span><span class="hljs-string">" + imageView.image + "</span>\<span class="hljs-string">"\r\n\"</span>;";
    contentDisposition1+= <span class="hljs-string">"Content-Type: application/octet-stream\r\n\r\n"</span>;


    <span class="hljs-keyword">var</span> contentDisposition2 = <span class="hljs-string">"--"</span> + boundary + <span class="hljs-string">"\r\n"</span>; 
    contentDisposition2 += <span class="hljs-string">"Content-Disposition: form-data; name=\"</span>description\<span class="hljs-string">";"</span>;
    contentDisposition2 += <span class="hljs-string">"Content-Type: application/octet-stream\r\n\r\n"</span>;

    <span class="hljs-keyword">var</span> body1= contentDisposition1 + <span class="hljs-keyword">args</span>.photo  + <span class="hljs-string">"\r\n--"</span> + boundary + <span class="hljs-string">"--"</span>;
    <span class="hljs-keyword">var</span> body2= contentDisposition2 + <span class="hljs-keyword">args</span>.description  + <span class="hljs-string">"\r\n--"</span> + boundary + <span class="hljs-string">"--"</span>;
    <span class="hljs-keyword">var</span> fullContent = body1+body2;

    <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
        onload : function(<span class="hljs-keyword">e</span>){
            Ti.API.info(this.responseText); <span class="hljs-comment">//Print the result</span>
        },
        onerror : function(<span class="hljs-keyword">e</span>){
            Ti.API.<span class="hljs-keyword">error</span>(this.responseText); <span class="hljs-comment">//Print the result</span>
        },
        timeout : 120000
    });
    client.<span class="hljs-keyword">open</span>('<span class="hljs-keyword">POST</span>', url);
    client.setRequestHeader('Authorization', 'Bearer ' + <span class="hljs-keyword">token</span>);
    client.setRequestHeader('Content-<span class="hljs-keyword">Type</span>', <span class="hljs-string">"multipart/form-data; boundary=\"</span><span class="hljs-string">" + boundary + "</span>\<span class="hljs-string">""</span>);
    client.setRequestHeader('Connection', '<span class="hljs-keyword">close</span>');
    client.send(fullContent);
</code></pre><p>I&#39;ll have to get in touch with the API team to ask them to send the documentation since I&#39;ve been working with the endpoint and simple guidelines, so far I didn&#39;t have any problem until I tried to upload a photo. If there&#39;s a way to get in touch with you outside the question email me at uriel[at]nenvo.com<br>Thanks for your attention.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 5:55:50 pm">September 5th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246905">
				
						<section>
							<p>Hi, I have been having a headache because of this issue (uploading image data and other post data), until I realized this might be easier than I though. I am doing this with the photo gallery, but this can be applied to any image blob:</p>
<p>THE JS in Appcelerator:</p>
<pre><code class="hljs">Ti.Media.openPhotoGallery({
    <span class="hljs-comment">// just making sure it's only a photo    </span>
    mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO],

    <span class="hljs-comment">// we all like to be successful</span>
    success : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>)</span>{

        <span class="hljs-comment">// HERE'S THE IMPORTANT PART</span>
        <span class="hljs-comment">// base64 encode it, then toString() that encoding</span>
        <span class="hljs-comment">// if this gives you errors, CLEAN YOUR PROJECT, it works...</span>
        <span class="hljs-keyword">var</span> img = Ti.Utils.base64encode(response.media).toString();

        <span class="hljs-comment">// postRequestData on my end is just the data object I am appending this image to</span>
    postRequestData[<span class="hljs-string">'image'</span>] = img;

        <span class="hljs-comment">// this is a quick way to grab the mimeType of the blob, and make it into an extension</span>
        <span class="hljs-comment">// for those thinking "why use a regular expression for the replace?", I say "just for kicks"</span>
    postRequestData[<span class="hljs-string">'image_type'</span>] = response.media.mimeType.replace(<span class="hljs-regexp">/image\//ig</span>, <span class="hljs-string">""</span>);
    }
});
</code></pre><p>So I have retreived the blob, encoded it, made it a string, then added it to my Object which I will send in the &quot;xhr&quot; request.</p>
<p>For the PHP CODE:</p>
<pre><code class="hljs"><span class="hljs-variable">$image</span>      = isset($_POST[<span class="hljs-string">'image'</span>])      ? $_POST[<span class="hljs-string">'image'</span>]      : <span class="hljs-string">""</span>;
<span class="hljs-variable">$image</span>_type = isset($_POST[<span class="hljs-string">'image_type'</span>]) ? $_POST[<span class="hljs-string">'image_type'</span>] : <span class="hljs-string">""</span>;

// this is <span class="hljs-keyword">where</span> you would check your vars and all that good stuff, but <span class="hljs-keyword">for</span> brevity:

<span class="hljs-variable">$folder</span>_path = <span class="hljs-string">"my_folder_pathski"</span>;
<span class="hljs-variable">$filename</span> = <span class="hljs-string">"myPrefix_"</span> . time() . <span class="hljs-string">"."</span> . <span class="hljs-variable">$image</span>_type;

<span class="hljs-keyword">if</span>(!file_exists(<span class="hljs-variable">$folder</span>_path)){
    mkdir(<span class="hljs-variable">$folder</span>_path);
}

<span class="hljs-keyword">if</span> (file_exists(<span class="hljs-variable">$folder</span>_path . <span class="hljs-string">"/"</span> . <span class="hljs-variable">$filename</span>)){
    // then myCustomError_exists();
}

file_put_contents(<span class="hljs-variable">$folder</span>_path .<span class="hljs-string">"/"</span> . <span class="hljs-variable">$filename</span>, base64_decode(<span class="hljs-variable">$image</span>));
</code></pre><p>This is all taken as the snippets from a larger application code base, but these are the important parts that have worked for me.</p>
<p>I hope this helps</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 8th 2012, 12:54:06 am">September 8th 2012</span>
								by <span class='authorname'>Dennis Baskin</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-246905" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246679">
				
						<section>
							<p>Your Image is a TI Blob Object,So You can send that directly in body of your request using Post HTTP Client.<br>use</p>
<pre><code class="hljs"> xhr.<span class="hljs-built_in">send</span>(<span class="hljs-string">"your blob object"</span>)<span class="hljs-comment">;</span>
</code></pre><p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 4th 2012, 3:35:04 pm">September 4th 2012</span>
								by <span class='authorname'>pankaj Goyal</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-246679" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>but I need to send both photo and the description text, I tried the following:</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> photo = imageView.image;
        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Info received: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.send({file : photo, description : descriptionText.value});
</code></pre><p>and then I tried :</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> photo = eventMedia; <span class="hljs-comment">// where eventMedia is a variable that contains the value of the event.media I get when I select the photo from the gallery</span>
        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Info received: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.send({file : photo, description : descriptionText.value});
</code></pre><p>and still didn&#39;t get the photo uploaded. The post is being made in the server but the image data isn&#39;t being sent properly. I&#39;m really confused with this problem.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 4:20:14 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi,</p>
<p>I cannot test at the moment but don&#39;t you have simple encoding problem ?  What type of content-type is expected byt the server ?</p>
<p>You could try to base64encode the photo.  I remember that I used something like this in a project:</p>
<pre><code class="hljs">Ti<span class="hljs-class">.Utils</span><span class="hljs-class">.base64encode</span>(photo.<span class="hljs-function"><span class="hljs-title">imageAsResized</span><span class="hljs-params">(<span class="hljs-number">250</span>,<span class="hljs-number">250</span>)</span></span>).text
</code></pre><p>but that was sending with a content-type of the photo itself not as part of an array.</p>
<p>Also, and again I am sorry for not testing before sending, but if the above does not work, you could also try to JSON.stringify() your associative array before passing it to send().</p>
<p>Hope this helps you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 4:49:38 pm">September 4th 2012</span>
											by <span class='authorname'>Thierry Godfroid</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the Content-Type the server is expecting is any image type, so should I change my request headers?</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> photo = eventMedia; <span class="hljs-comment">// where eventMedia is a variable that contains the value of the event.media I get when I select the photo from the gallery</span>
        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Info received: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'image/gif'</span>);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'image/jpeg'</span>);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'image/png'</span>);
        client.send({file : photo, description : descriptionText.value});
</code></pre><p>Should I put something like that?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 6:12:06 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I tried to base64 encode but it didn&#39;t work. I put the following in send():</p>
<p><code>client.send(Ti.Utils.base64encode({file : photo, description : descriptionText}).text);</code></p>
<p>I got the following error:</p>
<pre><code class="hljs">[WARN] Exception in event callback. {
    line = 411<span class="hljs-comment">;</span>
    message = "Invalid type passed to function. invalid type  in -[UtilsModule convertToString:] (UtilsModule.m:31)"<span class="hljs-comment">;</span>
    sourceId = <span class="hljs-number">263491840</span><span class="hljs-comment">;</span>
    sourceURL = "file://localhost/Users/urielarvizu/Library/Application%20Support/iPhone%20Simulator/5.1/Applications/FD862B1A-DB35-492D-BB55-F<span class="hljs-number">50310A52286</span>/inTeamMovil.app///ui/common/PhotoAlbumViewer.js"<span class="hljs-comment">;</span>
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 6:32:35 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246705">
				
						<section>
							<p>@Nenvo the way my code works is something like….</p>
<p>You must try converting blob to image before sending it to the server</p>
<pre><code class="hljs">

<span class="actionscript"><span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
xhr.setTimeout(<span class="hljs-number">20000</span>);
xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    <span class="hljs-comment">//......some onerror.......//</span>
};
xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    <span class="hljs-comment">//......some onload.......//</span>
};
xhr.onsendstream = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    Ti.API.info(<span class="hljs-string">'ONSENDSTREAM - PROGRESS: '</span> + e.progress);
};
xhr.setRequestHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">'multipart/form-data'</span>);
xhr.open(<span class="hljs-string">'POST'</span>, your_url , <span class="hljs-literal">true</span>);
xhr.send({
    attachment : photo.getImage(),
    api_token : your_api_token_code,
    photo : photo
});</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 5th 2012, 3:51:18 am">September 5th 2012</span>
								by <span class='authorname'>Sahil Grover</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-246705" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I tried to get the file with the method getFile():</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> url = <span class="hljs-string">'http://api.veramiko.com/albums/'</span> + album.veramiko_id + <span class="hljs-string">'/photos'</span>;
        <span class="hljs-keyword">var</span> photo = foto;
        <span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
            onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.info(<span class="hljs-string">'Info received: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                Ti.API.error(<span class="hljs-string">'Error uploading photo: '</span> + <span class="hljs-keyword">this</span>.responseText);
            },
            timeout : <span class="hljs-number">60000</span>
        });
        client.open(<span class="hljs-string">'POST'</span>, url);
        client.setRequestHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'Bearer '</span> + token);
        client.setRequestHeader(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'multipart/form-data'</span>);
        client.send({file : photo.getFile(), description : descriptionText.value});
</code></pre><p>but it didn&#39;t uploaded the photo. For some reason Titanium is sending empty the file property inside my parameters object, I&#39;m being told that the server is receiving an empty file property like this:</p>
<p><code>file=&amp;#39;&amp;#39;&amp;#39;&amp;#39;</code></p>
<p>How can I make sure Titanium sends the object properly?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 5th 2012, 1:09:19 pm">September 5th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287924">
				
						<section>
							<p>Any success on this? I am facing same issue, wants to upload image and description</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 15th 2015, 8:21:40 am">August 15th 2015</span>
								by <span class='authorname'>Namrata Thanekar</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-287924" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246673">
				
						<section>
							<p>You think too complicated: You can simple send the image via send command. The API forms the request:</p>
<p><code>send({myfile: Ti.Blob});</code></p>
<p>Plz read the manual about this.</p>
<p>Hope this helps.</p>
<p>Rainer</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 4th 2012, 1:41:32 pm">September 4th 2012</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="question/141868/how-to-send-a-photo-to-remote-server-using-httpclient#answer-246673" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That doesn&#39;t work, I forgot to explain but when posting a photo the arguments sent must be:</p>
<ul>
<li>file : multipart photo</li>
<li>description : string</li>
</ul>
<p>I put a <code>Ti.API.info(args);</code> to see the content of my args object and I got the following:</p>
<pre><code class="hljs"><span class="hljs-collection">[INFO]</span> <span class="hljs-collection">{
    description = These;
    file = <span class="hljs-string">"[object TiBlob]"</span><span class="hljs-comment">;</span>
}</span>
</code></pre><p>So the Blob object is being sent, but the order of the properties inside of my args object are changed, they should be:</p>
<pre><code class="hljs"><span class="hljs-collection">[INFO]</span> <span class="hljs-collection">{
    file = <span class="hljs-string">"[object TiBlob]"</span><span class="hljs-comment">;</span>
    description = These;
}</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 3:05:50 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Please read RFC. The order of elements is without importance, because the parser of server side make what the server wants.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 3:50:12 pm">September 4th 2012</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeah, you&#39;re right. I&#39;m really troubled at the fact that is not working. I annoys me that the file property value is wrapped in &#39;&#39; &#39;&#39;, or is that normal when displaying a Blob Object through Ti.API.info()?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2012, 4:28:32 pm">September 4th 2012</span>
											by <span class='authorname'>Nenvo Software</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
