<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Post upload photo to fanpage  on facebook with page token. » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Post upload photo to fanpage  on facebook with page token.</h1>
		</header>
		<section>
			<p>Hi.</p>
<p>I am struggling to upload a photo (From gallery or camera) to my FB fanpage.</p>
<p>I can post to my own page</p>
<pre><code class="hljs">'/<span class="hljs-keyword">me</span>/feed'  <span class="hljs-keyword">or</span> '/<span class="hljs-keyword">me</span>/photos'
</code></pre><p>But when i trying to  upload a phot to my fanpage i get Fb errdomain10000 </p>
<p>I think i have found why this is and i think the answer is here:<br><a href="http:&#x2F;&#x2F;www.kerstner.at&#x2F;en&#x2F;2012&#x2F;03&#x2F;post-to-facebook-fanpage-as-page-admin-through-app-via-impersonation&#x2F;">link to php code</a></p>
<p>What i dont know is how to wirte that for Titanium…..   #notsobright</p>
<p>Here is what i got so far but i need to get the page token i guess to make it work.</p>
<pre><code class="hljs"> Titanium.Media.openPhotoGallery({
            success:function(event)
            {Ti.Facebook.authorize();
                <span class="hljs-keyword">if</span>(Ti.Facebook.loggedIn &amp;&amp; !(Titanium.Network.networkType == Titanium.Network.NETWORK_NONE)) {


     var <span class="hljs-built_in">image</span> = event.media;

        Ti.API.info(<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> +<span class="hljs-string">' x '</span>+ <span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span>);

        var imageView = Titanium.UI.createImageView({
            <span class="hljs-built_in">image</span>:<span class="hljs-built_in">image</span>,
            <span class="hljs-variable">width</span>:<span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span> / <span class="hljs-number">1.7</span>,
            <span class="hljs-variable">height</span>:<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> / <span class="hljs-number">1.7</span>
        });

        <span class="hljs-built_in">image</span> = imageView.toImage();
        Ti.API.info(<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> + <span class="hljs-string">" x "</span> + <span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span>);

                var data = {source: <span class="hljs-built_in">image</span>};
                Titanium.Facebook.requestWithGraphPath(<span class="hljs-string">'/'</span>+ Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>) +<span class="hljs-string">'/photos'</span>, data, <span class="hljs-string">"POST"</span>, function(e){
            <span class="hljs-keyword">if</span>(e.success) {
     var d = Titanium.UI.createAlertDialog({
   title: Titanium.App.Properties.getString(<span class="hljs-string">"appname"</span>),
   message: <span class="hljs-string">'Uploaded!'</span>,
   buttonNames: [<span class="hljs-string">'Ok'</span>],
});
d.show();
</code></pre><p>Anyone that can help me with this….?</p>
<p>Thanx.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 5th 2013, 11:08:48 am">January 5th 2013</span>
				by <span class='authorname'>Richard Harrysson</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>api</span></li>
					
						<li><span class='tagname'>facebook</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Please do not re-post questions and certainly not within 24 hours.  People are checking questions, sometimes days and weeks old, those who may have the answer you seek may simply not be available immediately when you need help, or be in the same time zone as you are.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 5th 2013, 11:55:51 am">January 5th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Missing from you question are several pieces of information that will help you obtain a speedy and accurate answer;</p>
<ul>
<li>Titanium SDK Version?</li>
<li>Primary Target Platform; Android, iOS or both?</li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="January 5th 2013, 11:56:38 am">January 5th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ok sorry about that….</p>
<p>Sdk is 2.1.1.GA</p>
<p>And its for iOS.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 5th 2013, 12:08:50 pm">January 5th 2013</span>
								by <span class='authorname'>Richard Harrysson</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-253899">
				
						<section>
							<p>Where are you setting your request permissions ?</p>
<pre><code class="hljs">Ti<span class="hljs-class">.Facebook</span><span class="hljs-class">.permissions</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 5th 2013, 12:50:34 pm">January 5th 2013</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="question/146496/post-upload-photo-to-fanpage-on-facebook-with-page-token.html#answer-253899" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I am setting the permissions on the FB login win. (Not the same win.) </p>
<pre><code class="hljs"><span class="hljs-name">Ti</span>.<span class="hljs-name">Facebook</span>.<span class="hljs-atom">permissions</span> = [<span class="hljs-string">"photo_upload"</span>, <span class="hljs-string">"rsvp_event"</span>, <span class="hljs-string">"publish_stream"</span>];
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 5th 2013, 2:05:44 pm">January 5th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The article you refer to includes these permissions</p>
<pre><code class="hljs">Ti<span class="hljs-class">.Facebook</span><span class="hljs-class">.permissions</span> =  [<span class="hljs-string">'read_stream'</span>,<span class="hljs-string">'publish_stream'</span>,<span class="hljs-string">'offline_access'</span>,<span class="hljs-string">'manage_pages'</span>]
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 5th 2013, 2:21:20 pm">January 5th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>But in that case maybe i should do a second FB app that have all those permissions and then use that apps access token for the photo upload to the fanpage?<br>Because it doesnt make sense that i have to ask for the users permission to manage their pages because in that case it means that every user that wants to upload photos to the fanpage must be admin for that page.</p>
<p>Thats why i thought that if it would be possible to get the fanpage access token instead to be able to upload photos .</p>
<p>Am i making sense?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 5th 2013, 2:39:07 pm">January 5th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I added those permission both to FB app and in my code. But it stills post it to my personal fb .</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 5th 2013, 2:45:10 pm">January 5th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok so this is how far i gotten now…..</p>
<p>I guess that i am on to something with this but i am not sure.</p>
<pre><code class="hljs"> Titanium.Media.openPhotoGallery({
            success:function(event)
            {<span class="hljs-comment">//Ti.Facebook.authorize();</span>
                <span class="hljs-comment">//if(Ti.Facebook.loggedIn &amp;&amp; !(Titanium.Network.networkType == Titanium.Network.NETWORK_NONE)) {</span>


     var <span class="hljs-built_in">image</span> = event.media;

        Ti.API.info(<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> +<span class="hljs-string">' x '</span>+ <span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span>);

        var imageView = Titanium.UI.createImageView({
            <span class="hljs-built_in">image</span>:<span class="hljs-built_in">image</span>,
            <span class="hljs-variable">width</span>:<span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span> / <span class="hljs-number">1.7</span>,
            <span class="hljs-variable">height</span>:<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> / <span class="hljs-number">1.7</span>
        });

        <span class="hljs-built_in">image</span> = imageView.toImage();
        Ti.API.info(<span class="hljs-built_in">image</span>.<span class="hljs-variable">height</span> + <span class="hljs-string">" x "</span> + <span class="hljs-built_in">image</span>.<span class="hljs-variable">width</span>);

var data = {source: <span class="hljs-built_in">image</span>};

<span class="hljs-comment">//////////////////// N E W  S T U F F !!!!!!!!!!!!! </span>
    Ti.Facebook.requestWithGraphPath(<span class="hljs-string">'/'</span> + Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>), {fields: <span class="hljs-string">'access_token'</span>}, function(resp) {
        <span class="hljs-keyword">if</span>(resp.access_token) {

                Ti.Facebook.requestWithGraphPath(<span class="hljs-string">'/'</span> + Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>) +<span class="hljs-string">'/photos'</span>, data ,<span class="hljs-string">"POST"</span>,{access_token: resp.access_token}, function(e){
            <span class="hljs-keyword">if</span>(e.success) {
     var d = Titanium.UI.createAlertDialog({
   title: Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>),
   message: <span class="hljs-string">'Uploaded!'</span>,
   buttonNames: [<span class="hljs-string">'Ok'</span>],
});
d.show();
</code></pre><p>But i get this error when starting the app:</p>
<pre><code class="hljs">*** <span class="hljs-type">Terminating</span> app due <span class="hljs-keyword">to</span> uncaught <span class="hljs-keyword">exception</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">'__NSCFDictionary'</span>

terminate called throwing an <span class="hljs-keyword">exception</span>
</code></pre><p>Any ideas on this?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 5th 2013, 6:23:05 pm">January 5th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-253944">
				
						<section>
							<p>Richard,</p>
<p>Tried to respond to your DevMail earlier today but your mail server rejected it :(+</p>
<p>In answer to your question, the code you sent to me had a dictionary in place where the method should be.<br>If I read what you asked, access_token may need to be a property of your data object:</p>
<pre><code class="hljs"><span class="hljs-title">var</span> <span class="hljs-typedef"><span class="hljs-keyword">data</span> = <span class="hljs-container">{
    <span class="hljs-title">name</span>: '<span class="hljs-type">My</span> <span class="hljs-type">Cool</span> <span class="hljs-type">App</span>',
    <span class="hljs-title">message</span>: '<span class="hljs-type">My</span> <span class="hljs-title">cool</span> <span class="hljs-type">Message</span>,
    <span class="hljs-title">access_token</span>: <span class="hljs-title">myPageAccessToken</span>

}</span>;</span>
</code></pre><p>But the error you get is because requestWithGraphPath takes 4 params (target, data, method, callback)<br>In your second use case, sending it a dictionary where POST or GET would be expected.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 6th 2013, 5:20:06 pm">January 6th 2013</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="question/146496/post-upload-photo-to-fanpage-on-facebook-with-page-token.html#answer-253944" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I say that based upon what it would look like with curl:</p>
<pre><code class="hljs">curl -X POST \
     -<span class="ruby"><span class="hljs-constant">F</span> <span class="hljs-string">'message=Post%20with%20app%20access%20token'</span> \
</span>     -<span class="ruby"><span class="hljs-constant">F</span> <span class="hljs-string">'access_token=YOUR_APP_ACCESS_TOKEN'</span> \
</span>     https://graph.facebook.com/4804827/feed
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 6th 2013, 5:22:18 pm">January 6th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok i see.</p>
<p>So something like this? ( i am not sure on how to put the Callback in though….</p>
<pre><code class="hljs"> Ti.Facebook.requestWithGraphPath(Titanium.App.Properties.getString(<span class="hljs-string">"sidnamn"</span>), {fields: <span class="hljs-string">'access_token'</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(resp)</span> </span>{
        <span class="hljs-keyword">if</span>(resp.access_token) {
            Ti.API.info(resp.access_token);

            }    });
                <span class="hljs-keyword">var</span> data = {
                    picture: image,
                    message: <span class="hljs-string">'My cool message'</span>,
                    access_token: resp.access_token };
</code></pre><p>Thanx</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 6th 2013, 6:19:16 pm">January 6th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are only passing 3 args to requestWithGraphPath.</p>
<p>There isn&#39;t an example here (<a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Facebook">http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Facebook</a> that uses 3.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 6th 2013, 10:27:23 pm">January 6th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>do you have an actual example of a curl or ios call that demonstrates what you are trying to accomplish?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 6th 2013, 10:28:10 pm">January 6th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeas i must have been sleep coding….   Sorry about that.  </p>
<p>I got it to work now but this will just give me the pageID and not the page token.</p>
<pre><code class="hljs"> Ti.Facebook.requestWithGraphPath(<span class="hljs-string">'/'</span>+ Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>), {fields: <span class="hljs-string">'access_token'</span>}, <span class="hljs-string">'GET'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(resp)</span></span> {
        <span class="hljs-keyword">if</span>(resp.success) {
            data = JSON.parse(resp.result);
            alert(data);

                    } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (resp.<span class="hljs-built_in">error</span>) {
                alert(resp.<span class="hljs-built_in">error</span>);
            } <span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">"Unkown result"</span>);
            }
        }
    });

    });
</code></pre><p>I use something similar to get public feeds from a page without needing to log in to fb. I just get the token from my FB app and use that.</p>
<p>Is it maybe something like that but for page instead of FBapp?</p>
<p>I am really clueless on how i can post a pic to a page right now…… </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
   <span class="hljs-keyword">var</span> TokenResponse = <span class="hljs-keyword">this</span>.responseText;
   <span class="hljs-keyword">var</span> TokenArray = TokenResponse.split(<span class="hljs-string">"="</span>);
   <span class="hljs-keyword">var</span> Token = TokenArray[<span class="hljs-number">1</span>];
   <span class="hljs-keyword">if</span> (Token !=<span class="hljs-string">""</span>)
   {
        <span class="hljs-comment">// with your token you can read public feeds   </span>
    getFeeds(Token);
   }    

};

xhr.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"https://graph.facebook.com/oauth/access_token?client_id=53XXXXXXXXX&amp;client_secret=d2XXXXXXXXXXXXXX&amp;grant_type=client_credentials"</span>);
xhr.send();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFeeds</span><span class="hljs-params">(Token)</span>
</span>{

 Ti.Facebook.requestWithGraphPath(Titanium.App.Properties.getString(<span class="hljs-string">"pageID"</span>) +<span class="hljs-string">'/feed'</span>, {access_token: Token}, <span class="hljs-string">'GET'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        <span class="hljs-keyword">if</span> (e.success) {

<span class="hljs-comment">//Do your thing</span>
</code></pre><p>Thanx</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 6th 2013, 11:13:46 pm">January 6th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok it seems that i need to post the picture as multipart&#x2F;form-data . How can i do that?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 7th 2013, 10:44:19 am">January 7th 2013</span>
											by <span class='authorname'>Richard Harrysson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am also looking for a solution to this? any pointers…</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 9th 2013, 6:48:56 am">October 9th 2013</span>
											by <span class='authorname'>Ramesh Jayal</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
