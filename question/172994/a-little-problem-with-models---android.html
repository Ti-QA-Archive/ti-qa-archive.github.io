<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>A little problem with models - Android » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>A little problem with models - Android</h1>
		</header>
		<section>
			<p>So, i&#39;m building an app (for Android) In ALLOY with an pre-existing database, and i&#39;l trying to feed a &lt;TableView&gt; with &lt;TableViewRows&gt; with the model info, and it doesn&#39;t work, it gives me an error, this error.</p>
<pre><code class="hljs">Location:
[<span class="hljs-number">19</span>,<span class="hljs-number">43</span>] alloy/controllers/row.js

Message:
Uncaught TypeError: Cannot read property <span class="hljs-string">'_transform'</span> <span class="hljs-keyword">of</span> undefined.

Source:
text: <span class="hljs-string">"undefined"</span>!=typeof<span class="hljs-variable">$model</span>._transform[<span class="hljs-string">"titulo"</span>] ? <span class="hljs-variable">$model</span>._tr
</code></pre><p><strong>This is my View(XML):</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menuWindow"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menuView"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"table"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">TableViewSection</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menuSection"</span> <span class="hljs-attribute">headerTitle</span>=<span class="hljs-value">"Menu"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"tareas"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tareas"</span><span class="hljs-value">onClick="abrirTareas"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"rutas"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Rutas"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"abrirRutas"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"chat"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Chat"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"abrirChat"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"sincronizar"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Sincronizar"</span>/&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">TableViewSection</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"mainView"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"tareasView"</span> <span class="hljs-attribute">datacollection</span>=<span class="hljs-value">"tarea"</span> <span class="hljs-attribute">dataTransform</span>=<span class="hljs-value">"transformData"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Require</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"row"</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"rutasView"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"rutasTable"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"ruta 1"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"rutaDetalle"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"ruta 2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"ruta 3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"ruta 4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"ruta 5"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"chatView"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Label</span>&gt;</span>Chat<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
         <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p><strong>This is my controller:</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> tareas = Alloy.Collections.tarea;

<span class="hljs-keyword">var</span> menuView=$.menuView;
menuView.setLeft(<span class="hljs-string">"-160dip"</span>);
<span class="hljs-keyword">var</span> mainView=$.mainView;
<span class="hljs-keyword">var</span> tareasView =$.tareasView;
$.chatView.setVisible(<span class="hljs-literal">false</span>);
$.rutasView.setVisible(<span class="hljs-literal">false</span>);
$.tareasView.setVisible(<span class="hljs-literal">true</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformData</span>(<span class="hljs-params">model</span>) </span>{
    <span class="hljs-keyword">var</span> attrs = model.toJSON();
    <span class="hljs-comment">// Ti.API.info('attrs: ' + JSON.stringify(attrs));</span>
    <span class="hljs-keyword">return</span> attrs;
}

<span class="hljs-comment">//Función para mostrar el menú y mover la lista de tareas para que no se sobrepongan</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mostrarMenu</span>(<span class="hljs-params"></span>)</span>{
    menuView.animate({
        left:<span class="hljs-number">0</span>,
        duration:<span class="hljs-number">400</span>,
        curve:Ti.UI.ANIMATION_CURVE_EASE_IN_OUT
    });
    mainView.animate({
        left:<span class="hljs-string">"160dip"</span>,
        duration:<span class="hljs-number">400</span>,
        curve:Ti.UI.ANIMATION_CURVE_EASE_IN_OUT
    });
}

<span class="hljs-comment">//Función para esconder el menu, y al mismo tiempo devolver la lista de tareas a su posición inicial</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">esconderMenu</span>(<span class="hljs-params"></span>)</span>{
    menuView.animate({
         left:<span class="hljs-string">"-160dip"</span>,
         duration:<span class="hljs-number">400</span>,
         curve:Ti.UI.ANIMATION_CURVE_EASE_IN_OUT
        });
    mainView.animate({
        left:<span class="hljs-string">"0"</span>,
        duration:<span class="hljs-number">400</span>,
        curve:Ti.UI.ANIMATION_CURVE_EASE_IN_OUT
    });
}

<span class="hljs-comment">//Este comando agrega un evento SWIPE a la ventana, de izquierda y derecha, para detectar cuando mostar o esconder el menu</span>
$.menuWindow.addEventListener(<span class="hljs-string">'swipe'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
   <span class="hljs-keyword">if</span> (e.direction == <span class="hljs-string">'right'</span>) {
        mostrarMenu();
   } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(e.direction==<span class="hljs-string">"left"</span>) {
           <span class="hljs-comment">// alert("prueba");</span>
        esconderMenu();
   }
});

<span class="hljs-comment">//Función para abrir la ventana tareaDetalle</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tareaDetalle</span>(<span class="hljs-params"></span>)</span>{
    _cf.openWindow(<span class="hljs-string">'tareaDetalle'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rutaDetalle</span>(<span class="hljs-params"></span>)</span>{
    _cf.openWindow(<span class="hljs-string">'rutaDetalle'</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abrirRutas</span>(<span class="hljs-params"></span>)</span>{
    $.chatView.setVisible(<span class="hljs-literal">false</span>);
    $.rutasView.setVisible(<span class="hljs-literal">true</span>);
    $.tareasView.setVisible(<span class="hljs-literal">false</span>);
    $.rutasView.setTop(<span class="hljs-string">"0dip"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abrirTareas</span>(<span class="hljs-params"></span>)</span>{
    $.chatView.setVisible(<span class="hljs-literal">false</span>);
    $.rutasView.setVisible(<span class="hljs-literal">false</span>);
    $.tareasView.setVisible(<span class="hljs-literal">true</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">abrirChat</span>(<span class="hljs-params"></span>)</span>{
    $.chatView.setVisible(<span class="hljs-literal">true</span>);
    $.rutasView.setVisible(<span class="hljs-literal">false</span>);
    $.tareasView.setVisible(<span class="hljs-literal">false</span>);
}

tareas.fetch();
</code></pre><p><strong>Here is my model</strong></p>
<pre><code class="hljs">exports.definition = {
    config: {

        <span class="hljs-string">"adapter"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"sql"</span>,
            <span class="hljs-comment">// The table name inside the sqlite database to use for</span>
            <span class="hljs-comment">// models and collections based on this definition.</span>
            <span class="hljs-string">"collection_name"</span>: <span class="hljs-string">"tarea"</span>,

            <span class="hljs-comment">// db_file tells model to use myapp.sqlite file to install</span>
            <span class="hljs-comment">// database</span>
            <span class="hljs-string">"db_file"</span>: <span class="hljs-string">"/db/eRutasDB.sqlite"</span>,

            <span class="hljs-comment">// db_name tells model to use the given name as the database</span>
            <span class="hljs-comment">// name instead of using the filename. In this case we'll be</span>
            <span class="hljs-comment">// using "fighters" instead of "myapp".</span>
            <span class="hljs-string">"db_name"</span>: <span class="hljs-string">"eRutasDB"</span>,

            <span class="hljs-comment">// idAttribute tells Alloy/Backbone to use this column in</span>
            <span class="hljs-comment">// my table as its unique identifier field. Without</span>
            <span class="hljs-comment">// specifying this, Alloy's default behavior is to create</span>
            <span class="hljs-comment">// and "alloy_id" field which will uniquely identify your</span>
            <span class="hljs-comment">// rows in the table.</span>
            <span class="hljs-string">"idAttribute"</span>: <span class="hljs-string">"id"</span>,

            <span class="hljs-comment">// remoteBackup tells Alloy to set the value of the property</span>
            <span class="hljs-comment">// Ti.Filesystem.File.remoteBackup. This setting tells iOS</span>
            <span class="hljs-comment">// whether or not to allow your database to be backed up to</span>
            <span class="hljs-comment">// iCloud or in iTunes backups.</span>
            <span class="hljs-string">"remoteBackup"</span>: <span class="hljs-literal">false</span>
        }
    }
};
</code></pre><p><strong>Here is my Alloy:</strong></p>
<pre><code class="hljs">Alloy.Collections.tarea = Alloy.createCollection(<span class="hljs-string">'tarea'</span>);
</code></pre><p><strong>Here is my row view</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span>&gt;</span>  
          <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"titulo"</span> <span class="hljs-attribute">text</span>=<span class="hljs-value">"{titulo}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p><strong>The row controller</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$model</span>) {
    $.row.model = <span class="hljs-variable">$model</span>.toJSON();
}
</code></pre><p>And here is my database estructure:</p>
<pre><code class="hljs"><span class="hljs-attribute">Table</span>:
    tarea
        <span class="hljs-attribute">colum</span>:
            id
            id_usuario
            id_formulario
            titulo
            descripcion
            estatus
</code></pre><p>Can anybody help me? please?. I&#39;m really hating models and i need some help.</p>
<p>My computer-development specifications are this:</p>
<pre><code class="hljs"><span class="hljs-tag">Macbook</span> <span class="hljs-tag">Pro</span> <span class="hljs-tag">with</span> <span class="hljs-tag">OSX</span> <span class="hljs-tag">Maverick</span> 10<span class="hljs-class">.9</span><span class="hljs-class">.2</span>
<span class="hljs-tag">Titanium</span> <span class="hljs-tag">SDK</span>: 3<span class="hljs-class">.2</span><span class="hljs-class">.2</span><span class="hljs-class">.GA</span>
<span class="hljs-tag">Titanium</span> <span class="hljs-tag">Studio</span>, <span class="hljs-tag">build</span>: 3<span class="hljs-class">.2</span><span class="hljs-class">.1</span><span class="hljs-class">.201402041146</span>
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 23rd 2014, 10:37:30 pm">April 23rd 2014</span>
				by <span class='authorname'>Oscar Armando Gallo Guido</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>backbone</span></li>
					
						<li><span class='tagname'>models</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-278091">
				
						<section>
							<p>Hi Oscar:<br>The <code>Uncaught TypeError: Cannot read property &amp;#39;_transform&amp;#39; of undefined.</code> is telling you that the transform function doesn&#39;t have a model to work on. This happens because the collection has not  been properly setup for the window.<br>I suggest you to read carefully the docs so that you get an understanding of what a Collection singleton and a Collection instance are, and how you instantiate them either programtically on a js file (ie a controller) or in a view xml.<br>In your case, you are creating a local collection in alloy.js and assigning it to an Alloy.Globals property. This is incorrect. </p>
<p>1-You can remove the alloy.js collection code.</p>
<p>2- Add  &lt;Collection src=&quot;tarea&quot; &#x2F;&gt; to your window view xml definition</p>
<p>3- Define the table view row directly on the xml file</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Collection</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"tarea"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menuWindow"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"horizontal"</span>&gt;</span>


        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"mainView"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"tareasView"</span> <span class="hljs-attribute">datacollection</span>=<span class="hljs-value">"tarea"</span> <span class="hljs-attribute">dataTransform</span>=<span class="hljs-value">"transformData"</span>&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span>&gt;</span>  
                      <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"titulo"</span> <span class="hljs-attribute">text</span>=<span class="hljs-value">"{titulo}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>

         <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>I&#39;ve got rid of less relevant parts of your code for clarity&#39;s sake.</p>
<p>Now your view knows about the &#39;tareas&#39; collection. You can actually even get rid of the data transform function as you are not doing anything with it (it can be used to generate data from the model and display this data on the view.<br>I hope this helps.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 24th 2014, 1:09:44 pm">April 24th 2014</span>
								by <span class='authorname'>Richard Lustemberg</span><br>
								<a class="icon-bg icon-link" href="question/172994/a-little-problem-with-models---android#answer-278091" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
