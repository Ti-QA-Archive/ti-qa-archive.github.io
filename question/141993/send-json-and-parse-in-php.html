<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Send JSON and parse in PHP » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Send JSON and parse in PHP</h1>
		</header>
		<section>
			<p>Hi !</p>
<p>I&#39;m searching for days now and i can&#39;t find the mistake, i send my json : </p>
<pre><code class="hljs">var xhr = Ti.Network.createHTTPClient();
xhr.open(<span class="hljs-string">"<span class="hljs-keyword">POST</span>"</span>, <span class="hljs-string">"http://****.php"</span>);
xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-<span class="hljs-number">8</span>');

var postData = {
    object: { child1:'value', child2:'value' }
}
xhr.send(JSON.stringify(postData));
</code></pre><p>And in my php, i tried : </p>
<p><code>$data = json_decode(stripslashes($_POST[&amp;#39;postData&amp;#39;]), true);</code></p>
<p><code>$data = json_decode(stripslashes($_POST[&amp;#39;object&amp;#39;]), true);</code></p>
<p><code>$data = json_decode($_POST[&amp;#39;postData&amp;#39;]);</code></p>
<p><code>$data = json_decode($_POST[&amp;#39;object&amp;#39;]);</code></p>
<p>But <code>$data</code> is always null, where did i fail ?</p>
<p>TY</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 7th 2012, 10:32:54 am">September 7th 2012</span>
				by <span class='authorname'>Maxime Charruel</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>array</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>object</span></li>
					
						<li><span class='tagname'>parse</span></li>
					
						<li><span class='tagname'>php</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-246876">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Try <code>xhr.send({myData:JSON.stringify(postData)});</code> and <code>$data = json_decode($_POST[&amp;#39;myData&amp;#39;]);</code></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 7th 2012, 12:11:54 pm">September 7th 2012</span>
								by <span class='authorname'>Shannon Hicks</span><br>
								<a class="icon-bg icon-link" href="question/141993/send-json-and-parse-in-php.html#answer-246876" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>There&#39;s no reason that I can think of to unnecessarily stringify and decode postData when you can just send the object directly.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 12:17:45 pm">September 7th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I have to vote this one back up simply on premise. This answers the OPs question in the context in which it was asked.</p>
<p>Lets not forget that our primary goal here is to first answer the question that the OP asked. If the answer is not the best solution, then we offer a better solution. Only by seeing both solutions can the OP really understand which is the better solution.</p>
<p>In this case, the question was how to send and parse json in php. Even though it may not be the logical thing to do, we should first answer the question, then offer a more logical solution.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 12:42:46 pm">September 7th 2012</span>
											by <span class='authorname'>Anthony Decena</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Anthony hit the nail on the head. Jason, for all you know the OP is using something like MongoDB on the backend, and is just using PHP as the middleman in keeping sync between a mobile database and a local one.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 12:50:21 pm">September 7th 2012</span>
											by <span class='authorname'>Shannon Hicks</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You&#39;re absolutely right – and after going back and looking at this more closely, I see that I was wrong.</p>
<p>I wasn&#39;t paying close enough attention to the output of my PHP.  While the value I got out of the php $_POST array <em>looks</em> similar to an array, it&#39;s really not.  It&#39;s just a formatted string.</p>
<p>If you change my JS and PHP to use Shannon&#39;s technique, the output looks like this:</p>
<pre><code class="hljs">stdClass <span class="hljs-built_in">Object</span>
(
    [objectlist] =&gt; Array
        (
            [<span class="hljs-number">0</span>] =&gt; stdClass <span class="hljs-built_in">Object</span>
                (
                    [id] =&gt; <span class="hljs-number">1</span>
                    [label] =&gt; one
                )

            [<span class="hljs-number">1</span>] =&gt; stdClass <span class="hljs-built_in">Object</span>
                (
                    [id] =&gt; <span class="hljs-number">2</span>
                    [label] =&gt; two
                )
        )
)
</code></pre><p>which is obviously a real PHP object, not just a formatted string.  Voting Shannon&#39;s answer up.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 1:00:11 pm">September 7th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246870">
				
						<section>
							<p>Problem 1:  don&#39;t stringify your POST data, just send it directly, like this:</p>
<pre><code class="hljs">var xhr = Ti.Network.createHTTPClient();
xhr.open(<span class="hljs-string">"<span class="hljs-keyword">POST</span>"</span>, <span class="hljs-string">"http://****.php"</span>);
xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-<span class="hljs-number">8</span>');

var postData = {
    object: { child1:'value', child2:'value' }
}
xhr.send(postData);
</code></pre><p>Problem 2:  the server won&#39;t see anything called &#39;postData&#39;.  That&#39;s just a variable name in your javascript.  The server script&#39;s $_POST data will look like this:</p>
<pre><code class="hljs"><span class="hljs-keyword">object</span>: {
    child<span class="hljs-number">1</span> = <span class="hljs-keyword">value</span>;
    child<span class="hljs-number">2</span> = <span class="hljs-keyword">value</span>;
}
</code></pre><p>So to use it, you would just do this:</p>
<pre><code class="hljs"><span class="hljs-variable">$child1</span> = $_POST[<span class="hljs-string">'child1'</span>];
<span class="hljs-variable">$child2</span> = $_POST[<span class="hljs-string">'child2'</span>];
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 7th 2012, 10:56:40 am">September 7th 2012</span>
								by <span class='authorname'>Jason Priebe</span><br>
								<a class="icon-bg icon-link" href="question/141993/send-json-and-parse-in-php.html#answer-246870" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Jason !</p>
<p>TY for your answer but this is not working.<br>It only works if i do :</p>
<p><code>xhr2.setRequestHeader(&amp;#39;Content-Type&amp;#39;, &amp;#39;application&amp;#x2F;x-www-form-urlencoded&amp;#39;);</code></p>
<p>and : </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> postData = {
    child1:<span class="hljs-string">'value1'</span>, child2:<span class="hljs-string">'value2'</span> 
}
</code></pre><p>And this is not what i want, i want to pass objects with parameters (json or not now i don&#39;t really care), but i have thousands objects with 6-7 parameters and i thought json was the best solution.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 11:55:55 am">September 7th 2012</span>
											by <span class='authorname'>Maxime Charruel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I don&#39;t understand the problem.  Let&#39;s look at what happens if we send a more complex object (or an array of objects)</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"http://****.php"</span>);
xhr.setRequestHeader('Content-<span class="hljs-keyword">Type</span>', 'application/json; charset=utf-8');

<span class="hljs-keyword">var</span> postData = {
    objectlist: [
        {
            id: 1,
            <span class="hljs-keyword">label</span>: '<span class="hljs-keyword">one</span>'
        },
        {
            id: 2,
            <span class="hljs-keyword">label</span>: '<span class="hljs-keyword">two</span>'
        }
    ]    
}

xhr.send(postData);
</code></pre><p>php:</p>
<pre><code class="hljs"><span class="hljs-built_in">print</span>_r (<span class="hljs-variable">$_POST</span>);
</code></pre><p>results in</p>
<pre><code class="hljs">Array
(
    [objectlist] =&gt; (
        {
        id = 1;
        <span class="hljs-built_in">label</span> <span class="bash">= one;
</span>    },
        {
        id = 2;
        <span class="hljs-built_in">label</span> <span class="bash">= two;
</span>    }
)
)
</code></pre><p>Doesn&#39;t this do exactly what you&#39;re talking about?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 12:28:14 pm">September 7th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Strike this – see my last response to Shannon&#39;s answer.  For anything more than scalar values, Shannon&#39;s technique is the right one.  You have to JSON encode the object.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 7th 2012, 1:01:26 pm">September 7th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246871">
				
						<section>
							<p>Jason is right, also <code>var_dump($_POST);</code> is your choice to check the passed data before trying to access it</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 7th 2012, 11:20:59 am">September 7th 2012</span>
								by <span class='authorname'>Alexander Bauer</span><br>
								<a class="icon-bg icon-link" href="question/141993/send-json-and-parse-in-php.html#answer-246871" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-247008">
				
						<section>
							<p>TY Jason, Shannon and Anthony, this was nice.<br>Sorry for late answer but i wanted to test with and without json and i finally used Shannon solution :<br><code>$data = json_decode($_POST[&amp;#39;myData&amp;#39;], true);</code></p>
<p>The second parameter return this output instead of Jason output :</p>
<pre><code class="hljs"><span class="hljs-built_in">array</span>(<span class="hljs-number">1</span>) {
  [<span class="hljs-string">"objectiflist"</span>]=&gt;
  <span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) {
    [<span class="hljs-number">0</span>]=&gt;
    <span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) {
      [<span class="hljs-string">"id"</span>]=&gt;
      <span class="hljs-keyword">int</span>(<span class="hljs-number">1</span>)
      [<span class="hljs-string">"label"</span>]=&gt;
      <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">"one"</span>
    }
    [<span class="hljs-number">1</span>]=&gt;
    <span class="hljs-built_in">array</span>(<span class="hljs-number">2</span>) {
      [<span class="hljs-string">"id"</span>]=&gt;
      <span class="hljs-keyword">int</span>(<span class="hljs-number">2</span>)
      [<span class="hljs-string">"label"</span>]=&gt;
      <span class="hljs-built_in">string</span>(<span class="hljs-number">3</span>) <span class="hljs-string">"two"</span>
    }
  }
}
</code></pre><p>And then, to get my data :<br><code>$data[&amp;#39;objectiflist&amp;#39;][0][&amp;#39;id&amp;#39;];</code></p>
<p>TY everybody for your help ;)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 10th 2012, 7:09:13 am">September 10th 2012</span>
								by <span class='authorname'>Maxime Charruel</span><br>
								<a class="icon-bg icon-link" href="question/141993/send-json-and-parse-in-php.html#answer-247008" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-263683">
				
						<section>
							<p>In my PHP (5.4) page I use the function <a href="http:&#x2F;&#x2F;php.net&#x2F;manual&#x2F;en&#x2F;function.file-get-contents.php">file_get_contents</a> to read post data, otherwise PHP don&#39;t see nothing.</p>
<pre><code class="hljs"><span class="hljs-variable">$aRequest</span> = json_decode(file_get_contents(<span class="hljs-string">'php://input'</span>), <span class="hljs-literal">true</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 31st 2013, 12:48:30 pm">May 31st 2013</span>
								by <span class='authorname'>Lorenzo Grio</span><br>
								<a class="icon-bg icon-link" href="question/141993/send-json-and-parse-in-php.html#answer-263683" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
