<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Mapview click event listener not working iOS7 » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Mapview click event listener not working iOS7</h1>
		</header>
		<section>
			<p>Hi, the event listener of Titanium.Map its not working properly on iOS7 under Titanium 3.1.3.GA.</p>
<p>If you click on the annotation pin the buble opens correctly but if you click on the buble its not responding. This was working fine on 3.1.2 with iOS6.1 and it was printing &quot;Title clicked&quot;</p>
<pre><code class="hljs">mapView.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(evt)</span></span>{
    <span class="hljs-keyword">var</span> clicksource = evt.clicksource;
    <span class="hljs-keyword">if</span> (clicksource == <span class="hljs-string">'title'</span>){  
        Ti.API.info(<span class="hljs-string">'Title clicked'</span>);                            
    }
});
</code></pre><p>Does someone know some native patch for this?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 21st 2013, 8:46:39 pm">September 21st 2013</span>
				by <span class='authorname'>Fernando Souto</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>click event</span></li>
					
						<li><span class='tagname'>ios7</span></li>
					
						<li><span class='tagname'>mapview annotation</span></li>
					
				</ul>
			

			<section>
				<h5>7 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hello , Can you send me runnable code and test case for this?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 22nd 2013, 10:07:45 am">September 22nd 2013</span>
								by <span class='authorname'>Md. Mostafizur Rahman</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Fernando,</p>
<p>Its working fine for me.</p>
<p>Thanks SP</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 23rd 2013, 4:33:02 am">September 23rd 2013</span>
								by <span class='authorname'>Sunny Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Sunny,<br>are you on 3.1.3 sdk.<br>not working on 3.1.3.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 23rd 2013, 5:26:55 am">September 23rd 2013</span>
								by <span class='authorname'>Ans Riaz</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Ans,</p>
<p>I am on 3.1.3 sdk. its working fine for me.</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 23rd 2013, 5:30:52 am">September 23rd 2013</span>
								by <span class='authorname'>Sunny Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>We&#39;re running into the same exact issue - anybody have a fix?</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 23rd 2013, 6:38:19 am">September 23rd 2013</span>
								by <span class='authorname'>Haim Barad</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Also having the same issue. Tried with both new and old Titanium SDK but it doesn&#39;t work so seems it&#39;s iOS7 that&#39;s the problem here.</p>
<p>Worst case scenario I guess we will have to put a button there, they still seem to work.<br>(If you aren&#39;t already using both left and right buttons for other purposes, that is…)</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 23rd 2013, 6:56:19 am">September 23rd 2013</span>
								by <span class='authorname'>Jimmie Jönsson</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I am also having this problem. anyone fix yet?</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 25th 2015, 7:02:23 am">August 25th 2015</span>
								by <span class='authorname'>Phillip BNK</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-268987">
				
						<section>
							<p>Hello,</p>
<p> In Map view click event, clicksource return only pin or leftButton. So you can’t get title as clicksource value. </p>
<p>Please my following code for testing. I hope that will help to you.</p>
<pre><code class="hljs">var win2 = Ti.UI.createWindow({
    <span class="hljs-string">barColor :</span> <span class="hljs-string">'#ff0000'</span>,
    <span class="hljs-string">extendEdges :</span> [Ti.UI.EXTEND_EDGE_ALL],
});

var mountainView = Titanium.Map.createAnnotation({
    <span class="hljs-string">latitude :</span> <span class="hljs-number">37.390749</span>,
    <span class="hljs-string">longitude :</span> -<span class="hljs-number">122.081651</span>,
    <span class="hljs-string">title :</span> <span class="hljs-string">"Appcelerator Headquarters"</span>,
    <span class="hljs-string">subtitle :</span> <span class="hljs-string">'Mountain View, CA'</span>,
    <span class="hljs-string">pincolor :</span> Titanium.Map.ANNOTATION_RED,
    <span class="hljs-string">animate :</span> <span class="hljs-literal">true</span>,
    <span class="hljs-string">leftButton :</span> <span class="hljs-string">'/images/arrow.png'</span>,
    <span class="hljs-string">myid :</span> <span class="hljs-number">1</span> <span class="hljs-comment">// Custom property to uniquely identify this annotation.</span>
});

var mapview = Titanium.Map.createView({
    <span class="hljs-string">mapType :</span> Titanium.Map.STANDARD_TYPE,
    <span class="hljs-string">region :</span> {
        <span class="hljs-string">latitude :</span> <span class="hljs-number">37.390749</span>,
        <span class="hljs-string">longitude :</span> -<span class="hljs-number">122.081651</span>,
        <span class="hljs-string">latitudeDelta :</span> <span class="hljs-number">0.01</span>,
        <span class="hljs-string">longitudeDelta :</span> <span class="hljs-number">0.01</span>
    },
    <span class="hljs-string">animate :</span> <span class="hljs-literal">true</span>,
    <span class="hljs-string">regionFit :</span> <span class="hljs-literal">true</span>,
    <span class="hljs-string">userLocation :</span> <span class="hljs-literal">true</span>,
    <span class="hljs-string">annotations :</span> [mountainView]
});

win2.add(mapview);
<span class="hljs-comment">// Handle click events on any annotations on this map.</span>
mapview.addEventListener(<span class="hljs-string">'click'</span>, function(evt) {
    var clicksource = evt.clicksource;
    Ti.API.info(<span class="hljs-string">"Annotation "</span> + evt.title + <span class="hljs-string">" clicked, id: "</span> + evt.annotation.myid + <span class="hljs-string">'clicksource'</span> + clicksource);

    alert(<span class="hljs-string">"Annotation "</span> + evt.title + <span class="hljs-string">", left button clicked."</span> + clicksource);

});

win2.open();
</code></pre><p>And Please visit following link <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Map.View-event-click">Map View</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 23rd 2013, 9:28:17 am">September 23rd 2013</span>
								by <span class='authorname'>Md. Mostafizur Rahman</span><br>
								<a class="icon-bg icon-link" href="question/157471/mapview-click-event-listener-not-working-ios7#answer-268987" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Mostafizur,</p>
<p>I find the following on Mapview:</p>
<p>&quot;On iOS, if the user clicks on the pin or annotation, the clicksource is one of: pin, annotation, leftButton, rightButton, leftView, rightView, title, or subtitle. If the user deselects the annotation by clicking elsewhere in the map view, clicksource is null.&quot;</p>
<p>And when checking the &quot;clicksource&quot; it says:<br>&quot;Source of the click event,  <strong>such as</strong> pin, or leftButton.&quot; , not that pin or leftButton are the only clicksources?</p>
<p>Shouldn&#39;t title and subtitle work also? It sure has before.</p>
<p>Am I misunderstanding?</p>
<p>Thanks in advance</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 23rd 2013, 11:43:50 am">September 23rd 2013</span>
											by <span class='authorname'>Jimmie Jönsson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Mostafizur,</p>
<p>We´re running the issue on 3.1.3 sdk iOS7 but it was working under 3.1.2 sdk iOS6.</p>
<p>We &quot;solved&quot; adding a rightButton and now the mapview event listener it´s responding to &#39;rightButton&#39;.</p>
<pre><code class="hljs">mapView.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(evt)</span></span>{
    <span class="hljs-keyword">var</span> clicksource = evt.clicksource;
    <span class="hljs-keyword">if</span> (clicksource == <span class="hljs-string">'title'</span> || clicksorce == <span class="hljs-string">'rightButton'</span>){  
        Ti.API.info(<span class="hljs-string">'Item clicked'</span>);                           
    }
});
</code></pre><p>So now iOS6 its responding to <em>title</em> and <em>rightButton</em> and iOS7 is responding only for <em>rightButton</em>.</p>
<p>We will apreciate if anybody could make a native patch for this issue.</p>
<p>Thx.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 23rd 2013, 6:41:22 pm">September 23rd 2013</span>
											by <span class='authorname'>Fernando Souto</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello, You can add request or create bug via https:&#x2F;&#x2F;jira.appcelerator.org. Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 24th 2013, 5:25:00 am">September 24th 2013</span>
											by <span class='authorname'>Md. Mostafizur Rahman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>has anyone added a JIRA bug for this yet? It&#39;s probably an underlying iOS bug, of course…</p>
<p>It&#39;s very easy to see though - just log the value of clicksource as you click on different parts of an annotation. When running under iOS 6 Simulator, they&#39;re as documented (Modules.Map.View events), but when running under iOS 7 Simulator you get rightButton (when you have a right button defined) even if you click on the title or subtitle.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 12th 2013, 9:13:12 am">December 12th 2013</span>
											by <span class='authorname'>James Grinter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>to answer my own question, https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-15448 and https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-15545 seem related.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 12th 2013, 9:16:03 am">December 12th 2013</span>
											by <span class='authorname'>James Grinter</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-274058">
				
						<section>
							<p>I have found a workaround by using &quot;leftView&quot; and &quot;rightView&quot; annotation attributes.</p>
<p>Remember, you have to detect the events for the recently created views.</p>
<p>Implementatio algorithm:</p>
<p>yourView = create view with the image</p>
<p>annotation.leftView = yourView;</p>
<p>yourView.addEventListener(&#39;click&#39;, function(e){<br>    alert(&#39;This way you will have click events again!&#39;);<br>});</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 17th 2014, 1:19:01 pm">January 17th 2014</span>
								by <span class='authorname'>Joao Silva</span><br>
								<a class="icon-bg icon-link" href="question/157471/mapview-click-event-listener-not-working-ios7#answer-274058" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287901">
				
						<section>
							<p>I tried the above workaround, but it didn&#39;t work.<br>I follow the same approach by making a rightView but instead of Click event I used singletap event and it working properly. </p>
<pre><code class="hljs">annotationRightView.addEventListener(<span class="hljs-string">"singletap"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
    annoListener(e);
});
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 9th 2015, 11:57:22 pm">August 9th 2015</span>
								by <span class='authorname'>Ali Al-Qaissey</span><br>
								<a class="icon-bg icon-link" href="question/157471/mapview-click-event-listener-not-working-ios7#answer-287901" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287909">
				
						<section>
							<p>I experienced the same problem. I used the &quot;singletap&quot; proposal from Ali Al-Qaissey with Joao Silva&#39;s workaround and it works. Put an image of the greater than &quot;&gt;&quot; symbol onto the button to make it look like the pin annotations on Apple Maps.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 11th 2015, 2:37:09 pm">August 11th 2015</span>
								by <span class='authorname'>Charles Rethman</span><br>
								<a class="icon-bg icon-link" href="question/157471/mapview-click-event-listener-not-working-ios7#answer-287909" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287910">
				
						<section>
							<p>What I used and works without anyproblem is as follow:</p>
<pre><code class="hljs">var annotationRightView = Ti.UI.createView({
                    backgroundImage:<span class="hljs-string">"/images/annotationRightButton.png"</span>,
                    height:<span class="hljs-number">30</span>,
                    width:<span class="hljs-number">30</span>,
                    id:<span class="hljs-string">"rightButton"</span>,


                });
l.rightView= annotationRightView;
</code></pre><p>&quot;l&quot; is the created annotation variable</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 12th 2015, 12:04:46 am">August 12th 2015</span>
								by <span class='authorname'>Ali Al-Qaissey</span><br>
								<a class="icon-bg icon-link" href="question/157471/mapview-click-event-listener-not-working-ios7#answer-287910" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
