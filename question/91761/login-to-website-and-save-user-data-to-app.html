<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>login to website and save user data to app » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>login to website and save user data to app</h1>
		</header>
		<section>
			<p>I want a user to login to my app using a username and password which is then sent to a website for verification. If true then the users profile data will be sent back to the app as json. If false then an alert is sent to the user.   This is all working. My problem is the next step.  I want to take the json returned from the website and store the users profile data into a sqlite database I already have stored in the app so I and auto log them in next time. </p>
<p>Here is my code https:&#x2F;&#x2F;gist.github.com&#x2F;747600</p>
<p>I am getting the following error</p>
<pre><code class="hljs"><span class="hljs-setting">line = <span class="hljs-value"><span class="hljs-number">9</span>;</span></span>
<span class="hljs-setting">message = <span class="hljs-value"><span class="hljs-string">"Can't find variable: name"</span>;</span></span>
</code></pre><p>It seems to me that the variables I&#39;ve set in line 65 are not being properly read or passed back into the insert statement on line 9. </p>
<p>I know this is probably a fairly standard functionality but I am just banging my head on it.  I&#39;d appreciate any help.  </p>
<p>Thanks.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 19th 2010, 5:31:17 pm">December 19th 2010</span>
				by <span class='authorname'>Forrest Frazier</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>what version of the SDK are you using?</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 20th 2010, 1:08:39 am">December 20th 2010</span>
								by <span class='authorname'>Aaron Saunders</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I&#39;m using Titanium 1.2.2 and iphone SDK 4.2</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 20th 2010, 2:16:48 am">December 20th 2010</span>
								by <span class='authorname'>Forrest Frazier</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-207301">
				
						<section>
							<p>Mate try to change the insert:</p>
<pre><code class="hljs">
WRONG!!
  var theData = db.execute('<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">users</span> (username, email)
                        <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">"'+name.value+'"</span>,<span class="hljs-string">"'+email.value+'"</span>)<span class="hljs-string">');


CORRECT!!
  var theData = db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">users</span> (username, email)
                        <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">"'+dbData.name+'"</span>,<span class="hljs-string">"'+dbData.email+'"</span>)<span class="hljs-string">');

};</span></span>
</code></pre><p>you get the array dbData so insert &quot;&quot; instead of &quot;name.value&quot;</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 5th 2011, 8:12:45 am">May 5th 2011</span>
								by <span class='authorname'>Dennis van den Ende</span><br>
								<a class="icon-bg icon-link" href="question/91761/login-to-website-and-save-user-data-to-app#answer-207301" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-165501">
				
						<section>
							<p>get the paramaters properly from JSON object</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">VALUES</span><span class="hljs-params">(<span class="hljs-string">"'+ dbData.name +'"</span>,<span class="hljs-string">"'+dbData.email+'"</span>)</span></span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 19th 2010, 5:35:36 pm">December 19th 2010</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/91761/login-to-website-and-save-user-data-to-app#answer-165501" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That is what I first did however when using that code my app automatically closes upon clicking the login button and I get no information other than </p>
<pre><code class="hljs">[INFO] Application <span class="hljs-keyword">has</span> exited <span class="hljs-keyword">from</span> Simulator
</code></pre><p>in the console.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 19th 2010, 6:59:57 pm">December 19th 2010</span>
											by <span class='authorname'>Forrest Frazier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I attempted using your code again and finally (after running through it about 8 times) got some feedback in the console.</p>
<pre><code class="hljs"> *** Terminating app due <span class="hljs-keyword">to</span> uncaught exception 'org.myapp.TiDatabaseProxy', reason: 'invalid SQL statement. Error Domain=com.plausiblelabs.pldatabase Code=<span class="hljs-number">3</span> <span class="hljs-string">"An error occured parsing the provided SQL statement."</span> UserInfo=<span class="hljs-number">0xb129e50</span> {com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.vendor.code=<span class="hljs-number">26</span>, NSLocalizedDescription=An <span class="hljs-keyword">error</span> occured parsing <span class="hljs-keyword">the</span> provided SQL statement., com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.query.<span class="hljs-type">string</span>=INSERT INTO users (username, email) VALUES(<span class="hljs-string">"firstuser"</span>,<span class="hljs-string">"firstuser@example.com"</span>), com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.vendor.<span class="hljs-type">string</span>=<span class="hljs-type">file</span> <span class="hljs-keyword">is</span> encrypted <span class="hljs-keyword">or</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> a database} <span class="hljs-keyword">in</span> -[TiDatabaseProxy execute:] (TiDatabaseProxy.m:<span class="hljs-number">134</span>)'
*** Call stack <span class="hljs-keyword">at</span> <span class="hljs-keyword">first</span> throw:
</code></pre><p>The values are correct so it looks like the sql statement is wrong. I looked at the kitchen sink example of sql inserts and this appears to be following the same constructs. </p>
<p>Still trying to figure this out.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 19th 2010, 8:50:45 pm">December 19th 2010</span>
											by <span class='authorname'>Forrest Frazier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i would check your database file…. there error indicates there is something wrong</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 19th 2010, 10:33:39 pm">December 19th 2010</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-165591">
				
						<section>
							<p>Change database path to this, I am assuming you have the db in the Resources directory</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'myapp.sqlite'</span>,<span class="hljs-string">'users'</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 19th 2010, 10:37:02 pm">December 19th 2010</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/91761/login-to-website-and-save-user-data-to-app#answer-165591" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>The path is correct as the database in in the Resources directory but my file is one directory deeper.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 12:04:57 am">December 20th 2010</span>
											by <span class='authorname'>Forrest Frazier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>where are you getting the database from initially? Did you validated that the database is the proper version? My hunch based on the fact that it is in the proper directory, but generating that error, is that it is simply the wrong version</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 12:24:07 am">December 20th 2010</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I built the database in navicat.  Its one table, no rows.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 12:52:38 am">December 20th 2010</span>
											by <span class='authorname'>Forrest Frazier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>this file must be in the SQLite 3 file format.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 1:08:12 am">December 20th 2010</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Verified the database using the firefox plugin, resaved it using SQLite 3.7.1</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 2:19:38 am">December 20th 2010</span>
											by <span class='authorname'>Forrest Frazier</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>and you are getting the same error?</p>
<pre><code class="hljs">var db = <span class="hljs-type">Ti</span>.<span class="hljs-type">Database</span>.install(<span class="hljs-symbol">'myapp</span>.sqlite',<span class="hljs-symbol">'myapp</span>.sqlite');
</code></pre><p>saw this when looking through the Q&amp;A forum</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2010, 11:45:37 pm">December 20th 2010</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
