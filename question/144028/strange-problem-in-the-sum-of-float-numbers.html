<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Strange problem in the sum of float numbers » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Strange problem in the sum of float numbers</h1>
		</header>
		<section>
			<p>Hello to all you guys! I encountered a strange problem while the sum of float numbers. Basically I have a function here in step two values, the function takes the first of these values ??and adds it to the previous ones passed. The problem is that the sum of the float numbers is not correct … for example by adding 6.90 + 6.90 + 6.90 is 20.700000000000003 ..</p>
<p>this is my function…</p>
<pre><code class="hljs">addCart.addEventListener(<span class="hljs-string">'touchend'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{

            <span class="hljs-keyword">if</span> (e.source.id == <span class="hljs-number">0</span>) {
                nome = <span class="hljs-string">"Pizzaccia Chef"</span>;
                prezzo = <span class="hljs-number">6.50</span>;

                nuovaRow(nome,prezzo);

            }
.
.
.
</code></pre><pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nuovaRow</span><span class="hljs-params">(n, p)</span></span> {
    //Ti.API.info(p.replace(<span class="hljs-string">' €'</span>, <span class="hljs-string">''</span>));
    somma = somma + p;
    tot.text = <span class="hljs-string">"Tot : "</span> + somma + <span class="hljs-string">" €"</span>;

.
.
.
</code></pre><p>how can I solve this problem?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 26th 2012, 3:42:20 pm">October 26th 2012</span>
				by <span class='authorname'>nicolò monili</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>float</span></li>
					
						<li><span class='tagname'>parsefloat</span></li>
					
						<li><span class='tagname'>sum number</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-250046">
				
						<section>
							<p><a href="http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;1458633&#x2F;elegant-workaround-for-javascript-floating-point-number-problem">http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;1458633&#x2F;elegant-workaround-for-javascript-floating-point-number-problem</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 26th 2012, 4:08:42 pm">October 26th 2012</span>
								by <span class='authorname'>Shannon Hicks</span><br>
								<a class="icon-bg icon-link" href="question/144028/strange-problem-in-the-sum-of-float-numbers#answer-250046" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-250050">
				
						<section>
							<p>This is the nature of floating-point math. It can&#39;t precisely represent all numbers, so errors are introduced. See, for example, <a href="http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Floating_point#Accuracy_problems">Wikipedia on Floating Point Accuracy Problems</a>.</p>
<p>You can use toFixed to round to the appropriate number of digits:</p>
<pre><code class="hljs">somma = <span class="hljs-comment">(somma + p)</span>.toFixed<span class="hljs-comment">(2)</span>;
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 26th 2012, 4:22:21 pm">October 26th 2012</span>
								by <span class='authorname'>Arthur Evans</span><br>
								<a class="icon-bg icon-link" href="question/144028/strange-problem-in-the-sum-of-float-numbers#answer-250050" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>i tried so<br>somma = somma + p;<br>somma.toFixed(2);</p>
<p>but the problem persists</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 4:46:54 pm">October 26th 2012</span>
											by <span class='authorname'>nicolò monili</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>toFixed(2) is a method on the Number class that <em>returns</em> the value rounded to two decimal places. So:</p>
<pre><code class="hljs">somma = <span class="hljs-comment">(somma + p)</span>.toFixed<span class="hljs-comment">(2)</span>;
</code></pre><p>Is what you want. Add two floats, round the result, then assign to somma.</p>
<p>It is not perfect–the BigDecimal class mentioned in Shannon&#39;s answer is going to be more accurate. But toFixed is a lot simpler and probably accurate enough if you&#39;re primarily doing addition and subtraction.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 5:35:18 pm">October 26th 2012</span>
											by <span class='authorname'>Arthur Evans</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>if i use : <code>somma = (somma + p).toFixed(2);</code></p>
<p><code>message = &amp;quot;&amp;#39;undefined&amp;#39; is not a function (evaluating &amp;#39;(somma + p).toFixed(2)&amp;#39;)&amp;quot;;</code></p>
</p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 5:39:59 pm">October 26th 2012</span>
											by <span class='authorname'>nicolò monili</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the first time that sum, sum correctly …<br>but the second one by mistake …</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 5:47:32 pm">October 26th 2012</span>
											by <span class='authorname'>nicolò monili</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It sounds like somewhere in your code you&#39;re implicitly converting somma or prezzo to a string. You can cast them back to Number by multiplying by 1.0:</p>
<pre><code class="hljs">    somma = (somma*<span class="hljs-number">1.0</span> + p*<span class="hljs-number">1.0</span>).toFixed(<span class="hljs-number">2</span>);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 6:14:23 pm">October 26th 2012</span>
											by <span class='authorname'>Arthur Evans</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>thank you very much!! Now it works perfectly! THANKS AGAIN!</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 26th 2012, 6:22:01 pm">October 26th 2012</span>
											by <span class='authorname'>nicolò monili</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You can also use unary &quot;+&quot; operator to cast to integer (it&#39;s a bit shorter form):</p>
<pre><code class="hljs">somma = <span class="hljs-comment">(+somma + +p)</span>.toFixed<span class="hljs-comment">(2)</span>;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="October 27th 2012, 5:56:51 am">October 27th 2012</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
