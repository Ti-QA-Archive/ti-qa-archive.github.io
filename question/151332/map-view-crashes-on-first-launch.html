<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Map view crashes on first launch Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Map view crashes on first launch</h1>
		</header>
		<section>
			<p>Hi<br>I am currently using Titanium SDK 3.0.0.</p>
<p>In my app i am opening a window and adding two views to it : a list view and a map view. The map view is set using the previously acquired current lat, lon.</p>
<p>When i install the app for the first time (tested on Samsung S2, and HTC Explore), the app crashes as soon as that particular window is opened. After commenting various snippets of code, i  came to the conclusion that the app crashes when i add the map to its view.</p>
<p>The app works fine on subsequent runs.</p>
<pre><code class="hljs">    lv.purchase_win = Ti.UI.createWindow({
        <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'white'</span>,
        <span class="hljs-string">tabHeight :</span> <span class="hljs-string">'20dp'</span>,
        <span class="hljs-string">orientationModes :</span> [Titanium.UI.PORTRAIT],
        <span class="hljs-string">navBarHidden :</span> <span class="hljs-literal">true</span>,
    });
    lv.purchase_win.open();

    lv.infoBar = createTopBar(lv.purchase_win, <span class="hljs-string">"purchase"</span>, <span class="hljs-literal">true</span>);

    lv.list_view = Ti.UI.createView({                <span class="hljs-comment">//View for the list</span>
        <span class="hljs-string">top :</span> <span class="hljs-string">'60dp'</span>,
        <span class="hljs-string">layout :</span> <span class="hljs-string">'vertical'</span>,
        <span class="hljs-string">height :</span> Ti.UI.SIZE,
    });

    lv.map_view = Ti.UI.createView({            <span class="hljs-comment">//View for the map    </span>
        <span class="hljs-string">top :</span> <span class="hljs-string">'60dp'</span>,
        <span class="hljs-string">layout :</span> <span class="hljs-string">'vertical'</span>,
        <span class="hljs-string">height :</span> Ti.UI.SIZE,
        <span class="hljs-string">visible :</span> <span class="hljs-literal">false</span>,
    });

    lv.purchase_win.add(lv.list_view);
    lv.map_view.hide();
    lv.purchase_win.add(lv.map_view);

    lv.map = Ti.Map.createView({
        <span class="hljs-string">top :</span> <span class="hljs-number">0</span>,
        <span class="hljs-string">mapType :</span> Titanium.Map.STANDARD_TYPE,
        <span class="hljs-string">regionFit :</span> <span class="hljs-literal">true</span>,
        <span class="hljs-string">animate :</span> <span class="hljs-literal">true</span>,
        <span class="hljs-string">touchEnabled :</span> <span class="hljs-literal">true</span>,
        <span class="hljs-string">userLocation :</span> <span class="hljs-literal">true</span>,
        <span class="hljs-string">region :</span> {

            <span class="hljs-string">latitude :</span> Ti.App.currentLat,
            <span class="hljs-string">longitude :</span> Ti.App.currentLon,
            <span class="hljs-string">latitudeDelta :</span> <span class="hljs-number">0.5</span>,
            <span class="hljs-string">longitudeDelta :</span> <span class="hljs-number">0.5</span>
        }

    });
    lv.map_view.add(lv.map);                <span class="hljs-comment">// Line causing the crash(probably)</span>
</code></pre><p>Could you please tell me what the problem might be?</p>
<p>Thank you.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 22nd 2013, 3:37:45 am">April 22nd 2013</span>
				by <span class='authorname'>Harsh Pathak</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>map</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-261241">
				
						<section>
							<p>Hi Harsh,</p>
<p>Android support only one map view at a time in application. if you open map view in other window and again open map window, then your app definitely crashes.</p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2013, 3:59:49 am">April 22nd 2013</span>
								by <span class='authorname'>Sunny Patel</span><br>
								<a class="icon-bg icon-link" href="question/151332/map-view-crashes-on-first-launch#answer-261241" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Sunny,<br>I am opening just one map. The other view contains a simple table with data. And no other window contains a map.<br>Thank you</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 4:08:37 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Harsh,<br>can you please provide error log here?</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 4:11:14 am">April 22nd 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am sorry. I am not quite sure how to post an error log. its kind of huge.<br>Could you help me a bit there?</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 5:09:36 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Just copy all the error log and paste in text file.<br>then send me on my devlink mail. so i will check and get back to you.</p>
<p>THanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 5:12:14 am">April 22nd 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did you get the bug log?</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 6:43:16 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>yes i got.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 7:10:22 am">April 22nd 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i checked that, but i could not find any issue related to map.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 7:11:06 am">April 22nd 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-261237">
				
						<section>
							<p>Harsh pzl check whether the value really exist by showing in alert.you could also check by giving absolute value</p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2013, 3:44:51 am">April 22nd 2013</span>
								by <span class='authorname'>Muhammad Wahhab Mirza</span><br>
								<a class="icon-bg icon-link" href="question/151332/map-view-crashes-on-first-launch#answer-261237" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I am sorry.. which value are you talking about?<br>If you are referring to the location coordinates, i have checked that. I am getting the right coordinates before the creation of the map.<br>And i did not understand the absolute value part.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 3:54:27 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>do something like this and let me know if it still crash</p>
<pre><code class="hljs">  latitude :<span class="hljs-number">105</span>,
            longitude : <span class="hljs-number">50</span>,
</code></pre><p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 3:58:04 am">April 22nd 2013</span>
											by <span class='authorname'>Muhammad Wahhab Mirza</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry, its still crashing.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 4:07:26 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-261253">
				
						<section>
							<p>hi,</p>
<p>so i think this is the problem with 3.0.0 SDK , just check your AndroidManifest.xml file there should be <strong>ti.modules.titanium.map.TiMapActivity</strong> activity tag existed but if you not found that tab then you should add this tag manually.</p>
<p>so just copy your manifest file and create folder named platform in your project root and create another folder named android in platform folder then paste copied manifest file in android folder then add the following tag after main activity tag.</p>
<pre><code class="hljs">&lt;activity
            android:<span class="hljs-property">name</span>=<span class="hljs-string">"ti.modules.titanium.map.TiMapActivity"</span>
            android:configChanges=<span class="hljs-string">"keyboardHidden|orientation"</span>
            android:launchMode=<span class="hljs-string">"singleTask"</span>
            android:screenOrientation=<span class="hljs-string">"portrait"</span> /&gt;

&lt;uses-library android:<span class="hljs-property">name</span>=<span class="hljs-string">"com.google.android.maps"</span> /&gt;
</code></pre><p><strong>then clean build project and also remove app from emulator and&#x2F;or device then try</strong></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2013, 6:44:41 am">April 22nd 2013</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="question/151332/map-view-crashes-on-first-launch#answer-261253" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>OK. so the tag was present in the manifest file.<br>Still i created the folders as you have mentioned and added the manifest file there too.<br>The app is still crashing.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2013, 7:01:08 am">April 22nd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-261270">
				
						<section>
							<p>Add this to your tiapp.xml:</p>
<pre><code class="hljs">...
    &lt;android <span class="hljs-string">xmlns:</span>android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>&gt;
        &lt;manifest&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"android.permission.INTERNET"</span>/&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span>/&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"android.permission.ACCESS_COARSE_LOCATION"</span>/&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"com.google.android.providers.gsf.permission.READ_GSERVICES"</span>/&gt;
            &lt;uses-feature <span class="hljs-string">android:</span>glEsVersion=<span class="hljs-string">"0x00020000"</span> <span class="hljs-string">android:</span>required=<span class="hljs-string">"true"</span>/&gt;
            &lt;uses-permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"APP ID.permission.MAPS_RECEIVE"</span>/&gt;
            &lt;permission <span class="hljs-string">android:</span>name=<span class="hljs-string">"APP ID.permission.MAPS_RECEIVE"</span> <span class="hljs-string">android:</span>protectionLevel=<span class="hljs-string">"signature"</span>/&gt;
            &lt;application&gt;
                &lt;meta-data <span class="hljs-string">android:</span>name=<span class="hljs-string">"com.google.android.maps.v2.API_KEY"</span> <span class="hljs-string">android:</span>value=<span class="hljs-string">"YOUR API KEY"</span>/&gt;
            &lt;/application&gt;
            &lt;activity <span class="hljs-string">android:</span>name=<span class="hljs-string">"ti.modules.titanium.map.TiMapActivity"</span> <span class="hljs-string">android:</span>configChanges=<span class="hljs-string">"keyboardHidden|orientation"</span> <span class="hljs-string">android:</span>launchMode=<span class="hljs-string">"singleTask"</span> <span class="hljs-string">android:</span>screenOrientation=<span class="hljs-string">"portrait"</span> /&gt;
             &lt;uses-library <span class="hljs-string">android:</span>name=<span class="hljs-string">"com.google.android.maps"</span> /&gt;
        &lt;/manifest&gt;
    &lt;/android&gt;
...
</code></pre><p>Replace <strong>APP ID</strong> with your app id and replace <strong>YOUR API KEY</strong> with your api v2 key.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2013, 8:52:32 am">April 22nd 2013</span>
								by <span class='authorname'>Ian den Hamer</span><br>
								<a class="icon-bg icon-link" href="question/151332/map-view-crashes-on-first-launch#answer-261270" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hey Ian<br>I am using version 1 and i think this is required for version 2. Or should i add it anyways?<br>Thank you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 23rd 2013, 2:16:40 am">April 23rd 2013</span>
											by <span class='authorname'>Harsh Pathak</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
