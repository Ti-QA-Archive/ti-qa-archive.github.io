<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Using JSON but getting [ERROR] Error Domain=com.google.GDataXML Code=-1 » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Using JSON but getting [ERROR] Error Domain=com.google.GDataXML Code=-1</h1>
		</header>
		<section>
			<p>We have verified the header from my App to IIS is application&#x2F;json, the server is processing into a .net object doing its task, and returning the properly formatted json with content-type of application&#x2F;json also.</p>
<p>However, I am getting:</p>
<pre><code class="hljs">[ERROR] Error Domain=com<span class="hljs-class">.google</span><span class="hljs-class">.GDataXML</span> Code=-<span class="hljs-number">1</span> <span class="hljs-string">"The operation couldn’t be completed. (com.google.GDataXML error -1.)"</span>.   <span class="hljs-keyword">in</span> -[TiDOMDocumentProxy parseString:] (TiDOMDocumentProxy<span class="hljs-class">.m</span>:<span class="hljs-number">57</span>)
</code></pre><p><em>WE</em> are not calling .reponseXML or anything like that - so what made the core code think that it needed to use the XML engine? It freezes up our app and does not call onerror, nor onload events… I am just hung waiting for one to fire. The code works for plain text, html, xml, not when we use JSON and this project uses JSON. The error is down in the Titanium framework… how do we get around this? I tried to set the accept on the Titanium app, did not change it.</p>
<p>Thanks,<br>Ozz</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 5th 2012, 4:52:00 pm">July 5th 2012</span>
				by <span class='authorname'>Ozz Nixon</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>application/json</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>xml</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>need some code to help mate…</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 5th 2012, 4:54:49 pm">July 5th 2012</span>
								by <span class='authorname'>Nick Milner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>ITS NOT MY CODE. My framework works with everything but JSON. The error is happening in the framework as posted in my initial question. My code never gets the response…</p>
<p>My code looks like:</p>
<pre><code class="hljs">      <span class="hljs-keyword">ws</span> = <span class="hljs-string">'{"deviceID":"your_momma"}'</span>;

      comm_state = <span class="hljs-number">1</span>;
      PluginManager.plugins[<span class="hljs-string">"communications"</span>].<span class="hljs-built_in">call</span>(<span class="hljs-string">"post"</span>, <span class="hljs-string">"json"</span>, <span class="hljs-string">"http://192.168.24.124/eProServicesWeb/eProService.svc/GetStudiesForDevice?deviceid=your_momma"</span>, <span class="hljs-keyword">ws</span>);
</code></pre><p>tmpdump back from the web server:</p>
<pre><code class="hljs">    <span class="hljs-number">0x0040</span>:  efc5 <span class="hljs-number">4854</span> <span class="hljs-number">5450</span> <span class="hljs-number">2f</span>31 <span class="hljs-number">2e31</span> <span class="hljs-number">2032</span> <span class="hljs-number">3030</span> <span class="hljs-number">204f</span>  ..HTTP/<span class="hljs-number">1.1</span><span class="hljs-number">.200</span>.O
    <span class="hljs-number">0x0050</span>:  <span class="hljs-number">4</span>b0d <span class="hljs-number">0</span>a43 <span class="hljs-number">6f</span>6e <span class="hljs-number">7465</span> <span class="hljs-number">6e74</span> <span class="hljs-number">2</span>d54 <span class="hljs-number">7970</span> <span class="hljs-number">653</span>a  K..Content-Type:
    <span class="hljs-number">0x0060</span>:  <span class="hljs-number">2074</span> <span class="hljs-number">6578</span> <span class="hljs-number">742f</span> <span class="hljs-number">706</span>c <span class="hljs-number">6169</span> <span class="hljs-number">6e0</span>d <span class="hljs-number">0</span>a43 <span class="hljs-number">6f</span>6e  .text/plain..Con
    <span class="hljs-number">0x0070</span>:  <span class="hljs-number">7465</span> <span class="hljs-number">6e74</span> <span class="hljs-number">2</span>d45 <span class="hljs-number">6e63</span> <span class="hljs-number">6f</span>64 <span class="hljs-number">696</span>e <span class="hljs-number">673</span>a <span class="hljs-number">2067</span>  tent-Encoding:.g
    <span class="hljs-number">0x0080</span>:  <span class="hljs-number">7</span>a69 <span class="hljs-number">700</span>d <span class="hljs-number">0</span>a56 <span class="hljs-number">6172</span> <span class="hljs-number">793</span>a <span class="hljs-number">2041</span> <span class="hljs-number">6363</span> <span class="hljs-number">6570</span>  zip..Vary:.Accep
    <span class="hljs-number">0x0090</span>:  <span class="hljs-number">742</span>d <span class="hljs-number">456</span>e <span class="hljs-number">636f</span> <span class="hljs-number">6469</span> <span class="hljs-number">6e67</span> <span class="hljs-number">0</span>d0a <span class="hljs-number">5365</span> <span class="hljs-number">7276</span>  t-Encoding..Serv
    <span class="hljs-number">0x00a0</span>:  <span class="hljs-number">6572</span> <span class="hljs-number">3</span>a20 <span class="hljs-number">4</span>d69 <span class="hljs-number">6372</span> <span class="hljs-number">6f</span>73 <span class="hljs-number">6f</span>66 <span class="hljs-number">742</span>d <span class="hljs-number">4949</span>  er:.Microsoft-II
    <span class="hljs-number">0x00b0</span>:  <span class="hljs-number">532f</span> <span class="hljs-number">372</span>e <span class="hljs-number">350</span>d <span class="hljs-number">0</span>a58 <span class="hljs-number">2</span>d50 <span class="hljs-number">6f</span>77 <span class="hljs-number">6572</span> <span class="hljs-number">6564</span>  S/<span class="hljs-number">7.5</span>..X-Powered
    <span class="hljs-number">0x00c0</span>:  <span class="hljs-number">2</span>d42 <span class="hljs-number">793</span>a <span class="hljs-number">2041</span> <span class="hljs-number">5350</span> <span class="hljs-number">2e4</span>e <span class="hljs-number">4554</span> <span class="hljs-number">0</span>d0a <span class="hljs-number">4461</span>  -By:.ASP.NET..Da
    <span class="hljs-number">0x00d0</span>:  <span class="hljs-number">7465</span> <span class="hljs-number">3</span>a20 <span class="hljs-number">5468</span> <span class="hljs-number">752</span>c <span class="hljs-number">2030</span> <span class="hljs-number">3520</span> <span class="hljs-number">4</span>a75 <span class="hljs-number">6</span>c20  te:.Thu,<span class="hljs-number">.05</span>.Jul.
    <span class="hljs-number">0x00e0</span>:  <span class="hljs-number">3230</span> <span class="hljs-number">3132</span> <span class="hljs-number">2031</span> <span class="hljs-number">383</span>a <span class="hljs-number">3535</span> <span class="hljs-number">3</span>a35 <span class="hljs-number">3620</span> <span class="hljs-number">474</span>d  <span class="hljs-number">2012.18</span>:<span class="hljs-number">55</span>:<span class="hljs-number">56.</span>GM
    <span class="hljs-number">0x00f0</span>:  <span class="hljs-number">540</span>d <span class="hljs-number">0</span>a43 <span class="hljs-number">6f</span>6e <span class="hljs-number">6e65</span> <span class="hljs-number">6374</span> <span class="hljs-number">696f</span> <span class="hljs-number">6e3</span>a <span class="hljs-number">2063</span>  T..Connection:.c
    <span class="hljs-number">0x0100</span>:  <span class="hljs-number">6</span>c6f <span class="hljs-number">7365</span> <span class="hljs-number">0</span>d0a <span class="hljs-number">436f</span> <span class="hljs-number">6e74</span> <span class="hljs-number">656</span>e <span class="hljs-number">742</span>d <span class="hljs-number">4</span>c65  lose..Content-Le
    <span class="hljs-number">0x0110</span>:  <span class="hljs-number">6e67</span> <span class="hljs-number">7468</span> <span class="hljs-number">3</span>a20 <span class="hljs-number">3135</span> <span class="hljs-number">340</span>d <span class="hljs-number">0</span>a0d <span class="hljs-number">0</span>a1f <span class="hljs-number">8</span>b08  ngth:<span class="hljs-number">.154</span>.......
</code></pre><p>it never fires onerror nor onload. In this run, I changed IIS to return the header of text&#x2F;plain, and it still tried to parse it with the XML engine. See below, you will see, it happens before firing onerror or onload:</p>
<pre><code class="hljs">[INFO] Thu Jul <span class="hljs-number">05</span> <span class="hljs-number">2012</span> <span class="hljs-number">15</span>:<span class="hljs-number">04</span>:<span class="hljs-number">07</span> GMT-<span class="hljs-number">0400</span> (EDT) onreadystatechange
[INFO] Thu Jul <span class="hljs-number">05</span> <span class="hljs-number">2012</span> <span class="hljs-number">15</span>:<span class="hljs-number">04</span>:<span class="hljs-number">07</span> GMT-<span class="hljs-number">0400</span> (EDT) onreadystatechange
[INFO] Thu Jul <span class="hljs-number">05</span> <span class="hljs-number">2012</span> <span class="hljs-number">15</span>:<span class="hljs-number">04</span>:<span class="hljs-number">07</span> GMT-<span class="hljs-number">0400</span> (EDT) onreadystatechange
[INFO] Thu Jul <span class="hljs-number">05</span> <span class="hljs-number">2012</span> <span class="hljs-number">15</span>:<span class="hljs-number">04</span>:<span class="hljs-number">08</span> GMT-<span class="hljs-number">0400</span> (EDT) ondatastream: <span class="hljs-number">1</span> of undefined
[INFO] Thu Jul <span class="hljs-number">05</span> <span class="hljs-number">2012</span> <span class="hljs-number">15</span>:<span class="hljs-number">04</span>:<span class="hljs-number">08</span> GMT-<span class="hljs-number">0400</span> (EDT) onreadystatechange
Entity: line <span class="hljs-number">1</span>: parser error : Start tag expected, <span class="hljs-string">'&lt;'</span> not found
{<span class="hljs-string">"d"</span>:<span class="hljs-string">"We're off to see the wizard!"</span>}
^
[ERROR] Error Domain=com.google.GDataXML Code=-<span class="hljs-number">1</span> <span class="hljs-string">"The operation couldn’t be completed. (com.google.GDataXML error -1.)"</span>.   in -[TiDOMDocumentProxy parseString:] (TiDOMDocumentProxy.m:<span class="hljs-number">57</span>)
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 5th 2012, 5:04:12 pm">July 5th 2012</span>
								by <span class='authorname'>Ozz Nixon</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Need some of your javascript code, not the request&#x2F;response data</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 5th 2012, 5:39:42 pm">July 5th 2012</span>
								by <span class='authorname'>Nick Milner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>There is almost zero code, and I could not post it anyway. When we switch to XML on IIS&#39;s output, everything works. I do not know how to explain to you this is not in my code…</p>
<p>my internal socket call:</p>
<pre><code class="hljs">      postJSON : function(url, JSON_string) {
         PluginManager.plugins[<span class="hljs-string">"console"</span>].call(<span class="hljs-string">"log"</span>,<span class="hljs-string">'^ postJSON('</span>+url+<span class="hljs-string">')'</span>);
         <span class="hljs-keyword">this</span>.XMLHttpRequest.open(<span class="hljs-string">"POST"</span>, url);
<span class="hljs-regexp">//</span>         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">"Content-type"</span>, <span class="hljs-string">"application/json-rpc"</span>);
         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">"Content-type"</span>, <span class="hljs-string">"application/json"</span>);
<span class="hljs-regexp">//</span>         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">"Content-type"</span>, <span class="hljs-string">"text/json"</span>);
<span class="hljs-regexp">//</span>         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">"Content-type"</span>, <span class="hljs-string">"text/plain"</span>);
         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>);
         <span class="hljs-keyword">this</span>.XMLHttpRequest.setRequestHeader(<span class="hljs-string">'Accept'</span>,<span class="hljs-string">'application/json'</span>);
         <span class="hljs-keyword">this</span>.XMLHttpRequest.send(JSON_string);
</code></pre><p>it never calls back my onload or onerror event. From the .send to error is all NATIVE Titanium Framework, not 3F&#39;s framework, which is 2+ years mature. This is literally the first time I wanted to drop the XML bloat for JSON streaming.</p>
<p>This project is literally 1 line of code - call my frame work, which calls the above line of code, and BLAH. But, when I change the server side to return output as XML then onload() fires. If I force an error, then onerror() fires… but, when it should fire either for json, I get the GDataXML issue.</p>
<p>This is not the first time I reported this issue… but, now it is mission critical, and now we are an Enterprise customer who shelled out ridiculous amounts of money…</p>
<p>Ozz</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 5th 2012, 5:46:17 pm">July 5th 2012</span>
								by <span class='authorname'>Ozz Nixon</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-242585">
				
						<section>
							<p>btw - your server is returning a content type of &quot;text&#x2F;plain&quot; - perhaps your &quot;framework&quot; interprets this as xml ? If so, maybe return &quot;application&#x2F;json&quot; content type? (havent tried this though)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 5th 2012, 5:43:20 pm">July 5th 2012</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="question/139304/using-json-but-getting-error-error-domaincomgooglegdataxml-code-1#answer-242585" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Content-Type:  text&#x2F;plain</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 5th 2012, 5:46:27 pm">July 5th 2012</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>NOPE - that was a test - read my content &quot;In this run, I changed…&quot;. I have had it return application&#x2F;json, text&#x2F;json, text&#x2F;plain, etc. The core Ti framework is still trying to parse { as &lt;.</p>
<p>Ozz</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 5th 2012, 5:47:57 pm">July 5th 2012</span>
											by <span class='authorname'>Ozz Nixon</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-242649">
				
						<section>
							<p>What happens if you setRequestHeader <em>before</em> you call .open ?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 6th 2012, 4:09:29 pm">July 6th 2012</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="question/139304/using-json-but-getting-error-error-domaincomgooglegdataxml-code-1#answer-242649" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Nothing. Actually one certain SDK versions, .open must proceed the setRequestHeader otherwise it has not affect.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 10th 2012, 4:20:33 pm">July 10th 2012</span>
											by <span class='authorname'>Ozz Nixon</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
