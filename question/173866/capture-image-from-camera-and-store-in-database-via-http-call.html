<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Capture image from camera and store in database via HTTP call » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Capture image from camera and store in database via HTTP call</h1>
		</header>
		<section>
			<p>Hi</p>
<p>In my index.js on button click</p>
<pre><code class="hljs">Titanium.Media.showCamera({
    success:function(<span class="hljs-keyword">e</span>) {
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">e</span>.mediaType == Ti.Media.MEDIA_TYPE_PHOTO) {
            <span class="hljs-keyword">var</span> imageView = Ti.UI.createImageView({
                width:<span class="hljs-keyword">win</span>.width,
                height:<span class="hljs-keyword">win</span>.height,
                image:<span class="hljs-keyword">e</span>.media
            });
            <span class="hljs-keyword">win</span>.add(imageView);
        } <span class="hljs-keyword">else</span> {
            alert(<span class="hljs-string">"got the wrong type back ="</span>+<span class="hljs-keyword">e</span>.mediaType);
        }
    },
    cancel:function() {
        <span class="hljs-comment">// called when user cancels taking a picture</span>
    },
    <span class="hljs-keyword">error</span>:function(<span class="hljs-keyword">error</span>) {
        <span class="hljs-comment">// called when there's an error</span>
        <span class="hljs-keyword">var</span> a = Titanium.UI.createAlertDialog({title:'Camera'});
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">error</span>.code == Titanium.Media.NO_CAMERA) {
            a.setMessage('Please <span class="hljs-keyword">run</span> this <span class="hljs-keyword">test</span> <span class="hljs-keyword">on</span> device');
        } <span class="hljs-keyword">else</span> {
            a.setMessage('Unexpected <span class="hljs-keyword">error</span>: ' + <span class="hljs-keyword">error</span>.code);
        }
        a.show();
    },
    mediaTypes:[Ti.Media.MEDIA_TYPE_PHOTO]
});
</code></pre><p>I have opened camera and show captured image in imageview as done in above code.</p>
<p>I want to store capture image in database and show that captured-stored image in other screen in any device.</p>
<p>I have tried with storing image in database with <code>Ti.Utils.base64encode(e.media));</code> and <code>JSON.stringify(e.media);</code> and when I get back that I do <code>Ti.Utils.base64decode(myResponseObjectFromDB.imageProfile);</code> and <code>JSON.parse (myResponseObjectFromDB.imageProfile);</code></p>
<p>But with this I did not get my image back :(</p>
<p>Ex. :- User Profile<br>In user profile I am having field like user Image, User can login from any device.</p>
<p>Framework : alloy<br>platform : android<br>Titanium SDK : 3.2.0 GA</p>
<p>Thanks In advance. Please help me ASAP.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 5th 2014, 8:03:34 am">May 5th 2014</span>
				by <span class='authorname'>Krupa Patel</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>image</span></li>
					
						<li><span class='tagname'>titanium</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Did you preform JSON.stringify(e.media); before storing image in database ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 5th 2014, 8:14:50 am">May 5th 2014</span>
								by <span class='authorname'>Moiz Chhatriwala</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>There is no need for JSON.stringify(e.media);  for storing image in database</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 5th 2014, 8:15:35 am">May 5th 2014</span>
								by <span class='authorname'>Moiz Chhatriwala</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ok . So how can I store ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 5th 2014, 8:16:58 am">May 5th 2014</span>
								by <span class='authorname'>Krupa Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Can I store directly e.media?</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 5th 2014, 8:20:45 am">May 5th 2014</span>
								by <span class='authorname'>Krupa Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello</p>
<p>Is there any solution? please help me out of this.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 12th 2014, 9:45:16 am">May 12th 2014</span>
								by <span class='authorname'>Krupa Patel</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-278407">
				
						<section>
							<p>you can store directly into database by preforming this 2 steps:</p>
<pre><code class="hljs"><span class="hljs-type">data</span> =  Ti.Utils.base64encode(e.media)); // this you can store <span class="hljs-type">in</span> database
// <span class="hljs-keyword">save</span> this <span class="hljs-type">data</span> <span class="hljs-type">in</span> database
</code></pre><p>at time of reterving data</p>
<pre><code class="hljs">
<span class="hljs-comment">// after you receive dat:</span>

blob= Ti.Utils.base<span class="hljs-number">64</span>decode<span class="hljs-comment">(myResponseObjectFromDB.imageProfile)</span>;

<span class="hljs-comment">// directly use this image</span>
</code></pre><p>there is no need to use JSON.stringify()</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 5th 2014, 8:33:49 am">May 5th 2014</span>
								by <span class='authorname'>Moiz Chhatriwala</span><br>
								<a class="icon-bg icon-link" href="../../question/173866/capture-image-from-camera-and-store-in-database-via-http-call.html#answer-278407" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Moiz</p>
<p>I have tried with your solution but still its not giving my image back.</p>
<p>Thanks<br>Krupa</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2014, 8:52:09 am">May 5th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Provide your complete code…so that we can help you…</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2014, 2:28:56 pm">May 5th 2014</span>
											by <span class='authorname'>Moiz Chhatriwala</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>As if there is too much stuff in my code so I am giving part of that </p>
<p>On click of  <code>$.OpenCam</code> I have opened camera and do alert. Here For testing purpose I have done some manual work to test. I have copied string from alert of <code>Ti.Utils.base64encode (e.media)</code> and paste that string into database directly(Update database imageProfile field by pasting).</p>
<pre><code class="hljs">$.OpenCam.addEventListener (<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    Ti.Media.showCamera ({
        success : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            <span class="hljs-keyword">if</span> (e.mediaType == Ti.Media.MEDIA_TYPE_PHOTO) {
                <span class="hljs-comment">//$.imageViewLoginMainPIN.image = e.media;</span>
                alert (<span class="hljs-string">"e.media : "</span> + Ti.Utils.base64encode (e.media));
            }
        },
        cancel : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            alert (<span class="hljs-string">"Cancel photo click"</span>);
        },
        error : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
            alert(<span class="hljs-string">"error"</span>);
        },
        <span class="hljs-comment">//saveToPhotoGallery : true,</span>
        allowEditing : <span class="hljs-literal">true</span>,
        mediaTypes : [Ti.Media.MEDIA_TYPE_PHOTO]
    });
});
</code></pre><p>On click Of Login button I have call this below function which call my HTTP service function and get</p>
<p> response back.From that response I have done</p>
<p> <code>$.imageViewLoginMainPIN.image  =  Ti.Utils.base64decode (responseObj.ImageProfile);</code> </p>
<p>to set image.</p>
<pre><code class="hljs"><span class="hljs-comment">//Service call for login</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoginServiceCall</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> request = Titanium.Network.createHTTPClient ();
    request.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">var</span> responseObj = <span class="hljs-built_in">JSON</span>.parse (<span class="hljs-keyword">this</span>.responseText);


    $.imageViewLoginMainPIN.image = Ti.Utils.base64decode (responseObj.ImageProfile);


    };
    request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        alert (<span class="hljs-string">"error"</span>);
    };

    request.open (<span class="hljs-string">"POST"</span>, <span class="hljs-string">"http://service.MyWebHost.com/api/User/login"</span>);
    request.setRequestHeader (<span class="hljs-string">"enctype"</span>, <span class="hljs-string">"multipart/form-data"</span>);
    request.setRequestHeader (<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json; charset=utf-8"</span>);
    request.send ();
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 6th 2014, 4:08:34 am">May 6th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Moiz</p>
<p>I hope above code detailing is sufficient to understand what I am doing.</p>
<p>thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 6th 2014, 4:10:22 am">May 6th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Moiz</p>
<p>Please let me know what am I doing wrong? Any other way to do this?</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2014, 5:16:51 am">May 7th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So is your webservice returning encoded data ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2014, 9:17:27 am">May 7th 2014</span>
											by <span class='authorname'>Moiz Chhatriwala</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Secondly what you can try is after decoding data write the image in application data directory as a .png or jpeg image and have a look onto image is it coming properly or not. You can pass same image url in image view</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2014, 9:19:57 am">May 7th 2014</span>
											by <span class='authorname'>Moiz Chhatriwala</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>No my web service is not returning encoded data. It returns me same data which is stored in database.</p>
<p>Thanks for your response Moiz</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2014, 9:23:38 am">May 7th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Moiz</p>
<p>sorry I did not get you, what you are trying to convey for image in application data directory.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2014, 9:24:55 am">May 7th 2014</span>
											by <span class='authorname'>Krupa Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Please give me solution. I have also same problem. anyone have idea?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2014, 7:19:30 am">May 8th 2014</span>
											by <span class='authorname'>Ankita Gadhia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-279258">
				
						<section>
							<p>Hi <strong>Krupa</strong>,</p>
<p>Follow these steps to capture image and store it in db.</p>
<ul>
<li>First encode image using Ti.Utils.base64encode()). It will returns you blob object which has one property named text. This property contains image as encoded string. Upload or send this string along with some other<br>data [json object]<br>to the server or api. Then when you want to display it simply decode this text to get back blob data.</li>
</ul>
<p>for example </p>
<p>To get image as base64 string</p>
<ul>
<li><p>Encode image or media using Ti.Utils.base64encode</p>
<ul>
<li>var encodedData = Ti.Utils.base64encode(blobobject);</li>
</ul>
</li>
<li><p>Then get value of text property of encoded object</p>
<ul>
<li>var imageAsString = encodedData.text;</li>
</ul>
</li>
</ul>
<p>To get image from base64 string</p>
<ul>
<li>Decode base64 string using Ti.Utils.base64decode<ul>
<li>var blobobj = Ti.Utils.base64decode(encodedtextValue);</li>
</ul>
</li>
</ul>
<p>I have successfully implemented this functionality in one of my project.<br>Let me know if you have any query or doubt.</p>
<p>Thanks,</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 30th 2014, 7:50:40 am">May 30th 2014</span>
								by <span class='authorname'>Chintan Dave</span><br>
								<a class="icon-bg icon-link" href="../../question/173866/capture-image-from-camera-and-store-in-database-via-http-call.html#answer-279258" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
