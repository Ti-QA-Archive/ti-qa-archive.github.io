<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Dynamic height in tableViewRow Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Dynamic height in tableViewRow</h1>
		</header>
		<section>
			<p>I have a tableView with rows generated dynamically based on JSON content. some of these rows have a an image and some don&#39;t.<br>The porblem Im facing is that even though the height of the table is set to TI.UI.SIZE (to take the height of the content). it is ending not taking this value. and taking the whole page height. I&#39;ve tried setting a fixed height (say 20dp) and no change happens . I&#39;ve tried as well letting the image load and then resetting the height but it is not working properly. below is the code</p>
<pre><code class="hljs">//widget.xml
<span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"newsRow"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"newsRowContainer"</span> &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">ImageView</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"newsImage"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">ImageView</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"newsTitle"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"newsContent"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-title">TableViewRow</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><pre><code class="hljs"><span class="hljs-comment">//widget.tss</span>

<span class="hljs-string">"#newsRow"</span>:{
    backgroundColor:<span class="hljs-string">'#0Ff0f0'</span>,
        <span class="hljs-variable">height</span>: Ti.UI.SIZE,
    <span class="hljs-variable">width</span>:<span class="hljs-string">'100%'</span>,
    selectionStyle : Titanium.UI.iPhone.TableViewCellSelectionStyle.NONE
},
<span class="hljs-string">"#newsRowContainer"</span>:{
    top:<span class="hljs-number">0</span>,
    layout:<span class="hljs-string">'vertical'</span>,
    <span class="hljs-variable">width</span>:<span class="hljs-string">'100%'</span>,
        <span class="hljs-variable">height</span>: Ti.UI.SIZE,
    backgroundColor:<span class="hljs-string">'#00ff00'</span>
}
</code></pre><pre><code class="hljs"><span class="hljs-comment">//widget.js //trying to adjust height after remote image is layed out</span>
<span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]  || {};

<span class="hljs-keyword">if</span> (args.thumbnail_large){
    $.newsImage.image = args.thumbnail_large;
    $.newsImage.addEventListener(<span class="hljs-string">'postlayout'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        <span class="hljs-keyword">if</span> ($.newsImage.size.height &gt; <span class="hljs-number">0</span> &amp;&amp; !$.newsRowContainer.hasContent){
            $.newsRowContainer.hasContent = <span class="hljs-literal">true</span>;
            addContent();
            $.newsRow.height = Ti.UI.SIZE; <span class="hljs-comment">//value never changes </span>
        }
    });
}
</code></pre><p>I am currently using the 3.2.0 beta. Another thing with this is that it seems that vertical layout on the tableViewRow is not working as i tried initially to do without the <code>$.newsRowContainer</code> but the elements never changed to the layout.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 14th 2013, 1:46:59 pm">December 14th 2013</span>
				by <span class='authorname'>Mauro Pirrone</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>height</span></li>
					
						<li><span class='tagname'>layout</span></li>
					
						<li><span class='tagname'>tableviewrow</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-272536">
				
						<section>
							<p>Try this</p>
<pre><code class="hljs">var w = Ti.UI.createWindow({
    <span class="hljs-string">top :</span> <span class="hljs-number">20</span>,
    <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'black'</span>
});

var d = [];

<span class="hljs-keyword">for</span> (var x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">10</span>; x++) {

    var r = Ti.UI.createTableViewRow({
        <span class="hljs-string">height :</span> Ti.UI.SIZE
    });

    var v = Ti.UI.createView({
        <span class="hljs-string">height :</span> Ti.UI.SIZE,
        <span class="hljs-string">layout :</span> <span class="hljs-string">'vertical'</span>
    });

    <span class="hljs-keyword">if</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
        var i = Ti.UI.createImageView({
            <span class="hljs-string">image :</span> <span class="hljs-string">'http://static.bbci.co.uk/frameworks/barlesque/2.58.1/desktop/3.5/img/blq-blocks_grey_alpha.png'</span>,
            <span class="hljs-string">top :</span> <span class="hljs-number">5</span>
        });
        v.add(i);
    }
    var l1 = Ti.UI.createLabel({
        <span class="hljs-string">text :</span> <span class="hljs-string">'News Title'</span>,
        <span class="hljs-string">top :</span> <span class="hljs-number">5</span>
    });

    var l2 = Ti.UI.createLabel({
        <span class="hljs-string">text :</span> <span class="hljs-string">'News Content'</span>,
        <span class="hljs-string">top :</span> <span class="hljs-number">5</span>
    });

    v.add(l1);
    v.add(l2);
    r.add(v);
    d.push(r);
}

var t = Ti.UI.createTableView({
    <span class="hljs-string">data :</span> d
});

w.add(t);

w.open();
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 14th 2013, 3:31:45 pm">December 14th 2013</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="question/160465/dynamic-height-in-tableviewrow#answer-272536" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Its right @Nick, but this is the standard programmatically coded solution. I think Mauro want to realize the table view in alloy.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2013, 3:40:16 pm">December 14th 2013</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Indeed. As Alloy <em>is</em> titanium, i&#39;m assuming the question asker is perfectly capable of setting those same values in a tss file. Not exactly rocket science IMHO</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2013, 3:48:19 pm">December 14th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>With that solution it already works better (the only thing im seeing different is that there is no use of a tableview section; the rows are given directly to the table). However the issue partly still remains with the rows having an image.</p>
<p>Take for example this screenshot <img src="http:&#x2F;&#x2F;img96.imageshack.us&#x2F;img96&#x2F;449&#x2F;s3kh.png" alt="alt text">  </p>
<p>If it is a remote image than the the height of the row is <strong>not resized</strong> automatically. However on second launch of the app , since the image is cached than it works perfectly. </p>
<p>This is not the case for all rows containing images. Some appear correctly but the majority end up like that screenshot</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2013, 5:34:12 am">December 16th 2013</span>
											by <span class='authorname'>Mauro Pirrone</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>on android it looks as follows:</p>
<p><img src="http:&#x2F;&#x2F;img826.imageshack.us&#x2F;img826&#x2F;7150&#x2F;znsn.png" alt="alt screenshot"></p>
<p>Two issues are in this screenshot:</p>
<ol>
<li>Images are not resized accordingly ( i think there is a Jira issue ongoing on this)</li>
<li>The Row&#39;s height does not adapat to its content even though its Ti.UI.SIZE</li>
</ol>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2013, 6:14:10 am">December 16th 2013</span>
											by <span class='authorname'>Mauro Pirrone</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>If you are using Alloy, I would suggest you further split up the Alloy markup so that you have one &#39;type&#39; of row you include when you have an image, and another row type that doesnt include the imageView.  You really should supply the width&#x2F;height on the image if its known (especially on Android) as without it, the tableView doesnt know how much to SIZE by.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2013, 11:42:04 am">December 16th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the thing is that i dont know the widths&#x2F;heights of the images so what i&#39;m specifying is a width of &#39;96%&#39; I&#39;ve switched to generation of the rows via javascript and the same issue persists (I have an if condition to check if an image is available or not. On android the thing is that as soon as you scroll back up the height is updated accordingly. does this mean that I probably have got to check each and every image size on load and update the rows height accordingly?</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 18th 2013, 8:08:52 am">December 18th 2013</span>
											by <span class='authorname'>Mauro Pirrone</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The only way I can think of would be to download your images separately using the httpClient, save them to the filesystem then construct an image blob from them. That way you can extract the correct width&#x2F;height of the images to put into your imageView</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 18th 2013, 10:13:04 am">December 18th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
