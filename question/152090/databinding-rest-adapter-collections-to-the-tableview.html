<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Databinding REST Adapter Collections to the TableView » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Databinding REST Adapter Collections to the TableView</h1>
		</header>
		<section>
			<p>Hi there-</p>
<p>Has anyone successfully performed a databind from the Alloy custom rest adapter to a TableView?  I definitely have a successful connection from my application to myservices using the restapi adapter, as specified by:</p>
<p><a href="https:&#x2F;&#x2F;github.com&#x2F;viezel&#x2F;napp.alloy.adapter.restapi">https:&#x2F;&#x2F;github.com&#x2F;viezel&#x2F;napp.alloy.adapter.restapi</a></p>
<p>I have debugged the connection client side to view the callback, and have seen the collection populated with data, post a fetch of the collection.  In addition, within my controller, in debug mode, I have done the following:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> orders = Alloy.createCollection(<span class="hljs-string">'order'</span>)
orders.fetch()

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformFunction</span><span class="hljs-params">(model)</span> </span>{

  <span class="hljs-keyword">var</span> transform = model.toJSON();
  transform.MyField = <span class="hljs-string">'['</span> + transform.MyField + <span class="hljs-string">']'</span>;
  <span class="hljs-keyword">return</span> transform;

}
</code></pre><p>and placed a debug point in the transform blowout of the controller from the Resources directory.  In the XML file, I reference the collection&#x2F;transform as such:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">Collection</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'order'</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">'myView'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">dataCollection</span>=<span class="hljs-value">'order'</span> <span class="hljs-attribute">dataTransform</span>=<span class="hljs-value">'transformFunction'</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">'{MyField}'</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>For simplicity sake, I have reduced my examples.  Now, the only other difference I have is that the id returned from the server in the models is Id, so in my model definition, on my extendModel property, I set the idAttribute to &#39;Id&#39;.</p>
<p>From the documentation located at:</p>
<p>[http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Alloy_Data_Binding] (http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Alloy_Data_Binding)</p>
<p>…it looks like I am hitting all of the points I should be. I think the main issue is that this is a databind via a rest adapter…which is why I am wondering if anyone has tried this out?  Am I missing something basic here?  I think I am also unclear why in the documentation I also needed to perform the transform and add the brackets around my fields (I did try with and without the transform, each with no success).</p>
<p>Thanks for any help…this is truly my last hurdle before getting a nice Alloy app up and running, and migrated from the Titanium framework.</p>
<p>Hope all is well<br>Chris</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 7th 2013, 4:51:05 pm">May 7th 2013</span>
				by <span class='authorname'>Christopher McGuire</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>databinding</span></li>
					
						<li><span class='tagname'>datatransform</span></li>
					
						<li><span class='tagname'>model</span></li>
					
						<li><span class='tagname'>rest</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-262318">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I had a similar issue fetching a collection with the restapi adapter.<br>Had to remove -in the model-  the very same line which sets the idAttribute to &#39;id&#39;…</p>
<p>..still confused about that.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 7th 2013, 5:02:27 pm">May 7th 2013</span>
								by <span class='authorname'>patrick demarta</span><br>
								<a class="icon-bg icon-link" href="question/152090/databinding-rest-adapter-collections-to-the-tableview#answer-262318" rel="permalink">permalink</a>
							</div>

							<h5>17 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>btw: I was fetching from a simple json api developed with rails.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:05:10 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>so, did you not do the following in your model then:</p>
<pre><code class="hljs"><span class="hljs-tag">extendModel</span>: <span class="hljs-tag">function</span>(Model) {        
        <span class="hljs-tag">_</span><span class="hljs-class">.extend</span>(Model.prototype, {
            <span class="hljs-comment">// Due to JSON parsing errors, use id_str instead of id.</span>
            <span class="hljs-comment">// The IDs are too large to store as integers using the JavaScript spec.</span>
            <span class="hljs-attribute">idAttribute</span>: <span class="hljs-string">'Id'</span>
        }); <span class="hljs-comment">// end extend</span>
        <span class="hljs-tag">return</span> <span class="hljs-tag">Model</span>;
    }
</code></pre><p>..if so, I had originally tried that, prior to seeing id was different, but it hadn&#39;t made a difference…or am I misreading the response?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:20:33 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Uhm.. i remember (maybe i&#39;m wrong) the &#39;idAttribute&#39;: &#39;id&#39; should be in the config object of the model, not in the extendModel function.</p>
<p>Then here is my working model with restapi adapter, as simple as</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> Alloy = <span class="hljs-built_in">require</span>(<span class="hljs-string">"alloy"</span>);

exports.definition = {

    config: {

        <span class="hljs-string">"URL"</span>: Alloy.Globals.apiURL + <span class="hljs-string">"products"</span>,

        <span class="hljs-string">"adapter"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"restapi"</span>,
            <span class="hljs-string">"collection_name"</span>: <span class="hljs-string">"products"</span>
        }
    },


    extendModel: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Model</span>) </span>{
        _.extend(Model.prototype, {

            <span class="hljs-comment">// extended functions go here</span>

        }); <span class="hljs-comment">// end extend</span>

        <span class="hljs-keyword">return</span> Model;
    },


    extendCollection: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Collection</span>) </span>{
        _.extend(Collection.prototype, {

            <span class="hljs-comment">// extended functions go here</span>

        }); <span class="hljs-comment">// end extend</span>

        <span class="hljs-keyword">return</span> Collection;
    }

}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:27:35 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>in <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Alloy_Sync_Adapters_and_Migrations-section-36739597_AlloySyncAdaptersandMigrations-CustomSyncAdapters">this doc section</a><br>you can see an example of a custom sync adapter setting the idAttribute in the adapter object in config :</p>
<pre><code class="hljs">exports.definition = {
    config: {
        <span class="hljs-string">"columns"</span>: {
            <span class="hljs-string">"title"</span>: <span class="hljs-string">"TEXT"</span>,
            <span class="hljs-string">"author"</span>: <span class="hljs-string">"TEXT"</span>,
            <span class="hljs-string">"book_id"</span>: <span class="hljs-string">"INTEGER PRIMARY KEY AUTOINCREMENT"</span>
        },
        <span class="hljs-string">"adapter"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"sql"</span>,
            <span class="hljs-string">"collection_name"</span>: <span class="hljs-string">"books"</span>,
            <span class="hljs-string">"idAttribute"</span>: <span class="hljs-string">"book_id"</span>
        }
    }
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:34:24 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Still a no go. :(  So odd. I have the idAttribute in my adapter of the config. I see the model if I debug as well.  The oddities are that the binding isn&#39;t happening though, and that the dataTransform function isn&#39;t hit in the debugger for some reason.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:40:43 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>it&#39;s a stupid suggestion i guess … but did you tried without setting the idAttribute at all?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:44:47 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I have. :)  That was before I realized the id was set to Id.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:45:46 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i&#39;d be glad to help more with it, but at this point it wold be usefull a test-app to play with your problematic-code :) (github&#x2F;bitbucket?)</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:56:17 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I actually just put an alert within my dataTransform function, and the alert never fires as well.  Per the example provided, the dataTransform function does the following:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> transform</span> = model.toJSON();
</code></pre><p>and returns the transform object.  My guess is, the root of my issue is that this function is never hit…now, why the dataTransform function is not hit is anyones guess. :(</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:56:46 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>consider that fetch method has success and error callbacks that you can use as in</p>
<pre><code class="hljs">orders.fetch({
  success: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">collection</span>) </span>{
    alert(<span class="hljs-built_in">JSON</span>.stringify(collection));
  },
  error: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    alert(<span class="hljs-string">"Error: "</span> + e)
  }
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 6:05:27 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Definitely worked, and had a successful output object alerted (and I sent it via a message to you so you could also see the JSON obj), but all looks well from the fetch of the collection.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 6:16:35 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Adding a dataFilter row to the TableView and an alert to the dataFilter I notice the same behavior…the alert is never hit…as if the dataTransform nor dataFilter functions are never called.  Not sure, but for some reason, I am curious as to why these functions aren&#39;t called (and when they should be called…I would assume on a databind it would be post the fetch success).</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 6:29:00 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Shooting in the dark here, but here is a theory.</p>
<p>Going on the fact that not only is the databinding not working, but the transform, nor filter functions are never hit, yet the data is loaded to the UI, I just tried to add the following:</p>
<pre><code class="hljs">orders.on(<span class="hljs-string">'change'</span>, testEvt);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testEvt</span><span class="hljs-params">(context)</span> </span>{

  alert(<span class="hljs-string">"Change Event"</span>);

}
</code></pre><p>I would assume that post the success of the fetch, since the collection is being altered, this event would be triggered, correct?  Is it possible that the change event is not being fired, which would also cause the binding, nor other TableView functions to not be hit?  If so, I guess the question would be why would the change event not be fired, and is there a way to force the change event to fire on a collection?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 7:18:25 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>to force a change events for orders collection you can use</p>
<pre><code class="hljs">orders.trigger(<span class="hljs-string">'change'</span>);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 7:34:40 pm">May 7th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>cool…let me try to force that in my fetch and see what happens.</p>
<p>Thx again!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 7:37:40 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Success at last!</p>
<p>Thanks for all of the help!</p>
<p>Here is the final solution that got this databinding to work with the REST adapter:</p>
<p>Thanks to your offline suggestions, within the view I did the following:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Collection</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"ords"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"order"</span> <span class="hljs-attribute">instance</span>=<span class="hljs-value">"true"</span>/&gt;</span> 

<span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">dataCollection</span>=<span class="hljs-value">'$.ords'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">'orderTable'</span> <span class="hljs-attribute">dataTransform</span>=<span class="hljs-value">'transformFunction'</span>&gt;</span>
</code></pre><p>…then, within the controller, I referenced the collection by id as follows:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> orders_instance = $.ords;
orders_insance.fetch();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformFunction</span>(<span class="hljs-params">model</span>) </span>{

  <span class="hljs-keyword">var</span> transform = model.toJSON();
  <span class="hljs-keyword">return</span> transform;

}
</code></pre><p>With this in place, the table bindings work properly and all is great! :)  The overriding questions will remain, why is the above any different than the original means of databinding I originally implemented?  Why is the transformFunction needed in this case?  I also found another oddity in that if I added a filterFunction that filtered all results out, and returned nothing, the app through an error from the backbone.js, since the model.length was undefined….something I am going to investigate.  That will be left for another day though.</p>
<p>Talk soon<br>Chris</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2013, 12:15:20 pm">May 8th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Happy to read that!</p>
<p>The transformFunction is doing nothing in this case, so you could remove its code and the related attribute in the TableView tag, without affecting anything.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 8th 2013, 2:40:27 pm">May 8th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-262322">
				
						<section>
							<p>Adding brackets it is just an example of how you can manipulate the model attributes before displaying them, giving you the opportunity to create custom model attributes on thr fly, as adding extra chars or maybe joining them in a single value as could be</p>
<pre><code class="hljs"><span class="hljs-built_in">transform</span>.full_address = <span class="hljs-built_in">transform</span>.address + <span class="hljs-string">" "</span> + <span class="hljs-built_in">transform</span>.city;
</code></pre><p>You are not forced to do any transformation of the model&#39;s attributes, but can be usefull in many cases.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 7th 2013, 5:16:27 pm">May 7th 2013</span>
								by <span class='authorname'>patrick demarta</span><br>
								<a class="icon-bg icon-link" href="question/152090/databinding-rest-adapter-collections-to-the-tableview#answer-262322" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That totally makes sense…ok…so it is simply just a converter (sorry, ExtJS talk here. :) ) on the model object….fair enough.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 5:21:32 pm">May 7th 2013</span>
											by <span class='authorname'>Christopher McGuire</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-284559">
				
						<section>
							<p>Thank you Christopher for putting your notes down. Previously, like you I was creating an instance of the Collection from the controller file and I was not getting the binding to occur. As soon as I gave my &lt;Controller&gt; tag an id and called the fetch() method on it all was right in my world.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 17th 2014, 1:39:14 am">December 17th 2014</span>
								by <span class='authorname'>Joe Ybarra</span><br>
								<a class="icon-bg icon-link" href="question/152090/databinding-rest-adapter-collections-to-the-tableview#answer-284559" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
