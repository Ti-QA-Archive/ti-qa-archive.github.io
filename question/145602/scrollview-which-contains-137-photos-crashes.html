<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>scrollView which contains 137 photos crashes » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>scrollView which contains 137 photos crashes</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I have a crash i dont find where is the problem.<br>i put offline photos (save photos in cache)…</p>
<p>when i load the album again, it gets photos not from server but from cache..<br>and the window which contains scrollView (which contains 137 photos) blocks…</p>
<p>when i click, it crashes…but works fine on simulateur. it crashes only on phone.</p>
<p>bizarrely, i display available memory at the end of loading photos from cache and it displays 70 sometimes or 200. so there is free memory….</p>
<p>my code for displaying : </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> mediasScroll = Ti.UI.createScrollView({
        top: <span class="hljs-number">40</span>,
        contentHeight: Ti.UI.SIZE,
        showVerticalScrollIndicator: <span class="hljs-keyword">true</span>
    });

    <span class="hljs-keyword">var</span> content = Ti.UI.createView({
        layout: <span class="hljs-string">'horizontal'</span>,
        height: Ti.UI.SIZE,
        top: <span class="hljs-number">0</span>
    });

    <span class="hljs-keyword">var</span> leftContent = Ti.UI.createView({
        top: <span class="hljs-number">0</span>,
        layout: <span class="hljs-string">'vertical'</span>,
        width: <span class="hljs-number">160</span>,
        height: Ti.UI.SIZE
    });

    <span class="hljs-keyword">var</span> rightContent = Ti.UI.createView({
        top: <span class="hljs-number">0</span>,
        layout: <span class="hljs-string">'vertical'</span>,
        width: <span class="hljs-number">160</span>,
        height: Ti.UI.SIZE
    });

    content.add(leftContent);
    content.add(rightContent);
    mediasScroll.add(content);

    winMedias.addEventListener(<span class="hljs-string">'open'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        loadMedias(<span class="hljs-keyword">true</span>);
    });

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadMedias</span><span class="hljs-params">(loadInfosAlbum)</span></span>{
        updating = <span class="hljs-keyword">true</span>;
        indicateur.show();
        <span class="hljs-keyword">if</span>(loadInfosAlbum) getInfosAlbum(param.idAlbum);
        <span class="hljs-keyword">require</span>(<span class="hljs-string">'BusinessLogic/getMedias'</span>).getMedias(
            param.idAlbum,
            page,
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">(medias)</span></span>{
                page++;
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>, j=medias.length; i &lt; j; i++){

                    <span class="hljs-keyword">var</span> mediaView = Ti.UI.createImageView({
                        image : medias[i].thumb,
                        top: <span class="hljs-number">8</span>,
                        height: medias[i].height,
                        width: <span class="hljs-number">152</span>,
                        id: medias[i].id
                    });

                    mediaView.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{

                        <span class="hljs-keyword">var</span> winMedia = <span class="hljs-keyword">require</span>(<span class="hljs-string">'ui/winMedia'</span>).createWindow({
                            idAlbum: param.idAlbum,
                            id: e.source.id,
                            medias: medias, 
                            offline: param.offline, 
                            updated: param.updated,
                            search: <span class="hljs-keyword">false</span>,
                            page: page,
                            deleteCallback: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
                                loadMedias();
                            }
                        });
                        winMedias.tabGroup.activeTab.open(winMedia);
                    });                    

                    <span class="hljs-keyword">if</span>(leftValue &lt;= rightValue){
                        leftContent.add(mediaView);
                        leftValue += mediaView.height + <span class="hljs-number">8</span>;
                    }    
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (leftValue &gt; rightValue){
                        rightContent.add(mediaView);
                        rightValue += mediaView.height + <span class="hljs-number">8</span>;
                    }        
                }

                indicateur.hide();
                updating = <span class="hljs-keyword">false</span>;
                <span class="hljs-keyword">if</span>(!param.offline)
                    mediasScroll.contentHeight = Ti.UI.SIZE;

                <span class="hljs-keyword">if</span>(param.updated &amp;&amp; param.offline){
                    <span class="hljs-comment">//remettre en cache si upadted coté serveur</span>
                    <span class="hljs-keyword">require</span>(<span class="hljs-string">'BusinessLogic/GestionCache/setAlbumOffline'</span>).setAlbumOffline(
                        param.idAlbum,
                        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">success</span><span class="hljs-params">()</span></span>{param.updated = <span class="hljs-keyword">false</span>;},
                        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span><span class="hljs-params">(msg)</span></span>{},
                        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setProgressMax</span><span class="hljs-params">(max)</span></span>{}
                    );
                }

                alert(<span class="hljs-string">'available memory : '</span> + Ti.Platform.availableMemory);
            },

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span><span class="hljs-params">(msg)</span></span>{
                <span class="hljs-comment">//msg = 0 c'est la fin de la pagination.</span>
                <span class="hljs-comment">//msg "album empty" album vide.</span>
                <span class="hljs-keyword">if</span>(msg.<span class="hljs-keyword">empty</span>){
                    <span class="hljs-keyword">var</span> emptyAlbumLabel = Ti.UI.createLabel({
                        text: msg.<span class="hljs-keyword">empty</span>,
                        color: <span class="hljs-string">'white'</span>,
                        font:{fontSize: <span class="hljs-number">15</span>, fontWeight: <span class="hljs-string">'bold'</span>}
                    });

                    mediasScroll.add(emptyAlbumLabel);
                }
                <span class="hljs-comment">//sinon erreur                </span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(msg !== <span class="hljs-number">0</span>){
                    <span class="hljs-keyword">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(msg);
                }

                indicateur.hide();
                updating = <span class="hljs-keyword">false</span>;
            },

            param.offline,
            param.updated
        );
    }
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 11th 2012, 12:35:16 pm">December 11th 2012</span>
				by <span class='authorname'>Djamel ZAHAL</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>images</span></li>
					
						<li><span class='tagname'>memory</span></li>
					
						<li><span class='tagname'>scrollview</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>the variable page is not used, it used only when i load remote image..not from local.<br>it is the parameter offline which indicates that..</p>
<p>thanks</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 11th 2012, 12:37:21 pm">December 11th 2012</span>
								by <span class='authorname'>Djamel ZAHAL</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>and the image i saved are : 245*190…it is not so big…</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 11th 2012, 12:43:31 pm">December 11th 2012</span>
								by <span class='authorname'>Djamel ZAHAL</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-252579">
				
						<section>
							<p>Reading from all the comments (as well, as the previous exchanges we had on this subject) It is now clear that you cannot show such a big quantity of images. And don&#39;t try to pinpoint the problem with cache handling, simulator vs device or even pagination. The reason for this is simple, you have a memory issue and memory issues are very hard to pinpoint.</p>
<p>Tim has a point with his link detailing how to identify memory leaks. While this won&#39;t fix your issue, it may help monitor the actual memory consumption. </p>
<p>That being said, what you want to do is achievable, but you will have to change the way you load (and unload) your images. One good way to do this is to only load the images <strong>that are visible</strong>. And when the user scroll, simply load the new images to display. The important thing though is to unload the other images since you no longer need them. I strongly suggest you have a look at the <strong><a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.UI.View-method-remove">remove</a></strong> function.</p>
<p>This is a general idea and you will need to do some heavy-lifting to achieve it. But it is completely possible,</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 12th 2012, 8:40:23 am">December 12th 2012</span>
								by <span class='authorname'>Christian Brousseau</span><br>
								<a class="icon-bg icon-link" href="question/145602/scrollview-which-contains-137-photos-crashes#answer-252579" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>what you say is to remove imageView that are not visible ?<br>it is the component imageView which unload invisible images when they are remote and doesn&#39;t unload them when they are local ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 13th 2012, 8:25:28 am">December 13th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I don&#39;t quite understand what you are trying to say here. But I am not talking about hiding the images themselves. What I am suggesting is to completely <strong>remove</strong> the ImageViews themselves form the container.</p>
<p>My advice to you is quite simple. Don&#39;t expect the framework and its components to do the work for you. It works in most cases, but not in your case here. You <strong>have to</strong>  code this yourself.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 13th 2012, 8:32:24 am">December 13th 2012</span>
											by <span class='authorname'>Christian Brousseau</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Chrisitian. there is a point I still do not understand.<br>why when i load remote images, it works. even if i dont remove imageViews from scrollView and i have the same system of pagination (1-20, 40, 60 images, …) and finally i have until 300 thumbs displayed without problemes…..</p>
<p>but when my imageView point to local path…when i load until 80 images. it crashes….</p>
<p>that&#39;s my problem….</p>
<p>and i have seen applications which displays lot of photos….</p>
<p>thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2012, 9:12:41 am">December 14th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p><strong>Stop</strong> comparing what you cannot compare. Local and remote objects are completely different.</p>
<p>Now, I gave you a path to follow, you are completely free to implement it or not; that is your choice. But it appears you are putting more effort trying to convince yourself not do do it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 14th 2012, 9:32:02 am">December 14th 2012</span>
											by <span class='authorname'>Christian Brousseau</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Christian,  i have seen facebook app and instagram and tried to understand their logic.<br>they have a scrollView like my app.<br>and if they have 300 photos for example to display. they dont remove invisible photos from scrollView (the scrollView keep positions of all photos). but it seems that invisible photos are unloaded (but they keep their position) and reloaded when visible…</p>
<p>how is it possible to unload invisible photos wihtout delete them from scrollView (without change height of scrollView and positions of all of its children elements) ?</p>
<p>thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2012, 3:27:19 pm">December 16th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi,</p>
<p>Here what i did to refresh memory :</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chargerEcranDuBas</span><span class="hljs-params">(screenToLoad)</span>{</span>
        var container;
        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=leftContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>((leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">1</span>)) &amp;&amp; (leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">5</span>)) &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].removed){
                container = leftContent.<span class="hljs-built_in">children</span>[i];
                container.add(
                    Ti.UI.createImageView({
                        image : container.path,
                        height: container.height,
                        width: <span class="hljs-number">152</span>,
                        touchEnabled: <span class="hljs-literal">false</span>
                    })
                );

                leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>((rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">1</span>)) &amp;&amp; (rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">2</span>)) &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].removed){
                container = rightContent.<span class="hljs-built_in">children</span>[i];
                container.add(
                    Ti.UI.createImageView({
                        image : container.path,
                        height: container.height,
                        width: <span class="hljs-number">152</span>,
                        touchEnabled: <span class="hljs-literal">false</span>
                    })
                );

                rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
            }
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chargerEcranDuHaut</span><span class="hljs-params">(currentScreen)</span>{</span>
        var container;
        <span class="hljs-keyword">for</span>(var i=leftContent.<span class="hljs-built_in">children</span>.length - <span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i--){

            <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> currentScreen &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (currentScreen - <span class="hljs-number">5</span>) &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].removed){
                container = leftContent.<span class="hljs-built_in">children</span>[i];
                container.add(
                    Ti.UI.createImageView({
                        image : container.path,
                        height: container.height,
                        width: <span class="hljs-number">152</span>,
                        touchEnabled: <span class="hljs-literal">false</span>
                    })
                );

                leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-keyword">for</span>(var i=rightContent.<span class="hljs-built_in">children</span>.length - <span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i--){

            <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> currentScreen &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (currentScreen - <span class="hljs-number">5</span>) &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].removed){
                container = rightContent.<span class="hljs-built_in">children</span>[i];
                container.add(
                    Ti.UI.createImageView({
                        image : container.path,
                        height: container.height,
                        width: <span class="hljs-number">152</span>,
                        touchEnabled: <span class="hljs-literal">false</span>
                    })
                );

                rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
            }
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supprimerEcranDuBas</span><span class="hljs-params">(screenToRemove)</span>{</span>
        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=leftContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>((leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)) &amp;&amp; (leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">2</span>))){
                <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                    leftContent.<span class="hljs-built_in">children</span>[i].remove(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                    leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                    leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                    Ti.API.info('supprime ecran du bas gauche');
                }
            }
        }

        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>((rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)) &amp;&amp; (rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">2</span>))){
                <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                    rightContent.<span class="hljs-built_in">children</span>[i].remove(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                    rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                    rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                    Ti.API.info('supprime ecran du bas droit');
                }
            }
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supprimerEcranDuHaut</span><span class="hljs-params">(screenToRemove)</span>{</span>

        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=leftContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> screenToRemove &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)){
                <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                    leftContent.<span class="hljs-built_in">children</span>[i].remove(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                    leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                    leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                    Ti.API.info('supprime ecran du haut gauche');
                }
            }
        }

        <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

            <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> screenToRemove &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)){
                <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                    rightContent.<span class="hljs-built_in">children</span>[i].remove(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                    rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                    rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                    Ti.API.info('supprime ecran du haut droit');
                }
            }
        }
    }

    var pageScroll = <span class="hljs-number">0</span>, newPage = <span class="hljs-number">0</span>;
    var <span class="hljs-built_in">offset</span>, height, current, theEnd, distance;
    mediasScroll.addEventListener('scroll', <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
        <span class="hljs-comment">//position courante</span>
        height = e.source.size.height;
        <span class="hljs-built_in">offset</span> = e.source.contentOffset.y;
        current = <span class="hljs-built_in">offset</span> + height;
        theEnd = (leftValue &lt;= rightValue) ? leftValue : rightValue;

         <span class="hljs-comment">//distance</span>
         distance = theEnd - current;

         <span class="hljs-keyword">if</span>(pageScroll <span class="hljs-built_in">!</span>= parseInt(<span class="hljs-built_in">offset</span> / <span class="hljs-number">480</span>)){
             newPage = parseInt(<span class="hljs-built_in">offset</span> / <span class="hljs-number">480</span>);
             <span class="hljs-comment">//la page a changé</span>
             <span class="hljs-keyword">if</span>(pageScroll &lt; newPage){
                 <span class="hljs-keyword">if</span>(pageScroll &gt;= <span class="hljs-number">5</span>){
                     <span class="hljs-comment">//on descend vers le bas</span>

                     Ti.API.info('supprime ecran du haut / page : ' + pageScroll);
                     <span class="hljs-comment">//supprimer les écrans en haut</span>
                     supprimerEcranDuHaut(pageScroll - <span class="hljs-number">5</span>);

                     <span class="hljs-comment">//recharger les écrans en bas qui ont été supprimés</span>
                     chargerEcranDuBas(pageScroll); <span class="hljs-comment">//5 screen charged</span>
                 }
             }
             <span class="hljs-keyword">else</span>{
                 <span class="hljs-keyword">if</span>(pageScroll &gt;= <span class="hljs-number">5</span>){
                     <span class="hljs-comment">//on monte vers le haut</span>

                     <span class="hljs-comment">//supprimer les écrans en bas</span>
                     supprimerEcranDuBas(pageScroll + <span class="hljs-number">5</span>);

                     <span class="hljs-comment">//recharger les écrans en haut qui ont été supprimés</span>
                     chargerEcranDuHaut(pageScroll); <span class="hljs-comment">//5 screen charged</span>
                 }
             }

             pageScroll = newPage;
         }

        <span class="hljs-keyword">if</span> (distance &lt; distanceToLoad &amp;&amp; <span class="hljs-built_in">!</span>updating &amp;&amp; medias.length <span class="hljs-built_in">!</span>= param.countMedias)
        {
            loadMedias(<span class="hljs-literal">false</span>);
        }
    });
</code></pre><p>to explain, when i am on screen 5. i clean screen 0, when on 6, i clean screen 1 and so on to free memory…. -&gt; supprimerEcranDuHaut(pageScroll - 5)</p>
<p>i dont know why the app crashes again..</p>
<p>ps : my display is like this : http:&#x2F;&#x2F;dzmob.net&#x2F;medias.png</p>
<p>thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 9th 2013, 7:46:36 am">January 9th 2013</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>function chargerEcranDuBas(screenToLoad){<br>        var container;<br>        for(var i=0, j=leftContent.children.length; i&lt;j; i++){</p>
<pre><code class="hljs">        <span class="hljs-keyword">if</span>((leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">1</span>)) &amp;&amp; (leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">5</span>)) &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].removed){
            container = leftContent.<span class="hljs-built_in">children</span>[i];
            container.add(
                Ti.UI.createImageView({
                    image : container.path,
                    height: container.height,
                    width: <span class="hljs-number">152</span>,
                    touchEnabled: <span class="hljs-literal">false</span>
                })
            );

            leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

        <span class="hljs-keyword">if</span>((rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">1</span>)) &amp;&amp; (rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToLoad + <span class="hljs-number">2</span>)) &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].removed){
            container = rightContent.<span class="hljs-built_in">children</span>[i];
            container.add(
                Ti.UI.createImageView({
                    image : container.path,
                    height: container.height,
                    width: <span class="hljs-number">152</span>,
                    touchEnabled: <span class="hljs-literal">false</span>
                })
            );

            rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chargerEcranDuHaut</span><span class="hljs-params">(currentScreen)</span>{</span>
    var container;
    <span class="hljs-keyword">for</span>(var i=leftContent.<span class="hljs-built_in">children</span>.length - <span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i--){

        <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> currentScreen &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (currentScreen - <span class="hljs-number">5</span>) &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].removed){
            container = leftContent.<span class="hljs-built_in">children</span>[i];
            container.add(
                Ti.UI.createImageView({
                    image : container.path,
                    height: container.height,
                    width: <span class="hljs-number">152</span>,
                    touchEnabled: <span class="hljs-literal">false</span>
                })
            );

            leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">for</span>(var i=rightContent.<span class="hljs-built_in">children</span>.length - <span class="hljs-number">1</span>; i&gt;=<span class="hljs-number">0</span>; i--){

        <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> currentScreen &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (currentScreen - <span class="hljs-number">5</span>) &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].removed){
            container = rightContent.<span class="hljs-built_in">children</span>[i];
            container.add(
                Ti.UI.createImageView({
                    image : container.path,
                    height: container.height,
                    width: <span class="hljs-number">152</span>,
                    touchEnabled: <span class="hljs-literal">false</span>
                })
            );

            rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">false</span>;
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supprimerEcranDuBas</span><span class="hljs-params">(screenToRemove)</span>{</span>
    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=leftContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

        <span class="hljs-keyword">if</span>((leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)) &amp;&amp; (leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">2</span>))){
            <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                leftContent.<span class="hljs-built_in">children</span>[i].remove(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                Ti.API.info('supprime ecran du bas gauche');
            }
        }
    }

    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

        <span class="hljs-keyword">if</span>((rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)) &amp;&amp; (rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt;  <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">2</span>))){
            <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                rightContent.<span class="hljs-built_in">children</span>[i].remove(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                Ti.API.info('supprime ecran du bas droit');
            }
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supprimerEcranDuHaut</span><span class="hljs-params">(screenToRemove)</span>{</span>

    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=leftContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

        <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> screenToRemove &amp;&amp; leftContent.<span class="hljs-built_in">children</span>[i].y + leftContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)){
            <span class="hljs-keyword">if</span>(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                leftContent.<span class="hljs-built_in">children</span>[i].remove(leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                leftContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                leftContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                Ti.API.info('supprime ecran du haut gauche');
            }
        }
    }

    <span class="hljs-keyword">for</span>(var i=<span class="hljs-number">0</span>, j=rightContent.<span class="hljs-built_in">children</span>.length; i&lt;j; i++){

        <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].y &gt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> screenToRemove &amp;&amp; rightContent.<span class="hljs-built_in">children</span>[i].y + rightContent.<span class="hljs-built_in">children</span>[i].height &lt; <span class="hljs-number">480</span> <span class="hljs-built_in">*</span> (screenToRemove + <span class="hljs-number">1</span>)){
            <span class="hljs-keyword">if</span>(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] <span class="hljs-built_in">!</span>= undefined){
                rightContent.<span class="hljs-built_in">children</span>[i].remove(rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>]);
                rightContent.<span class="hljs-built_in">children</span>[i].<span class="hljs-built_in">children</span>[<span class="hljs-number">0</span>] = null;
                rightContent.<span class="hljs-built_in">children</span>[i].removed = <span class="hljs-literal">true</span>;
                Ti.API.info('supprime ecran du haut droit');
            }
        }
    }
}

var pageScroll = <span class="hljs-number">0</span>, newPage = <span class="hljs-number">0</span>;
var <span class="hljs-built_in">offset</span>, height, current, theEnd, distance;
mediasScroll.addEventListener('scroll', <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    <span class="hljs-comment">//position courante</span>
    height = e.source.size.height;
    <span class="hljs-built_in">offset</span> = e.source.contentOffset.y;
    current = <span class="hljs-built_in">offset</span> + height;
    theEnd = (leftValue &lt;= rightValue) ? leftValue : rightValue;

     <span class="hljs-comment">//distance</span>
     distance = theEnd - current;

     <span class="hljs-keyword">if</span>(pageScroll <span class="hljs-built_in">!</span>= parseInt(<span class="hljs-built_in">offset</span> / <span class="hljs-number">480</span>)){
         newPage = parseInt(<span class="hljs-built_in">offset</span> / <span class="hljs-number">480</span>);
         <span class="hljs-comment">//la page a changé</span>
         <span class="hljs-keyword">if</span>(pageScroll &lt; newPage){
             <span class="hljs-keyword">if</span>(pageScroll &gt;= <span class="hljs-number">5</span>){
                 <span class="hljs-comment">//on descend vers le bas</span>

                 Ti.API.info('supprime ecran du haut / page : ' + pageScroll);
                 <span class="hljs-comment">//supprimer les écrans en haut</span>
                 supprimerEcranDuHaut(pageScroll - <span class="hljs-number">5</span>);

                 <span class="hljs-comment">//recharger les écrans en bas qui ont été supprimés</span>
                 chargerEcranDuBas(pageScroll); <span class="hljs-comment">//5 screen charged</span>
             }
         }
         <span class="hljs-keyword">else</span>{
             <span class="hljs-keyword">if</span>(pageScroll &gt;= <span class="hljs-number">5</span>){
                 <span class="hljs-comment">//on monte vers le haut</span>

                 <span class="hljs-comment">//supprimer les écrans en bas</span>
                 supprimerEcranDuBas(pageScroll + <span class="hljs-number">5</span>);

                 <span class="hljs-comment">//recharger les écrans en haut qui ont été supprimés</span>
                 chargerEcranDuHaut(pageScroll); <span class="hljs-comment">//5 screen charged</span>
             }
         }

         pageScroll = newPage;
     }

    <span class="hljs-keyword">if</span> (distance &lt; distanceToLoad &amp;&amp; <span class="hljs-built_in">!</span>updating &amp;&amp; medias.length <span class="hljs-built_in">!</span>= param.countMedias)
    {
        loadMedias(<span class="hljs-literal">false</span>);
    }
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 9th 2013, 7:49:00 am">January 9th 2013</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-252512">
				
						<section>
							<p>Oh, no, not very large at all:</p>
<p>245x190@72 DPI = 46.5k pixels ~ 181kb</p>
<p>137 such images ~ <strong>24 MEGABYTES</strong> loaded into a scrollview and you want to know why it crashes????</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 11th 2012, 1:00:31 pm">December 11th 2012</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="question/145602/scrollview-which-contains-137-photos-crashes#answer-252512" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>so what should i do ?</p>
<p>there is a maximum ?</p>
<p>how to diplay lot of images ? it is not possible ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2012, 1:01:51 pm">December 11th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>And given that depending on target OS version, you can have as little as 12MB of memory available to your app, you could easily be greatly exceeding your app&#39;s allotment. See <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Managing_Memory_and_Finding_Leaks">http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Managing_Memory_and_Finding_Leaks</a> for more info. (Typical for current OSes is more like 30 MB. The advice still applies.)</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2012, 1:05:18 pm">December 11th 2012</span>
											by <span class='authorname'>Tim Poulsen</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok thanks…</p>
<p>the problem is that i dont see what i can remove from memory in the code above…<br>all variables created are used to display photos…and i should display all the photos…</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2012, 1:14:34 pm">December 11th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>even if i make pagination for each 20 photos…finally, at the end of scroll, i will display 137…so what can i release ?<br>thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2012, 1:34:32 pm">December 11th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Tim, when i load from server each 20 photos with pagination it works fine..even if i load finally 137 at the end of pagination….</p>
<p>but when i load them from cache, even with pagination…it crashes even if it is the same images, the sames numbers of photos…..</p>
<p>so i dont understand ??</p>
<p>thanks for help..</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 11th 2012, 3:38:11 pm">December 11th 2012</span>
											by <span class='authorname'>Djamel ZAHAL</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
