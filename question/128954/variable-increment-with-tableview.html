<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Variable increment with tableview » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Variable increment with tableview</h1>
		</header>
		<section>
			<p>Hi all,</p>
<p>Ive been trying to get this to work for a couple of days now (joys of being a noob to programming !) Im parsing a soundcloud json feed to put audio tracks  for a user in a tableview. Now I have used the twitter kitchen sink example to get it working. I can populate a tableview with track name and a button with event listener that plays audio. HOWEVER….this is always the same track that plays.The last one that is loaded. I&#39;m guessing this has to do with the variable name of the media player being the same on each row ??? therefor pressing play on any row targets the last loaded media player url. So how do i create a unique media player variable name on each row ?</p>
<pre><code class="hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> <span class="hljs-built_in">c</span>=<span class="hljs-number">0</span>;<span class="hljs-built_in">c</span>&lt;<span class="hljs-type">Tracks</span>.length;<span class="hljs-built_in">c</span>++){

<span class="hljs-keyword">var</span> streamPlayer= <span class="hljs-type">Ti</span>.<span class="hljs-type">Media</span>.createAudioPlayer({
    url:<span class="hljs-type">Tracks</span>[<span class="hljs-built_in">c</span>].stream_url });
</code></pre><p>I presume to be able to address each individual track each audio player need to have a unique variable name?</p>
<p>Any help reaaaally appreciated</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 1st 2011, 8:57:10 pm">December 1st 2011</span>
				by <span class='authorname'>d i</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>audio</span></li>
					
						<li><span class='tagname'>increment variable</span></li>
					
						<li><span class='tagname'>json</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>7</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>7 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-224691">
				
						<section>
							<p>Hi Damon, what you need to do is create a data array. In your for loop you add rows to your data array and once you&#39;re done getting all the data, you set it within your tableview.  Something like the following.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> someTableView = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTableView({data:[]});
<span class="hljs-keyword">var</span> data = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> <span class="hljs-built_in">c</span>=<span class="hljs-number">0</span>;<span class="hljs-built_in">c</span>&lt;<span class="hljs-type">Tracks</span>.length;<span class="hljs-built_in">c</span>++){

<span class="hljs-keyword">var</span> streamPlayer= <span class="hljs-type">Ti</span>.<span class="hljs-type">Media</span>.createAudioPlayer({
    url:<span class="hljs-type">Tracks</span>[<span class="hljs-built_in">c</span>].stream_url 
}),
row = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTableViewRow();
row.add(streamPlayer);
data[<span class="hljs-built_in">c</span>] = row;
}
someTableView.setData(data);
</code></pre><p>Hope this helps.  Feel free to ask more questions!  :)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 1st 2011, 9:58:01 pm">December 1st 2011</span>
								by <span class='authorname'>Paul Nelson</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224691" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224692">
				
						<section>
							<p>Do you want to create an audio player on each row, or would it be better to create an audio player when the user selects that track, like this:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> table = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTableView();
<span class="hljs-keyword">var</span> data = [];

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> <span class="hljs-built_in">c</span> = <span class="hljs-number">0</span>; <span class="hljs-built_in">c</span>&lt;<span class="hljs-type">Tracks</span>.length;<span class="hljs-built_in">c</span>++){
 data.push(<span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTableViewRow({ 
    title:<span class="hljs-type">Tracks</span>[<span class="hljs-built_in">c</span>].track_title,  <span class="hljs-comment">//or some type of identifier</span>
    url:<span class="hljs-type">Tracks</span>[<span class="hljs-built_in">c</span>].stream_url, 
    hasDetail:<span class="hljs-literal">true</span> 
  });
} 

table.setData(data);

<span class="hljs-comment">//listen for the click event</span>
table.addEventListener('click', function(e){
<span class="hljs-keyword">var</span> streamPlayer= <span class="hljs-type">Ti</span>.<span class="hljs-type">Media</span>.createAudioPlayer({
    url:e.rowData.url
<span class="hljs-comment">//start the audio or do other things here... </span>
});

<span class="hljs-comment">//add the table to the window, open the window, etc.</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 1st 2011, 10:25:48 pm">December 1st 2011</span>
								by <span class='authorname'>Adam Paxton</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224692" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I&#39;m with Adam.  There is a lot of overhead with creating a separate player instance for each row.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2011, 12:22:39 am">December 2nd 2011</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Okay… thanks.Of course it makes sense to do it like that ! Now ive just got to get it to work.  Is there a service anywhere anyone knows of where you can pay to get this done ? This has been 3 days now. Wish I could just fast foward my knowledge by 10 years :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2011, 8:34:15 am">December 2nd 2011</span>
											by <span class='authorname'>d i</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You can try the <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;devlink">Devlink</a>.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2011, 11:23:40 am">December 2nd 2011</span>
											by <span class='authorname'>Adam Paxton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Adam…I&#39;ll check it out.Although that comment was made more out of frustration. Think ill stick with it. Want to learn. Its one of those things were if you see the code youll have a lightbulb moment</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2011, 1:23:39 pm">December 2nd 2011</span>
											by <span class='authorname'>d i</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224693">
				
						<section>
							<p>Paul….. thanks for your input.Much appreciated…this is driving me nuts. Heres my code. Excuse the messy variable names etc….im a noob and its a hack of the twitter feed json example. </p>
<p>This code works fine mostly.It creates a row for each track, adds the avatar fine and the button that when pressed streams audio.However whatever button is pressed its the lasttrack that plays and the pause track dialogue toggles on the last row. Its always targetting the last track ! I cant see the problem ?</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> globalColor= <span class="hljs-string">'#104976'</span>;

<span class="hljs-keyword">var</span> Title = <span class="hljs-string">'Name'</span>;
<span class="hljs-keyword">var</span> win = Ti.UI.currentWindow;
win.title = <span class="hljs-string">'Listening to '</span>+Title;


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTweets</span>(<span class="hljs-params">screen_name</span>)</span>{

    <span class="hljs-comment">// create table view data object</span>
    <span class="hljs-keyword">var</span> data = [];

    <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
    xhr.timeout = <span class="hljs-number">1000000</span>;
    xhr.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"http://api.myjsonfeedhere"</span>);

    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">try</span>
        {
            <span class="hljs-keyword">var</span> tweets = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span>+<span class="hljs-keyword">this</span>.responseText+<span class="hljs-string">')'</span>);

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c=<span class="hljs-number">0</span>;c&lt;tweets.length;c++){

                <span class="hljs-keyword">var</span> tracktitle = tweets[c].title;
                <span class="hljs-keyword">var</span> user = tweets[c].user.username;
                <span class="hljs-keyword">var</span> avatar = tweets[c].artwork_url;
                <span class="hljs-keyword">var</span> track_url = tweets[c].stream_url;
                <span class="hljs-keyword">var</span> waveform = tweets[c].waveform_url;
                <span class="hljs-comment">//var bgcolor = (c % 2) == 0 ? '#adc9f0' : '#adc9f0';</span>
                <span class="hljs-keyword">var</span> bgcolor = (c % <span class="hljs-number">2</span>) == <span class="hljs-number">0</span> ? <span class="hljs-string">'#fff'</span> : <span class="hljs-string">'#ddd'</span>;

<span class="hljs-comment">//-------------------player with client id attached</span>

                <span class="hljs-keyword">var</span> streamer= Ti.Media.createAudioPlayer({
    url:tweets[c].stream_url+<span class="hljs-string">'?1234567'</span>});

<span class="hljs-comment">//---------------------------------</span>


<span class="hljs-keyword">var</span> row = Ti.UI.createTableViewRow({        
                hasChild:<span class="hljs-literal">true</span>,
                height:<span class="hljs-string">'auto'</span>,
                backgroundColor:bgcolor,
                });



<span class="hljs-comment">// Create a vertical layout view to hold all the info labels and images for each track</span>


            <span class="hljs-keyword">var</span> post_view = Ti.UI.createView({
                    height:<span class="hljs-string">'auto'</span>,
                    layout:<span class="hljs-string">'vertical'</span>,
                    left:<span class="hljs-number">5</span>,
                    top:<span class="hljs-number">5</span>,
                    bottom:<span class="hljs-number">5</span>,
                    right:<span class="hljs-number">5</span>,

                });

<span class="hljs-comment">// add button to make audio play    </span>

<span class="hljs-keyword">var</span> streamingButton = Ti.UI.createButton({
    title: tracktitle,
    width:<span class="hljs-string">'200'</span>,
    height:<span class="hljs-string">'40'</span>,
    top:<span class="hljs-number">5</span>    
});
streamingButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>(streamer.playing) {
        streamer.pause();
        streamingButton.title = tweet;
    } <span class="hljs-keyword">else</span> {
        streamer.start();
        streamingButton.title = <span class="hljs-string">'Click to pause stream'</span>;
    }
});
<span class="hljs-comment">// ADD Stream BUTTON</span>

post_view.add(streamingButton);                



<span class="hljs-comment">//------------------------------------------------------------------------</span>
                    <span class="hljs-keyword">var</span> av = Ti.UI.createImageView({
                        image:avatar,
                        left:<span class="hljs-number">0</span>,
                        top:-<span class="hljs-number">10</span>,
                        borderRadius:<span class="hljs-number">5</span>,
                        height:<span class="hljs-number">48</span>,
                        width:<span class="hljs-number">48</span>
                    });
                <span class="hljs-comment">// Add the avatar image to the view</span>
                post_view.add(av);

                <span class="hljs-keyword">var</span> user_label = Ti.UI.createLabel({
                    text:user,
                    left:<span class="hljs-number">54</span>,
                    width:<span class="hljs-number">120</span>,
                    top:-<span class="hljs-number">48</span>,
                    bottom:<span class="hljs-number">2</span>,
                    height:<span class="hljs-number">16</span>,
                    textAlign:<span class="hljs-string">'left'</span>,
                    color:globalColor,
                    font:{fontFamily:<span class="hljs-string">'Trebuchet MS'</span>,fontSize:<span class="hljs-number">10</span>,fontWeight:<span class="hljs-string">'bold'</span>}
                });
                <span class="hljs-comment">// Add the username to the view</span>
            <span class="hljs-comment">//    post_view.add(user_label);</span>

                <span class="hljs-keyword">var</span> date_label = Ti.UI.createLabel({
                    text:track_url,
                    right:<span class="hljs-number">0</span>,
                    top:-<span class="hljs-number">18</span>,
                    bottom:<span class="hljs-number">2</span>,
                    height:<span class="hljs-number">14</span>,
                    textAlign:<span class="hljs-string">'right'</span>,
                    width:<span class="hljs-number">110</span>,
                    color:<span class="hljs-string">'#444444'</span>,
                    font:{fontFamily:<span class="hljs-string">'Trebuchet MS'</span>,fontSize:<span class="hljs-number">12</span>}
                });
                <span class="hljs-comment">// Add the date to the view</span>
                <span class="hljs-comment">//post_view.add(date_label);</span>

                <span class="hljs-keyword">var</span> tweet_text = Ti.UI.createLabel({
                    text:tweet,
                    left:<span class="hljs-number">54</span>,
                    top:<span class="hljs-number">0</span>,
                    bottom:<span class="hljs-number">2</span>,
                    height:<span class="hljs-string">'auto'</span>,
                    width:<span class="hljs-number">236</span>,
                    textAlign:<span class="hljs-string">'left'</span>,
                    font:{fontSize:<span class="hljs-number">14</span>}
                });
                <span class="hljs-comment">// Add the tweet to the view</span>
                <span class="hljs-comment">//post_view.add(tweet_text);</span>
                <span class="hljs-comment">// Add the vertical layout view to the row</span>
                row.add(post_view);
                row.className = <span class="hljs-string">'item'</span>+c;
                data[c] = row;
            }
            <span class="hljs-comment">// Create the tableView and add it to the window.</span>
            <span class="hljs-keyword">var</span> tableview = Titanium.UI.createTableView({data:data,minRowHeight:<span class="hljs-number">58</span>});
            Ti.UI.currentWindow.add(tableview);
        }
        <span class="hljs-keyword">catch</span>(E){
            alert(E);
        }
    };





    <span class="hljs-comment">// Get the data</span>
    xhr.send();
}

<span class="hljs-comment">// Get the tweets for</span>
getTweets(twitter_name);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 1st 2011, 10:28:08 pm">December 1st 2011</span>
								by <span class='authorname'>d i</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224693" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224701">
				
						<section>
							<p>u dont have to try hard for this b coz ive already faced the same problem and here are many option to solve this problem, here i m posting he solution ive tried in my code anf its working very fine ::</p>
<pre><code class="hljs">song.addEventListener(<span class="hljs-string">'complete'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span>(PlayerScreen.repeatPressed) {
            PlayerScreen.Play(currentIndex);
        } <span class="hljs-keyword">else</span> {
            PlayerScreen.Next(currentIndex);
        }
    });
</code></pre><p>Here in this post if repeat button is pressed then it will call play on same song index and if not pressed then it will call next method on the same index in which i m incrementing the index of the song.<br>Thanx</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 2nd 2011, 3:33:04 am">December 2nd 2011</span>
								by <span class='authorname'>Gagan Tiwari</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224701" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for sharing</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2011, 5:48:40 am">December 2nd 2011</span>
											by <span class='authorname'>Sharry Stowell</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224783">
				
						<section>
							<p>Hi Everyone. Me again,</p>
<p>Firstly. Thanks for all your input on this..Its great there are experienced people willing to help us noobs.Im starting to think there is a weird bug or something. It still will only ever play the last track that loads. I think ive taken your comments on board but its still doing it.Everything works great apart from it not playing the track associated with the row.Here is my latest (slightly tidier) code. If anyone can see where im going wrong id appreciate it.</p>
<pre><code class="hljs">
<span class="hljs-comment">//First thing is to check for internet connection</span>

<span class="hljs-keyword">if</span> (Titanium.Network.networkType === Titanium.Network.NETWORK_NONE) {
   Titanium.API.info(<span class="hljs-string">' no connection '</span>);
   alert(<span class="hljs-string">'No Internet Connection'</span>);
} <span class="hljs-keyword">else</span> {
   Titanium.API.info(<span class="hljs-string">' connection present '</span>);
}

<span class="hljs-comment">//Set variables</span>

<span class="hljs-keyword">var</span> globalColor= <span class="hljs-string">'#104976'</span>;
<span class="hljs-keyword">var</span> user_name = <span class="hljs-string">'me'</span>;
<span class="hljs-keyword">var</span> win = Ti.UI.currentWindow;
win.title = <span class="hljs-string">''</span>+user_name;

<span class="hljs-comment">// Here we go with feed stuff.</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTracks</span>(<span class="hljs-params">user_name</span>)</span>{

    <span class="hljs-comment">// create table view data object</span>
    <span class="hljs-keyword">var</span> data = [];

    <span class="hljs-keyword">var</span> xhr = Ti.Network.createHTTPClient();
    xhr.timeout = <span class="hljs-number">1000000</span>;
    xhr.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"http://api.url.com/users/tracks.json?client_id=1234"</span>);

    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{
        <span class="hljs-keyword">try</span>
        {

            <span class="hljs-keyword">var</span> feed = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span>+<span class="hljs-keyword">this</span>.responseText+<span class="hljs-string">')'</span>);

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c=<span class="hljs-number">0</span>;c&lt;feed.length;c++){
<span class="hljs-comment">// get variables from feed</span>
                <span class="hljs-keyword">var</span> tracktitle = feed[c].title;
                <span class="hljs-keyword">var</span> user = feed[c].user.username;
                <span class="hljs-keyword">var</span> avatar = feed[c].artwork_url;
                <span class="hljs-keyword">var</span> track_url = feed[c].stream_url;
                <span class="hljs-keyword">var</span> counter= feed[c].playback_count;
                <span class="hljs-keyword">var</span> bgcolor = (c % <span class="hljs-number">2</span>) == <span class="hljs-number">0</span> ? <span class="hljs-string">'#fff'</span> : <span class="hljs-string">'#ddd'</span>;                

                <span class="hljs-keyword">var</span> row = Ti.UI.createTableViewRow({        
                hasChild:<span class="hljs-literal">false</span>,
                height:<span class="hljs-string">'auto'</span>,
                backgroundColor:bgcolor,                });


<span class="hljs-comment">// Create a vertical layout view to hold all the info labels and images for each track</span>
                <span class="hljs-keyword">var</span> post_view = Ti.UI.createView({
                    height:<span class="hljs-string">'auto'</span>,
                    layout:<span class="hljs-string">'vertical'</span>,
                    left:<span class="hljs-number">5</span>,
                    top:<span class="hljs-number">5</span>,
                    bottom:<span class="hljs-number">5</span>,
                    right:<span class="hljs-number">5</span>,
                });

<span class="hljs-comment">//make player</span>
<span class="hljs-keyword">var</span> streamer = Ti.Media.createAudioPlayer({
    url: track_url+<span class="hljs-string">'?client_id=1234'</span>
});



<span class="hljs-comment">// Make play / pause info for eack track</span>
<span class="hljs-keyword">var</span> streamingButton = Ti.UI.createButton({
    title: <span class="hljs-string">'Play'</span>,
    width:<span class="hljs-string">'50'</span>,
    height:<span class="hljs-string">'40'</span>,
    top:<span class="hljs-string">'7'</span>,
    left:<span class="hljs-string">'260'</span>
});

<span class="hljs-comment">// add event listener to row to make streamer play or pause</span>
row.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>(streamer.playing) {
        streamer.pause();
        streamingButton.title = <span class="hljs-string">'Play'</span>;
    } <span class="hljs-keyword">else</span> {
        streamer.start();
        streamingButton.title = <span class="hljs-string">'Pause'</span>;
    }
});

<span class="hljs-comment">// add play / pause info to row</span>
row.add(streamingButton);

<span class="hljs-comment">// track avatar</span>
                <span class="hljs-keyword">var</span> av = Ti.UI.createImageView({
                        image:avatar,
                        defaultImage: <span class="hljs-string">'load.gif'</span>,
                        left:<span class="hljs-number">0</span>,
                        top:-<span class="hljs-number">10</span>,
                        borderRadius:<span class="hljs-number">5</span>,
                        height:<span class="hljs-number">48</span>,
                        width:<span class="hljs-number">48</span>
                    });
                <span class="hljs-comment">// Add the avatar image to the view</span>
                post_view.add(av);



<span class="hljs-comment">//artist title</span>
                <span class="hljs-keyword">var</span> user_label = Ti.UI.createLabel({
                    text:user,
                    left:<span class="hljs-number">54</span>,
                    width:<span class="hljs-number">120</span>,
                    top:-<span class="hljs-number">48</span>,
                    bottom:<span class="hljs-number">2</span>,
                    height:<span class="hljs-number">16</span>,
                    textAlign:<span class="hljs-string">'left'</span>,
                    color:globalColor,
                    font:{fontFamily:<span class="hljs-string">'Trebuchet MS'</span>,fontSize:<span class="hljs-number">10</span>,fontWeight:<span class="hljs-string">'bold'</span>}
                });
                <span class="hljs-comment">// Add the username to the view</span>
                post_view.add(user_label);

<span class="hljs-comment">//track title</span>

                <span class="hljs-keyword">var</span> tracktitle_text = Ti.UI.createLabel({
                    text:tracktitle,
                    left:<span class="hljs-number">54</span>,
                    top:<span class="hljs-number">0</span>,
                    bottom:<span class="hljs-number">2</span>,
                    height:<span class="hljs-string">'auto'</span>,
                    width:<span class="hljs-number">236</span>,
                    textAlign:<span class="hljs-string">'left'</span>,
                    font:{fontSize:<span class="hljs-number">14</span>}    
                });
                <span class="hljs-comment">// Add the track to the view</span>
                post_view.add(tracktitle_text);
                <span class="hljs-comment">// Add the vertical layout view to the row</span>

                row.add(post_view);
                row.className = <span class="hljs-string">'item'</span>+c;
                data[c] = row;
            }
            <span class="hljs-comment">// Create the tableView and add it to the window.</span>
            <span class="hljs-keyword">var</span> tableview = Titanium.UI.createTableView({data:data,minRowHeight:<span class="hljs-number">58</span>});
            Ti.UI.currentWindow.add(tableview);            

        }
        <span class="hljs-keyword">catch</span>(E){
            alert(E);
        }
    };

    <span class="hljs-comment">// Get the data</span>
    xhr.send();
}

<span class="hljs-comment">// Get the tracks </span>
getTracks(user_name);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 3rd 2011, 3:03:43 pm">December 3rd 2011</span>
								by <span class='authorname'>d i</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224783" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224788">
				
						<section>
							<p>You don&#39;t seem to be capturing the row that was clicked in your click eventlistener on your row.</p>
<p>You should change the creation of your createAudioPlayer to:</p>
<pre><code class="hljs">
<span class="hljs-variable"><span class="hljs-keyword">var</span> streamer</span> = Ti.Media.createAudioPlayer({

});
</code></pre><p>and then set up your event listener to capture the url of the row you click:</p>
<pre><code class="hljs">
// <span class="hljs-keyword">add </span>event listener to row to make <span class="hljs-keyword">streamer </span>play or pause
<span class="hljs-label">row.addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-preprocessor">function</span>(e){

    <span class="hljs-keyword">streamer.url </span>= e.track_url+<span class="hljs-string">'?client_id=1234'</span>

    <span class="hljs-preprocessor">if</span>(<span class="hljs-keyword">streamer.playing) </span>{
        <span class="hljs-keyword">streamer.pause();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Play'</span><span class="hljs-comment">;</span>
    } <span class="hljs-preprocessor">else</span> {
        <span class="hljs-keyword">streamer.start();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Pause'</span><span class="hljs-comment">;</span>
    }
})<span class="hljs-comment">;</span>
</code></pre><p>I added the url capture to this event listener and also the &quot;e&quot; to your function().</p>
<p>The reason it was playing the last track is because you were referencing the last track in your for loop.</p>
<p>This should get you closer.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 3rd 2011, 5:58:26 pm">December 3rd 2011</span>
								by <span class='authorname'>Darren Adams</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224788" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>You may have to play around with where you put the</p>
<pre><code class="hljs">
streamer<span class="hljs-class">.url</span> = e.track_url+<span class="hljs-string">'?client_id=1234'</span>
</code></pre><p>within the event listener. I suspect you may have to move it in to your else statement like so:</p>
<pre><code class="hljs">
// <span class="hljs-keyword">add </span>event listener to row to make <span class="hljs-keyword">streamer </span>play or pause
<span class="hljs-label">row.addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-preprocessor">function</span>(e){


    <span class="hljs-preprocessor">if</span>(<span class="hljs-keyword">streamer.playing) </span>{
        <span class="hljs-keyword">streamer.pause();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Play'</span><span class="hljs-comment">;</span>
    } <span class="hljs-preprocessor">else</span> {
        <span class="hljs-keyword">streamer.url </span>= e.track_url+<span class="hljs-string">'?client_id=1234'</span>
        <span class="hljs-keyword">streamer.start();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Pause'</span><span class="hljs-comment">;</span>
    }
})<span class="hljs-comment">;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 3rd 2011, 6:23:09 pm">December 3rd 2011</span>
											by <span class='authorname'>Darren Adams</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Darren,</p>
<p>Thank you for that. I had kinda sussed out that it must be because I was referencing outside the loop because  it was always looking at the last loaded event ??? Is that the way to look at it ? </p>
<p>However it still doesn&#39;t work with your solution.In the last four days of trying to get this going i&#39;ve tried to use the &#39;e&#39; solution but it seems its that it doesn&#39;t get row specific data from that. For instance, if I do this as suggested :</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> streamer</span> = Ti.Media.createAudioPlayer({

});
</code></pre><p>Which I didnt know you could do by the way so cheers for that</p>
<p>and then add your code (in both ways of the suggestions you made) but with an alert to see url:</p>
<pre><code class="hljs">

<span class="scilab">
<span class="hljs-comment">// add event listener to row to make streamer play or pause</span>
<span class="hljs-transposed_variable">row.</span>addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    alert(<span class="hljs-transposed_variable">e.</span>track_url)
    <span class="hljs-transposed_variable">streamer.</span>url=<span class="hljs-transposed_variable">e.</span>track_url+<span class="hljs-string">'?client_id=1234'</span>

    <span class="hljs-keyword">if</span>(<span class="hljs-transposed_variable">streamer.</span>playing) {
        <span class="hljs-transposed_variable">streamer.</span><span class="hljs-keyword">pause</span>();
        <span class="hljs-transposed_variable">streamingButton.</span>title = <span class="hljs-string">'Play'</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-transposed_variable">streamer.</span>start();
        <span class="hljs-transposed_variable">streamingButton.</span>title = <span class="hljs-string">'Pause'</span>;
    }
});

<span class="hljs-comment">// add</span></span>
</code></pre><p>the alert does not give the correct url, in fact it just gives a blank alert and then says &#39;unable to configure network read stream&#39; Seems like its a step closer though so thanks. You confirmed that I did actually learn something as was right in thinking it must be something to do with it being outside the loop</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 3rd 2011, 10:31:46 pm">December 3rd 2011</span>
											by <span class='authorname'>d i</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224803">
				
						<section>
							<p>Hooray ! Light bulb moment ! </p>
<p>Thanks to  Darren for the e.track_url hint. Couldn&#39;t work out why it wouldnt pass data from the row until I realised i was using labels to populate the text rather than the title property etc ! So….. ive ended up assigning the classname of the row as the track streaming url and using e.rowData.className to pass the stream url :) And it seems to work okay.However now the app is crashing after two or three plays with :</p>
<p>&gt;2011-12-04 13:16:13.188 Silversun Soundcloud[2538:207] <em>*</em> Terminating app due to uncaught exception &#39;NSInternalInconsistencyException&#39;, reason: &#39;stopAudioSession called too many times&#39;</p>
<p>If it helps anyone else here is the code I used to pass the url of the stream</p>
<pre><code class="hljs">
<span class="hljs-comment">// Add the vertical layout view to the row(track titles etc)</span>

                row.add(post_view);
                row.className = track_url;
<span class="hljs-comment">//track_url defined earlier from json feed</span>
                data[c] = row;
            }
<span class="hljs-comment">// Create the tableView and add it to the window.</span>
            <span class="hljs-keyword">var</span> tableview = Titanium.UI.createTableView({data:data,
                minRowHeight:<span class="hljs-number">58</span>,

                });
            Ti.UI.currentWindow.add(tableview);        



<span class="hljs-comment">//row listener</span>
<span class="hljs-comment">// add event listener to row to make streamer play or pause</span>

tableview.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
    <span class="hljs-keyword">var</span> rowtrack = e.rowData.className;
    streamer.url=rowtrack+<span class="hljs-string">'?client_id=488b31b763e777ee54a7ca5ba9e4582b'</span>;
<span class="hljs-comment">//streamer defined earlier as a media player</span>

    <span class="hljs-keyword">if</span>(streamer.playing) {
        streamer.stop();
        streamingButton.title = <span class="hljs-string">'Play'</span>;
    } <span class="hljs-keyword">else</span> {
        streamer.start();
        streamingButton.title = <span class="hljs-string">'Pause'</span>;
    }
});
</code></pre><p>Thanks to everyone for your help.I&#39;ve learned a shed load in the past few days. Now…to sort out this crash !</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 4th 2011, 11:33:14 am">December 4th 2011</span>
								by <span class='authorname'>d i</span><br>
								<a class="icon-bg icon-link" href="question/128954/variable-increment-with-tableview.html#answer-224803" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I just realized before coming here, the code you need from my above post is:</p>
<pre><code class="hljs">
// <span class="hljs-keyword">add </span>event listener to row to make <span class="hljs-keyword">streamer </span>play or pause
<span class="hljs-label">row.addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-preprocessor">function</span>(e){


    <span class="hljs-preprocessor">if</span>(<span class="hljs-keyword">streamer.playing) </span>{
        <span class="hljs-keyword">streamer.pause();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Play'</span><span class="hljs-comment">;</span>
    } <span class="hljs-preprocessor">else</span> {
        <span class="hljs-keyword">streamer.url </span>= e.rowData.track_url+<span class="hljs-string">'?client_id=1234'</span>
        <span class="hljs-keyword">streamer.start();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Pause'</span><span class="hljs-comment">;</span>
    }
})<span class="hljs-comment">;</span>
</code></pre><p>I left out the rowData part.</p>
<p>The crash is something I&#39;ll have to consider some more.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 4th 2011, 4:56:20 pm">December 4th 2011</span>
											by <span class='authorname'>Darren Adams</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I would consider stopping the player and making it equal to null and declare it on Play instead of where you declare it now.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 4th 2011, 4:58:46 pm">December 4th 2011</span>
											by <span class='authorname'>Darren Adams</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Something like:</p>
<pre><code class="hljs">

<span class="armasm">// <span class="hljs-keyword">add </span>event listener to row to make <span class="hljs-keyword">streamer </span>play or pause
<span class="hljs-label">row.addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-preprocessor">function</span>(e){


    <span class="hljs-preprocessor">if</span>(<span class="hljs-keyword">streamer.playing) </span>{
        <span class="hljs-keyword">streamer.pause();
</span>        <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Play'</span><span class="hljs-comment">;</span>
        <span class="hljs-keyword">streamer </span>= null<span class="hljs-comment">;</span>
    } <span class="hljs-preprocessor">else</span> {
    var <span class="hljs-keyword">streamer </span>= Ti.Media.createAudioPlayer({

})<span class="hljs-comment">;</span>
    <span class="hljs-keyword">streamer.url </span>= e.rowData.track_url+<span class="hljs-string">'?client_id=1234'</span>
    <span class="hljs-keyword">streamer.start();
</span>    <span class="hljs-keyword">streamingButton.title </span>= <span class="hljs-string">'Pause'</span><span class="hljs-comment">;</span>
    }
})<span class="hljs-comment">;</span></span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 4th 2011, 5:03:35 pm">December 4th 2011</span>
											by <span class='authorname'>Darren Adams</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
