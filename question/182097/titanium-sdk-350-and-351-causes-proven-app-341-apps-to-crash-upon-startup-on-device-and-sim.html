<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Titanium SDK 3.5.0 and 3.5.1 Causes proven App 3.4.1 Apps to crash upon startup on device and sim » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Titanium SDK 3.5.0 and 3.5.1 Causes proven App 3.4.1 Apps to crash upon startup on device and sim</h1>
		</header>
		<section>
			<p>Titanium SDK 3.5.0 and 3.5.1 Causes proven App 3.4.1 Apps to crash upon startup on device and sim .</p>
<p>We experienced this with 3.5.0 GA and waited expecting the SDK to fix the issue but it does. not. If we could upload using our App using the 3.4.1 SDK we would but it does not support 64bit and Apple only allows 64Bit supported Apps as of Feb 2015.</p>
<p>WTF!</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 21st 2015, 9:35:25 pm">April 21st 2015</span>
				by <span class='authorname'>Frank Rivera</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>crash iso iphone 3.5</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-287100">
				
						<section>
							<ol>
<li><p>If they are &quot;proven apps&quot; then I assume you have released them before. You can avoid the 64-bit requirement on updates until June 1. That&#39;s just a band-aid, of course.</p>
</li>
<li><p>Correct, you need Titanium 3.5.x or newer for 64bit support. You will need to fix whatever is causing the crashes on startup. We can&#39;t help if you don&#39;t share details. There are hundreds of iOS apps using Titanium 3.5 and 4.0 beta, that don&#39;t crash on startup. It&#39;s not the SDK, it&#39;s your implementation. :)</p>
</li>
</ol>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 21st 2015, 11:24:37 pm">April 21st 2015</span>
								by <span class='authorname'>Shannon Hicks</span><br>
								<a class="icon-bg icon-link" href="question/182097/titanium-sdk-350-and-351-causes-proven-app-341-apps-to-crash-upon-startup-on-device-and-sim.html#answer-287100" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287106">
				
						<section>
							<p>Sorry for the rude post. I was frustrated and have been for some time because what should work and does work will not with 3.5.1. I can appreciate the fact that many developers are using Titanium but as you know this is software and there are always bugs hiding in the weeds.</p>
<p>I&#39;m fine distributing the app on 3.4.1 but iTunes Connect refuses to upload the app with 3.4.1 due to the 64bit requirement.</p>
<p>What I mean by proven is the product was built with 3.3.00 and we have migrated&#x2F;upgraded without issue all the way up to 3.4.1. This App has been in the hands of approx. 45k users for months. All that is required to cause the app to crash is to select the Titanium SDK 3.5.1 GA and recompile. It crashes in the iOS SIM and it crashes on any iOS device. Here is the code that we have isolated. If we comment it out no cash on 3.5.1. No recent code changes and this has been in the hands of actual users using their actual data on 3.4.1 since its release without issue. It has been rock solid and very stable. We first experienced this with 3.5.0 and waited for the next release but 3.5.1 does the same thing. Its appears to be in the TiDom methods.</p>
<p>&#x2F; &#x2F; self.RSLT_META = basic simple XML</p>
<p>for ( var ck = startIdx; ck &lt; colCnt; ck++ ) {</p>
<pre><code class="hljs">       var rsp = self.RSLT_META.getElementsByTagName( <span class="hljs-string">"Response"</span> );

      /<span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>  CRASH  <span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>/    
       var chdattr = rsp.item(0).childNodes.item( ck ).attributes; // crash on 3.5.1 GA
      /<span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>  CRASH  <span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span>/    

                var key;

                for ( var cka=0; chdattr &amp;&amp; cka<span class="hljs-variable">&lt;chdattr.length; cka++ ) {

                    if ( chdattr.item(cka).nodeName=="key" ) {

                        key = chdattr.item(cka).nodeValue; 

                        break;

                    }

                }

       .....</span>
</code></pre><p>}</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2015, 3:23:47 am">April 22nd 2015</span>
								by <span class='authorname'>Frank Rivera</span><br>
								<a class="icon-bg icon-link" href="question/182097/titanium-sdk-350-and-351-causes-proven-app-341-apps-to-crash-upon-startup-on-device-and-sim.html#answer-287106" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287108">
				
						<section>
							<p>The above code has code removed so it is incomplete. Here is the actual code that fails.</p>
<p>&#x2F;&#x2F; self.RSLT_META = simple XML. We only read &quot;Response&quot; node</p>
<p>genRecordSet : function() {</p>
<pre><code class="hljs">    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">self</span>.RSLT_META==<span class="hljs-keyword">null</span> || <span class="hljs-keyword">self</span>.RSLT_DATA==<span class="hljs-keyword">null</span> ) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">var</span> recCnt = ( <span class="hljs-keyword">self</span>.RSLT_DATA==<span class="hljs-keyword">null</span> ) ? <span class="hljs-number">0</span> : <span class="hljs-keyword">self</span>.RSLT_DATA.length;

    <span class="hljs-keyword">self</span>.trace( <span class="hljs-string">"!!@!!   records("</span> +<span class="hljs-keyword">self</span>.HDXSVC+ <span class="hljs-string">") FNC:"</span>+ <span class="hljs-keyword">self</span>.HDXFNC +<span class="hljs-string">" Recs: "</span>+ recCnt +<span class="hljs-string">" MEM:"</span>+ Titanium.Platform.availableMemory );

    <span class="hljs-keyword">if</span> ( recCnt&gt;<span class="hljs-number">0</span> ) {

        <span class="hljs-keyword">var</span> rsp = <span class="hljs-keyword">self</span>.RSLT_META.getElementsByTagName( <span class="hljs-string">"Response"</span> );

        <span class="hljs-keyword">var</span> startIdx = <span class="hljs-number">1</span>; 

        <span class="hljs-keyword">for</span>( <span class="hljs-keyword">var</span> r=<span class="hljs-number">0</span>; r&lt;recCnt; r++ ) {

            <span class="hljs-keyword">var</span> recStr = <span class="hljs-keyword">self</span>.RSLT_DATA[r].replace( <span class="hljs-keyword">self</span>.LFT_DELIM, <span class="hljs-string">""</span> ).replace( <span class="hljs-keyword">self</span>.RGT_DELIM, <span class="hljs-string">""</span> );

            <span class="hljs-keyword">var</span> recCols = recStr.split( <span class="hljs-keyword">self</span>.COL_DELIM );

            <span class="hljs-keyword">var</span> colCnt = recCols.length;

            <span class="hljs-keyword">var</span> rec = {};

            rec[ <span class="hljs-string">"rowIndex"</span> ] = r;

            <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> ck = startIdx; ck &lt; colCnt; ck++ ) {

                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>
                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>

                <span class="hljs-keyword">var</span> chdattr = rsp.item(<span class="hljs-number">0</span>).childNodes.item( ck ).attributes; &lt;-- CRASH !!!!!

                <span class="hljs-keyword">var</span> key;

                <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> cka=<span class="hljs-number">0</span>; chdattr &amp;&amp; cka&lt;chdattr.length; cka++ ) {

                    <span class="hljs-keyword">if</span> ( chdattr.item(cka).nodeName==<span class="hljs-string">"key"</span> ) {

                        key = chdattr.item(cka).nodeValue; <span class="hljs-comment">//chrattritm.nodeValue;</span>

                        <span class="hljs-keyword">break</span>;

                    }

                }

                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>
                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>

                rec[ key ] = recCols[ ck - startIdx ].toString();

            }

            <span class="hljs-keyword">self</span>.RSLT_RECS.push( rec );

        }

    }

}
</code></pre><p>This code is ported over and is part of a very successful product. The code is the same we distribute and implement in JavaScript, Flex and Java. The only difference is the implementation of the DOM parsing lib being used which in this case is provided by Ti. The XML, the service call, the back end code is 15 years old and is not new or has changed. As you can se this ins&#39;t a complex function, we are simply iterating over nodes of a very basic XML object.</p>
<p>Works fine under 3.4.1 but it bombs intermittently while iterating over nodes many nodes. Not a memory issue as far as we can tell since we print the remaining memory as it executes. Using the same data and XML it will bomb at different points but always at the same line of this method in 3.5.1 but not in 3.3.0 -&gt; 3.4.1</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2015, 4:46:10 am">April 22nd 2015</span>
								by <span class='authorname'>Frank Rivera</span><br>
								<a class="icon-bg icon-link" href="question/182097/titanium-sdk-350-and-351-causes-proven-app-341-apps-to-crash-upon-startup-on-device-and-sim.html#answer-287108" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>What line does it bomb at. And, what do the crash logs say?</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2015, 10:41:07 am">April 22nd 2015</span>
											by <span class='authorname'>Shannon Hicks</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287119">
				
						<section>
							<p>Shannon in the code I indicate the line with the word CRASH !!! I know it is hard to see. Here is the line.</p>
<p>var chdattr = rsp.item( 0 ).childNodes.item( ck ).attributes; It looks like a memory issue to me.</p>
<p>This code simply gets the column name form some XML representing meta_data. It is very basic XML.</p>
<p> &lt;HDX:Response isdynamic=&quot;FALSE&quot; &gt;</p>
<pre><code class="hljs">     &lt;Column
                key=<span class="hljs-string">"esq.ar.name"</span> &lt;<span class="hljs-comment">-- we are getting this column name</span>
                <span class="hljs-keyword">label</span>=<span class="hljs-string">"Name"</span>
                <span class="hljs-keyword">default</span>=<span class="hljs-string">""</span>
                <span class="hljs-keyword">type</span>=<span class="hljs-string">"string"</span>
                visible=<span class="hljs-string">"Y"</span>
        /&gt;
</code></pre><p>…</p>
<p>::::LOG:::: Running in iOS Simulator with Ti SDK 3.5.1</p>
<p>Service exited due to signal: Segmentation fault: 11</p>
<p>Apr 22 10:12:02 Franciscos-MacBook-Pro.local SpringBoard[50917]: [MPUSystemMediaControls] Updating supported commands for now playing application.<br>Apr 22 10:12:02 Franciscos-MacBook-Pro.local SpringBoard[50917]: Unable to get short BSD proc info for 50948: No such process<br>Apr 22 10:12:02 Franciscos-MacBook-Pro com.apple.CoreSimulator.SimDevice.CB9A58DE-FF98-41E2-9CB3-43C0850CF1DC.launchd_sim[50903] (UIKitApplication:com.logicBit.HoudiniEsq[0xe5fd][50948]): Service exited due to signal: Segmentation fault: 11<br>Apr 22 10:12:02 Franciscos-MacBook-Pro.local SpringBoard[50917]: Application &#39;UIKitApplication:com.logicBit.HoudiniEsq[0xe5fd]&#39; crashed.<br>Apr 22 10:12:02 Franciscos-MacBook-Pro.local assertiond[50921]: notify_suspend_pid() failed with error 7<br>Apr 22 10:12:02 Franciscos-MacBook-Pro assertiond[50921]: assertion failed: 14C1514 12F69: assertiond + 12334 [8E465C14-E4AE-36E9-AFBE-D28459602962]: 0x1</p>
<p>Apr 22 10:12:02 — last message repeated 1 time —<br>Apr 22 10:12:02 Franciscos-MacBook-Pro.local calaccessd[50945]: table drop: 101<br>…</p>
<p>::: SOLUTION ::::</p>
<p>We can prevent the crash if we only iterate over the XML once. Doing it more than once causes the crash every time but at different points in the XML but always on rsp.item( 0 ).childNodes.item( ck ).attributes;</p>
<p>In the following code we added at the top of the method an array</p>
<p>var columnNames = [];</p>
<p>We cache the column names on the first pass so rsp.item( 0 ).childNodes.item( ck ).attributes isn&#39;t called again. </p>
<p>This avoids the crash on 3.5.1. No performance boost using this columnName array since the XML is really small.</p>
<p>On 3.3.0 thru 3.4.1 it is fine but on 3.5.0 and 3.5.1 it bombs. The App exits with </p>
<p>The following is the code that prevents the crash using an array to avoid parsing XML nodes.</p>
<pre><code class="hljs">               <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>
                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>

                <span class="hljs-keyword">if</span> ( !columnNames[ ck - startIdx ] ) {

                    var chdattr = rsp.item( <span class="hljs-number">0</span> ).childNodes.item( ck ).attributes; &lt;-- USED TO CRASH !!!

                    var <span class="hljs-variable">key</span>;

                    <span class="hljs-keyword">for</span> ( var cka=<span class="hljs-number">0</span>; chdattr &amp;&amp; cka&lt;chdattr.length; cka++ ) {

                        <span class="hljs-keyword">if</span> ( chdattr.item(cka).nodeName==<span class="hljs-string">"key"</span> ) {

                            <span class="hljs-variable">key</span> = chdattr.item(cka).nodeValue; 

                            <span class="hljs-keyword">break</span>;

                        }

                    }

                    columnNames[ ck - startIdx ] = <span class="hljs-variable">key</span>;

                } <span class="hljs-keyword">else</span> {

                    <span class="hljs-variable">key</span> = columnNames[ ck - startIdx ]; &lt;-- SAVES THE DAY

                }

                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>
                <span class="hljs-comment">////--- DEFINE COLUMNS FOR RECORD</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 22nd 2015, 12:21:45 pm">April 22nd 2015</span>
								by <span class='authorname'>Frank Rivera</span><br>
								<a class="icon-bg icon-link" href="question/182097/titanium-sdk-350-and-351-causes-proven-app-341-apps-to-crash-upon-startup-on-device-and-sim.html#answer-287119" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Use markdown on your code to make it readable!</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 22nd 2015, 3:06:26 pm">April 22nd 2015</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-287144">
				
						<section>
							<p>Shannon in the code I indicate the line with the word CRASH !!! I know it is hard to see. Here is the line.<br>var chdattr = rsp.item( 0 ).childNodes.item( ck ).attributes;</p>
<pre><code class="hljs">This code simply gets the column name from basic XML representing meta_data. 

&lt;HDX:Response isdynamic=<span class="hljs-string">"FALSE"</span> &gt;
     &lt;Column
                key=<span class="hljs-string">"esq.ar.name"</span> &lt;<span class="hljs-comment">-- we are getting this column name</span>
                <span class="hljs-keyword">label</span>=<span class="hljs-string">"Name"</span>
                <span class="hljs-keyword">default</span>=<span class="hljs-string">""</span>
                <span class="hljs-keyword">type</span>=<span class="hljs-string">"string"</span>
                visible=<span class="hljs-string">"Y"</span>
        /&gt;
...
</code></pre><p>::::LOG:::: Running in iOS Simulator with Ti SDK 3.5.1</p>
<p>Service exited due to signal: Segmentation fault: 11</p>
<p>Apr 22 10:12:02 MacBook-Pro.local SpringBoard[50917]:<br>[MPUSystemMediaControls] Updating supported commands for now playing application. </p>
<p>Apr 22 10:12:02 MacBook-Pro.local SpringBoard[50917]:<br>Unable to get short BSD proc info for 50948: No such process </p>
<p>Apr 22 10:12:02 MacBook-Pro com.apple.CoreSimulator.SimDevice.<br>CB9A58DE-FF98-41E2-9CB3-43C0850CF1DC.launchd_sim[50903]<br>(UIKitApplication:com.logicBit.HoudiniEsq[0xe5fd][50948]):<br>Service exited due to signal: Segmentation fault: 11 </p>
<p>Apr 22 10:12:02 MacBook-Pro.local SpringBoard[50917]:<br>Application &#39;UIKitApplication:com.logicBit.HoudiniEsq[0xe5fd]&#39; crashed.</p>
<p>Apr 22 10:12:02 MacBook-Pro.local assertiond[50921]:<br>notify_suspend_pid() failed with error 7 </p>
<p>Apr 22 10:12:02 MacBook-Pro assertiond[50921]:<br> assertion failed: 14C1514 12F69: assertiond + 12334 [8E465C14-E4AE-36E9-AFBE-D28459602962]: 0x1</p>
<p>Apr 22 10:12:02 — last message repeated 1 time —<br>Apr 22 10:12:02 MacBook-Pro.local calaccessd[50945]: table drop: 101 …</p>
<p>::: SOLUTION ::::</p>
<p>In the following code we added at the top of the method an array</p>
<p>We cache the column names on the first pass so the statement below isn&#39;t called again.</p>
<pre><code class="hljs">// We can prevent the crash<span class="hljs-instruction"> if </span>comment out one line<span class="hljs-instruction"> or </span>we only iterate over the XML once. Doing it more than once causes the crash every time but at different points in the XML.<span class="hljs-instruction"> if </span>we<span class="hljs-instruction"> add </span>and cache the column names on the first pass

var columnNames = <span class="hljs-keyword">[</span>];

//<span class="hljs-instruction"> and </span>don't call this statement

rsp.item( 0<span class="hljs-function"> ).childNodes.item(</span> ck <span class="hljs-function">)</span>.attributes 

// no more than once to<span class="hljs-instruction"> fill </span>the columnName cache we avoid the crash on 3.5.0-3.5.1. No performance boost using this columnName<span class="hljs-instruction"> array </span>since the XML has always been tiny.
</code></pre><p>On 3.3.0 thru 3.4.1 this code has run fine but on 3.5.0 and 3.5.1 it bombs. The App exits with above errors in the log.</p>
<p>The following code uses the columnName array as described above to prevent the crash.</p>
<pre><code class="hljs">                <span class="hljs-comment">//-- DEFINE COLUMNS FOR RECORD</span>

        var <span class="hljs-variable">key</span>;

        <span class="hljs-keyword">if</span> ( !columnNames[ ck - startIdx ] ) {

            <span class="hljs-comment">//-- CUASES CRASH IF CALLED IN LOOP MANY TIMES !!!</span>
            var chdattr = rsp.item( <span class="hljs-number">0</span> ).childNodes.item( ck ).attributes;  

            <span class="hljs-keyword">for</span> ( var cka=<span class="hljs-number">0</span>; chdattr &amp;amp;&amp;amp; cka&lt;chdattr.length; cka++ ) {

                <span class="hljs-keyword">if</span> ( chdattr.item(cka).nodeName==<span class="hljs-string">"key"</span> ) {

                    <span class="hljs-variable">key</span> = chdattr.item(cka).nodeValue; 

                    <span class="hljs-keyword">break</span>;

                }

            }

            columnNames[ ck - startIdx ] = <span class="hljs-variable">key</span>;

        } <span class="hljs-keyword">else</span> {

            <span class="hljs-variable">key</span> = columnNames[ ck - startIdx ]; <span class="hljs-comment">//-- SAVES THE DAY !!!</span>

        }
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 23rd 2015, 6:32:06 pm">April 23rd 2015</span>
								by <span class='authorname'>Frank Rivera</span><br>
								<a class="icon-bg icon-link" href="question/182097/titanium-sdk-350-and-351-causes-proven-app-341-apps-to-crash-upon-startup-on-device-and-sim.html#answer-287144" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
