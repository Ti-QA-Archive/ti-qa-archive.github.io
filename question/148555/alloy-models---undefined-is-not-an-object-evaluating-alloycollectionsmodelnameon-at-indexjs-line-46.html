<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Alloy Models - &#39;undefined&#39; is not an object (evaluating &#39;Alloy.Collections.modelName.on&#39;) at index.js (line 46). Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Alloy Models - &#39;undefined&#39; is not an object (evaluating &#39;Alloy.Collections.modelName.on&#39;) at index.js (line 46).</h1>
		</header>
		<section>
			<p>I&#39;m a student developer who&#39;s currently learning Alloy. I am trying to create the TCAD tutorials, but using Alloy (I started before the new TCD tutorials were released). Anyway, I&#39;m on working with local data (250). I created a model for storing the criminals based off the Appcelerator tutorials and the TCD models lab example. I also created functions to work with that model. However, when I run my app, I get <a href="http:&#x2F;&#x2F;imageshack.us&#x2F;download&#x2F;716&#x2F;screenshot20130220at339.png">this error</a>.</p>
<p>I also looked in the iOS Simulator Library directory and found that the SQlite database wasn&#39;t even being created. I created a new migration that tells the database to create the tables, but that didn&#39;t work either. I commented out the parts of my code that are supposed to interface the database, but that didn&#39;t work either. The code seems in line with the example, and I&#39;m not exactly sure what went wrong.</p>
<p>I&#39;m using the latest Titanium Studio, Titanium SDK, and Alloy version.</p>
<p>Thank you for your help.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 20th 2013, 7:50:26 pm">February 20th 2013</span>
				by <span class='authorname'>Anthony Jesmok</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>error</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>models</span></li>
					
						<li><span class='tagname'>osx</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-257295">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I&#39;m guessing you haven&#39;t defined the global singleton instance of the &quot;criminals&quot; collection anywhere in your code. Do this:</p>
<h3 id="app-x2f-alloy-js">app&#x2F;alloy.js</h3>
<pre><code class="hljs">Alloy.Collections.criminals = Alloy.createCollection(<span class="hljs-string">'criminals'</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 21st 2013, 4:16:28 pm">February 21st 2013</span>
								by <span class='authorname'>Tony Lukasavage</span><br>
								<a class="icon-bg icon-link" href="question/148555/alloy-models---undefined-is-not-an-object-evaluating-alloycollectionsmodelnameon-at-indexjs-line-46.html#answer-257295" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That&#39;s what was missing. Thanks!</p>
<p>It looks like the Alloys Models lab needs to be updated for 1.0: https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;td&#x2F;06.+Models+and+Collections</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 4:41:58 pm">February 21st 2013</span>
											by <span class='authorname'>Quinn Madson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>If you would, please mark this answer as best so other developers reading here will know where to look for the resolution.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 4:44:34 pm">February 21st 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Tony, Quinn, Zack, and Aaron for your help! It&#39;s all fixed now and working.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 4:59:37 pm">February 21st 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>(Titanium 3.0.2, Alloy 1.0.0) I&#39;m having the same issue; however, I do have the global singleton instance defined in app&#x2F;alloy.js. I looked in the Resources folder, and this is being put into my controller at build time:</p>
<pre><code class="hljs">Alloy.Collections.Course.on(<span class="hljs-string">"fetch destroy change add remove reset"</span>, __alloyId11);
    <span class="hljs-keyword">var</span> __alloyId12 = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        $.__alloyId5.text = _.isFunction(Alloy.Models.Course.transform) ? Alloy.Models.Course.transform().CRS_TXT : Alloy.Models.Course.<span class="hljs-keyword">get</span>(<span class="hljs-string">"CRS_TXT"</span>);
        $.__alloyId7.text = _.isFunction(Alloy.Models.Course.transform) ? Alloy.Models.Course.transform().COURSE : Alloy.Models.Course.<span class="hljs-keyword">get</span>(<span class="hljs-string">"COURSE"</span>);
        $.__alloyId9.text = _.isFunction(Alloy.Models.Course.transform) ? Alloy.Models.Course.transform().CREDITS : Alloy.Models.Course.<span class="hljs-keyword">get</span>(<span class="hljs-string">"CREDITS"</span>);
    };
    Alloy.Models.Course.on(<span class="hljs-string">"fetch change destroy"</span>, __alloyId12);
    exports.destroy = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        Alloy.Collections.Course.off(<span class="hljs-string">"fetch destroy change add remove reset"</span>, __alloyId11);
        Alloy.Models.Course.off(<span class="hljs-string">"fetch change destroy"</span>, __alloyId12);
    };
</code></pre><p>I&#39;ve tried cleaning the project and rebuilding, but I still get the same issue.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 11:59:27 am">February 22nd 2013</span>
											by <span class='authorname'>Christina H</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hard to tell without seeing any of your code. What is the exact error?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 12:56:57 pm">February 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>&#39;undefined&#39; is not an object (evaluating &#39;Alloy.models.Course.on&#39;) at Courses.js (line 45)</p>
<p>I&#39;ve been following this Q&amp;A thread since it described the error I was having, but as I said above, I already have the global singleton instance defined and I&#39;m not using on() in my own code, it&#39;s being generated when I build the project and look in the Resources folder.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 1:02:19 pm">February 22nd 2013</span>
											by <span class='authorname'>Christina H</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>can you show in what file and how you are generating your singleton collection? Something is obviously not working correctly there.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 1:14:44 pm">February 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>This is the only line in app&#x2F;alloy.js:</p>
<p><code>Alloy.Collections.Course = Alloy.createCollection(&amp;#39;Course&amp;#39;);</code></p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 1:42:19 pm">February 22nd 2013</span>
											by <span class='authorname'>Christina H</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok, I don&#39;t really see anything obviously wrong, we&#39;ll probably need a test app then to see what the problem is. See if you can reduce it down to the smallest test app that exhibits the problem.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 2:23:01 pm">February 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I would really like to know why this is necessary.  I know this answer is 2 years old, but it still seems to be required, even if you are not creating  a singleton instance.  Furthermore, how do I handle this in a Widget?  There doesn&#39;t seem to be an equivalent of alloy.js for widgetsâ¦  Just started Alloy, but have been using Ti for 3 years.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 8th 2015, 7:22:53 pm">April 8th 2015</span>
											by <span class='authorname'>Trey Jones</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>7</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-257195">
				
						<section>
							<p>If you just updated Titanium I found that replacing .on() with .addEventListener() causes the problem to go away.  Nothing stated in the change log that describes deprecation of the .on event..  </p>
<p>I am having the same problem with event handlers.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 20th 2013, 7:56:53 pm">February 20th 2013</span>
								by <span class='authorname'>Zack Carlson</span><br>
								<a class="icon-bg icon-link" href="question/148555/alloy-models---undefined-is-not-an-object-evaluating-alloycollectionsmodelnameon-at-indexjs-line-46.html#answer-257195" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Weird part though is that I actually never put the on function in my code, but Titanium compiles it anyway.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 7:58:52 pm">February 20th 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Somewhere in the code, the event listener syntax .on() is in there; I was working on an app with only like 4 or 5 event listeners in there and removing them all causes the app to compile.  I would guess this is a bug that they haven&#39;t been able to figure out yet.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:00:52 pm">February 20th 2013</span>
											by <span class='authorname'>Zack Carlson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am having the same issue as Anthony. I started my Alloy work with the TCAD tutorials and have my code is near identical to the code given with in the tutorial, yet I still get this error. I put my vote towards bug as well, but why would they give us buggy code to work from?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:06:17 pm">February 20th 2013</span>
											by <span class='authorname'>Aaron Hartwig</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Just tried changing the on event to addEventListener in app.js, still getting the same error, same line, etc.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:10:55 pm">February 20th 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Could you link to the specific example you are using?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:17:38 pm">February 20th 2013</span>
											by <span class='authorname'>Zack Carlson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;td&#x2F;06.+Models+and+Collections</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:18:20 pm">February 20th 2013</span>
											by <span class='authorname'>Aaron Hartwig</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Same example as Aaron for me.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 20th 2013, 8:21:03 pm">February 20th 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-257290">
				
						<section>
							<p>this is a work and tested Alloy 1.0 implementation of the fugutives app</p>
<p><a href="https:&#x2F;&#x2F;github.com&#x2F;aaronksaunders&#x2F;alloy_fugitive">https:&#x2F;&#x2F;github.com&#x2F;aaronksaunders&#x2F;alloy_fugitive</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 21st 2013, 2:43:32 pm">February 21st 2013</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/148555/alloy-models---undefined-is-not-an-object-evaluating-alloycollectionsmodelnameon-at-indexjs-line-46.html#answer-257290" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-257210">
				
						<section>
							<p>It is in fact mentioned in the changelog and answered here: <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;148514&#x2F;updated-to-titanium-302-error-in-alloycreatecontroller.html#answer-257175">http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;148514&#x2F;updated-to-titanium-302-error-in-alloycreatecontroller.html#answer-257175</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 21st 2013, 12:00:53 am">February 21st 2013</span>
								by <span class='authorname'>Tony Lukasavage</span><br>
								<a class="icon-bg icon-link" href="question/148555/alloy-models---undefined-is-not-an-object-evaluating-alloycollectionsmodelnameon-at-indexjs-line-46.html#answer-257210" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks Tony. The thing is, I&#39;m not actually defining an on event whatsoever in my code. This is simply what Alloy is compiling to the invisible Resources directory.  All I&#39;m doing is defining a migration and a database structure. I commented out the part of my app that was supposed to interact with the collection, and I&#39;m still getting this error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 12:21:05 am">February 21st 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>We&#39;ll probably need the smallest possible test case that reproduces the issue in order to troubleshoot further. Narrow it down as much as possible.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 12:26:12 am">February 21st 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Migration I created:</p>
<pre><code class="hljs">migration.up = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(db)</span> </span>{
    migrator.createTable({
        <span class="hljs-string">"columns"</span> : {
            <span class="hljs-string">"name"</span> : <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"captured"</span> : <span class="hljs-string">"integer"</span>,
            <span class="hljs-string">"url"</span> : <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"capturedLat"</span> : <span class="hljs-string">"real"</span>,
            <span class="hljs-string">"capturedLong"</span> : <span class="hljs-string">"real"</span>
        }
    });
};

migration.down = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(db)</span> </span>{
    migrator.dropTable(<span class="hljs-string">"criminals"</span>);
};
</code></pre><p>criminals.js Model</p>
<pre><code class="hljs">exports.definition = {

    config : {
        <span class="hljs-string">"columns"</span> : {
            <span class="hljs-string">"name"</span> : <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"captured"</span> : <span class="hljs-string">"integer"</span>,
            <span class="hljs-string">"url"</span> : <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"capturedLat"</span> : <span class="hljs-string">"real"</span>,
            <span class="hljs-string">"capturedLong"</span> : <span class="hljs-string">"real"</span>
        },
        <span class="hljs-string">"defaults"</span> : {
            <span class="hljs-string">"name"</span> : <span class="hljs-string">""</span>,
            <span class="hljs-string">"captured"</span> : <span class="hljs-number">0</span>,
            <span class="hljs-string">"url"</span> : <span class="hljs-string">"http://www.uwm.edu"</span>,
            <span class="hljs-string">"capturedLat"</span> : <span class="hljs-string">""</span>,
            <span class="hljs-string">"capturedLong"</span> : <span class="hljs-string">""</span>
        },
        <span class="hljs-string">"adapter"</span> : {
            <span class="hljs-string">"type"</span> : <span class="hljs-string">"sql_new"</span>,
            <span class="hljs-string">"collection_name"</span> : <span class="hljs-string">"criminals"</span>
        }
    },

    extendModel : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Model)</span> </span>{
        _.extend(Model.prototype, {

        });
        <span class="hljs-comment">// end extend</span>

        <span class="hljs-keyword">return</span> Model;
    },

    extendCollection : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Collection)</span> </span>{
        _.extend(Collection.prototype, {

        });
        <span class="hljs-comment">// end extend</span>

        <span class="hljs-keyword">return</span> Collection;
    }
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 1:57:39 am">February 21st 2013</span>
											by <span class='authorname'>Anthony Jesmok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>this isn&#39;t a test case. Please reduce it down to the smallest set of code and files that are needed to reproduce the issue. All files in the &quot;app&quot; directory necessary to generate the problem should be included. Please don&#39;t just dump your whole app in here, try and get it down to just the problem you are experiencing. Often this will lead to finding the issue on your own.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 2:23:30 am">February 21st 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Tony,</p>
<p>I will work with Anthony to reduce the code down to a smaller example; However, in the meantime, I can confirm that he isn&#39;t doing any event listeners via .on().</p>
<p>A grep of app&#x2F; has no occurrences of .on():</p>
<pre><code class="hljs">Anthonys-MacBook-<span class="hljs-keyword">Pro</span>:<span class="hljs-keyword">app</span> ajjesmok$ grep -R '\.<span class="hljs-keyword">on</span>(' *

Anthonys-MacBook-<span class="hljs-keyword">Pro</span>:<span class="hljs-keyword">app</span> ajjesmok$ <span class="hljs-keyword">cd</span> ../Resources/

Anthonys-MacBook-<span class="hljs-keyword">Pro</span>:Resources ajjesmok$ grep -R '\.<span class="hljs-keyword">on</span>(' *

alloy/backbone.js:                <span class="hljs-keyword">for</span> (a = a ? a.<span class="hljs-keyword">split</span>(p) : f.keys(<span class="hljs-keyword">e</span>); <span class="hljs-keyword">d</span> = a.shift(); ) <span class="hljs-keyword">if</span> (<span class="hljs-keyword">h</span> = <span class="hljs-keyword">e</span>[<span class="hljs-keyword">d</span>], delete <span class="hljs-keyword">e</span>[<span class="hljs-keyword">d</span>], <span class="hljs-keyword">h</span> &amp;&amp; (b || c)) <span class="hljs-keyword">for</span> (<span class="hljs-keyword">g</span> = <span class="hljs-keyword">h</span>.tail; (<span class="hljs-keyword">h</span> = <span class="hljs-keyword">h</span>.next) !== <span class="hljs-keyword">g</span>; ) (j = <span class="hljs-keyword">h</span>.callback, q = <span class="hljs-keyword">h</span>.context, b &amp;&amp; j !== b || c &amp;&amp; q !== c) &amp;&amp; this.<span class="hljs-keyword">on</span>(<span class="hljs-keyword">d</span>, j, q);

alloy/backbone.js:            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">d</span> = a.length; c &lt; <span class="hljs-keyword">d</span>; c++) (<span class="hljs-keyword">e</span> = a[c]).<span class="hljs-keyword">on</span>(<span class="hljs-string">"all"</span>, this._onModelEvent, this), this._byCid[<span class="hljs-keyword">e</span>.cid] = <span class="hljs-keyword">e</span>, null != <span class="hljs-keyword">e</span>.id &amp;&amp; (this._byId[<span class="hljs-keyword">e</span>.id] = <span class="hljs-keyword">e</span>);

alloy/controllers/index.js:    Alloy.Collections.criminals.<span class="hljs-keyword">on</span>(<span class="hljs-string">"fetch destroy change add remove reset"</span>, __alloyId10);
</code></pre><p>That last match in index.js is what is throwing the runtime error and appears to be generated code.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 21st 2013, 3:13:05 pm">February 21st 2013</span>
											by <span class='authorname'>Quinn Madson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
