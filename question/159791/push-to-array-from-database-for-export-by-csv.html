<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Push to Array from Database for export by .csv Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Push to Array from Database for export by .csv</h1>
		</header>
		<section>
			<p>Titanium Mobile 3.1.3<br>Target: iOS </p>
<p>Greetings:)</p>
<p>I am trying to wrap my head around an other export problem, this time as .csv file. I what to get information from my database and export it as a .csv file. For the csv export part I use a great tutorial which can be find here:</p>
<p>http:&#x2F;&#x2F;www.titaniumtutorial.com&#x2F;2012&#x2F;05&#x2F;export-csv-in-titanium.html</p>
<p>So far so good, the use of an array with pre-set values works fine. However, the values of the array I need will change depending on the entries in the database. So for testing I am using the example code as follows: </p>
<pre><code class="hljs">
<span class="hljs-atom">var</span>  <span class="hljs-atom">inputCsvtest</span> = [];

<span class="hljs-atom">pushDataBtn</span>.<span class="hljs-atom">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-atom">function</span>(<span class="hljs-atom">e</span>){


   <span class="hljs-atom">inputCsvtest</span>.<span class="hljs-atom">push</span>([<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>]+<span class="hljs-string">'\n'</span>);

   <span class="hljs-name">Ti</span>.<span class="hljs-name">API</span>.<span class="hljs-atom">info</span>(<span class="hljs-atom">inputCsvtest</span>);
   <span class="hljs-name">Ti</span>.<span class="hljs-name">API</span>.<span class="hljs-atom">info</span>(<span class="hljs-string">"input array lenght= "</span>+ <span class="hljs-atom">inputCsvtest</span>.<span class="hljs-atom">length</span>);


   <span class="hljs-atom">var</span> <span class="hljs-atom">op</span> = <span class="hljs-atom">csv</span>.<span class="hljs-atom">exportCsvData</span>(<span class="hljs-atom">inputCsvtest</span>);
   // <span class="hljs-atom">alert</span>(<span class="hljs-string">"Output file path = "</span>+ <span class="hljs-atom">op</span>); 
});


<span class="hljs-name">Which</span> <span class="hljs-atom">returns</span> <span class="hljs-atom">this</span> <span class="hljs-atom">in</span> <span class="hljs-atom">the</span> <span class="hljs-atom">console</span>:


[<span class="hljs-name">INFO</span>] :   (
[<span class="hljs-name">INFO</span>] :       <span class="hljs-string">"sample data 0,sample data 1,sample data 2,sample data 3\n"</span>,
[<span class="hljs-name">INFO</span>] :       <span class="hljs-string">"sample data 0,sample data 1,sample data 2,sample data 3\n"</span>,
[<span class="hljs-name">INFO</span>] :       <span class="hljs-string">"sample data 0,sample data 1,sample data 2,sample data 3\n"</span>,
[<span class="hljs-name">INFO</span>] :       <span class="hljs-string">"sample data 0,sample data 1,sample data 2,sample data 3\n"</span>
[<span class="hljs-name">INFO</span>] :   )
[<span class="hljs-name">INFO</span>] :   <span class="hljs-atom">input</span> <span class="hljs-atom">array</span> <span class="hljs-atom">lenght</span>= <span class="hljs-number">4</span>
</code></pre><p>This seems good enough but when I export the csv file and open in for example excel,  for some reason every character is split into single cells. So the problem lies somewhere in the push to array method.</p>
<p>Using a pre-set array as the following works fine:</p>
<pre><code class="hljs">
 <span class="hljs-atom">var</span> <span class="hljs-atom">input</span> = [
     [<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>],
     [<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>],
     [<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>],
     [<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>]
   ];
</code></pre><p>I haven&#39;t included the code for pushing the values from the database into the array to make it more readable, but is the exact same problem. Could I be getting the Array in wrong format because of incorrect use of the push method?:&#x2F;</p>
<p>As always very grateful for any help!:)</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 24th 2013, 8:35:47 pm">November 24th 2013</span>
				by <span class='authorname'>Gustav Gullstrand</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>csv, array push</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-271719">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>when you do </p>
<pre><code class="hljs"> inputCsvtest.<span class="hljs-keyword">push(["sample </span><span class="hljs-preprocessor">data</span> <span class="hljs-number">0</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">1</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">2</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">3</span><span class="hljs-string">"]+'\n');</span>
</code></pre><p>you are pushing a string, as you can see in your info log</p>
<pre><code class="hljs">'sample <span class="hljs-typedef"><span class="hljs-keyword">data</span> 0,sample <span class="hljs-keyword">data</span> 1,sample <span class="hljs-keyword">data</span> 2,sample <span class="hljs-keyword">data</span> 3\n'</span>
</code></pre><p>that is not the same as the element of the preset-array of example in the link provided</p>
<pre><code class="hljs">[<span class="hljs-string">"sample data 0"</span>, <span class="hljs-string">"sample data 1"</span>, <span class="hljs-string">"sample data 2"</span>, <span class="hljs-string">"sample data 3"</span>]
</code></pre><p>So my suggestion is try without the + &#39;\n&#39; part when in the push line:</p>
<pre><code class="hljs"> inputCsvtest.<span class="hljs-keyword">push(["sample </span><span class="hljs-preprocessor">data</span> <span class="hljs-number">0</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">1</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">2</span><span class="hljs-string">", "</span>sample <span class="hljs-preprocessor">data</span> <span class="hljs-number">3</span><span class="hljs-string">"]);</span>
</code></pre><p>hth</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 24th 2013, 9:02:10 pm">November 24th 2013</span>
								by <span class='authorname'>patrick demarta</span><br>
								<a class="icon-bg icon-link" href="../../question/159791/push-to-array-from-database-for-export-by-csv.html#answer-271719" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>In other words: the input for exportCsvData is an array of arrays of strings [[&quot;a&quot;, &quot;b&quot;], [&quot;c&quot;, &quot;d&quot;]] , but your are providing it with an array of strings [&quot;a, b&quot; , &quot;c, d&quot;], then it splits the strings into single chars as you get in the resulting csv files.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 24th 2013, 9:10:29 pm">November 24th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>.. this happens at line 7 of the exportCsvData module</p>
<pre><code class="hljs">rowTxt += '"' + input[<span class="hljs-link_label">i</span>][<span class="hljs-link_reference">j</span>] + '"';
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="November 24th 2013, 9:15:57 pm">November 24th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Awesome! This works great for getting to correct formatting in excel, however an other problem arises. Now the text encoding doesn&#39;t display some characters correctly, which I find strange since it worked fine when I had the &quot;&#39;\n&#39;&quot; at the end.:&#x2F; really strange.<br>The language of the strings are Swedish so some special characters are displayed wrong, for example &quot;Ã¥&quot; gives &quot;?Â§&quot;</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 25th 2013, 7:49:49 am">November 25th 2013</span>
											by <span class='authorname'>Gustav Gullstrand</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Figured this out to be just an Excel language import problem. I works great in a excel version with the right language options:)</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 28th 2013, 8:08:27 am">November 28th 2013</span>
											by <span class='authorname'>Gustav Gullstrand</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>yup, I suspected that. happy you got it right :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 28th 2013, 8:59:52 am">November 28th 2013</span>
											by <span class='authorname'>patrick demarta</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
