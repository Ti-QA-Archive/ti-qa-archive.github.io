<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>sql update seems to do nothing » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>sql update seems to do nothing</h1>
		</header>
		<section>
			<p>mobile, 1.8.2, ios, ios simulator, osx 10.7.2, Titanium Studio, build: 1.0.9.201202141208, no console logs after update button pressed.</p>
<p>The issue I am having is that I in a different context or view I am opening the database and reading data from the database fine. I then try and update a record and it seemingly does nothing. No console output and looking in the simulator files private documents&#x2F;dbname.db.sql when opened does not have the change made to it. I don&#39;t think it is the sql query as when using a sqlite browser the query is effective. I have also checked that I don&#39;t close the database earlier in the context and therefore the database should be open and I receive no database locked errors.</p>
<p>Below is my code that I am trying to use.</p>
<pre><code class="hljs">
addButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{

    <span class="hljs-comment">// code to be run here</span>


    <span class="hljs-comment">// need to grab the value of the module selected and change the selected option to 1</span>

    <span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = picker.getSelectedRow(<span class="hljs-number">2</span>).title; <span class="hljs-comment">// grab the value of the module row</span>

    alert(<span class="hljs-built_in">module</span>);

    <span class="hljs-keyword">var</span> on = <span class="hljs-number">1</span>;


    db.execute(<span class="hljs-string">'UPDATE Module SET selected =? WHERE name =?'</span>, on, <span class="hljs-built_in">module</span>); <span class="hljs-comment">// update the selected module with the new select - this is currently not working</span>

    Ti.App.fireEvent(<span class="hljs-string">'app:updateTables'</span>); <span class="hljs-comment">// this should fire an event which my list view is listening for</span>




})
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 14th 2012, 7:50:37 am">March 14th 2012</span>
				by <span class='authorname'>David Meads</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>picker</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>do you have same issue if you run it again, without cleaning it ? </p>
<p>one more thing whenever you clear data or delete app from simulator, your database will have no previous entry.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 14th 2012, 8:48:25 am">March 14th 2012</span>
								by <span class='authorname'>Gagan Tiwari</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Gagan thank you for your comment, I still have the same issue after I re-run the application without cleaning it. By clean it do you mean the app and run again?</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 14th 2012, 10:33:58 am">March 14th 2012</span>
								by <span class='authorname'>David Meads</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-233256">
				
						<section>
							<p>hi David,</p>
<p>be sure that after firing the update query you close the database</p>
<p>db.close();<br>because i do not see any line of doing that…</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 14th 2012, 8:51:23 am">March 14th 2012</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="question/133778/sql-update-seems-to-do-nothing.html#answer-233256" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>to see any effect in the database you should close close your open connection</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 8:52:02 am">March 14th 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Mitul, thanks for your reply.</p>
<p>If I close the db immediately after the update command and before the fireEvent as below I now receive a database locked warning in the console. So I then decided the close the database further up in the file which was opening for reading data and then open again as shown in the code below but still receive the database locked error.</p>
<pre><code class="hljs">
<span class="hljs-keyword">var</span> module = picker.getSelectedRow(2).title; <span class="hljs-comment">// grab the value of the module row</span>

    alert(module);

    <span class="hljs-keyword">var</span> <span class="hljs-keyword">on</span> = 1;



    <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.<span class="hljs-keyword">open</span>('titanium.<span class="hljs-keyword">db</span>');
    <span class="hljs-keyword">db</span>.execute('<span class="hljs-keyword">UPDATE</span> Module <span class="hljs-keyword">SET</span> selected =? WHERE name =?', <span class="hljs-keyword">on</span>, module); <span class="hljs-comment">// update the selected module with the new select - this is currently not working</span>
    <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();

    Ti.<span class="hljs-keyword">App</span>.fireEvent('<span class="hljs-keyword">app</span>:updateTables'); <span class="hljs-comment">// this should fire an event which my list view is listening for</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 10:30:59 am">March 14th 2012</span>
											by <span class='authorname'>David Meads</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>show me the line when you first install your database…<br>like </p>
<pre><code class="hljs">Ti.Database.install(&lt;<span class="hljs-property">name</span>&gt;,&lt;<span class="hljs-type">alias</span> <span class="hljs-property">name</span>&gt;);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 10:41:04 am">March 14th 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>and also show me code of &#39;app:updateTables&#39;</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 10:42:09 am">March 14th 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The install and app:updateTables takes place in the tableview js file.</p>
<pre><code class="hljs">

<span class="actionscript">Ti.App.addEventListener(<span class="hljs-string">'app:updateTables'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        tableview.setData(tableData(day));
    });

<span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'titanium.db'</span>, <span class="hljs-string">'titanium.db'</span>);</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 10:44:05 am">March 14th 2012</span>
											by <span class='authorname'>David Meads</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok,i think problem is with the open and close database connection</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 11:43:05 am">March 14th 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-233254">
				
						<section>
							<p>The database .db file you use in your resource is different from that of on sqlite manager, so don&#39;t expect same changes there you make through your application. </p>
<p>you might forget to reload&#x2F;repopulate table. or might have different names of columns you have in db. </p>
<p>for better help can you show that part which populate table and open database ?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 14th 2012, 8:43:16 am">March 14th 2012</span>
								by <span class='authorname'>Gagan Tiwari</span><br>
								<a class="icon-bg icon-link" href="question/133778/sql-update-seems-to-do-nothing.html#answer-233254" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
