<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android Back Button Too Slow When Playing Video » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android Back Button Too Slow When Playing Video</h1>
		</header>
		<section>
			<p>Here is the Android log when I click the back button whilst playing a video…</p>
<pre><code class="hljs"><span class="hljs-keyword">D</span>/ConnectivityService(  <span class="hljs-number">483</span>): Sampling interval elapsed, updating statistics ..
<span class="hljs-keyword">D</span>/ConnectivityService(  <span class="hljs-number">483</span>): Done.
<span class="hljs-keyword">D</span>/ConnectivityService(  <span class="hljs-number">483</span>): <span class="hljs-keyword">Setting</span> timer for <span class="hljs-number">720</span>seconds
W/TiWebViewBinding(<span class="hljs-number">20300</span>): (KrollRuntimeThread) [<span class="hljs-number">19797</span>,<span class="hljs-number">87824</span>] Timeout waiting to evaluate JS
<span class="hljs-keyword">I</span>/Choreographer(<span class="hljs-number">20300</span>): Skipped <span class="hljs-number">219</span> frames!  The application may be doing too much work on its main thread.
<span class="hljs-keyword">I</span>/TiWebChromeClient.console(<span class="hljs-number">20300</span>): (main) [<span class="hljs-number">58</span>,<span class="hljs-number">87882</span>] Uncaught SyntaxError: Unexpected token var (<span class="hljs-number">1</span>:file:///android_asset/Resources/)
W/TimedEventQueue(  <span class="hljs-number">125</span>): Event <span class="hljs-number">980</span> was not found in the queue, already cancelled?
<span class="hljs-keyword">I</span>/hwcomposer(  <span class="hljs-number">122</span>): <span class="hljs-keyword">Setting</span> interactive mode: <span class="hljs-keyword">On</span>
<span class="hljs-keyword">D</span>/NvOsDebugPrintf(  <span class="hljs-number">125</span>): NvMMDecTVMRDestroyParser <span class="hljs-keyword">Begin</span> 
<span class="hljs-keyword">D</span>/NvOsDebugPrintf(  <span class="hljs-number">125</span>): --------- <span class="hljs-keyword">Closing</span> TVMR <span class="hljs-keyword">Frame</span> Delivery <span class="hljs-keyword">Thread</span> -------------
<span class="hljs-keyword">D</span>/NvOsDebugPrintf(  <span class="hljs-number">125</span>): ------- NvAvpClose -------
<span class="hljs-keyword">D</span>/NvOsDebugPrintf(  <span class="hljs-number">125</span>): NvMMDecTVMRDestroyParser Done 
<span class="hljs-keyword">D</span>/NvOsDebugPrintf(  <span class="hljs-number">125</span>): NvMMLiteTVMRDecPrivateClose Done 
W/AudioFlinger(  <span class="hljs-number">125</span>): session id <span class="hljs-number">488</span> not found for pid <span class="hljs-number">20300</span>
</code></pre><p>The app takes too long to react when the back button is clicked due to, I presume, the App doing too much on one thread. eg.</p>
<pre><code class="hljs">I/Choreographer(<span class="hljs-number">20300</span>): Skipped <span class="hljs-number">219</span> frames!  The <span class="hljs-type">application</span> may be doing too much work <span class="hljs-function_start"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword">its</span> main thread.
</code></pre><p>How can I launch the video player using a separate thread?</p>
<p>Thank You,<br>George</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 7th 2014, 1:10:23 pm">August 7th 2014</span>
				by <span class='authorname'>George Palframan</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>thread</span></li>
					
						<li><span class='tagname'>video</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>This is down to your code in someway………</p>
<p>Your questions omits quite a few important points.</p>
<p>1) Titanium Details.</p>
<pre><code class="hljs"> <span class="hljs-operator">a</span>) CLI <span class="hljs-operator">or</span> Studio
 b) Version <span class="hljs-operator">of</span> CLI <span class="hljs-operator">or</span> Studio
 c) Alloy <span class="hljs-operator">or</span> Classic ?
 d) SDK <span class="hljs-built_in">version</span>
</code></pre><p>2) Hardware</p>
<pre><code class="hljs"> <span class="hljs-literal">a</span>) Mac, Windows <span class="hljs-literal">or</span> Linux,
 b) OS
</code></pre><p>3) Target platform</p>
<pre><code class="hljs"> <span class="hljs-operator">a</span>) IOS <span class="hljs-operator">or</span> Android ?.
 b) OS <span class="hljs-built_in">version</span> i.e. IOS <span class="hljs-number">7</span> <span class="hljs-operator">or</span> Android <span class="hljs-number">4.1</span> ?
</code></pre><p>4) Code Example  (Do not post a load of code in pure text), Enter it as a block or use <a href="http:&#x2F;&#x2F;pastebin.com">Paste Bin</a> </p>
<p>5) Look at the <a href="https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides2&#x2F;Using+Questions+and+Answers">Q &amp; A Guidelines</a> </p>
<p>We are here to help, but please enable us to, by spending time looking at the question you are asking, and providing as much relevant information as required for us to answer the question.</p>
<p>A single sentence or 1 line question really isn’t helpful</p>
<p>When asking a question please read the information provided on the page where you enter the question details.</p>
<p>T.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 7th 2014, 1:16:57 pm">August 7th 2014</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I find your list of requirements in order for you to attempt an answer not seem relevant to what I&#39;m asking.<br>I believe that my question supplies you with what you need to know, however, here are your answers….</p>
<pre><code class="hljs"><span class="hljs-number">1</span>) Titanium Details.
<span class="hljs-operator">a</span>) CLI <span class="hljs-operator">or</span> Studio
b) Version <span class="hljs-operator">of</span> CLI <span class="hljs-operator">or</span> Studio
c) Alloy <span class="hljs-operator">or</span> Classic ? XXX
d) SDK <span class="hljs-built_in">version</span>
</code></pre><p>I am using Alloy.</p>
<pre><code class="hljs"><span class="hljs-number">2</span>) Hardware
 <span class="hljs-literal">a</span>) Mac, Windows <span class="hljs-literal">or</span> Linux, XXX
 b) OS
</code></pre><p>Mac but surely the complied code is running on an Android device so I&#39;m not sure how this is going to help.</p>
<pre><code class="hljs"><span class="hljs-number">3</span>) Target <span class="hljs-built_in">platform</span>
 <span class="hljs-operator">a</span>) IOS <span class="hljs-operator">or</span> Android ?.
 b) OS <span class="hljs-built_in">version</span> i.e. IOS <span class="hljs-number">7</span> <span class="hljs-operator">or</span> Android <span class="hljs-number">4.1</span> ?
</code></pre><p>As referred to in the question and the question title, I am having problems in Android.</p>
<pre><code class="hljs"><span class="hljs-number">4</span>) Code Example (Do <span class="hljs-operator">not</span> <span class="hljs-built_in">post</span> <span class="hljs-operator">a</span> <span class="hljs-built_in">load</span> <span class="hljs-operator">of</span> code <span class="hljs-operator">in</span> pure <span class="hljs-keyword">text</span>), Enter <span class="hljs-keyword">it</span> <span class="hljs-keyword">as</span> <span class="hljs-operator">a</span> block <span class="hljs-operator">or</span> use Paste Bin
</code></pre><p>As you can see in the question itself and in this answer I have used code blocks.</p>
<pre><code class="hljs"><span class="hljs-number">5</span>) Look <span class="hljs-keyword">at</span> <span class="hljs-operator">the</span> Q &amp; A Guidelines
</code></pre><p>This, I have done.</p>
<p>Please can anyone attempt to answer my question regarding playing a video using a new thread?<br>Trevor, I hope this now makes it easier for you to think about the question in hand.</p>
<p>Thank You,<br>George</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 7th 2014, 1:33:28 pm">August 7th 2014</span>
								by <span class='authorname'>George Palframan</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>When Trevor said Code Example, he meant JavaScript, not the output of the log! It&#39;s mentioned under #7 of the Q&amp;A Question Checklist</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 7th 2014, 1:49:56 pm">August 7th 2014</span>
								by <span class='authorname'>Michael Browne</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Here is the code that calls the video…</p>
<p>From the model I am building some HTML that is added to the page</p>
<pre><code class="hljs">pointVideo =  &lt;a onClick=<span class="hljs-string">"Ti.App.fireEvent( \'app:playVideo\', { path: this.getAttribute(\'data-href\') } ); return false;"</span> data-href=<span class="hljs-string">"' + point.videoPath() + '"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"buttonStyle videoButton"</span>&gt;&lt;span&gt;<span class="hljs-comment">' + L('pointMessage_3') + '<span class="hljs-xmlDocTag">&lt;/span&gt;</span><span class="hljs-xmlDocTag">&lt;/a&gt;</span>';</span>
</code></pre><p>Then in alloy.js I have</p>
<pre><code class="hljs"><span class="hljs-tag">Ti</span><span class="hljs-class">.App</span><span class="hljs-class">.addEventListener</span>(<span class="hljs-string">'app:playVideo'</span>, <span class="hljs-function">function</span>(e){
  <span class="hljs-tag">Alloy</span><span class="hljs-class">.createController</span>(<span class="hljs-string">'video'</span>, {<span class="hljs-attribute">videoPath</span>: e.path});
});
</code></pre><p>This then calls my video.js controller which comprises of this…</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>] || {};
<span class="hljs-keyword">var</span> index = args.videoIndex;
<span class="hljs-keyword">var</span> killEverything = <span class="hljs-literal">false</span>;


$.videoPlayer.addEventListener(<span class="hljs-string">'complete'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
  <span class="hljs-keyword">if</span> (!killEverything){
    index += <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (args.videoPaths &amp;&amp; e.reason == Titanium.Media.VIDEO_FINISH_REASON_PLAYBACK_ENDED &amp;&amp; index &lt; args.videoPaths.length) {
      $.videoPlayer.setUrl(args.videoPaths[index]);
      $.videoPlayer.play();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (OS_ANDROID){
        $.videoPlayer.hide();
        $.videoPlayer.release();
        $.videoPlayer = <span class="hljs-literal">null</span>;
      }
      $.videoWindow.close();
    }
  }
});

$.videoPlayer.addEventListener(<span class="hljs-string">'fullscreen'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
  <span class="hljs-keyword">if</span> (e.entering == <span class="hljs-literal">false</span>) {
    killEverything = <span class="hljs-literal">true</span>;
    $.videoWindow.close();
  };
});

$.videoPlayer.url = args.videoPath || args.videoPaths[index];

<span class="hljs-keyword">if</span> (OS_IOS){
  $.videoWindow.open();
}

$.videoWindow.addEventListener(<span class="hljs-string">"close"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
  $.destroy();
});
</code></pre><p>I think that the reason for the controller taking a long time to close the video is because there is already too much going on for the app to handle. So what I&#39;d like to be able to do is start the video player in it&#39;s own thread so as to avoid the lag after the back button is pressed.</p>
<p>Thank You,<br>George</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 7th 2014, 1:57:36 pm">August 7th 2014</span>
								by <span class='authorname'>George Palframan</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-281526">
				
						<section>
							<p>From my experience, I don&#39;t think it is possible to use another thread with Titanium, but I would love to be proved wrong.</p>
<p>I also don&#39;t understand how you are seeing a lag when it comes to the video player. I&#39;ve created a simple project (available <a href="https:&#x2F;&#x2F;github.com&#x2F;brownemint&#x2F;Simple-Android-Video-Player">here</a>) and noticed no notable lag when pressing the back button.</p>
<p>There must be something else going on in your app that is hogging some resources.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 8th 2014, 12:31:49 pm">August 8th 2014</span>
								by <span class='authorname'>Michael Browne</span><br>
								<a class="icon-bg icon-link" href="question/176845/android-back-button-too-slow-when-playing-video.html#answer-281526" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Yes I think that is exactly whats going on. </p>
<p>I gonna try and find a way to start a new thread. So far I&#39;ve tried using a timeout (no joy), firing an event in app.js from alloy.js (no joy) and as I&#39;m already using webviews in alloy I would have thought that these are already in their own thread but no….</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 8th 2014, 12:41:06 pm">August 8th 2014</span>
											by <span class='authorname'>George Palframan</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
