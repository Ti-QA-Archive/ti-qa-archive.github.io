<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Best practices  handling parent window refresh. » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Best practices  handling parent window refresh.</h1>
		</header>
		<section>
			<p>I have a situation where I need to choose from 3 possible values to update a data item with in a remote database. I need to this without using the picker method.  I chose tabbed bar with 3 tabs. The values loaded into the tabbed bar are &#39;admin&#39;,&#39;mgr&#39; and &#39;assoc&#39;. The choosing and database updating is done in a sibling window which is created by listener attached to the corresponding label that exposes the data to be changed. All this works just fine, however, not unexpectedly, the value that was changed in the sibling window is not shown changed in the parent window because upon returning back to the parent window there was no refresh done from the database.</p>
<p>My questions regarding this situation are:</p>
<p> 1) Is there a way to detect a &quot;return state&quot; so that it may be followed by  code that refreshes the page?</p>
<p> 2) Is there a way to return back to the grand parent window? (In my case this would be best!)</p>
<p> 3) Can a small window withing the parent window be created to do the change without leaving the<br>     parent window? Much like it can be done with pickers.</p>
<p> 4) Is there a best solution to this problem?</p>
<p>Thank you in advance for your help!</p>
<p>Alex<br>—————– Information abut my Titanium dev system —————–</p>
<p>1) Application Type: Mobil</p>
<p>2) Titanium SDK version: 2.0.1 (04&#x2F;12&#x2F;12 16:33 999c68a)</p>
<p>3) IOS 5.0,  Xcode 4.3</p>
<p>4) IOS Simulator</p>
<p>5) Host Operating System: Mac OS X version 10.7</p>
<p>6) Ti Studio build: 2.1.0.201206251749, Date: 25&#x2F;6&#x2F;2012</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 21st 2012, 2:39:31 am">July 21st 2012</span>
				by <span class='authorname'>Alexander Blazso</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>mobile iphone ipad</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-243521">
				
						<section>
							<p>Thank you very much for your suggestions Stephen. I will try all of them tomorrow except the last one in<br>which you suggest that I could pass an update function as a callback passed to my window.  I presume you meant parent window.  I cannot visualize how that can be done. If you could elaborate a bit more on that subject I&#39;ll be willing try that too.  Thanks again!</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 21st 2012, 4:20:04 am">July 21st 2012</span>
								by <span class='authorname'>Alexander Blazso</span><br>
								<a class="icon-bg icon-link" href="question/139969/best-practices-handling-parent-window-refresh#answer-243521" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-243582">
				
						<section>
							<p>Stephen, Here is the main part of my code that I changed per your suggestion #1. It woks partially. If I click on the text display of the 4th iteration of thisType the replacement of the text works OK, however iterations 1 thru 3 do not. I believe that thisType.text inf the close function only refers to the last row. Interestingly, even that text replacement has a problem. If I replace the text with a shorter or equal length text there is no problem, however if I replace the text value with a longer that the current value, the value will be abbreviated (i.e. if &quot;mgr&quot; to be replaced with &quot;associate&quot; the new value will be &quot;a..&quot;). Can you please help me with these problems?</p>
<pre><code class="hljs">    <span class="hljs-keyword">var</span> tableData = []; 
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) { 
         <span class="hljs-keyword">var</span> thisLabelName = Ti.UI.createLabel({
          color: <span class="hljs-string">'#000'</span>, text : gx_name[i], 
          width: <span class="hljs-string">'auto'</span>, left: <span class="hljs-number">5</span> 
         }); 
         <span class="hljs-keyword">var</span> thisType = Titanium.UI.createLabel({ 
              color: <span class="hljs-string">'blue'</span>, 
              text: gu_type[i], 
              width: <span class="hljs-string">'auto'</span>, 
              textAlign: <span class="hljs-string">'left'</span>, 
              bottom: <span class="hljs-number">0</span>,
              left: <span class="hljs-number">25</span>, 
              height: <span class="hljs-number">14</span> 
         }) 
         thisType.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{ 
              <span class="hljs-keyword">var</span> type = e.source.text;
      Ti.API.info(<span class="hljs-string">'thisTiype\'s text value: '</span> + e.source.text); 
              <span class="hljs-keyword">var</span> row = e.source.getParent(); 
              <span class="hljs-keyword">var</span> guid = row.children[<span class="hljs-number">0</span>].objectId; 
              <span class="hljs-keyword">var</span> gutype = row.children[<span class="hljs-number">0</span>].objectType; 
              Titanium.App.Properties.setString(<span class="hljs-string">'user_type'</span>,gutype); 
      <span class="hljs-keyword">var</span> winUserType = Ti.UI.createWindow({            
        url:<span class="hljs-string">'tabbedbar.js'</span>,
            title:<span class="hljs-string">'Set user type'</span>
      });
      Titanium.UI.currentTab.open(winUserType,{animated:<span class="hljs-literal">true</span>});
             inUserType.addEventListener(<span class="hljs-string">'close'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
         gutype = Titanium.App.Properties.getString(<span class="hljs-string">'user_type'</span>);
         ype.text = gutype;
          });
    })

        <span class="hljs-keyword">var</span> thisRow = Ti.UI.createTableViewRow({
            layout: <span class="hljs-string">"vertical"</span>,
            textAlign: <span class="hljs-string">"center"</span>,
            selectedColor: <span class="hljs-string">"black"</span>,
            touchEnabled : <span class="hljs-literal">true</span>,
            left: <span class="hljs-number">1</span>,
            height: <span class="hljs-number">50</span>,
            top: <span class="hljs-number">1</span>
        });

        thisRow.add(thisLabelName);
        thisRow.add(thisType);
        tableData.push(thisRow);
    }

    <span class="hljs-keyword">var</span> table = Ti.UI.createTableView({
        style : Ti.UI.iPhone.TableViewStyle.BORDERED,
        backgroundColor : <span class="hljs-string">'transparent'</span>,
        borderColor : <span class="hljs-string">'#969'</span>,
        data : tableData,
        separatorColor : <span class="hljs-string">'#000'</span>,
        top : <span class="hljs-number">0</span>,
        width : <span class="hljs-string">'auto'</span>
    });
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 22nd 2012, 6:22:16 pm">July 22nd 2012</span>
								by <span class='authorname'>Alexander Blazso</span><br>
								<a class="icon-bg icon-link" href="question/139969/best-practices-handling-parent-window-refresh#answer-243582" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-243520">
				
						<section>
							<p>It all depends really on how your code is laid out.<br>If the parent and the child are in the same scope, the objects in the child could interact with the objects of the parent.</p>
<p>ex:</p>
<pre><code class="hljs">
<span class="hljs-keyword">var</span> mylabel, myparentwindow, mychildwindow;
myparentwindow = Ti.UI.createWindow();
mylabel = Ti.UI.createLabel(<span class="hljs-comment">{text:'I be a label'}</span>);
mylabel.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span><span class="hljs-comment">{
    mychildwindow.open();
}</span>

<span class="hljs-title">mychildwindow</span> = <span class="hljs-title">Ti</span>.<span class="hljs-title">UI</span>.<span class="hljs-title">createWindow</span><span class="hljs-params">()</span>;</span>
mychildwindow.addEventListener(<span class="hljs-string">'close'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span><span class="hljs-comment">{
    mylabel.text = 'My parents child window was closed';
}</span>

<span class="hljs-title">myparentwindow</span>.<span class="hljs-title">add</span><span class="hljs-params">(mylabel)</span>;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 21st 2012, 3:12:52 am">July 21st 2012</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="question/139969/best-practices-handling-parent-window-refresh#answer-243520" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>You could fire an app level event to make the change:</p>
<pre><code class="hljs">Ti.App.addEventListener(<span class="hljs-string">'my_label_update'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
   mylabel.text = e.updated_text;

}



mychildwindow.addEventListener(<span class="hljs-string">'close'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    Ti.App.fireEvent(<span class="hljs-string">'my_label_update'</span>, {updared_text: <span class="hljs-string">'My parents child window was closed'</span>})
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 21st 2012, 3:15:56 am">July 21st 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You could use a function to open your window and pass an object as a reference:</p>
<pre><code class="hljs">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">openmychild</span> = <span class="hljs-title">function</span> (<span class="hljs-params">_label</span>)</span>{

    <span class="hljs-keyword">var</span> mychildwindow = Ti.UI.createWindow();

    mychildwindow.addEventListener(<span class="hljs-string">'close'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            _label.text = <span class="hljs-string">'My parents child window was closed'</span>;
    }

}

mychildwindow.open();
</code></pre><p>and call:</p>
<pre><code class="hljs">openmychild<span class="hljs-list">(<span class="hljs-keyword">mylabel</span>)</span><span class="hljs-comment">;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 21st 2012, 3:20:11 am">July 21st 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You could have an update function that you pass as a callback to your window.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 21st 2012, 3:21:01 am">July 21st 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you very much for you answers Stephen!  I am in the process  of trying them all, well maybe<br>not the last one in which you suggest that an update function could be passed as a callback to the window. I did not quite get that. Pass an update callback function to the parent window?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 21st 2012, 11:16:21 am">July 21st 2012</span>
											by <span class='authorname'>Alexander Blazso</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>We have a function:</p>
<pre><code class="hljs"><span class="hljs-keyword">function</span> myfunction(<span class="hljs-keyword">param</span>1, <span class="hljs-keyword">param</span>2){
    alert(JSON.stringify(<span class="hljs-keyword">param</span>1);
    alert(<span class="hljs-keyword">param</span>2);

}
</code></pre><p>You are probably familiar already with passing objects and values to a function:</p>
<pre><code class="hljs">var myvalue;
myvalue.<span class="hljs-type">text</span> = 'This <span class="hljs-keyword">is</span> <span class="hljs-keyword">my</span> values <span class="hljs-type">text</span>';
myfunction(myvalue,myvalue.<span class="hljs-type">text</span>);
</code></pre><p>Above we passed an entire object <code>myvalue</code> and only a specific property <code>myvalue.text</code> to our function. Lets add a 3 param to our function.</p>
<pre><code class="hljs"><span class="hljs-keyword">function</span> myfunction(<span class="hljs-keyword">param</span>1, <span class="hljs-keyword">param</span>2, <span class="hljs-keyword">param</span>3){
    alert(JSON.stringify(<span class="hljs-keyword">param</span>1);
    alert(<span class="hljs-keyword">param</span>2);
    <span class="hljs-keyword">param</span>3();
}
</code></pre><p>Now that looks really different.</p>
<pre><code class="hljs">var myvalue;
myvalue.<span class="hljs-type">text</span> = 'This <span class="hljs-keyword">is</span> <span class="hljs-keyword">my</span> values <span class="hljs-type">text</span>';

var myCallback = function (){
    myvalue.<span class="hljs-type">text</span> = 'This <span class="hljs-type">text</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> callback';
    alert('This was called <span class="hljs-keyword">in</span> <span class="hljs-keyword">my</span> callback function');

}

myfunction(myvalue,myvalue.<span class="hljs-type">text</span>,myCallback);
</code></pre><p>We passed a function into the other function just like any other object.  When that function is run, it can take params of its own, but in scope it can &#39;see&#39; the objects that were around it when it was created AND it can see the objects that are around it when it is run.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 21st 2012, 12:02:40 pm">July 21st 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Stephen, Here is the main part of my code that I changed per your suggestion #1. It woks partially.<br>If I click on the text display of the 4th iteration of thisType the replacement of the text works OK, however iterations 1 thru 3 do not. I believe that thisType.text inf the close function only refers to the last row.<br>Interestingly, even that text replacement has a problem.  If I replace the text with a shorter or equal length text there is no problem, however if I replace the text value with a longer that the current value, the value will be abbreviated (i.e. if &quot;mgr&quot; to be replaced with &quot;associate&quot; the new value will be<br>&quot;a..&quot;).<br>Can you please help me with these problems?</p>
<p>for loop iteration<br>        var tableData = [];<br>            for (var i = 0; i &lt; 4; i++) {<br>                var thisLabelName = Ti.UI.createLabel({<br>                    color: &#39;#000&#39;,<br>                    text : gx_name[i],<br>                    width: &#39;auto&#39;,<br>                    left: 5<br>                });<br>                var thisType =  Titanium.UI.createLabel({<br>                    color: &#39;blue&#39;,<br>                    text: gu_type[i],<br>                    width: &#39;auto&#39;,<br>                    textAlign: &#39;left&#39;,<br>                    bottom: 0,<br>                    left: 25,<br>                    height: 14<br>                })<br>                thisType.addEventListener(&#39;click&#39;, function(e) {<br>                    var type = e.source.text<br>                    Ti.API.info(&#39;thisTiype\&#39;s text value: &#39; + e.source.text);<br>                    var row = e.source.getParent();<br>                    var guid   = row.children[0].objectId;;<br>                    var gutype = row.children[0].objectType;<br>                    Titanium.App.Properties.setString(&#39;user_type&#39;,gutype);<br>                    var winUserType = Ti.UI.createWindow({<br>                        url:&#39;tabbedbar.js&#39;,<br>                        title:&#39;Set user type&#39;<br>                        });<br>                    Titanium.UI.currentTab.open(winUserType,{animated:true});<br>                    winUserType.addEventListener(&#39;close&#39;,function(){<br>                        gutype = Titanium.App.Properties.getString(&#39;user_type&#39;);<br>                        thisType.text = gutype;<br>                        });<br>                })</p>
<pre><code class="hljs">            var thisRow = Ti.UI.createTableViewRow({
<span class="hljs-label">                layout:</span> <span class="hljs-string">"vertical"</span>,
<span class="hljs-label">                textAlign:</span> <span class="hljs-string">"center"</span>,
<span class="hljs-label">                selectedColor:</span> <span class="hljs-string">"black"</span>,
                <span class="hljs-string">touchEnabled :</span> <span class="hljs-literal">true</span>,
<span class="hljs-label">                left:</span> <span class="hljs-number">1</span>,
<span class="hljs-label">                height:</span> <span class="hljs-number">50</span>,
<span class="hljs-label">                top:</span> <span class="hljs-number">1</span>
            });

            thisRow.add(thisLabelName);
            thisRow.add(thisType);
            tableData.push(thisRow);
        }

        var table = Ti.UI.createTableView({
            <span class="hljs-string">style :</span> Ti.UI.iPhone.TableViewStyle.BORDERED,
            <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'transparent'</span>,
            <span class="hljs-string">borderColor :</span> <span class="hljs-string">'#969'</span>,
            <span class="hljs-string">data :</span> tableData,
            <span class="hljs-string">separatorColor :</span> <span class="hljs-string">'#000'</span>,
            <span class="hljs-string">top :</span> <span class="hljs-number">0</span>,
            <span class="hljs-string">width :</span> <span class="hljs-string">'auto'</span>
        });
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2012, 5:56:24 pm">July 22nd 2012</span>
											by <span class='authorname'>Alexander Blazso</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
