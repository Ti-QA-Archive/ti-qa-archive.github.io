<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Keep a background service running » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Keep a background service running</h1>
		</header>
		<section>
			<p>Hi,<br>I have an iPhone app that runs a background service that needs to always be running but it stops after a certain time… How could I make this service never stop? I saw something saying you need to add a key to the info.plist file but that&#39;s apparently only for tracking services. But there should be another way because the Skype app is able to ever stop but it is not a tracking app.<br>Could you help me please?<br>Thanks :)</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 21st 2012, 6:04:46 pm">May 21st 2012</span>
				by <span class='authorname'>Pierre Berton</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>background</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>service</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-239834">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p><a href="http:&#x2F;&#x2F;developer.apple.com&#x2F;library&#x2F;ios&#x2F;#DOCUMENTATION&#x2F;iPhone&#x2F;Conceptual&#x2F;iPhoneOSProgrammingGuide&#x2F;ManagingYourApplicationsFlow&#x2F;ManagingYourApplicationsFlow.html">Here</a> is a great resource for understanding how the app interacts with the background. </p>
<p>There are only a couple different types of apps that are allowed to run in the background (and execute code) for extra time. (I think the normal limit is about 10 minutes)</p>
<ul>
<li>Apps that play audible content to the user while in the background, such as a music player app</li>
<li>Apps that keep users informed of their location at all times, such as a navigation app</li>
<li>Apps that support Voice over Internet Protocol (VoIP)</li>
<li>Newsstand apps that need to download and process new content</li>
<li>Apps that receive regular updates from external accessories</li>
</ul>
<p>Support for some types of background execution must be declared in advance by the app that uses them. An app declares support for a service using its <strong>Info.plist</strong> file. Add the <strong>UIBackgroundModes</strong> key to your Info.plist file and set its value to an array containing one or more of the following strings:</p>
<ul>
<li>audio—The app plays audible content to the user while in the background. (This content includes streaming audio or video content using AirPlay.)</li>
<li>location—The app keeps users informed of their location, even while it is running in the background.</li>
<li>voip—The app provides the ability for the user to make phone calls using an Internet connection.</li>
<li>newsstand-content—The app is a Newsstand app that downloads and processes magazine or newspaper content in the background.</li>
<li>external-accessory—The app works with a hardware accessory that needs to deliver updates on a regular schedule through the External Accessory framework.<br>bluetooth-central—The app works with a Bluetooth accessory that needs to deliver updates on a regular schedule through the CoreBluetooth framework.</li>
</ul>
<p>So take the info.plist file from your build folder and put it into the root of your project. Then edit it as described above. Hope this helps!</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 31st 2012, 4:24:58 pm">May 31st 2012</span>
								by <span class='authorname'>Chris Bill</span><br>
								<a class="icon-bg icon-link" href="../../question/137252/keep-a-background-service-running.html#answer-239834" rel="permalink">permalink</a>
							</div>

							<h5>8 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks :) that should make it</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 31st 2012, 5:22:22 pm">May 31st 2012</span>
											by <span class='authorname'>Pierre Berton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That is excellent, works a treat!</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 21st 2012, 9:08:26 pm">August 21st 2012</span>
											by <span class='authorname'>Stephen Page</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i need to track location in my app, I hv done all what u say but after i edit info.plist and run the app again the info.plist file changes to the previous one, then what should i do?<br>would u help me ? thanks alot</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 1:09:50 am">February 22nd 2013</span>
											by <span class='authorname'>Ario Barzan</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hmm that seems strange. Make sure that you&#39;re placing the info.plist file into the root and not into the Resources folder or build folder.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 22nd 2013, 2:56:05 am">February 22nd 2013</span>
											by <span class='authorname'>Chris Bill</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Can I get some clarification. Is the 10 min limit for non geolocation&#x2F;music apps? Or is the 10 min limit for geolocation and others can&#39;t run at all.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 27th 2013, 12:57:39 pm">March 27th 2013</span>
											by <span class='authorname'>Dan Moellering</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The maximum time an app can remain in the background mode without a special declaration in the info.plist file is 10 minutes.  If you specify that your app uses the geolocation or music functionality, the app will continue to run in the background past the 10 minute mark to perform those specific operations. </p>
<p>Does that help?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 27th 2013, 1:07:33 pm">March 27th 2013</span>
											by <span class='authorname'>Chris Bill</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Chris and all,</p>
<p>Here is my following..<br>My environment is Titanium SDK - 3.0.2 GA and testing the requirement that Pierre mentioned in this question.</p>
<p>In the info.plist ( X code 4.3.3) I have the following key&#x2F;value paris:<br>Required background modes defined as Array and under this i have Item 0 with value &quot;App registers for location updates&quot;</p>
<p>I have another key with <strong>Application does not run in background</strong> set to <strong>NO</strong></p>
<p>in app.js I have the following:</p>
<hr>
<pre><code class="hljs">   <span class="hljs-comment">// fired when an app resumes for suspension</span>
    Ti.App.addEventListener(<span class="hljs-string">'resume'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
            Ti.API.info(<span class="hljs-string">"app is resuming from the background"</span>);
            alert(<span class="hljs-string">"resume"</span>);
    });
    Ti.App.addEventListener(<span class="hljs-string">'resumed'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
            Ti.API.info(<span class="hljs-string">"app has resumed from the background"</span>);
            alert(<span class="hljs-string">"resumed..."</span>);

               <span class="hljs-comment">// ie: not via the notification 'OK' button..</span>
            <span class="hljs-keyword">if</span>(service!=<span class="hljs-literal">null</span>){
                service.stop();
                service.unregister();
            }

});

    Ti.App.addEventListener(<span class="hljs-string">'pause'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
            Ti.API.info(<span class="hljs-string">"app was paused from the foreground"</span>);
            alert(<span class="hljs-string">"user pressed the pause button and calling the background service"</span>);
            <span class="hljs-comment">// register a background service. this JS will run when the app is backgrounded</span>
            service = Ti.App.iOS.registerBackgroundService({url:<span class="hljs-string">'bg.js'</span>});

            Ti.API.info(<span class="hljs-string">"registered background service = "</span>+service);

    });
</code></pre><hr>
<p>In bg.js I have the following…</p>
<hr>
<p>var Cloud             = require(&#39;ti.cloud&#39;);</p>
<p>notify();</p>
<p>&#x2F;&#x2F;REGISTER SERVER PUSH<br>function notify(){</p>
<pre><code class="hljs">Titanium.Geolocation.getCurrentPosition( function(<span class="hljs-keyword">e</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.success) {
        Ti.<span class="hljs-keyword">App</span>.longitude = <span class="hljs-keyword">e</span>.coords.longitude;
        Ti.<span class="hljs-keyword">App</span>.latitude = <span class="hljs-keyword">e</span>.coords.latitude;
        <span class="hljs-keyword">return</span>;
    }
});

Titanium.Geolocation.reverseGeocoder(Ti.<span class="hljs-keyword">App</span>.latitude,Ti.<span class="hljs-keyword">App</span>.longitude,function(evt)
    {
        <span class="hljs-keyword">if</span> (evt.success) {
            <span class="hljs-keyword">var</span> places = evt.places;
            <span class="hljs-keyword">if</span> (places &amp;&amp; places.length) {
                Ti.<span class="hljs-keyword">App</span>.address = places[0].addresss;
                <span class="hljs-keyword">return</span>;
            } <span class="hljs-keyword">else</span> {
                Ti.<span class="hljs-keyword">App</span>.address = <span class="hljs-string">"No address found"</span>;
                <span class="hljs-keyword">return</span>;
                <span class="hljs-comment">//reverseGeo.text = "No address found";</span>
            }
            <span class="hljs-comment">//Ti.API.debug("reverse geolocation result = "+JSON.stringify(evt));</span>
        }
    });



Cloud.PushNotifications.notify({
    channel: 'friend_request',
    <span class="hljs-comment">//payload:'{alert:"address : "' + Ti.App.stashProductAlerts.length + ', sound:"default"}'</span>
    payload:'{alert:<span class="hljs-string">"longitude : "</span>' + Ti.<span class="hljs-keyword">App</span>.longitude + ' + <span class="hljs-string">"latitude : "</span>' + Ti.<span class="hljs-keyword">App</span>.latitude + ', sound:<span class="hljs-string">"default"</span>}'
}, function (<span class="hljs-keyword">e</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.success) {
        <span class="hljs-comment">//alert('longitude: '+ Ti.App.longitude + ' latitude: ' + latitude);</span>
    } <span class="hljs-keyword">else</span> {
       <span class="hljs-comment">// alert('Error:\\n' +</span>
         <span class="hljs-comment">//   ((e.error &amp;&amp; e.message) || JSON.stringify(e)));</span>
    }
});
</code></pre><p>}</p>
<p>var timer = setInterval(notify,10000);</p>
<hr>
<p>When I run this either from the console or on the device, it still runs for only 10 minutes. Other than the above, is there anything else that needs to be done or set?</p>
<p>Thanks,<br>Kumar</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 29th 2013, 3:01:09 pm">March 29th 2013</span>
											by <span class='authorname'>Tirumal Kumar Pappu</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Tirumal:  if I read your info.plist entries correctly, I think that is a least part of your issue.  Here are my entries in info.plist that work:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIRequiredDeviceCapabilities<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>accelerometer<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>gps<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>location-services<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIBackgroundModes<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>location<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="April 27th 2013, 2:28:31 pm">April 27th 2013</span>
											by <span class='authorname'>Richard Browne</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>9</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-239123">
				
						<section>
							<p>Unfortunately, this is not possible <em>out of the box</em> with Titanium</p>
<p>Here&#39;s <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;2.0&#x2F;index.html#!&#x2F;api&#x2F;Titanium.App.iOS.BackgroundService">an excerpt</a> from the API Doc.</p>
<p>####Background Service Limitations</p>
<p>A background service is subject to limitations imposed by the operating system, such as</p>
<ul>
<li>The OS limits the total amount of time a background service can run for after the application is paused, typically to no more than 10 minutes.</li>
<li>The OS may terminate the background service at any point to reclaim resources.</li>
</ul>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 21st 2012, 6:18:52 pm">May 21st 2012</span>
								by <span class='authorname'>Christian Brousseau</span><br>
								<a class="icon-bg icon-link" href="../../question/137252/keep-a-background-service-running.html#answer-239123" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Isn&#39;t it possible by editing the info.plist file or some thing like that?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2012, 2:02:21 am">May 22nd 2012</span>
											by <span class='authorname'>Pierre Berton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Or restart the service at a specific event?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2012, 4:23:16 am">May 22nd 2012</span>
											by <span class='authorname'>Pierre Berton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not that I know of (at least with Titanium) unfortunately.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2012, 6:32:19 pm">May 22nd 2012</span>
											by <span class='authorname'>Christian Brousseau</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Oh ok… Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2012, 6:35:07 pm">May 22nd 2012</span>
											by <span class='authorname'>Pierre Berton</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-4</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
