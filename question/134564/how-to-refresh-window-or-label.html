<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>How to Refresh window or label? » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>How to Refresh window or label?</h1>
		</header>
		<section>
			<p>Hi all…<br>For an iphone app…<br>Basically I need to refresh a label on a window, after making a change on another window.</p>
<p>Ok on my current window win4.  I am pulling a var from a sql database. Then I set it in a label.   </p>
<p>I then have the user go to the next window change the sql var. The data is successfully changed.  When you go back to win4, the old value is still there.  But if you go back another window and return the value is finally set to the correct value. </p>
<p>The second problem is sorta related, I want the button on the interface.js to reflect its current stat from the sql.  but it must have a preset state of true or false.   I need help with that too!  </p>
<p>I have tried using focus and tried setting up a fire event from the save button on the interface.js to either up date the whole window or just the label but it just does no work.<br>here is a example of the code…</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> win4</span> = Ti.UI.currentWindow;
detail.js___________
<span class="hljs-variable"><span class="hljs-keyword">var</span> win4</span> = Ti.UI.currentWindow;
<span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Titanium.Database.<span class="hljs-keyword">open</span>('custData7');
<span class="hljs-variable"><span class="hljs-keyword">var</span> sql4</span> = db.execute('SELECT wish FROM custTable1');
<span class="hljs-variable"><span class="hljs-keyword">var</span> wish</span> = sql4.fieldByName('wish');
db.close(); 

<span class="hljs-variable"><span class="hljs-keyword">var</span> onWishLabel</span> = Titanium.UI.createLabel({
    text: wish,
    color:<span class="hljs-string">"#FFFFFF"</span>,
    top:<span class="hljs-number">218</span>,
    left:<span class="hljs-number">200</span>,
    height:<span class="hljs-number">36</span>,
    width:<span class="hljs-string">"75%"</span>,
    font:{fontSize:<span class="hljs-number">12</span>},
    textAlign:<span class="hljs-string">"left"</span>
});
win4.add(onWishLabel);
</code></pre><p>interface.js<strong><strong>_</strong></strong></p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span><span class="hljs-params">(thisWish)</span></span>{
<span class="hljs-keyword">var</span> db = Titanium.Database.open(<span class="hljs-string">'custData7'</span>);

    db.execute(<span class="hljs-string">'DELETE FROM custTable1 WHERE ID = ?'</span>, thisID);

    db.execute(<span class="hljs-string">'INSERT INTO custTable1 (x, x, x, wish) VALUES (?, ?, ?, ?)'</span>, x, x, x, thisWish);

    <span class="hljs-keyword">var</span> sql4 = db.execute(<span class="hljs-string">'SELECT wish FROM custTable1'</span>);

    <span class="hljs-keyword">var</span> wish = sql4.fieldByName(<span class="hljs-string">'wish'</span>);

    alert(wish);
    db.close(); 

};

<span class="hljs-keyword">var</span> switch1 = Titanium.UI.createSwitch({
    top:<span class="hljs-number">86</span>,
    value:<span class="hljs-number">0</span>, 
    right:<span class="hljs-number">50</span>
});
userIntWindow.add(switch1);
<span class="hljs-keyword">var</span> insertButton = Ti.UI.createButton({
    title: <span class="hljs-string">'Update Your Info!'</span>,
    color: <span class="hljs-string">"black"</span>,
    top:<span class="hljs-number">320</span>,
    left: <span class="hljs-number">10</span>,
    height: <span class="hljs-number">40</span>
});
userIntWindow.add(insertButton);

insertButton.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    updateData(switch1.value);
});
</code></pre><p>I have the user change and update the wish in the sql.<br>by changing a switch, and hitting a button to save the change.<br>I have a alert set up the confirm the change.</p>
<p>User is to go back to detail via leftnavbutton. The Label does not reflect the new value of the wish back on the detail.js<br>Unless user goes back one more window via leftnavbutton to another window and return back to the detail.js.  Then the change shows up to the wish label.  </p>
<p>I have searched the forums and it seems either to be an easy fix or unfixable…Please help this noob!!!<br>Thanks</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 29th 2012, 1:38:35 am">March 29th 2012</span>
				by <span class='authorname'>Rich Carlton</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>click</span></li>
					
						<li><span class='tagname'>eventlistener</span></li>
					
						<li><span class='tagname'>events</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>navbar</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-234664">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi Rich,</p>
<p>Use function to get data from database all time and fire event when you come back to that window like this way.I think this way you get your data.best luck.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win4 = Ti.UI.currentWindow;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span><span class="hljs-params">()</span></span>{
<span class="hljs-keyword">var</span> db = Titanium.Database.open(<span class="hljs-string">'custData7'</span>);
<span class="hljs-keyword">var</span> sql4 = db.execute(<span class="hljs-string">'SELECT wish FROM custTable1'</span>);
<span class="hljs-keyword">var</span> wish = sql4.fieldByName(<span class="hljs-string">'wish'</span>);
db.close(); 

<span class="hljs-keyword">var</span> onWishLabel = Titanium.UI.createLabel({
    text: wish,
    color:<span class="hljs-string">"#FFFFFF"</span>,
    top:<span class="hljs-number">218</span>,
    left:<span class="hljs-number">200</span>,
    height:<span class="hljs-number">36</span>,
    width:<span class="hljs-string">"75%"</span>,
    font:{fontSize:<span class="hljs-number">12</span>},
    textAlign:<span class="hljs-string">"left"</span>
});
    win4.add(onWishLabel);

}

win4.addEventListener(<span class="hljs-string">'focus'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
 getData();
});
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 29th 2012, 5:16:04 am">March 29th 2012</span>
								by <span class='authorname'>Nitin Chavda</span><br>
								<a class="icon-bg icon-link" href="question/134564/how-to-refresh-window-or-label#answer-234664" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Ok I have applied your code again and it now adds the new value on top of the previous label.  If there is a 1 it adds a 0 on top without deleteing the 1.   I tried removing the label, and adding it back to the window, but that does not work either. I think we are on the right track but not there yet.  I also tried applying the focus on the whole window to reload the window but same results.  Any more ideas?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 29th 2012, 3:16:29 pm">March 29th 2012</span>
											by <span class='authorname'>Rich Carlton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Rich,</p>
<p>Can you try this code …</p>
<p>detail.js<strong><strong>___</strong></strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win4 = Ti.UI.currentWindow;

<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Titanium.Database.<span class="hljs-keyword">open</span>('custData7');
<span class="hljs-keyword">var</span> sql4 = <span class="hljs-keyword">db</span>.execute('SELECT wish FROM custTable1');
<span class="hljs-keyword">var</span> wish = sql4.fieldByName('wish');
<span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>(); 

<span class="hljs-keyword">var</span> onWishLabel = Titanium.UI.createLabel({
    text: wish,
    color:<span class="hljs-string">"#FFFFFF"</span>,
    top:218,
    left:200,
    height:36,
    width:<span class="hljs-string">"75%"</span>,
    font:{fontSize:12},
    textAlign:<span class="hljs-string">"left"</span>
});

win4.add(onWishLabel);


Ti.<span class="hljs-keyword">App</span>.addEventListener('getData',function(<span class="hljs-keyword">e</span>){
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Titanium.Database.<span class="hljs-keyword">open</span>('custData7');
    <span class="hljs-keyword">var</span> sql4 = <span class="hljs-keyword">db</span>.execute('SELECT wish FROM custTable1');
    <span class="hljs-keyword">var</span> wish = sql4.fieldByName('wish');
    <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>(); 
    onWishLabel.text = <span class="hljs-string">""</span>;
    onWishLabel.text = wish;
});
</code></pre><p>&#x2F;&#x2F;=======interface.js<strong><strong>_</strong></strong></p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span><span class="hljs-params">(thisWish)</span></span>{
<span class="hljs-keyword">var</span> db = Titanium.Database.open(<span class="hljs-string">'custData7'</span>);

    db.execute(<span class="hljs-string">'DELETE FROM custTable1 WHERE ID = ?'</span>, thisID);

    db.execute(<span class="hljs-string">'INSERT INTO custTable1 (x, x, x, wish) VALUES (?, ?, ?, ?)'</span>, x, x, x, thisWish);

    <span class="hljs-keyword">var</span> sql4 = db.execute(<span class="hljs-string">'SELECT wish FROM custTable1'</span>);

    <span class="hljs-keyword">var</span> wish = sql4.fieldByName(<span class="hljs-string">'wish'</span>);

    alert(wish);
    db.close(); 
    Ti.APP.fireEvent(<span class="hljs-string">'getData'</span>);

};

<span class="hljs-keyword">var</span> switch1 = Titanium.UI.createSwitch({
    top:<span class="hljs-number">86</span>,
    value:<span class="hljs-number">0</span>, 
    right:<span class="hljs-number">50</span>
});
userIntWindow.add(switch1);

<span class="hljs-keyword">var</span> insertButton = Ti.UI.createButton({
    title: <span class="hljs-string">'Update Your Info!'</span>,
    color: <span class="hljs-string">"black"</span>,
    top:<span class="hljs-number">320</span>,
    left: <span class="hljs-number">10</span>,
    height: <span class="hljs-number">40</span>
});
userIntWindow.add(insertButton);

insertButton.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    updateData(switch1.value);
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 30th 2012, 3:08:22 am">March 30th 2012</span>
											by <span class='authorname'>Nitin Chavda</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That worked!!!!    I was close to your solution,   My next thing to try was add the fire event to the sql.   THanks!</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 30th 2012, 3:44:15 pm">March 30th 2012</span>
											by <span class='authorname'>Rich Carlton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Rich,</p>
<p>It&#39;s my pleasure to help you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 31st 2012, 2:29:22 am">March 31st 2012</span>
											by <span class='authorname'>Nitin Chavda</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234663">
				
						<section>
							<p>You can set Application event for this situation.<br>add event where you label placed. you have to write function for this</p>
<pre><code class="hljs">Ti.APP.addEventListener(<span class="hljs-string">'ChangeWishLabel'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(lblText)</span></span>{
    onWishLabel.text = lblText <span class="hljs-comment">// "Your Text Here"</span>
});
</code></pre><p>and you can call this event by </p>
<pre><code class="hljs">Ti.APP.fireEvent('ChangeWishLabel', <span class="hljs-section"><span class="hljs-keyword">parameters</span>);</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 29th 2012, 5:12:42 am">March 29th 2012</span>
								by <span class='authorname'>Gaurang Chhatbar</span><br>
								<a class="icon-bg icon-link" href="question/134564/how-to-refresh-window-or-label#answer-234663" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Gaurang, I tried adding fire event with the save button when you change the sql.  But it never reloads the label on the detail.js.   Any other ideas??</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 29th 2012, 1:17:33 pm">March 29th 2012</span>
											by <span class='authorname'>Rich Carlton</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234746">
				
						<section>
							<p>Natin  For some reason focus does not work.   I tried having the focus before and after the sql, just no change.  It could be because there is just a window interface.js opening on top of this one, so it never refocused. Also if i try your method, I get an error that it cannot find wish for the label.  I tried having it fetch the var a separate time away from the get data function. But it still does not reload the data for the  label.  Any other Ideas????</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 29th 2012, 1:14:36 pm">March 29th 2012</span>
								by <span class='authorname'>Rich Carlton</span><br>
								<a class="icon-bg icon-link" href="question/134564/how-to-refresh-window-or-label#answer-234746" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
