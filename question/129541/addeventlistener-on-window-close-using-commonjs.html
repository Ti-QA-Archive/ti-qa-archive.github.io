<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>addEventListener on Window Close using CommonJS » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>addEventListener on Window Close using CommonJS</h1>
		</header>
		<section>
			<p>So I can&#39;t figure out how to get this to work. I&#39;ve tried a bunch of different ways but I can never get it to fire the event. I need to know that the window was closed so I can perform some other actions.</p>
<p>Any help would be appreciated … I&#39;m sure it&#39;s something stupid I&#39;m missing.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> addwindow = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/addwindow'</span>).addwindow;
<span class="hljs-keyword">new</span> addwindow().open({modal: <span class="hljs-literal">true</span>});

<span class="hljs-keyword">new</span> addwindow().addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Ti.API.info(<span class="hljs-string">'addwindow closed'</span>);
});

addwindow().addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Ti.API.info(<span class="hljs-string">'addwindow closed'</span>);
});

addwindow.addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    Ti.API.info(<span class="hljs-string">'addwindow closed'</span>);
});
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 16th 2011, 9:15:45 pm">December 16th 2011</span>
				by <span class='authorname'>Donnie La Curan</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>addeventlistener</span></li>
					
						<li><span class='tagname'>close</span></li>
					
						<li><span class='tagname'>commonjs</span></li>
					
						<li><span class='tagname'>window</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>might need a little more info. where do you close the window?.. also have you tried putting it into the modal window file as opposed to the calling file, on the window variable.</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2011, 9:44:05 pm">December 16th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I close the window through one of 2 buttons. One is a save which will save data then close the window with .close() and the other is a cancel button that just calls .close().</p>
<p>I need the calling window to know the modal window was closed to perform some actions.</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2011, 10:03:53 pm">December 16th 2011</span>
								by <span class='authorname'>Donnie La Curan</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>then you probably need to fire the event from within the modal window when it closes… and capture it above.. so in the modal window add the close event listener which fires the event upto the parent …</p>
<p>Hope this helps..</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2011, 10:15:49 pm">December 16th 2011</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>You wouldn&#39;t happen to have any code or links with examples of sending the event up to the parent like you&#39;re talking about would you. </p>
<p>Thanks for your help.</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2011, 10:20:06 pm">December 16th 2011</span>
								by <span class='authorname'>Donnie La Curan</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Found something that will work. Thanks for the pointers. Got me headed in the right direction!</p>
<p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;64331&#x2F;passing-data-from-child-window-to-parent">http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;64331&#x2F;passing-data-from-child-window-to-parent</a></p>
</div>
							<div class="author">
								&mdash; commented <span title="December 16th 2011, 10:57:18 pm">December 16th 2011</span>
								by <span class='authorname'>Donnie La Curan</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-225573">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Donnie, you&#39;re not adding the event listener to the window you created.  You need to assign an &quot;instance variable&quot; to the instance of the new window that you are creating.  Here&#39;s what you need:</p>
<pre><code class="hljs">MyWindow=<span class="hljs-keyword">new</span> addwindow();
MyWindow.open({modal: <span class="hljs-literal">true</span>});

MyWindow.addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    Ti.API.info(<span class="hljs-string">'MyWindow closed'</span>);
});
</code></pre><p>See, when you were calling <code>new addwindow().addEventListener...</code>, that was making yet another new window and adding the event listener to it.  <code>addwindow().addEventListener...</code> did exactly the same thing (since &quot;new&quot; is optional).  I don&#39;t know what was happening with <code>addwindow.addEventListener...</code> (that seems like an error waiting to happen).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 16th 2011, 10:50:25 pm">December 16th 2011</span>
								by <span class='authorname'>Shawn Lipscomb</span><br>
								<a class="icon-bg icon-link" href="question/129541/addeventlistener-on-window-close-using-commonjs#answer-225573" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That was it. I knew it was something stupid. This allows me to use the close event listener rather than fire off an event … which works as well.</p>
<p>Thanks to both you and Trevor for the help!</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 16th 2011, 11:11:53 pm">December 16th 2011</span>
											by <span class='authorname'>Donnie La Curan</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>3</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
