<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Help – my app ears memory » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Help – my app ears memory</h1>
		</header>
		<section>
			<p>Hi *,</p>
<p>a list of nearest dealer will update every 10 sec. via addEventListener</p>
<p>Inside the window the following code is cyclic calling:</p>
<pre><code class="hljs">var populateData = function() {
    var data = []<span class="hljs-comment">;</span>
    for (var r=0<span class="hljs-comment">;r&lt;velo.nextschrauberliste.length;r++) {</span>
        var item = velo.nextschrauberliste[r]<span class="hljs-comment">;</span>
        var row = Titanium.UI.createTableViewRow({})<span class="hljs-comment">;</span>
        var title = Titanium.UI.createLabel({
                    text:item.title
        })<span class="hljs-comment">;</span>
        var street = Titanium.UI.createLabel({
                    text:item.street
        })<span class="hljs-comment">;</span>
        var weg = 0<span class="hljs-comment">;</span>
        var dist = Titanium.UI.createLabel({text:weg})<span class="hljs-comment">;</span>
        row.add(title)<span class="hljs-comment">;</span>
        row.add(street)<span class="hljs-comment">;</span>
        row.add(dist)<span class="hljs-comment">;</span>
        data.push(row)<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
    mytableView.setData(data)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre><p>It eats memory. I dont understand why, because teh datas are local in this function.<br>How can I solve this problem?</p>
<p>Best regards<br>Rainer</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 16th 2011, 4:26:01 pm">July 16th 2011</span>
				by <span class='authorname'>Rainer Schleevoigt</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>memory leak</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>setinterval</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>8</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>8 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-213340">
				
						<section>
							<p>i think more code could be useful. it is likely to be that the event listner is being continually set. Or the update is not completing before the next update is called. It is unlikely to be local variables unless you are creating multiple instances of the function.</p>
<p>would need to see the calling code.</p>
<p>T.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 16th 2011, 4:50:49 pm">July 16th 2011</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213340" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213343">
				
						<section>
							<p>What SDK level are you using?  I suspect you are running into <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;121663&#x2F;just-a-heads-up-setdata-is-not-releasing-memory-in-170-and-171-but-works-in-170-rc">this</a> reported issue.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 16th 2011, 5:04:39 pm">July 16th 2011</span>
								by <span class='authorname'>Doug Handy</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213343" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Is there a workeround? How  I can release memory?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 16th 2011, 5:10:46 pm">July 16th 2011</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You didn&#39;t answer what SDK level you are using.  But your other answer suggests you are using 1.6.2, and if that is the case, then you are not having the issue I linked which specifically for 1.7.0 and up.</p>
<p>As to how to release the memory, the thread contains <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;121663&#x2F;just-a-heads-up-setdata-is-not-releasing-memory-in-170-and-171-but-works-in-170-rc.html#answer-213275">this</a> suggestion.  I&#39;m just a messenger here; I&#39;m only reporting what I remember seeing in another thread.  I don&#39;t profess to know any more details.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 16th 2011, 5:18:34 pm">July 16th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>How I can find the SDK level? My xcode has Version 4.0.1 (4A1006)<br>Sorry for my question …</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 16th 2011, 5:38:14 pm">July 16th 2011</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>If you are using Ti Developer, you select the SDK on the Edit tab for the project.  If you are using Ti Studio, open tiapp.xml in the project explorer.  There will be a dropdown listing the SDKs installed on your machine.  Based on another of your answers, I am thinking you are currently using 1.6.2, in which case my original SWAG on your problem does not apply (as far as I know).</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 16th 2011, 5:43:58 pm">July 16th 2011</span>
											by <span class='authorname'>Doug Handy</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213353">
				
						<section>
							<p>ok without running it through fully. everytime you call the function which sets the eventlistener a new instance of the listner is added. you do need to remove them.</p>
<p>also again without the context of how you are calling this overall namespace function I am guessing you are creating a new instance of the function everytime it is called, thus running using lots of memory.</p>
<p>can you use pastebin to include your clqlling code and I can try and see how it flows. like what dies the firevent do etc. reviewing yes it looks like it is creating multiple instances of the tableview data and just displaying over the top of the last.</p>
<p>hope this heps</p>
<p>T.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 16th 2011, 7:11:05 pm">July 16th 2011</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213353" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213378">
				
						<section>
							<p>I noticed that you have a bunch of timeouts and intervals stacked together. and calling XHR in there (which already is a bad idea). I think it&#39;s just a bad case of functions stacking on top of each other.</p>
<p><a href="http:&#x2F;&#x2F;bonsaiden.github.com&#x2F;JavaScript-Garden&#x2F;#other.timeouts">This is better explanation on that point</a>.</p>
<p>Now, I&#39;m not sure how Ti.Geolocation events are fired, but have you try to call the function when the user has travel, say 500m, away from the original location?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 17th 2011, 7:56:17 am">July 17th 2011</span>
								by <span class='authorname'>soemarko ridwan</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213378" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213387">
				
						<section>
							<p>Also, the array length should be cached so it&#39;s not checked on every iteration of the loop</p>
<pre><code class="hljs"><span class="hljs-keyword">for</span>(var <span class="hljs-built_in">i</span> = <span class="hljs-number">0</span>, l = array.<span class="hljs-built_in">length</span>; <span class="hljs-built_in">i</span> &lt; l; <span class="hljs-built_in">i</span>++)
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 17th 2011, 11:52:35 am">July 17th 2011</span>
								by <span class='authorname'>Brian Blankenship</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213387" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thanx for the hint.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 21st 2011, 4:12:25 am">July 21st 2011</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213370">
				
						<section>
							<p>Hi Trevor,</p>
<p>here is the view: http:&#x2F;&#x2F;pastie.org&#x2F;2225606<br>and here the controler: http:&#x2F;&#x2F;pastie.org&#x2F;2225610<br>and the app.js:</p>
<pre><code class="hljs"><span class="hljs-type">Titanium</span>.<span class="hljs-type">UI</span>.setBackgroundColor(<span class="hljs-char">'#000000'</span>);
var velo = {}; 
<span class="hljs-type">Ti</span>.<span class="hljs-keyword">include</span>(<span class="hljs-symbol">'velo</span>.ctrl.js');
<span class="hljs-type">Ti</span>.<span class="hljs-keyword">include</span>(<span class="hljs-symbol">'velo</span>.view.js');
var tabs = velo.ui.createApplicationTabGroup<span class="hljs-literal">()</span>;
tabs.<span class="hljs-keyword">open</span>({
    transition:<span class="hljs-type">Titanium</span>.<span class="hljs-type">UI</span>.iPhone.<span class="hljs-type">AnimationStyle</span>.<span class="hljs-type">CURL_UP</span>,
    duration:<span class="hljs-number">1000</span>
});
tabs.setActiveTab(<span class="hljs-number">1</span>);
</code></pre><p>Now I changed to SDK 1.7.1<br>If I comment out the line addEventlistener, the memory eating is terminated. The cron run in real life every 10 sec and not every 60 ms.<br>I think there is only one instance of tableView. The problem comes by changing of data filling. Idea: one time construct the data array and then only reordering?</p>
<p>Best regards<br>Rainer</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 17th 2011, 4:56:27 am">July 17th 2011</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213370" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>and here the structure of &quot;db&quot;:<br>{&quot;dealer&quot;:[{&quot;title&quot;:&quot;Biedler Bikes SD-Service&quot;,&quot;strasse&quot;:&quot;Jarrestrasse 29&quot;,&quot;ort&quot;:&quot;&quot;,&quot;lat&quot;:&quot;10.0236000000&quot;,&quot;lon&quot;:&quot;53.5848117700&quot;,&quot;id&quot;:&quot;1&quot;,&quot;thumb&quot;:&quot;http:\&#x2F;\&#x2F;tools.webmasterei.com\&#x2F;velomap2\&#x2F;imgdb\&#x2F;icons\&#x2F;1.jpg&quot;},</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 17th 2011, 5:06:20 am">July 17th 2011</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213342">
				
						<section>
							<p>Hi Trevor,</p>
<p>here is the full code:</p>
<pre><code class="hljs"><span class="hljs-list">(<span class="hljs-keyword">function</span><span class="hljs-list">()</span> <span class="hljs-collection">{
    velo.ui = <span class="hljs-collection">{}</span><span class="hljs-comment">;</span>
    velo.ui.createTableView = function<span class="hljs-list">()</span> <span class="hljs-collection">{
    var tableView = Ti.UI.createTableView<span class="hljs-list">()</span><span class="hljs-comment">;</span>

    var populateData = function<span class="hljs-list">()</span> <span class="hljs-collection">{
        var data = <span class="hljs-collection">[]</span><span class="hljs-comment">;</span>
        for <span class="hljs-list">(<span class="hljs-keyword"><span class="hljs-built_in">var</span></span> r=0;r&lt;velo.nextschrauberliste.length;r++)</span> <span class="hljs-collection">{
            var item = velo.nextschrauberliste<span class="hljs-collection">[r]</span><span class="hljs-comment">;</span>
            var row = Titanium.UI.createTableViewRow<span class="hljs-list">(<span class="hljs-collection">{}</span>)</span><span class="hljs-comment">;</span>
            var title = Titanium.UI.createLabel<span class="hljs-list">(<span class="hljs-collection">{
                text:item.title
            }</span>)</span><span class="hljs-comment">;</span>
            var street = Titanium.UI.createLabel<span class="hljs-list">(<span class="hljs-collection">{
                text:item.street
            }</span>)</span><span class="hljs-comment">;</span>
            var weg = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
            var dist = Titanium.UI.createLabel<span class="hljs-list">(<span class="hljs-collection">{text:weg}</span>)</span><span class="hljs-comment">;</span>
            row.add<span class="hljs-list">(<span class="hljs-keyword">title</span>)</span><span class="hljs-comment">;</span>
            row.add<span class="hljs-list">(<span class="hljs-keyword">street</span>)</span><span class="hljs-comment">;</span>
            row.add<span class="hljs-list">(<span class="hljs-keyword">dist</span>)</span><span class="hljs-comment">;</span>
            data.push<span class="hljs-list">(<span class="hljs-keyword">row</span>)</span><span class="hljs-comment">;</span>
        }</span><span class="hljs-comment">;</span>
        tableView.setData<span class="hljs-list">(<span class="hljs-keyword">data</span>)</span><span class="hljs-comment">;</span>
    }</span><span class="hljs-comment">;</span>
     Ti.App.addEventListener<span class="hljs-list">(<span class="hljs-keyword">'newvelolist'</span>,populateData)</span><span class="hljs-comment">; // &lt;== here comes</span>
    return tableView;
}</span><span class="hljs-comment">;</span>
}</span>)</span><span class="hljs-list">()</span><span class="hljs-comment">;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 16th 2011, 5:01:59 pm">July 16th 2011</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213342" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213344">
				
						<section>
							<p>~~~<br>Starting build at 07&#x2F;16&#x2F;11 20:47<br>Build details:<br>   timestamp=04&#x2F;18&#x2F;11 17:16<br>   version=1.6.2<br>Script arguments:<br>   &#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.6.2&#x2F;iphone&#x2F;builder.py<br>   simulator<br>   &quot;4.3&quot;<br>   &quot;&#x2F;Users&#x2F;rainerschleevoigt&#x2F;Documents&#x2F;HamburgerRadfahrer&quot;<br>   com.webmasterei.hamburgerradschrauber<br>   &quot;HamburgerRadfahrer&quot;<br>   universal<br>   iphone<br>[INFO] Detected third-party module: com.ti.calendar&#x2F;0.1[INFO] Detected third-party module: ti.paint&#x2F;1.0</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 16th 2011, 5:07:48 pm">July 16th 2011</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="../../question/122669/help--my-app-ears-memory.html#answer-213344" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
