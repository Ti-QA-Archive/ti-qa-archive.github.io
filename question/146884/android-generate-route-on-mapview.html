<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android generate route on mapview » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android generate route on mapview</h1>
		</header>
		<section>
			<p>I&#39;ve gt a few question to ask:</p>
<p>1) Does generating route works on android? according to this link (https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Native+Maps+and+Annotations) ,route is for iOS only.</p>
<p>2) If answer to above question is yes, what must i prepare&#x2F;do in order to get it to work? I basically dun use android emulator and straight test it on my device.</p>
<p>Btw, I&#39;m using titanium sdk 2.1.4 and testing device is Galaxy S2 and S3.<br>Any help is much appreciated.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 15th 2013, 4:19:35 am">January 15th 2013</span>
				by <span class='authorname'>Chung Farn Kien</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>map</span></li>
					
						<li><span class='tagname'>mapview</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>route</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-254553">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>I provided an answer to this a while map, yes it is possible to add routes to android maps (now) and if you use the code sample in my original answer you can get perfectly smoothed routes rather than the standard set of straight lines.</p>
<p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;141002&#x2F;plot-a-route-on-google-map-in-android#answer-245304">Plot a a route previous answer</a></p>
<p>This should solve your problem easily, if not let me know.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 15th 2013, 6:33:18 am">January 15th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/146884/android-generate-route-on-mapview#answer-254553" rel="permalink">permalink</a>
							</div>

							<h5>12 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>ok this solved my problem but here is one thing. I dun want the route to show immediately when the app start. I wan like a button or something to trigger the route event. One thing that i tried is that i added click event to the map view. It kinda works but when we click the pin, the annotation immediately disappear after appearing a while. When I click the pin again, the app crash.</p>
<p>So, can I add something in the map view to trigger a click event to show the route?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 16th 2013, 2:49:11 am">January 16th 2013</span>
											by <span class='authorname'>Chung Farn Kien</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry, I only just noticed the follow-up.</p>
<p>This sample code will show you how to adapt the previous code so you can add routes based on an event - in this case a button click.</p>
<p>You can test this by creating a new default project and then replace the contents of <strong>app.js</strong> with the code below.  I have modified the function so you can call the route function based on parameters.</p>
<pre><code class="hljs"><span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.setBackgroundColor('<span class="hljs-comment">#000');</span>

<span class="hljs-keyword">var</span> tab1;

function decodeLine(encoded) {
    <span class="hljs-keyword">var</span> len = encoded.length;
    <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> <span class="hljs-type">array</span> = [];
    <span class="hljs-keyword">var</span> lat = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> lng = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">while</span> (index &lt; len) {
        <span class="hljs-keyword">var</span> b;
        <span class="hljs-keyword">var</span> shift = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> <span class="hljs-literal">result</span> = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">do</span> {
            b = encoded.charCodeAt(index++) - <span class="hljs-number">63</span>;
            <span class="hljs-literal">result</span> |= (b &amp; <span class="hljs-number">0x1f</span>) &lt;&lt; shift;
            shift += <span class="hljs-number">5</span>;
        } <span class="hljs-keyword">while</span> (b &gt;= <span class="hljs-number">0x20</span>);

        <span class="hljs-keyword">var</span> dlat = ((<span class="hljs-literal">result</span> &amp; <span class="hljs-number">1</span>) ? ~(<span class="hljs-literal">result</span> &gt;&gt; <span class="hljs-number">1</span>) : (<span class="hljs-literal">result</span> &gt;&gt; <span class="hljs-number">1</span>));
        lat += dlat;

        shift = <span class="hljs-number">0</span>;
        <span class="hljs-literal">result</span> = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">do</span> {
            b = encoded.charCodeAt(index++) - <span class="hljs-number">63</span>;
            <span class="hljs-literal">result</span> |= (b &amp; <span class="hljs-number">0x1f</span>) &lt;&lt; shift;
            shift += <span class="hljs-number">5</span>;
        } <span class="hljs-keyword">while</span> (b &gt;= <span class="hljs-number">0x20</span>);

        <span class="hljs-keyword">var</span> dlng = ((<span class="hljs-literal">result</span> &amp; <span class="hljs-number">1</span>) ? ~(<span class="hljs-literal">result</span> &gt;&gt; <span class="hljs-number">1</span>) : (<span class="hljs-literal">result</span> &gt;&gt; <span class="hljs-number">1</span>));
        lng += dlng;

        <span class="hljs-type">array</span>.push([lat * <span class="hljs-number">1</span>e-<span class="hljs-number">5</span>, lng * <span class="hljs-number">1</span>e-<span class="hljs-number">5</span>]);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-type">array</span>;
}
function addRoute(obj) {
    <span class="hljs-keyword">var</span> xhr = <span class="hljs-type">Ti</span>.<span class="hljs-type">Network</span>.createHTTPClient();
    xhr.onload = function (e) {
        <span class="hljs-keyword">var</span> response = this.responseText;
        <span class="hljs-keyword">var</span> json = <span class="hljs-type">JSON</span>.parse(response);

        <span class="hljs-keyword">var</span> step = json.routes[<span class="hljs-number">0</span>].legs[<span class="hljs-number">0</span>].steps;
        <span class="hljs-keyword">var</span> intStep = <span class="hljs-number">0</span>, intSteps = step.length, points = [];
        <span class="hljs-keyword">var</span> decodedPolyline, intPoint = <span class="hljs-number">0</span>, intPoints = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (intStep = <span class="hljs-number">0</span>; intStep &lt; intSteps; intStep = intStep + <span class="hljs-number">1</span>) {
            decodedPolyline = decodeLine(step[intStep].polyline.points);
            intPoints = decodedPolyline.length;
            <span class="hljs-keyword">for</span> (intPoint = <span class="hljs-number">0</span>; intPoint &lt; intPoints; intPoint = intPoint + <span class="hljs-number">1</span>) {
                <span class="hljs-keyword">if</span> (decodedPolyline[intPoint] != null) {
                    points.push({
                        latitude: decodedPolyline[intPoint][<span class="hljs-number">0</span>],
                        longitude: decodedPolyline[intPoint][<span class="hljs-number">1</span>]
                    });
                }
            }
        }

        <span class="hljs-keyword">var</span> route = {
            name: '<span class="hljs-type">Example</span> <span class="hljs-type">Route</span>',
            points: points,
            color: '<span class="hljs-comment">#c60000',</span>
            width: <span class="hljs-number">4</span>
        };
        obj.map.addRoute(route);    
    };
    xhr.onerror = function (e) {
        <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.info('error', <span class="hljs-type">JSON</span>.stringify(e));
    };
    <span class="hljs-keyword">var</span> param = [
        'destination=' + obj.stop,
        'origin=' + obj.start,
        'region=' + obj.region,
        'sensor=<span class="hljs-literal">false</span>'
    ];
    xhr.open('<span class="hljs-type">GET</span>', 'http://maps.googleapis.com/maps/api/directions/json?' + param.join('&amp;'));
    xhr.send();
} 

<span class="hljs-keyword">var</span> win = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createWindow({
    backgroundColor: '<span class="hljs-comment">#fff',</span>
    title: '<span class="hljs-type">Test</span>'
});
tab1 = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTab({
    icon: '<span class="hljs-type">KS_nav_views</span>.png',
    title: '<span class="hljs-type">Tab</span> <span class="hljs-number">1</span>',
    window: win
});

<span class="hljs-keyword">var</span> region = {
    latitude: <span class="hljs-number">52</span>.<span class="hljs-number">9219</span>,
    longitude: -<span class="hljs-number">1</span>.<span class="hljs-number">4758</span>,
    latitudeDelta: <span class="hljs-number">2</span>,
    longitudeDelta: <span class="hljs-number">2</span>
};
<span class="hljs-keyword">var</span> anno = <span class="hljs-type">Ti</span>.<span class="hljs-type">Map</span>.createAnnotation({
    animate: <span class="hljs-literal">true</span>,
    latitude: region.latitude,
    longitude: region.longitude,
    pincolor: <span class="hljs-type">Ti</span>.<span class="hljs-type">Map</span>.<span class="hljs-type">ANNOTATION_RED</span>,
    subtitle: '<span class="hljs-type">Start</span>',
    title: <span class="hljs-string">"Boston,MA"</span>,
});

<span class="hljs-keyword">var</span> map = <span class="hljs-type">Ti</span>.<span class="hljs-type">Map</span>.createView({
    animate: <span class="hljs-literal">true</span>,
    annotations: [anno],
    bottom: <span class="hljs-number">0</span>,
    height: <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.<span class="hljs-type">FILL</span>,
    mapType: <span class="hljs-type">Ti</span>.<span class="hljs-type">Map</span>.<span class="hljs-type">STANDARD_TYPE</span>,
    region: region,
    regionFit: <span class="hljs-literal">true</span>,
    top: <span class="hljs-number">60</span>,
    userLocation: <span class="hljs-literal">true</span>,
    width: <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.<span class="hljs-type">FILL</span>
});
win.add(map);

<span class="hljs-keyword">var</span> btn = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createButton({
    height: <span class="hljs-number">50</span>,
    left: <span class="hljs-number">10</span>,
    right: <span class="hljs-number">10</span>,
    title: '<span class="hljs-type">Add</span> <span class="hljs-type">Route</span>',
    top: <span class="hljs-number">5</span>,
    width: <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.<span class="hljs-type">FILL</span>
});
win.add(btn);
btn.addEventListener('click', function (e) {
    addRoute({
        map: map,
        region: '<span class="hljs-type">UK</span>',
        start: '<span class="hljs-type">Cambridge</span>',
        stop: '<span class="hljs-type">Birmingham</span>'
    });
});

<span class="hljs-keyword">var</span> tabGroup = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createTabGroup();
tabGroup.addTab(tab1);
tabGroup.open();
</code></pre><p>Hopefully this answers your question.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 19th 2013, 5:17:53 pm">January 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did this answer your question?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 22nd 2013, 7:45:12 pm">January 22nd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>sort of…if possible i want the button to be on the map view itself…cz my map take the whole screen…</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 23rd 2013, 3:43:19 am">January 23rd 2013</span>
											by <span class='authorname'>Chung Farn Kien</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You realise you can just change the properties to place the button over the map?</p>
<pre><code class="hljs">var <span class="hljs-built_in">map</span> = Ti.Map.createView({
    animate: <span class="hljs-keyword">true</span>,
    annotations: [anno],
    <span class="hljs-variable">height</span>: Ti.UI.FILL,
    mapType: Ti.Map.STANDARD_TYPE,
    region: region,
    regionFit: <span class="hljs-keyword">true</span>,
    userLocation: <span class="hljs-keyword">true</span>,
    <span class="hljs-variable">width</span>: Ti.UI.FILL
});
win.<span class="hljs-built_in">add</span>(<span class="hljs-built_in">map</span>);

var btn = Ti.UI.createButton({
    <span class="hljs-variable">height</span>: <span class="hljs-number">50</span>,
    left: <span class="hljs-number">10</span>,
    title: <span class="hljs-string">'Add Route'</span>,
    top: <span class="hljs-number">5</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">100</span>
});
win.<span class="hljs-built_in">add</span>(btn);
</code></pre><p>This will use a full window map and place the button in the top left hand corner, you can change these values to do whatever you want and give what UI you are after of course .</p>
<p>But just to confirm the map appears with a route as requested - thus answering your question?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 23rd 2013, 8:20:23 am">January 23rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>yup it does…..</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 24th 2013, 11:13:45 pm">January 24th 2013</span>
											by <span class='authorname'>Chung Farn Kien</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>realize*</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 19th 2013, 1:19:31 pm">March 19th 2013</span>
											by <span class='authorname'>Paul Nelson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Paul are you trying to correct the British spelling of <strong>realise&quot; with the US spelling of </strong>realize**?</p>
<p>Just to let you know I am British and live in the UK - you realise?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 19th 2013, 1:59:00 pm">March 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Malcolm… instead of giving the start and stop as a place name … how can we use if latitude and longitude of the place are provided????</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2013, 2:28:35 pm">March 22nd 2013</span>
											by <span class='authorname'>Biswajeet Nayak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>how can we add the latitude and longitude of the waypoints if i&#39;ve more than one way points???</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2013, 2:30:34 pm">March 22nd 2013</span>
											by <span class='authorname'>Biswajeet Nayak</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Biswajeet Nayak, try not to pollute the Q&amp;A with the same questions in two places, you are fine in the new question you asked today.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2013, 2:41:16 pm">March 22nd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the code is very useful,but my problem is i want route from user current location to a static location. how can i make this possible?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2013, 8:07:00 am">May 22nd 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-256481">
				
						<section>
							<p>Does this works on Android 2.3 ? if not what is the minimum version for this ?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 10th 2013, 6:58:09 pm">February 10th 2013</span>
								by <span class='authorname'>Armindo Da Silva</span><br>
								<a class="icon-bg icon-link" href="question/146884/android-generate-route-on-mapview#answer-256481" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Should do, the code is more dependant on the titanium version you are running as it was not possible before 2.1 to add a route to an android map.</p>
<p>Positive I checked on 2.3 with success, if you see different results report back with your code and I will check.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 10th 2013, 7:32:03 pm">February 10th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the code is very useful,but my problem is i want route from user current location to a static location.<br>how can i make this possible?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2013, 8:06:35 am">May 22nd 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Devyani - ask a new question and I or someone else will provide you the answer, if you add this information to an old question - no one else is going to see it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2013, 8:25:15 am">May 22nd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>sir i did but no one is answering it..and i am stuck at this point</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 22nd 2013, 8:58:34 am">May 22nd 2013</span>
											by <span class='authorname'>devyani p</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
