<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Error occurred calling next on a PLSqliteResultSet. SQLite error: » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Error occurred calling next on a PLSqliteResultSet. SQLite error:</h1>
		</header>
		<section>
			<p>Hi all!<br>I am getting this error in sqlite.</p>
<p>[WARN] Exception in event callback. {<br>    line = 636;<br>    message = &quot;Error occurred calling next on a PLSqliteResultSet. SQLite error: &#39;database is locked&#39; for &#39;INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES(&#39;Diver 1&#39;, &#39;2012&#x2F;05&#x2F;23&#39;, &#39;Multan&#39;, &#39;BZU bumps&#39;, &#39;10.5&#39;, &#39;1&#39;, &#39;100D&#39;, &#39;10.5&#39;, &#39;&#39;)&#39;&quot;;<br>    sourceId = 282491296;<br>    sourceURL = &quot;file:&#x2F;&#x2F;localhost&#x2F;Users&#x2F;shehzad&#x2F;Library&#x2F;Application%20Support&#x2F;iPhone%20Simulator&#x2F;5.0&#x2F;Applications&#x2F;A10F348D-C511-418A-BCF0-B3DD3A8DD3E1&#x2F;DiveManager.app&#x2F;submitScoreView.js&quot;;<br>}</p>
<p>please help to remove this error.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 23rd 2012, 10:49:08 am">May 23rd 2012</span>
				by <span class='authorname'>Abdus Sattar</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>sqlite</span></li>
					
						<li><span class='tagname'>titanium</span></li>
					
						<li><span class='tagname'>titanium studio</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Abdul, </p>
<p>I&#39;m sure you&#39;ll agree, that your question doesn&#39;t gives us much to work with. I strongly suggest you have a look at <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;ask">the guidelines to follow</a> when asking a question.</p>
<p>Also, please include some code detailing what you are trying to achieve. This will give everyone a better understanding of the problem you are facing.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 23rd 2012, 10:55:18 am">May 23rd 2012</span>
								by <span class='authorname'>Christian Brousseau</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ok Ok,<br>this is my code.<br>thanks for remind me Christian!</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span>(lbl_current_diver &gt;= submit_total_divers - <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span>(submit_total_dives &lt;= lbl_current_dive) {
            <span class="hljs-keyword">var</span> notes = textNotes.value;
            <span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'DiveManager_DB.sql'</span>, <span class="hljs-string">'DiveManager'</span>);
            db.execute(<span class="hljs-string">'BEGIN TRANSACTION'</span>);
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + notes + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = db.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            <span class="hljs-comment">//db3.execute('COMMIT TRANSACTION');</span>
            db.close();
            individual_diver_score[lbl_current_diver] = <span class="hljs-built_in">parseInt</span>(individual_diver_score[lbl_current_diver], <span class="hljs-number">10</span>) + <span class="hljs-built_in">parseInt</span>(ali_total_score, <span class="hljs-number">10</span>);
            individual_diver_notes[lbl_current_diver] = individual_diver_notes[lbl_current_diver] + <span class="hljs-string">' '</span> + textNotes.value;
            Titanium.App.Properties.setList(<span class="hljs-string">"diversScore"</span>, individual_diver_score);
            Titanium.App.Properties.setList(<span class="hljs-string">"diversNotes"</span>, individual_diver_notes);
            <span class="hljs-keyword">var</span> windowNext = Ti.UI.createWindow({
                url : <span class="hljs-string">'saveDive.js'</span>,
                _parent : Titanium.UI.currentWindow,
                _winArray : winAry,
                rootWindow : Titanium.UI.currentWindow.rootWindow
            });
            windowNext.orientationModes = [Titanium.UI.PORTRAIT];
            windowNext.open({
                animated : <span class="hljs-literal">true</span>
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> notes = textNotes.value;
            <span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'DiveManager_DB.sql'</span>, <span class="hljs-string">'DiveManager'</span>);
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + notes + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = db.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            db.close();
            lbl_current_dive = <span class="hljs-built_in">parseInt</span>(lbl_current_dive, <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>;
            Titanium.App.Properties.removeProperty(<span class="hljs-string">"current_dive"</span>);
            Titanium.App.Properties.setString(<span class="hljs-string">"current_dive"</span>, lbl_current_dive);
            individual_diver_score[lbl_current_diver] = <span class="hljs-built_in">parseInt</span>(individual_diver_score[lbl_current_diver], <span class="hljs-number">10</span>) + <span class="hljs-built_in">parseInt</span>(ali_total_score, <span class="hljs-number">10</span>);
            Titanium.App.Properties.setList(<span class="hljs-string">"diversScore"</span>, individual_diver_score);
            lbl_current_diver = <span class="hljs-number">0</span>;
            Titanium.App.Properties.removeProperty(<span class="hljs-string">"current_diver"</span>);
            Titanium.App.Properties.setString(<span class="hljs-string">"current_diver"</span>, lbl_current_diver);
            Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
            <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">3</span>) {
                <span class="hljs-keyword">var</span> windowScore = Ti.UI.createWindow({
                    url : <span class="hljs-string">'setupDiveNumber.js'</span>,
                    _parent : Ti.UI.currentWindow._parent._parent._parent,
                    _winArray : winAry,
                    rootWindow : Ti.UI.currentWindow._parent._parent._parent._parent.rootWindow
                });
            }
            Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
            <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">var</span> windowScore = Ti.UI.createWindow({
                    url : <span class="hljs-string">'setupDiveNumber.js'</span>,
                    _parent : Ti.UI.currentWindow._parent._parent._parent._parent,
                    _winArray : winAry,
                    rootWindow : Ti.UI.currentWindow._parent._parent._parent._parent.rootWindow
                });
            }
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

                Ti.UI.currentWindow._parent._parent._parent._parent.open({
                    animated : <span class="hljs-literal">true</span>
                });
                actInd.hide();
                btnSubmit.enabled = <span class="hljs-string">'true'</span>;
                <span class="hljs-comment">//}</span>
            }, <span class="hljs-number">2000</span>);
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
                <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">4</span>) {
                    <span class="hljs-keyword">var</span> awin = winsubmitScoreView._parent._parent._parent;
                    <span class="hljs-keyword">var</span> bwin = winsubmitScoreView._parent._parent;
                    <span class="hljs-keyword">var</span> cwin = winsubmitScoreView._parent;
                    awin.close();
                    bwin.close();
                    cwin.close();
                    winsubmitScoreView.close(winsubmitScoreView);
                }
                Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
                <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">3</span>) {
                    <span class="hljs-keyword">var</span> bwin = winsubmitScoreView._parent;
                    <span class="hljs-keyword">var</span> cwin = winsubmitScoreView._parent;
                    bwin.close();
                    cwin.close();
                    winsubmitScoreView.close(winsubmitScoreView);
                }
            }, <span class="hljs-number">4000</span>);
        }
        actInd.hide();
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> notes = textNotes.value;
        <span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'DiveManager_DB.sql'</span>, <span class="hljs-string">'DiveManager'</span>);
        <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + notes + <span class="hljs-string">"')"</span>;
        <span class="hljs-keyword">var</span> rows = db.execute(x);
        <span class="hljs-comment">//rows.close();</span>
        <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
        db.close();
        individual_diver_score[lbl_current_diver] = <span class="hljs-built_in">parseInt</span>(individual_diver_score[lbl_current_diver], <span class="hljs-number">10</span>) + <span class="hljs-built_in">parseInt</span>(ali_total_score, <span class="hljs-number">10</span>);
        Titanium.App.Properties.setList(<span class="hljs-string">"diversScore"</span>, individual_diver_score);
        lbl_current_diver = <span class="hljs-built_in">parseInt</span>(lbl_current_diver, <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>;
        Titanium.App.Properties.removeProperty(<span class="hljs-string">"current_diver"</span>);
        Titanium.App.Properties.setString(<span class="hljs-string">"current_diver"</span>, lbl_current_diver);
        Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
        <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">3</span>) {
            <span class="hljs-keyword">var</span> windowScore = Ti.UI.createWindow({
                url : <span class="hljs-string">'setupDiveNumber.js'</span>,
                _parent : Ti.UI.currentWindow._parent._parent._parent,
                _winArray : winAry,
                rootWindow : Ti.UI.currentWindow._parent._parent._parent.rootWindow
            });
        }
        Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
        <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">4</span>) {
            <span class="hljs-keyword">var</span> windowScore = Ti.UI.createWindow({
                url : <span class="hljs-string">'setupDiveNumber.js'</span>,
                _parent : Ti.UI.currentWindow._parent._parent._parent._parent,
                _winArray : winAry,
                rootWindow : Ti.UI.currentWindow._parent._parent._parent._parent.rootWindow
            });
        }
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            Ti.UI.currentWindow._parent._parent._parent._parent.open({
                animated : <span class="hljs-literal">true</span>
            });
            actInd.hide();
            btnSubmit.enabled = <span class="hljs-string">'true'</span>;
            <span class="hljs-comment">//}</span>
        }, <span class="hljs-number">2000</span>);
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
            <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">var</span> awin = winsubmitScoreView._parent._parent._parent;
                <span class="hljs-keyword">var</span> bwin = winsubmitScoreView._parent._parent;
                <span class="hljs-keyword">var</span> cwin = winsubmitScoreView._parent;
                awin.close();
                bwin.close();
                cwin.close();
                winsubmitScoreView.close(winsubmitScoreView);
            }
            Ti.API.info(<span class="hljs-string">'screenClose == &gt;'</span> + screenClose + <span class="hljs-string">'&lt;'</span>);
            <span class="hljs-keyword">if</span>(screenClose == <span class="hljs-number">3</span>) {
                <span class="hljs-keyword">var</span> bwin = winsubmitScoreView._parent;
                <span class="hljs-keyword">var</span> cwin = winsubmitScoreView._parent;
                bwin.close();
                cwin.close();
                winsubmitScoreView.close(winsubmitScoreView);
            }             <span class="hljs-comment">//Added 19/07/2011</span>
        }, <span class="hljs-number">4000</span>);
    }<span class="hljs-comment">//Else end</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="May 23rd 2012, 11:06:10 am">May 23rd 2012</span>
								by <span class='authorname'>Abdus Sattar</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>first one is large code I have reduce this is my code</p>
<pre><code class="hljs">    <span class="hljs-keyword">if</span>(lbl_current_diver &gt;= submit_total_divers - 1) {
        <span class="hljs-comment">//alert('Current Dive: '+lbl_current_dive);</span>
        <span class="hljs-comment">//alert('total Dives: '+submit_total_dives);</span>
        <span class="hljs-keyword">if</span>(submit_total_dives &lt;= lbl_current_dive) {
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">notes</span> = textNotes.value;
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.install('DiveManager_DB.sql', 'DiveManager');
            <span class="hljs-keyword">db</span>.execute('BEGIN TRANSACTION');
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + <span class="hljs-keyword">notes</span> + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
            <span class="hljs-comment">//db3.execute('COMMIT TRANSACTION');</span>
            <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
            individual_diver_score[lbl_current_diver] = parseInt(individual_diver_score[lbl_current_diver], 10) + parseInt(ali_total_score, 10);
            individual_diver_notes[lbl_current_diver] = individual_diver_notes[lbl_current_diver] + ' ' + textNotes.value;
            Titanium.<span class="hljs-keyword">App</span>.Properties.setList(<span class="hljs-string">"diversScore"</span>, individual_diver_score);
            Titanium.<span class="hljs-keyword">App</span>.Properties.setList(<span class="hljs-string">"diversNotes"</span>, individual_diver_notes);
            <span class="hljs-keyword">var</span> windowNext = Ti.UI.createWindow({
                url : 'saveDive.js',
                _parent : Titanium.UI.currentWindow,
                _winArray : winAry,
                rootWindow : Titanium.UI.currentWindow.rootWindow
            });
            windowNext.orientationModes = [Titanium.UI.PORTRAIT];
            windowNext.<span class="hljs-keyword">open</span>({
                animated : true
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">notes</span> = textNotes.value;
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.install('DiveManager_DB.sql', 'DiveManager');
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + <span class="hljs-keyword">notes</span> + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
            <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
            lbl_current_dive = parseInt(lbl_current_dive, 10) + 1;
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="May 23rd 2012, 11:08:22 am">May 23rd 2012</span>
								by <span class='authorname'>Abdus Sattar</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>sorry Christian!<br>my code is too large that it can&#39;t be posted.<br>after short listing code, I have posted in comments of the below answer</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 23rd 2012, 11:17:09 am">May 23rd 2012</span>
								by <span class='authorname'>Abdus Sattar</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-239269">
				
						<section>
							<p>hi,</p>
<p><strong>database is locked</strong> means you forgot to close the database after executing query somewhere so fond it first and close that connection before executing  INSERT INTO</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 23rd 2012, 11:04:11 am">May 23rd 2012</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="../../question/137343/error-occurred-calling-next-on-a-plsqliteresultset-sqlite-error.html#answer-239269" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>one more thing you should use <strong>Ti.Database.install</strong> only once in your app.js and then use<br><strong>Ti.Database.open</strong></p>
</p>
										<div class="author">
											&mdash; commented <span title="May 23rd 2012, 11:10:26 am">May 23rd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><pre><code class="hljs">
<span class="hljs-keyword">if</span>(condition1){
<span class="hljs-keyword">var</span> <span class="hljs-keyword">notes</span> = textNotes.value;
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.install('DiveManager_DB.sql', 'DiveManager');
            <span class="hljs-keyword">db</span>.execute('BEGIN TRANSACTION');
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + <span class="hljs-keyword">notes</span> + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
            <span class="hljs-comment">//db3.execute('COMMIT TRANSACTION');</span>
            <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
<span class="hljs-keyword">if</span>(innerCondition_condition1){
<span class="hljs-comment">// An other location I am using this</span>

<span class="hljs-keyword">var</span> <span class="hljs-keyword">notes</span> = textNotes.value;
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.install('DiveManager_DB.sql', 'DiveManager');
            <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + <span class="hljs-keyword">notes</span> + <span class="hljs-string">"')"</span>;
            <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
            <span class="hljs-comment">//rows.close();</span>
            <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
            <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
}<span class="hljs-comment">//inner if</span>
}<span class="hljs-comment">//1st if</span>

<span class="hljs-comment">// An other location I am using this</span>
<span class="hljs-keyword">else</span>{
<span class="hljs-keyword">var</span> <span class="hljs-keyword">notes</span> = textNotes.value;
        <span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.install('DiveManager_DB.sql', 'DiveManager');
        <span class="hljs-keyword">var</span> x = <span class="hljs-string">"INSERT INTO dive_records (diverName, event_date, event_location, event_name, diver_score, event_type, dive_Number, dive_score,  notes) VALUES('"</span> + array_divers[lbl_current_diver] + <span class="hljs-string">"', '"</span> + event_date + <span class="hljs-string">"', '"</span> + event_location + <span class="hljs-string">"', '"</span> + event_name + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + event_type + <span class="hljs-string">"', '"</span> + dive_name_ali + <span class="hljs-string">"', '"</span> + ali_total_score + <span class="hljs-string">"', '"</span> + <span class="hljs-keyword">notes</span> + <span class="hljs-string">"')"</span>;
        <span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
        <span class="hljs-comment">//rows.close();</span>
        <span class="hljs-comment">//alert(array_divers[i]+'    AS     '+individual_diver_score[i]);</span>
        <span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 23rd 2012, 11:14:37 am">May 23rd 2012</span>
											by <span class='authorname'>Abdus Sattar</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>in your app.js </p>
<p>set this line</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> db = Ti.Database.install(<span class="hljs-string">'DiveManager_DB.sql'</span>, <span class="hljs-string">'DiveManager'</span>);
db.<span class="hljs-built_in">close</span>();
</code></pre><p>now you should use</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.<span class="hljs-keyword">open</span>('DiveManager');
<span class="hljs-keyword">db</span>.execute('BEGIN TRANSACTION');
<span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
.
.

<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.<span class="hljs-keyword">open</span>('DiveManager');
<span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
<span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
.
.

<span class="hljs-keyword">var</span> <span class="hljs-keyword">db</span> = Ti.Database.<span class="hljs-keyword">open</span>('DiveManager');
<span class="hljs-keyword">var</span> rows = <span class="hljs-keyword">db</span>.execute(x);
<span class="hljs-keyword">db</span>.<span class="hljs-keyword">close</span>();
.
.
.
.
.
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 23rd 2012, 11:24:13 am">May 23rd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>3</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-239273">
				
						<section>
							<p>I had similar error when I forgot to ROLLBACK when transaction failed.</p>
<pre><code class="hljs"><span class="hljs-keyword">try</span> {
    db.execute(<span class="hljs-string">'BEGIN TRANSACTION'</span>);
    ...
    db.execute(<span class="hljs-string">'COMMIT'</span>);
}
<span class="hljs-keyword">catch</span>(e) {
    db.execute(<span class="hljs-string">'ROLLBACK'</span>);
}
</code></pre><p>… should do the trick.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 23rd 2012, 11:55:55 am">May 23rd 2012</span>
								by <span class='authorname'>Ivan Škugor</span><br>
								<a class="icon-bg icon-link" href="../../question/137343/error-occurred-calling-next-on-a-plsqliteresultset-sqlite-error.html#answer-239273" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-239271">
				
						<section>
							<p>From what I&#39;ve read so far, here&#39;s what I think you should address first:</p>
<ul>
<li>Call the <code>Ti.Database.install</code> function <strong>only once</strong> and reuse this variable for all your file.</li>
<li>The same goes for the <code>Ti.Database.close</code> function. Close the database only when you are completely done with it.</li>
<li>You begin a transaction without committing it. (the line is there, but commented out.)</li>
<li>You have variables that have the same name, this can be problematic. You should give them different names or declare them at the top and reuse them depending on what you want to do.</li>
</ul>
<p>Also and most importantly, your original question mentioned that the error was raised when calling the <code>next</code> function from the resultset. This is nowhere to be found in the code you provided.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 23rd 2012, 11:24:46 am">May 23rd 2012</span>
								by <span class='authorname'>Christian Brousseau</span><br>
								<a class="icon-bg icon-link" href="../../question/137343/error-occurred-calling-next-on-a-plsqliteresultset-sqlite-error.html#answer-239271" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thanks christian!<br>I am trying it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 24th 2012, 3:02:31 am">May 24th 2012</span>
											by <span class='authorname'>Abdus Sattar</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
