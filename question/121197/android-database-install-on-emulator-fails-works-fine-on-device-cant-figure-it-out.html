<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android Database Install on Emulator fails... works fine on device... can&#39;t figure it out » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android Database Install on Emulator fails... works fine on device... can&#39;t figure it out</h1>
		</header>
		<section>
			<p>So I signed up for the indie subscription because I thought it would be easier to debug some issues I am having in my app. Until Studio came out, I was ALWAYS installing on my device and using &#39;Alert&#39; boxes, etc to figure things out. Now I have the latest version of Titanium studio and Appcelerator 1.7.0. When I run the app on my device, it works fine. When I try to run on the emulator, it fails when installing the database. The current code is very simple:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> db_load</span> = Titanium.Database.install(dbPath,table);
</code></pre><p>dbpath is &#39;..&#x2F;pb.db&#39; and the table name is &#39;menu&#39;. Just fails, kicks out of the debugger and I can&#39;t get any further. Again, THIS WORKS PERFECTLY on the device (Samsung Galaxy S, in case you want to know) Is there something about the emulator that needs to be changed to install a database? I&#39;m at a loss.</p>
<p>Thanks,</p>
<p>Ray</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 16th 2011, 9:59:45 pm">June 16th 2011</span>
				by <span class='authorname'>Ray Belisle</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>install</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-210552">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Ray</p>
<p>What is the table argument for?  The APIDocs <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;apidoc&#x2F;mobile&#x2F;latest&#x2F;Titanium.Database.install-method.html">Titanium.Database.install</a> page makes no mention of it .</p>
<p>Try the following command instead, and let me know how you get on:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> db_load</span> = Titanium.Database.install(dbPath);
</code></pre><p>If that does not work, it may be due to the relative path you have passed. Try using an absolute path, relative to the <code>Resources</code> directory, ie <code>&amp;#x2F;mydir&amp;#x2F;pb.db</code>.</p>
<p>For further information, see <a href="http:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Working+with+Local+Data#WorkingwithLocalData-SQLiteDatabases">SQLite Databases</a> in the guides.</p>
<p>Cheers</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 16th 2011, 10:48:01 pm">June 16th 2011</span>
								by <span class='authorname'>Paul Dowsett</span><br>
								<a class="icon-bg icon-link" href="../../question/121197/android-database-install-on-emulator-fails-works-fine-on-device-cant-figure-it-out.html#answer-210552" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Ray</p>
<p>I am aware of the documentation for the install method. However, would you humor me please, Ray, by trying my suggest and reporting back?</p>
<p>Thank you</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 18th 2011, 8:57:10 pm">June 18th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Tried it with just the one argument. Doesn&#39;t work. Not really sure where to go with this one. Works fine on the device, but the whole idea of paying for a subscription was to debug other things. I can&#39;t even get my app loading (first thing is does is connect to DB) Looking at Kitchensink, the code to install the database is:</p>
<p>var db = Titanium.Database.install(&#39;..&#x2F;testdb.db&#39;,&#39;quotes&#39;);</p>
<p>When I open testdb.db, I see no reference to &#39;quotes&#39; so now I&#39;m not even sure what the second arg is supposed to represent?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 1:52:16 am">June 20th 2011</span>
											by <span class='authorname'>Ray Belisle</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ray</p>
<p>As far as I know (and I am NOT an expert!) the &#39;..&#x2F;test.db&#39; refers to the database sqlite file that you want to install on the device. The second parameter &#39;quotes&#39; is the name of the database after you install it.</p>
<p>So you need to use it like this:</p>
<p>install your db - with a table called &#39;table&#39; built in it</p>
<p><code>Titanium.Database.install(&amp;#39;test.db&amp;#39;, &amp;#39;quotes&amp;#39;);</code></p>
<p>then open</p>
<p><code>var db = Ti.Database.open(&amp;#39;quotes&amp;#39;);</code></p>
<p>and access the database tables</p>
<p><code>var result = db.execute(&amp;#39;SELECT * FROM table WHERE foo = ?&amp;#39;, &amp;#39;bar&amp;#39;);</code></p>
<p>&#39;test.db&#39; is then not actually used as it&#39;s only purpose was to create the device database called &#39;quotes&#39;.</p>
<p>Now, I &#39;think&#39; that if you omit the second parameter, you database will get called &#39;test.db&#39; automatically - instead of &#39;quotes&#39;, so then you would open &#39;test.db&#39; instead - (and I believe the install call actually opens it at the same time too). So in that case, you&#39;d not need the &#39;open&#39; line in my example above. Clear as mud?</p>
<p>Well, this is my understanding of it, so if anyone knows better, please feel free to shoot me down ;-)</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 6:50:06 am">June 20th 2011</span>
											by <span class='authorname'>Chris King</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for the info Chris. </p>
<p>I tried with different values for the second arg, still fails when running the &#39;install&#39; code in the debugger. </p>
<p>Any insight, other suggestions are welcome.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 3:53:55 pm">June 20th 2011</span>
											by <span class='authorname'>Ray Belisle</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Only other suggestion is delete the build directory - seems to solve a multitude of unusual issues. I must admit, the way these things deal with databases is a bit odd from my perspective, don&#39;t forget to try it without the second param as per Paul&#39;s comment - then just use the same name for the installed db that you used for the sqlite one (inc any file ext).</p>
<p>When I get a chance, I will try and run my &#39;working&#39; db install on an emulator - only problem is it was built for IOS and I am yet to port it to android (got a bunch of iPad specific things in it)</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 4:01:25 pm">June 20th 2011</span>
											by <span class='authorname'>Chris King</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well… deleted the project and created a new one, added my source code to the new project by copying the resources directory and sub-directories… re-started a couple of times… and it works…. This has GOT TO BE THE MOST FRUSTRATING PART OF USING APPCELERATOR… Never sure if it is something you have done or something the system doesn&#39;t like … and doesn&#39;t get you ANY ability to figure out what <strong><em>might</em></strong> be wrong… Well… works now… didn&#39;t change ANY CODE. Frustrating!</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 22nd 2011, 1:18:35 am">June 22nd 2011</span>
											by <span class='authorname'>Ray Belisle</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I have the same issue. I did the same: created new project rebuild everything: did not resolve the issue.<br>I have logged the call to Titanium.Database.install, observing that this call runs forever, and does NOT RETURN, so the db is not installed, and the app hangs while starting up.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 24th 2011, 8:41:55 am">June 24th 2011</span>
											by <span class='authorname'>Christian Foidl</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210572">
				
						<section>
							<p>Paul - the install function does have two arguments, a path and a name. So I guess Ray is using a variable called table that is passing the name of the database (otherwise it would need to be a string)</p>
<p>Chris</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 17th 2011, 6:52:13 am">June 17th 2011</span>
								by <span class='authorname'>Chris King</span><br>
								<a class="icon-bg icon-link" href="../../question/121197/android-database-install-on-emulator-fails-works-fine-on-device-cant-figure-it-out.html#answer-210572" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This worked for me with the sqlite db stored in the root of Resources dir</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> dbname =<span class="hljs-string">'n2ukDB'</span>;
    <span class="hljs-keyword">var</span> file = Titanium.Filesystem.getFile(Titanium.Filesystem.resourcesDirectory,dbname);

    <span class="hljs-keyword">if</span>(file.exists()) {
        <span class="hljs-keyword">if</span>(    Ti.App.Properties.getString(<span class="hljs-string">'dbinstalled'</span>)!=<span class="hljs-string">'yes'</span>) {
            /// <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> yes, install <span class="hljs-keyword">and</span> flag as yes
            Titanium.Database.install(<span class="hljs-string">'n2ukDB.db'</span>, dbname);
            //send events <span class="hljs-keyword">to</span> the rest <span class="hljs-keyword">of</span> the app
            Ti.App.Properties.setString(<span class="hljs-string">'dbinstalled'</span>,<span class="hljs-string">'yes'</span>);
            Ti.App.fireEvent(<span class="hljs-string">'grantEntrance'</span>);
        }

    };
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="June 17th 2011, 9:26:08 am">June 17th 2011</span>
											by <span class='authorname'>Chris King</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210605">
				
						<section>
							<p>You&#39;re right, it is path&#x2F;name that I am passing (not path&#x2F;table). I have also tried an absolute path, to no avail, though I have not checked to make sure the file existed. I&#39;m going to try putting a file.exists around the database call and make sure I&#39;m referencing the right location for the emulator. Report Back soon…</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 17th 2011, 11:39:24 am">June 17th 2011</span>
								by <span class='authorname'>Ray Belisle</span><br>
								<a class="icon-bg icon-link" href="../../question/121197/android-database-install-on-emulator-fails-works-fine-on-device-cant-figure-it-out.html#answer-210605" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>See comment above…</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 1:49:06 am">June 20th 2011</span>
											by <span class='authorname'>Ray Belisle</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213046">
				
						<section>
							<p>I too am baffled by this. It works on the iphone simulator as well as my android device. But running on the android simulator I always get a &quot;no such table: (tablename). I&#39;ve tried uninstalling and clearing the data from the emulator and still get the same results. It seems to me that the emulator is not installing the database and when Ti.database.open(…) is called to run queries it&#39;s creating a blank db. I think this might be a 1.7 titanium studio issue……?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 13th 2011, 3:39:32 pm">July 13th 2011</span>
								by <span class='authorname'>David Lowe</span><br>
								<a class="icon-bg icon-link" href="../../question/121197/android-database-install-on-emulator-fails-works-fine-on-device-cant-figure-it-out.html#answer-213046" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
