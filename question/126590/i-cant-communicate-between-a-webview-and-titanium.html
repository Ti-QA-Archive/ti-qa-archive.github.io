<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>i can&#39;t communicate between a webview and titanium » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>i can&#39;t communicate between a webview and titanium</h1>
		</header>
		<section>
			<p>hi,</p>
<p>i had read a lot about communication between a webview and the titanium-api but it don&#39;t wanna work. if i set a eventlistener in the app.js and call fireevent inside a webview i get nothing on my androidphone and in the emulator the app is restarting.</p>
<p>if i try the other way i found and declare a function in app.js like:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> testfunc = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    alert(<span class="hljs-string">"testfunc"</span>);
}

<span class="hljs-comment">// window</span>
<span class="hljs-keyword">var</span> win1 = Titanium.UI.createWindow({
    title:<span class="hljs-string">'kathiwork'</span>,
    backgroundColor:<span class="hljs-string">'#000'</span>

});

<span class="hljs-keyword">var</span> wv = Titanium.UI.createWebView({url:<span class="hljs-string">'kathiwork.html'</span>});
wv.testfunc = testfunc();
win1.add(wv);
</code></pre><p>and call the function in the html like this:</p>
<pre><code class="hljs">...
<span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="undefined">
Titanium.UI.currentWindow.testfunc;
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
...
</code></pre><p>nothing happend in the emulator or at the phone and in the &quot;console&quot; of titanium i get a message like &quot;E&#x2F;Web Console( 1256): TypeError: Result of expression &#39;Titanium.UI&#39; [undefined] is not an object. at file:&#x2F;&#x2F;&#x2F;android_asset&#x2F;Reso….&quot;</p>
<p>the youngest post i found that booth of this ways works is 5 months old. so, what is happend?? is there actually no way to communicate between a webview and the api or is my phone and my emulator sick?</p>
<p>please give me a hint &#39;cuz i&#39;m really at the end of my knowledge</p>
<p>thx<br>damien</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 8th 2011, 9:28:27 am">October 8th 2011</span>
				by <span class='authorname'>damien hoo</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>api</span></li>
					
						<li><span class='tagname'>eventlistener</span></li>
					
						<li><span class='tagname'>events</span></li>
					
						<li><span class='tagname'>javascript</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-220535">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I think you can&#39;t do that, you need to use app-level events (Ti.App.addEventListener &amp; Ti.App.fireEvent).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 8th 2011, 10:30:07 am">October 8th 2011</span>
								by <span class='authorname'>Ivan Škugor</span><br>
								<a class="icon-bg icon-link" href="question/126590/i-cant-communicate-between-a-webview-and-titanium#answer-220535" rel="permalink">permalink</a>
							</div>

							<h5>9 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>this is what i explained in the first part of my question. that don&#39;t work… if i do that, the app on my phone do nothing and the app in the emulator restart (and i get a huge errormessage on the titanium console)</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 10:33:19 am">October 8th 2011</span>
											by <span class='authorname'>damien hoo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>They should work. Can you provide some code in which you use app-level events so we can see what&#39;s wrong?</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 10:52:23 am">October 8th 2011</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>in app.js</p>
<pre><code class="hljs">Ti.App.addEventListener(<span class="hljs-string">"testEv"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    alert(<span class="hljs-string">"called event"</span>);
});
</code></pre><p>in the html-file, loaded in the webview:</p>
<pre><code class="hljs">...
<span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="actionscript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyEvent</span><span class="hljs-params">()</span> </span>{
    Ti.App.fireEvent(<span class="hljs-string">"testEv"</span>,<span class="hljs-string">"somedata"</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"#"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"MyEvent();"</span>&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>

...
</code></pre><p>if i click on the link, the app in the emulator is restarting and on the android-phone nothing happened.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 11:19:36 am">October 8th 2011</span>
											by <span class='authorname'>damien hoo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Try to change href=&quot;#&quot; onclick=&quot;MyEvent();&quot; to href=&quot;javascript:MyEvent();&quot;</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 11:22:28 am">October 8th 2011</span>
											by <span class='authorname'>Ivan Mathy</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Damien - you should post example that can run without any modification. Here is one that works on Android 2.2, TiSDK 1.7.3:</p>
<pre><code class="hljs">var html = '<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyEvent</span><span class="hljs-params">()</span> </span>{Ti.App.fireEvent(<span class="hljs-string">"testEv"</span>);}</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"#"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"MyEvent();"</span>&gt;</span>click me<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>';

Ti.App.addEventListener("testEv", function(e) {
    Ti.alert("called event");
});

var wv = Ti.UI.createWebView({
    html: html
});

var win = Ti.UI.createWindow({
    modal: true
});

win.add(wv);

win.open();
</code></pre><p>@Ivan - using &quot;javascript&quot; pseudo-protocol for calling JS function is a bad practice and it has some side effects in some browser engines. People use it often because they don&#39;t know how to prevent redirect (because they use &quot;a&quot; tag for something it is not intended to be used for). Anyway, JS function can be called via &quot;onclick&quot; attribute of &quot;a&quot; element, if redirect needs to be prevented, &quot;false&quot; has to be returned (there is one more way of preventing click event), so: onclick = &quot;MyEvent(); return false;&quot;<br>In this case it is not necessary because there is no redirect (&quot;#&quot; stays on the same page).</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 11:52:39 am">October 8th 2011</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i think i wanna drive crazy !!!!</p>
<p>it don&#39;t work… not in my app and not in a new blank project….</p>
<p>it always do nothing on the phone and restart the app in the emulator.<br>a part of the errormsg are:</p>
<p>W&#x2F;dalvikvm(  400): JNI WARNING: jarray 0x4057d2c8 points to non-array object (Ljava&#x2F;lang&#x2F;String;)</p>
<p>I&#x2F;dalvikvm(  400): &quot;WebViewCoreThread&quot; prio=5 tid=15 NATIVE</p>
<p>I&#x2F;dalvikvm(  400):   | group=&quot;main&quot; sCount=0 dsCount=0 obj=0x40512188 self=0x1fde68</p>
<p>I&#x2F;dalvikvm(  400):   | sysTid=415 nice=0 sched=0&#x2F;0 cgrp=default handle=2163552</p>
<p>I&#x2F;dalvikvm(  400):   | schedstat=( 763764745 1046467739 104 )</p>
<p>I&#x2F;dalvikvm(  400):   at android.webkit.WebViewCore.nativeTouchUp(Native Method)</p>
<p>I&#x2F;dalvikvm(  400):   at android.webkit.WebViewCore.nativeTouchUp(Native Method)</p>
<p>I&#x2F;dalvikvm(  400):   at android.webkit.WebViewCore.access$3300(WebViewCore.java:53)</p>
<p>I&#x2F;dalvikvm(  400):   at android.webkit.WebViewCore$EventHub$1.handleMessage(WebViewCore.java:1158)</p>
<p>I&#x2F;dalvikvm(  400):   at android.os.Handler.dispatchMessage(Handler.java:99)</p>
<p>I&#x2F;dalvikvm(  400):   at android.os.Looper.loop(Looper.java:123)</p>
<p>I&#x2F;dalvikvm(  400):   at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:629)</p>
<p>I&#x2F;dalvikvm(  400):   at java.lang.Thread.run(Thread.java:1019)</p>
<p>I&#x2F;dalvikvm(  400): </p>
<p>E&#x2F;dalvikvm(  400): VM aborting</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 12:17:56 pm">October 8th 2011</span>
											by <span class='authorname'>damien hoo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Okay, most probably the problem is that you left second argument in &quot;fireEvent&quot; method. I forgot to mention, argument passed to the &quot;fireEvent&quot; method has to be an object (you passed a string).</p>
<p>So …</p>
<pre><code class="hljs"><span class="hljs-tag">Ti</span><span class="hljs-class">.App</span><span class="hljs-class">.fireEvent</span>("<span class="hljs-tag">testEv</span>",<span class="hljs-rules">{ <span class="hljs-rule"><span class="hljs-attribute">data</span>:<span class="hljs-value"> <span class="hljs-string">"somedata"</span> </span></span></span>});
</code></pre><p>Unfortunately, Titanium is not robust as it should be and from error message description it is hard to tell what has caused the exception and what part of JS source code did cause that exception (especially if you don&#39;t have much experience and knowledge). Something they will have to work on, IMHO. :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 12:38:00 pm">October 8th 2011</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>wow, what a stupid failure from me…</p>
<p>so now, it works on the phone and thats all what i want.</p>
<p>thx a lot</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 1:12:50 pm">October 8th 2011</span>
											by <span class='authorname'>damien hoo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Cool. :)</p>
<p>It&#39;s good practice to mark answer as the best answer so others can easily find it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 8th 2011, 1:16:36 pm">October 8th 2011</span>
											by <span class='authorname'>Ivan Škugor</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234795">
				
						<section>
							<p>As the following articles, I have the same problems:</p>
<p><a href="https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Communication+Between+WebViews+and+Titanium">Communication Between WebViews and Titanium</a></p>
<p>I found that it <strong>Worked Well</strong> in a <strong>Real Mobile-Phone</strong>(<strong>Not Emulator</strong>).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 30th 2012, 3:10:26 am">March 30th 2012</span>
								by <span class='authorname'>li xinxin</span><br>
								<a class="icon-bg icon-link" href="question/126590/i-cant-communicate-between-a-webview-and-titanium#answer-234795" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
