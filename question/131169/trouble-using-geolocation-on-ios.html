<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Trouble using GeoLocation on iOS Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Trouble using GeoLocation on iOS</h1>
		</header>
		<section>
			<p>Hi there,</p>
<p>I&#39;m trying to get the location of an app user to parse into a HTTP request to populate a table.</p>
<p>It works fine by inputting static lon&#x2F;lat data, but trying to add dynamic locations based on the e.coords I get errors saying variable can&#39;t be found.</p>
<p>&quot;Can&#39;t find variable: latitude at gigs.js (line 9)&quot;</p>
<p>Anyone have any suggestions, it&#39;s bound to be a stupid error on my part!</p>
<p>Code below (ignore any reference to Tweets in there, it&#39;s lifted from another js file i&#39;m working on):</p>
<p><a href="http:&#x2F;&#x2F;pastie.org&#x2F;3250506">http:&#x2F;&#x2F;pastie.org&#x2F;3250506
</a></p>
<p>Many thanks</p>
<p>Simon</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 25th 2012, 1:56:07 pm">January 25th 2012</span>
				by <span class='authorname'>Simon Hume</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>error</span></li>
					
						<li><span class='tagname'>geolocation</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>YOu are defining your vars inside a function, you&#39;re losing those after you exit from there. Define them outside the function.</p>
<p>Best,</p>
<p>M</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 2:05:45 pm">January 25th 2012</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Mauro,</p>
<p>Are you talking about these vars?</p>
<pre><code class="hljs">        <span class="hljs-variable"><span class="hljs-keyword">var</span> longitude</span> = e.coords.longitude;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> latitude</span> = e.coords.latitude;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> altitude</span> = e.coords.altitude;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> heading</span> = e.coords.heading;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> accuracy</span> = e.coords.accuracy;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> speed</span> = e.coords.speed;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> timestamp</span> = e.coords.timestamp;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> altitudeAccuracy</span> = e.coords.altitudeAccuracy;
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 2:35:24 pm">January 25th 2012</span>
								by <span class='authorname'>Simon Hume</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Yes, we both are talking about that variables.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 2:36:24 pm">January 25th 2012</span>
								by <span class='authorname'>Yogin Bhungalia</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>OK, I moved those out of the variable and dropped them underneath, but it still won&#39;t recognise them.</p>
<p>What should I be putting in here to pick them up?</p>
<pre><code class="hljs">loader.open(<span class="hljs-string">"<span class="hljs-keyword">GET</span>"</span>, <span class="hljs-string">"http://www.myurl.com/json.php?lat="</span> + latitude + <span class="hljs-string">"&amp;lng="</span> + longitude + <span class="hljs-string">"&amp;radius=25"</span>);
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 2:38:47 pm">January 25th 2012</span>
								by <span class='authorname'>Simon Hume</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-228519">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I am not sure but this may help. you have defined your latitude variable in another function and you are using it in another function. So the other function may not able to find your latitude variable. It should be in global scope of that JS so that it can be accessed in all functions. </p>
<p>But I am not sure Why it showing line number 9 as you have not used that variable on line number 9.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 25th 2012, 2:06:06 pm">January 25th 2012</span>
								by <span class='authorname'>Yogin Bhungalia</span><br>
								<a class="icon-bg icon-link" href="../../question/131169/trouble-using-geolocation-on-ios.html#answer-228519" rel="permalink">permalink</a>
							</div>

							<h5>13 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Trying to move these vars around, outside of the other variable but still get the error.</p>
<p>Really frustrating!</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:36:23 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>But what I am not understanding is there is no code regarding latitude variable on 9th line than how it&#39;s showing error on 9th line ?</p>
<p>Is it still showing error on that same line ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:38:23 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>it&#39;s line 6 now!</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:39:38 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i get this instead of referring to &quot;latitude&quot;</p>
<p>&quot;Can&#39;t find variable: e at gigs.js (line 6)&quot;</p>
<p>i&#39;ve moved the code around like this</p>
<pre><code class="hljs">Titanium.Geolocation.getCurrentPosition(function(<span class="hljs-keyword">e</span>)
    {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">e</span>.success || <span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>)
        {
            currentLocation.text = '<span class="hljs-keyword">error</span>: ' + JSON.stringify(<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>);
            Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(<span class="hljs-keyword">e</span>.code));
            alert('<span class="hljs-keyword">error</span> ' + JSON.stringify(<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>));
            <span class="hljs-keyword">return</span>;
        }


    });

    <span class="hljs-keyword">var</span> longitude = <span class="hljs-keyword">e</span>.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = <span class="hljs-keyword">e</span>.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = <span class="hljs-keyword">e</span>.coords.altitude;
    <span class="hljs-keyword">var</span> heading = <span class="hljs-keyword">e</span>.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = <span class="hljs-keyword">e</span>.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = <span class="hljs-keyword">e</span>.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = <span class="hljs-keyword">e</span>.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = <span class="hljs-keyword">e</span>.coords.altitudeAccuracy;
</code></pre><p>Is that the correct placement for those vars?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:44:23 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>No. You just have to declare that variable out side of that function. You have to fill that inside getCurrrentLoaction only</p>
<p>Because e is part of getCurrentPosition function. It will not be visible out side of that function</p>
<p>see, like this,</p>
<pre><code class="hljs">    <span class="hljs-keyword">var</span> longitude ;
    <span class="hljs-keyword">var</span> latitude;
    <span class="hljs-keyword">var</span> altitude;
    <span class="hljs-keyword">var</span> heading;


Titanium.Geolocation.getCurrentPosition(function(<span class="hljs-keyword">e</span>)
    {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">e</span>.success || <span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>)
        {
            currentLocation.text = '<span class="hljs-keyword">error</span>: ' + JSON.stringify(<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>);
            Ti.API.info(<span class="hljs-string">"Code translation: "</span>+translateErrorCode(<span class="hljs-keyword">e</span>.code));
            alert('<span class="hljs-keyword">error</span> ' + JSON.stringify(<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>));
            <span class="hljs-keyword">return</span>;
        }

    longitude = <span class="hljs-keyword">e</span>.coords.longitude;
        latitude = <span class="hljs-keyword">e</span>.coords.latitude;
        altitude = <span class="hljs-keyword">e</span>.coords.altitude;

    });
</code></pre><p>Do this for all variables.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:48:44 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>And try to print that variables in console after filling that variables in getCurrentPosition() funciton and check whether you are getting some useful data or not.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 2:50:03 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK, that works now! </p>
<p>Though the actual readings are coming back as 0 for both latitude and longitude so i&#39;m going to have to try and work out why that&#39;s happening!</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:00:26 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think that may be the issue with simulator. You will not get coordinated on simulator. You can try this on device so that you can get original coordinates.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:02:19 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You can select the answer if you prob is solved :P</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:02:48 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i&#39;m on the device, i&#39;m not using the simulator for this test, for that reason</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:03:07 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ooops. Sorry than. I have no clue why it is returning 0.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:04:36 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for the help so far though, it&#39;s a big advance on where i was an hour ago.</p>
<p>It&#39;s been a long day!</p>
<p>:)</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:05:33 pm">January 25th 2012</span>
											by <span class='authorname'>Simon Hume</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>haha :) you welcome.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2012, 3:08:41 pm">January 25th 2012</span>
											by <span class='authorname'>Yogin Bhungalia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
