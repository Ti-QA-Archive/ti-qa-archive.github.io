<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Reset/Reload the App? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Reset/Reload the App?</h1>
		</header>
		<section>
			<p>I&#39;ve fiddled with the plist in order to stop my app reloading from the same place when you exit and open the app again.. which is great!</p>
<p>What I&#39;m dealing with now is the ability to restart all content of the app as it does when it first loads up.<br>The way I&#39;m trying is by resetting all the variables etc… but its proving a pain. </p>
<p>Is there an easier way to refresh&#x2F;restart everything without exiting the app and starting again?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 18th 2011, 9:38:13 am">August 18th 2011</span>
				by <span class='authorname'>Sam GRosset</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>exit</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>refresh</span></li>
					
						<li><span class='tagname'>restart</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-216804">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>No, resetting the values to your variables is the only way. Perhaps if you give us some idea to your code structure, we could give you some ideas as to how to better structure your code to make this easier…</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 18th 2011, 9:46:06 am">August 18th 2011</span>
								by <span class='authorname'>Matt Apperson</span><br>
								<a class="icon-bg icon-link" href="question/124434/resetreload-the-app#answer-216804" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I see! Thanks for the answer.</p>
<p>I think I&#39;ve got all the variables reset aside from the ones that control my stopwatch style timer. This code was given to me by another member on here, so I&#39;m a little unsure how to &#39;reset&#39; the time back to 00:00 really. I did try minutes = 0 and seconds = 0 but no luck.</p>
<pre><code class="hljs"><span class="hljs-comment">//test timer</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">niceTimeFromMilliseconds</span>(<span class="hljs-params">ms</span>)
</span>{
    <span class="hljs-keyword">var</span> total_seconds = ms / <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">var</span> minutes = <span class="hljs-built_in">Math</span>.floor(total_seconds / <span class="hljs-number">60</span>);
    <span class="hljs-keyword">var</span> seconds = total_seconds - (minutes * <span class="hljs-number">60</span>);

    <span class="hljs-keyword">if</span> (minutes &lt; <span class="hljs-number">10</span>) {
        minutes = <span class="hljs-string">"0"</span> + minutes;
    }
    <span class="hljs-keyword">if</span> (seconds &lt; <span class="hljs-number">10</span>) {
        seconds = <span class="hljs-string">"0"</span> + seconds;

    }

    <span class="hljs-keyword">return</span>  minutes + <span class="hljs-string">":"</span> + seconds;
}

<span class="hljs-comment">//root window</span>

<span class="hljs-keyword">var</span> start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
<span class="hljs-keyword">var</span> timerlabel = Ti.UI.createLabel({
    top: <span class="hljs-number">0</span>,
    left: <span class="hljs-number">0</span>,
    width: <span class="hljs-number">100</span>,
    height: <span class="hljs-number">30</span>,
    text: <span class="hljs-string">"00:00"</span>
});

<span class="hljs-keyword">var</span> timer = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> newTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
    timerlabel.text = niceTimeFromMilliseconds(newTime - start);
}, <span class="hljs-number">1000</span>);

win1.add(timerlabel);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 18th 2011, 11:17:35 am">August 18th 2011</span>
											by <span class='authorname'>Sam GRosset</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>like this:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> button = Ti.UI.createButton({
    height:<span class="hljs-number">30</span>,
    width:<span class="hljs-number">70</span>,
    backgroundColor: <span class="hljs-string">'red'</span>,
    title:<span class="hljs-string">'Reset'</span>
});
win1.add(button);

button.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
    timerlabel.text = <span class="hljs-string">"00:00"</span>;
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="August 18th 2011, 11:24:44 am">August 18th 2011</span>
											by <span class='authorname'>Matt Apperson</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-216829">
				
						<section>
							<p>Cool! That resets the timer for a second to 00:00, then flips back to the value that it was before, like 00:18. </p>
<p>There must be a variable being saved somewhere that im being a noob and missing.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 18th 2011, 11:35:19 am">August 18th 2011</span>
								by <span class='authorname'>Sam GRosset</span><br>
								<a class="icon-bg icon-link" href="question/124434/resetreload-the-app#answer-216829" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-216833">
				
						<section>
							<p>After making a new app I realised the above code does work on its own. So it must be something else in my code that&#39;s making the numbers switch back to what they were before…. </p>
<p>I hope my comments make sense here.</p>
<pre><code class="hljs"><span class="hljs-comment">//function to stop any sounds in the app playing</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">silence</span>(<span class="hljs-params"></span>) </span>{
    intro.stop();
    custno.stop();
    pin1.stop();
    pin3.stop();

}



<span class="hljs-comment">//variable for checking if we need to copy the textfield</span>
<span class="hljs-keyword">var</span> copy = <span class="hljs-number">1</span>;

<span class="hljs-comment">//Event listeners to check value changes </span>
tf1.addEventListener(<span class="hljs-string">'change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{


    <span class="hljs-comment">//check if we need to display the label value as textfield yet </span>
    <span class="hljs-keyword">if</span> (copy = <span class="hljs-number">2</span>){
    fieldlabel.text = tf1.value;
    }

      <span class="hljs-comment">//what numbers are in the textfield? if so, play the appropriate soundclip</span>
      <span class="hljs-keyword">if</span>(e.value == <span class="hljs-string">''</span>) {
          beep.play();
          intro.play();
          my_timer.start();  
      }

      <span class="hljs-keyword">if</span>(e.value == <span class="hljs-number">1</span>) {
          silence();
          beep.play();
          custno.play();
          <span class="hljs-comment">//we want to now make the label copy whats in the textfield</span>
          copy = <span class="hljs-number">2</span>;
      }

      <span class="hljs-keyword">if</span>(e.value == <span class="hljs-number">16</span>) {
         silence();
          beep.play();
          pin1.play();
      }

      <span class="hljs-keyword">if</span>(e.value == <span class="hljs-number">165</span>) {
          silence();
          beep.play();
          pin3.play();
      }

      <span class="hljs-keyword">if</span>(e.value == <span class="hljs-number">1657</span>) {
          silence();
          beep.play();
         }
   });






<span class="hljs-comment">//timer </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startcounting</span>(<span class="hljs-params"></span>)</span>{

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">niceTimeFromMilliseconds</span>(<span class="hljs-params">ms</span>)
        </span>{
            <span class="hljs-keyword">var</span> total_seconds = <span class="hljs-built_in">Math</span>.round(ms / <span class="hljs-number">1000</span>);
            <span class="hljs-keyword">var</span> minutes = <span class="hljs-built_in">Math</span>.floor(total_seconds / <span class="hljs-number">60</span>);
            <span class="hljs-keyword">var</span> seconds = total_seconds - (minutes * <span class="hljs-number">60</span>);

            <span class="hljs-keyword">if</span> (minutes &lt; <span class="hljs-number">10</span>) {
                minutes = <span class="hljs-string">"0"</span> + minutes;
            }
            <span class="hljs-keyword">if</span> (seconds &lt; <span class="hljs-number">10</span>) {
                seconds = <span class="hljs-string">"0"</span> + seconds;

            }

            <span class="hljs-keyword">return</span>  minutes + <span class="hljs-string">":"</span> + seconds;
        }

        <span class="hljs-comment">//root window</span>
        <span class="hljs-keyword">var</span> start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
        timerlabel.show();


        <span class="hljs-keyword">var</span> timer = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> newTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
            timerlabel.text = niceTimeFromMilliseconds(newTime - start);
        }, <span class="hljs-number">1000</span>);

}



<span class="hljs-comment">// set the timer</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTimer</span>(<span class="hljs-params">timetowait,context</span>) </span>{

        mt=<span class="hljs-number">0</span>;
        mtimer = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

                mt++;
        Ti.API.info(mt);

            <span class="hljs-keyword">if</span>(mt==timetowait) {
                <span class="hljs-comment">// start the stopwatch</span>
                startcounting();
                <span class="hljs-comment">//hide the label 'calling...'</span>
             calling.hide();
             clearInterval(mtimer);
              Ti.App.fireEvent(context);
        }
},<span class="hljs-number">1000</span>);
};    



<span class="hljs-comment">//event listener for the stopwatch</span>
begin.addEventListener(<span class="hljs-string">"stopwatchstart"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-comment">//start counting</span>
    startcounting();
    <span class="hljs-comment">//hide the label 'calling...'</span>
    calling.hide();

});


<span class="hljs-comment">//event listener for the start button</span>
begin.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ 
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
</span>{ 
        <span class="hljs-comment">//focus on the textfield</span>
        tf1.focus();
        <span class="hljs-comment">//start the intro soundclip</span>
        intro.play();
         <span class="hljs-comment">//display the label 'calling...'</span>
        calling.show();
        <span class="hljs-comment">//set the timer for 10 seconds </span>
         setTimer(<span class="hljs-number">10</span>, <span class="hljs-string">'stopwatchstart'</span>);
    },<span class="hljs-number">500</span>);
});





<span class="hljs-comment">//reset button</span>

<span class="hljs-keyword">var</span> button = Ti.UI.createButton({
    height:<span class="hljs-number">30</span>,
    width:<span class="hljs-number">70</span>,
    backgroundColor: <span class="hljs-string">'red'</span>,
    title:<span class="hljs-string">'Reset'</span>
});
win1.add(button);

button.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    start = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();
    timerlabel.text = <span class="hljs-string">"00:00"</span>;
});




<span class="hljs-comment">//open the window</span>
win1.open();
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 18th 2011, 11:56:58 am">August 18th 2011</span>
								by <span class='authorname'>Sam GRosset</span><br>
								<a class="icon-bg icon-link" href="question/124434/resetreload-the-app#answer-216833" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>The issue is that your start variable is within your startcounting method… remember in JS, functions can see vars outside them, but those outside can not see in.</p>
<p>set <code>var start = 0</code> at the top of your file, then where you have <code>var start = new Date().getTime();</code> change it to <code>start = new Date().getTime();</code></p>
</p>
										<div class="author">
											&mdash; commented <span title="August 18th 2011, 12:02:59 pm">August 18th 2011</span>
											by <span class='authorname'>Matt Apperson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ah, I&#39;ve only been using JS for a few days. Thanks for your help!</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 18th 2011, 12:08:56 pm">August 18th 2011</span>
											by <span class='authorname'>Sam GRosset</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
