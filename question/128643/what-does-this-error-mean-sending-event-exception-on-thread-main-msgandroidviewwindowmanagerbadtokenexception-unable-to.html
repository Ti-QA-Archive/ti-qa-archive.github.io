<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>What does this error mean?? Sending event: exception on thread: main msg:android.view.WindowManager$BadTokenException: Unable to » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>What does this error mean?? Sending event: exception on thread: main msg:android.view.WindowManager$BadTokenException: Unable to</h1>
		</header>
		<section>
			<p>I am creating a global instance of a mapview and using it in 2 different places. The problem im having is I open the first page, touch the mapview everything is ok. go back then to the second page touch the mapview and it blows up with :</p>
<pre><code class="hljs"><span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>): (main) [<span class="hljs-number">704</span>,<span class="hljs-number">880725</span>] Sending event: exception on thread: main msg:android.view.WindowManager$BadTokenException: Unable to add window -- token android.view.ViewRoot$W@<span class="hljs-number">4064</span>db80 is not valid; is your activity running?; Titanium <span class="hljs-number">1.7</span><span class="hljs-number">.5</span>,<span class="hljs-number">2011</span>/<span class="hljs-number">11</span>/<span class="hljs-number">02</span> <span class="hljs-number">17</span>:<span class="hljs-number">00</span>,ab20af7
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>): android.view.WindowManager$BadTokenException: Unable to add window -- token android.view.ViewRoot$W@<span class="hljs-number">4064</span>db80 is not valid; is your activity running?
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.view.ViewRoot.setView(ViewRoot.java:<span class="hljs-number">562</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="hljs-number">177</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:<span class="hljs-number">91</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.view.Window$LocalWindowManager.addView(Window.java:<span class="hljs-number">433</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.widget.ZoomButtonsController.setVisible(ZoomButtonsController.java:<span class="hljs-number">370</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at com.google.android.maps.MapView.displayZoomControls(MapView.java:<span class="hljs-number">1053</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at com.google.android.maps.MapView$<span class="hljs-number">1.</span>onDown(MapView.java:<span class="hljs-number">341</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at com.google.android.maps.GestureDetector.onTouchEvent(GestureDetector.java:<span class="hljs-number">488</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at com.google.android.maps.MapView.onTouchEvent(MapView.java:<span class="hljs-number">683</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at android.view.View.dispatchTouchEvent(View.java:<span class="hljs-number">3932</span>)
<span class="hljs-number">11</span>-<span class="hljs-number">23</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">17.850</span>: ERROR/TiUncaughtHandler(<span class="hljs-number">26866</span>):     at
</code></pre><p>Here&#39;s a simplified version of my project:<br>app.js</p>
<pre><code class="hljs">LT.AndroidMapview = Ti.Map.createView({
        <span class="hljs-string">mapType :</span> Ti.Map.STANDARD_TYPE,
        <span class="hljs-string">animate :</span> <span class="hljs-literal">true</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">height :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">regionFit :</span> <span class="hljs-literal">true</span>
    });
</code></pre><p>Page 1</p>
<pre><code class="hljs">holderMapView.<span class="hljs-keyword">add</span>(LT.AndroidMapview);
win.<span class="hljs-keyword">add</span>(holderMapView);

<span class="hljs-comment">//remove from view when closing window</span>
win.addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>
    <span class="hljs-comment">{
    holderMapView.remove(LT.AndroidMapview);
    }</span>);</span>
</code></pre><p>Page 2</p>
<pre><code class="hljs">holderMapView2.<span class="hljs-keyword">add</span>(LT.AndroidMapview);
win.<span class="hljs-keyword">add</span>(holderMapView2);

<span class="hljs-comment">//remove from view when closing window</span>
win.addEventListener(<span class="hljs-string">'close'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>
    <span class="hljs-comment">{
    holderMapView2.remove(LT.AndroidMapview);
    }</span>);</span>
</code></pre><p>Any help is much appreciated!</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 23rd 2011, 7:17:45 pm">November 23rd 2011</span>
				by <span class='authorname'>Andrew Royce</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>blowup</span></li>
					
						<li><span class='tagname'>click</span></li>
					
						<li><span class='tagname'>global</span></li>
					
						<li><span class='tagname'>mapview</span></li>
					
				</ul>
			

			<section>
				<h5>7 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>are the pages different tabs? We need more information and and working example to try and duplicate your error… in a pastie or gist please</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 7:20:42 pm">November 23rd 2011</span>
								by <span class='authorname'>Aaron Saunders</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>No, they are includes.I will upload a zip with a sample project in a few minutes. I am running on htc thunderbolt, sdk 1.7.5, studio 1.0.6.201110251616, and running windows 7.</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 7:31:39 pm">November 23rd 2011</span>
								by <span class='authorname'>Andrew Royce</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Recreated a simple app that has the same issue. thanks for the help!<br><a href="http:&#x2F;&#x2F;dl.dropbox.com&#x2F;u&#x2F;224773&#x2F;sample.zip">Sample app</a></p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 7:44:21 pm">November 23rd 2011</span>
								by <span class='authorname'>Andrew Royce</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Make sure to touch&#x2F;pan the first map, when touch&#x2F;pan the second map it will blow up.</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 7:45:28 pm">November 23rd 2011</span>
								by <span class='authorname'>Andrew Royce</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>this works… <a href="https:&#x2F;&#x2F;gist.github.com&#x2F;1390068">https:&#x2F;&#x2F;gist.github.com&#x2F;1390068</a> let me look at your code</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 8:06:17 pm">November 23rd 2011</span>
								by <span class='authorname'>Aaron Saunders</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Aaron, thanks for the example. Unfortunately my app doesn&#39;t use tabs and is quite more complex. Please take a look at the project i uploaded and let me know. Its possible on doing something wrong but it seems to me a normal thing to want to use map view like i do in the project</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 24th 2011, 2:26:02 am">November 24th 2011</span>
								by <span class='authorname'>Andrew Royce</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>dont remove the mapView from the window, just close the window… I believe the remove call is trashing the mapView.</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 25th 2011, 5:14:15 am">November 25th 2011</span>
								by <span class='authorname'>Aaron Saunders</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-224271">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>sorry added to comments, should have been answer… I have this working fine using your project.</p>
<p>the fix was to not call <code>remove</code> on the mapObject</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 25th 2011, 3:12:41 pm">November 25th 2011</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/128643/what-does-this-error-mean-sending-event-exception-on-thread-main-msgandroidviewwindowmanagerbadtokenexception-unable-to#answer-224271" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Aaron, thanks alot, that was the issue. I find it interesting that in the first example (your code) you are supposed to call the .remove method but in my instance it was that exact method that was causing the issue. Either way thanks again!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 25th 2011, 9:08:01 pm">November 25th 2011</span>
											by <span class='authorname'>Andrew Royce</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
