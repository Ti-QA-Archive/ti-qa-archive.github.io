<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Deleting multiple rows from a table with one click Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Deleting multiple rows from a table with one click</h1>
		</header>
		<section>
			<p>I have a table and I am trying to iterate through the rows and delete certain rows. The end result is to collapse a group of rows. So all the rows that have a property called expandable and I use that as a way to delete the rows in between the rows with the collapsible vale of 1. My problem is that rows are being deleted from outside the area where they should be deleted. I have created some example code below that recreates the issue. If you run the code and click on the image on the left in the top row two of the three rows below the top row are deleted and also one row from the middle section of rows. If you then click on the second image from the top the row with the third image is deleted along with some other rows that should be deleted.</p>
<p>What I was shooting for was to click on the image and have the rows below the image deleted down to the next image.  Any help is appreciated.</p>
<pre><code class="hljs"><span class="hljs-comment">//FirstView Component Constructor</span>
function FirstView() {
    <span class="hljs-comment">//create object instance, a parasitic subclass of Observable</span>
    var self = Ti.UI.createView({
<span class="hljs-label">        backgroundColor:</span><span class="hljs-string">'#222222'</span>
    });

var tableData = [];

var i = <span class="hljs-number">0</span>;

var row1 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">1</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

imgCollapse = Ti.UI.createImageView({
<span class="hljs-label">    left:</span><span class="hljs-number">5</span>,<span class="hljs-string">width:</span><span class="hljs-number">40</span>,<span class="hljs-string">height:</span><span class="hljs-number">40</span>,<span class="hljs-string">image:</span><span class="hljs-string">'iconCollapse.png'</span>,<span class="hljs-string">myImage:</span><span class="hljs-string">'collapse'</span>,<span class="hljs-string">id:</span><span class="hljs-string">'image'</span>
});

row1.add(imgCollapse);        
tableData.push(row1); 

var row21 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});
tableData.push(row21);  

var row22 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

tableData.push(row22); 

var row23 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});
tableData.push(row23); 

var row3 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">1</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

imgCollapse = Ti.UI.createImageView({
<span class="hljs-label">    left:</span><span class="hljs-number">5</span>,<span class="hljs-string">width:</span><span class="hljs-number">40</span>,<span class="hljs-string">height:</span><span class="hljs-number">40</span>,<span class="hljs-string">image:</span><span class="hljs-string">'iconCollapse.png'</span>,<span class="hljs-string">myImage:</span><span class="hljs-string">'collapse'</span>,<span class="hljs-string">id:</span><span class="hljs-string">'image'</span>
});

row3.add(imgCollapse);        
tableData.push(row3); 

var row31 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

tableData.push(row31); 

var row32 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

tableData.push(row32); 

var row33 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});
tableData.push(row33); 


var row4 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">1</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

imgCollapse = Ti.UI.createImageView({
<span class="hljs-label">    left:</span><span class="hljs-number">5</span>,<span class="hljs-string">width:</span><span class="hljs-number">40</span>,<span class="hljs-string">height:</span><span class="hljs-number">40</span>,<span class="hljs-string">image:</span><span class="hljs-string">'iconCollapse.png'</span>,<span class="hljs-string">myImage:</span><span class="hljs-string">'collapse'</span>,<span class="hljs-string">id:</span><span class="hljs-string">'image'</span>
});

row4.add(imgCollapse);        
tableData.push(row4); 

var row41 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

tableData.push(row41); 

var row42 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});

tableData.push(row42); 

var row43 = Ti.UI.createTableViewRow({
<span class="hljs-label">    hasCheck:</span><span class="hljs-number">1</span>,<span class="hljs-string">rowIndex:</span>i++,<span class="hljs-string">expandable:</span><span class="hljs-number">0</span>,<span class="hljs-string">height:</span><span class="hljs-number">50</span>
});
tableData.push(row43); 



var tableView = Ti.UI.createTableView({
<span class="hljs-label">  backgroundColor:</span><span class="hljs-string">'white'</span>,
<span class="hljs-label">  data:</span>tableData
});

self.add(tableView);

    tableView.addEventListener(<span class="hljs-string">'click'</span>, function(e){

    <span class="hljs-keyword">if</span> (e.source.id === <span class="hljs-string">'image'</span>) {

        var rows = tableView.data[<span class="hljs-number">0</span>].rows;
        <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>; i &lt; rows.length; ++i) {
            <span class="hljs-keyword">if</span> (rows[i].rowIndex &gt; e.rowData.rowIndex) {
                <span class="hljs-keyword">if</span> (rows[i].expandable == <span class="hljs-number">1</span>) {
                    <span class="hljs-keyword">break</span>;
                }<span class="hljs-keyword">else</span>{
                    tableView.deleteRow(i);
                   }
            }
        }        
    }
});

    <span class="hljs-keyword">return</span> self;
}

module.exports = FirstView;
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 12th 2014, 2:27:41 am">December 12th 2014</span>
				by <span class='authorname'>Paul Bauer</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>table</span></li>
					
						<li><span class='tagname'>tableview</span></li>
					
						<li><span class='tagname'>tableviewrow</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Ok. I think the issue is that the loop is deleting to fast for the table to update. I added a function to delete the rows and call that function from the loop. The behavior is now as expected. Using a function was mentioned in this <a href="https:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;125359&#x2F;deleting-multiple-rows-from-tableview">post</a>.</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 12th 2014, 11:47:13 pm">December 12th 2014</span>
								by <span class='authorname'>Paul Bauer</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-284445">
				
						<section>
							<p>Hi Paul</p>
<p>you need to start you for loop from last index not from beginning because when delete any row from table view rest of row will be reindexed. so try to this</p>
<pre><code class="hljs">...
for <span class="hljs-comment">(var i = rows.length-1; i &gt;=0 ; i--)</span> {
            <span class="hljs-keyword">if</span> <span class="hljs-comment">(rows[i].rowIndex &gt; e.rowData.rowIndex)</span> {
                <span class="hljs-keyword">if</span> <span class="hljs-comment">(rows[i].expandable == 1)</span> {
                    break;
                }else{
                    tableView.deleteRow<span class="hljs-comment">(i)</span>;
                }
            }
        }      
...
</code></pre><p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 12th 2014, 12:25:55 pm">December 12th 2014</span>
								by <span class='authorname'>Nilesh Patel</span><br>
								<a class="icon-bg icon-link" href="../../question/179601/deleting-multiple-rows-from-a-table-with-one-click.html#answer-284445" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thank you for the suggestion Nilesh. The problem with this solution is that it starts deleting rows from the bottom up even though those rows may fall outside the group of cells that need to be removed. So your solution always starts deleting cells at the bottom and then stops at the first cell that has the expandable flag set. For example if cells 1, 5 and 9 have the expandable flag set and you click on row 5 then only rows 6, 7 and 8 should be removed.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 12th 2014, 5:59:33 pm">December 12th 2014</span>
											by <span class='authorname'>Paul Bauer</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
