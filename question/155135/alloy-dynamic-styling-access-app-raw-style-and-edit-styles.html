<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Alloy dynamic styling: access app raw style and edit styles » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Alloy dynamic styling: access app raw style and edit styles</h1>
		</header>
		<section>
			<p>Hi there,</p>
<p>I&#39;m exploring the new possibilities of dynamic styling of Alloy 1.2.0. I&#39;m aware that it is not officially released, but the api seems pretty well defined and implemented and there&#39;s a good <a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;alloy&#x2F;tree&#x2F;master&#x2F;test&#x2F;apps&#x2F;advanced&#x2F;dynamic_styling">working sample</a>. </p>
<p>My intention is to access a style predefined in a tss file and modify it on the fly, so new components are affected by those changes. I do NOT pretend that when a style is modified all components using that style are automatically updated, but only the new components.</p>
<p>First issue I found is that app.tss raw styles can&#39;t be accesed as the rest of styles. So, while</p>
<pre><code class="hljs"><span class="hljs-built_in">require</span>(<span class="hljs-string">'alloy/styles/index'</span>);
</code></pre><p>works fine, I haven&#39;t found the way to access the app.tss file</p>
<pre><code class="hljs"><span class="hljs-built_in">require</span>(<span class="hljs-string">'alloy/styles/app'</span>);
</code></pre><p>This make sense because app is not a component, but is there any method to modify those &quot;global&quot; styles? Accessing styles in this file would be really useful for some tasks. For what I&#39;ve seen in Resources folder, the only way would be to manually modify every components one by one by hand, including widgets, as app.tss styles are copied to every single style file in the project.</p>
<p>And the second point is how to modify those styles. Note that I don&#39;t want to add&#x2F;remove classes, just modify existing one.</p>
<p>I know I can access raw styles as</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> styles = <span class="hljs-built_in">require</span>(<span class="hljs-string">'alloy/styles/index'</span>);
<span class="hljs-keyword">var</span> winStyle = styles[<span class="hljs-number">0</span>];
winStyle.style.backgroundColor = <span class="hljs-string">'pink'</span> ;
</code></pre><p>The module style is updated, even if I require the module again from other component I can see how it has the new values, but the new components created does not reflect the changes. So, is that possible? Which would be the best method to massively change raw styles?</p>
<p>thanks,<br>Javier</p>
<p>testing on iOS 6.1 with alloy 1.2.0</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 22nd 2013, 9:05:12 am">July 22nd 2013</span>
				by <span class='authorname'>devault GmbH</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>alloy 1.2.0-beta</span></li>
					
						<li><span class='tagname'>dynamic styling</span></li>
					
						<li><span class='tagname'>styles</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-266227">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>The intention was for people to use the API, but of course Javier has to come around and start manipulating the raw style arrays… :P</p>
<p>I&#39;ll make the app.tss accessible like the others. That&#39;s a good feature request, and I should be able to do it very quickly. Don&#39;t even bother writing a ticket for it, I&#39;ll take care of it.</p>
<p>Let me investigate your second point a little. As stated, I figured devs would focus mostly on the exposed APIs, so I didn&#39;t mess around with too much runtime style array manipulation. I&#39;ll see if there&#39;s a shortcoming there, or perhaps if you might be accessing it wrong. I&#39;ll report back here.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 22nd 2013, 12:08:25 pm">July 22nd 2013</span>
								by <span class='authorname'>Tony Lukasavage</span><br>
								<a class="icon-bg icon-link" href="question/155135/alloy-dynamic-styling-access-app-raw-style-and-edit-styles.html#answer-266227" rel="permalink">permalink</a>
							</div>

							<h5>11 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Actually, Javier, with regards to question #1, can you give me a good use case? I&#39;m hesitant to expose the global style as a separate module because that would then require multiple modules to determine a runtime style, making it slower. Other than just messing around with what you can do with dynamic styling, what is a practical reason to modify the global style at runtime? Wouldn&#39;t this be better handled by better defining your styles during development?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:12:45 pm">July 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>;)</p>
<p>Thanks, Tony. If you&#39;re asking yourself why the hell I want to do that, I&#39;m going to write my own wrapper to dynamically apply themes. In my case, all my themes only contains an app.tss style, so that&#39;s why I want to modify it. So my intention is, when the user changes the theme, I&#39;ll close all windows, apply the new styles defined in my theme (stored as json data) and re-open again.</p>
<p>I do not pretend to implement all the alloy themes functionality for obvious reasons, but be able to easily customize the app from some predefined or downloaded json styles files.</p>
<p>Maybe is there an easier way to do that that I overlooked?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:19:25 pm">July 22nd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;ve read your 2nd comment after sending mine. I think it is clear why I want to modify app.tss styles, but I&#39;ll give you a simple example:</p>
<p>If I defined some styles in app.tss as for example:</p>
<pre><code class="hljs">
"<span class="hljs-tag">Window</span>":<span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">backgroundColor</span>:<span class="hljs-value"><span class="hljs-string">'#fff'</span>,
</span></span></span>},

"<span class="hljs-tag">Window</span><span class="hljs-attr_selector">[platform=ios]</span>":<span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">barColor</span>:<span class="hljs-value"> <span class="hljs-string">'#333'</span>
</span></span></span>},


"<span class="hljs-class">.H1</span>":<span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value"><span class="hljs-string">'#333'</span>,
    font:{
        fontFamily: Alloy.CFG.fontBold,
        fontSize:<span class="hljs-string">'16dp'</span>,
        fontWeight:<span class="hljs-string">'bold'</span>
    </span></span></span>},
    <span class="hljs-tag">textAlign</span><span class="hljs-pseudo">:'left'</span>,
    <span class="hljs-tag">height</span><span class="hljs-pseudo">:Ti</span><span class="hljs-class">.UI</span><span class="hljs-class">.SIZE</span>
},
</code></pre><p>the idea is that I can redefine class &quot;H1&quot; or all windows backgroundColor modifing it globally, instead of doing for every component using $.resetClass and $.addClass. </p>
<p>As I said before, I have to modify a lot of styles in bulk mode defined in a json file, and I don&#39;t know which styles or components will be affected, so I can&#39;t consider all cases in development, except those that can&#39;t be modified and of course default values.</p>
<p>Hope it helps.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:31:37 pm">July 22nd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I understand your issue with #1 now, I just need it logged as a ticket so we can address it in detail further. It&#39;s not trivial as I first thought, so I need to carve out some time to look at it. </p>
<p>#2 though should be answered by my previous comment.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:34:49 pm">July 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK, I changed my mind, log a <a href="https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC">Titanium Community Jira Project</a> ticket for the global style module as a feature request. I took a look and it turns out to be non-trivial and would potentially make dynamic styling slower, so I need to really dig in to make it suitable for Alloy as a whole and not just your particular situation. Also, I don&#39;t have a time frame yet, but dynamic themes are actual getting near the top of my priority list, so you should see something similat to what you are describing in alloy in he not too distant future.</p>
<p>As to your second concern, I think you may have just be modifying the wrong part of the style array. It helps to just print out the style to the console first. Be aware though, that the order is determined entirely by the sorting priority to make style application at runtime as fast as possible. This means as you add new style entries, the styles could very well move around in the array. </p>
<p>Here&#39;s a small example to show you how you can modify the default color of Labels in the index controller (tested):</p>
<h3 id="index-xml">index.xml</h3>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"showLabel"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><h3 id="index-tss">index.tss</h3>
<pre><code class="hljs"><span class="hljs-string">'Label'</span>: {
    <span class="hljs-variable">width</span>: Ti.UI.SIZE,
    <span class="hljs-variable">height</span>: Ti.UI.SIZE,
    <span class="hljs-built_in">color</span>: <span class="hljs-string">'#000'</span>
}

<span class="hljs-string">'#index'</span>: {
    backgroundColor: <span class="hljs-string">'#fff'</span>,
    modal: <span class="hljs-keyword">false</span>,
    exiOnClose: <span class="hljs-keyword">true</span>
}
</code></pre><h3 id="index-js">index.js</h3>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showLabel</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> style = <span class="hljs-built_in">require</span>(<span class="hljs-string">'alloy/styles/index'</span>);
    style[<span class="hljs-number">0</span>].style.color = <span class="hljs-string">'#0f0'</span>;
    $.index.add($.UI.create(<span class="hljs-string">'Label'</span>, {
        text: <span class="hljs-string">'I should be green'</span>
    }));
}

$.index.open();
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:35:52 pm">July 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>sorry for the heading style in the last comment, I started the line with #1. Another good example of why styles can&#39;t be always hardcoded :D</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:57:01 pm">July 22nd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>#1: Sure, I&#39;ll do. I was surprised to hear that it could be easy. In my understanding, when you pre-compile the alloy code to titanium, you mix the app.tss styles with the component styles in a new javascript module (like Resources&#x2F;Alloy&#x2F;styles&#x2F;index.js).</p>
<p>That means that app.tss is copied to every style file in the project, even if its classes are not used by that component, which seems to me that it may require more memory and redundant information than having some kind of global file applied in real time. So, what you say is that it is possible to do but is slower? How much slower? Because mixing two javascript objects in memory should be quite fast, isn&#39;t it?</p>
<p> #2: But I don&#39;t want to create the components from controller. What I want is to keep using my xml and tss files and the Alloy.createController() and Alloy.createWidget() methods and modify the styles dynamically. I.e. if I have a label in my xml file with class=&quot;H1&quot;, what I want is just to modify the style and then create the new controller that contains the new label with the new style (not the old one I used in compilation time)</p>
<p>I think $.UI.create is great for those cases that you want to create components from code, but this shouldn&#39;t be the normal case in alloy. Is it too much to ask? :P</p>
<p>thanks a lot, as always.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 12:57:42 pm">July 22nd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>#1 Mixing 2 javascript objects shouldn&#39;t take much time, but it takes more than <em>not</em> doing it. I have to soncider that this will be the foundational step for much more resource intensive things like dynamic themes. The redundancy of the information in the styles is far outweighed by the simplicity of accessing a single, pre-sorted array of styles IMO.</p>
<p>#2. I think I see what you mean. The issue there is that the initial XML styles are all pre-compiled for the sake of speed. They don&#39;t even reference the runtime style module when they are first loaded. This again would fall into a gray area of functionality verus speed. For this first introduction to dynamic styling I opted for speed as functionality can always be added later, but speed is hard to get back. To be able to do this with the XML you&#39;ll likely need to log another ticket for this functionality, because it would require Alloy referencing the runtime styles when a controller is created instead of using the pre-compiled ones. You could do something hacky like doing this in your controller code:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> style = $.createStyle({
    apiName: <span class="hljs-string">'Label'</span>,
    classes: [],
    id: <span class="hljs-string">'someId'</span>
});
$.someLabel.applyProperties(style);
</code></pre><p>but this is obviously not ideal nor efficient. In any case, again log this one as a ticket and we&#39;ll dig into it, likely for Alloy 1.2.1.</p>
<p><strong>Can you see now why I was hoping devs would use the exposed API instead of directly manipulating the style arrays? :P</strong></p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 1:16:56 pm">July 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>haha, sure. You always have the last word, so no complaints :) I&#39;ll prepare two tickets and try to convince you how super cool would be to let developers to do this. Thanks for your time and patience again.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 1:23:33 pm">July 22nd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>No worries man. I think both definitely have their applications and will likely become part of Alloy in short order, likely before 1.3.0 but after 1.2.0. I just need to plan how to balance it with the best possible performance in mind.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 22nd 2013, 1:31:41 pm">July 22nd 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry for the delay, the tickets are now open:</p>
<p><a href="https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2646">https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2646</a></p>
<p><a href="https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2648">https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2648</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2013, 2:04:12 pm">July 23rd 2013</span>
											by <span class='authorname'>devault GmbH</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
