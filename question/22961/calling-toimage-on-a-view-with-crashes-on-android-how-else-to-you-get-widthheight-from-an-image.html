<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Calling toImage() on a view with crashes on Android. How else to you get width/height from an Image? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Calling toImage() on a view with crashes on Android. How else to you get width/height from an Image?</h1>
		</header>
		<section>
			<p>Is this expected, that toImage() on a view is not supported on Android? According to the API docs (that we all know are half-baked) I didn&#39;t see anything that would lead me to believe that you cannot. My attempts to get an image blob on a View or ImageView all end badly. After banging my head a while against this I dug into the KitchenSink app and found an eventual call to toImage guarded by a check for the iPhone platform.</p>
<p>On iPhone, you can create an ImageView from a file and then call toImage to get an image blob on which you can query the width and height.  Is there another way?  Without such, do we really have to hard-code all our image dimensions to what the anticipated native dimensions of the image are?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 6th 2010, 9:28:43 pm">May 6th 2010</span>
				by <span class='authorname'>Christopher Rumpf</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>blob</span></li>
					
						<li><span class='tagname'>image</span></li>
					
						<li><span class='tagname'>toimage</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>11</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>11 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-237516">
				
						<section>
							<p>I found a reason why it was crashing for me. On Android, toImage() does not return a blob. Instead, it returns an object with basic info about the image, like x, y, width, height, and one of those properties is the blob (the media property). So an android, you need to do: view.toImage().media to get the Ti.Blob</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 30th 2012, 3:10:27 am">April 30th 2012</span>
								by <span class='authorname'>Christopher Stea</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-237516" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This worked for me!</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 17th 2013, 6:24:23 pm">January 17th 2013</span>
											by <span class='authorname'>Freddy Montano</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>NICE! Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 3rd 2013, 6:29:43 pm">February 3rd 2013</span>
											by <span class='authorname'>Miguel Ángel Castaño Fajardo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You, sir, are my hero. It&#39;s immensely annoying that they just &quot;forget&quot; to mention absolutely vital stuff like this in the documentation. </p>
<p>Things like these, which should all be well documented, have already cost me upwards of 15 hours of useless &quot;where&#39;s-this-bug-coming-from&quot; time, which is huge cost for both my company and our end customers.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 31st 2014, 1:44:52 pm">March 31st 2014</span>
											by <span class='authorname'>Karst Ms</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>9</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-49821">
				
						<section>
							<p>Have you tried setting the ImageView&#39;s width&#x2F;height to &quot;auto&quot; ?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 6th 2010, 9:40:47 pm">May 6th 2010</span>
								by <span class='authorname'>Marshall Culpepper</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-49821" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>That doesn&#39;t work either. When I set the ImgView&#39;s height to &#39;auto&#39; and then query the height using imgView.size.height, it returns 0.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 21st 2011, 5:02:05 am">January 21st 2011</span>
											by <span class='authorname'>Satheesh Subramanian</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-49811">
				
						<section>
							<p>Hello Christopher,</p>
<p>After the crash occurs, can you set the &quot;Filter&quot; on the &quot;Test &amp; Package&quot; screen in Titanium Developer to &quot;Trace&quot;, then copy all of the trace window&#39;s contents to clipboard and paste into a new &quot;pastie&quot; at <a href="http:&#x2F;&#x2F;pastie.org">pastie.org</a>, then put the URL of your pastie here?</p>
<p>Thank you,</p>
<p>Bill</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 6th 2010, 9:38:45 pm">May 6th 2010</span>
								by <span class='authorname'>Bill Dawson</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-49811" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-49831">
				
						<section>
							<p>Thanks guys for your answers:</p>
<p>Here&#39;s the trace bit where things go down in flames:</p>
<p>http:&#x2F;&#x2F;pastie.org&#x2F;949366</p>
<p>Indeed, it&#39;s complaining about width&#x2F;height</p>
<p>The offending code seems to be the toImage line in the code below:</p>
<p>http:&#x2F;&#x2F;pastie.org&#x2F;949372</p>
<p>–</p>
<h2 id="update">UPDATE</h2>
<p>@Bill_Dawson - I was hoping that your hunch was right. At first I did not have the view added to a window when I tried this. I changed things up so that the view was added to a window and then tried the toImage. Same result unfortunately. It&#39;s still before the window is actually opened though but I have to refactor a good number of things before I can test that out.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 6th 2010, 9:58:42 pm">May 6th 2010</span>
								by <span class='authorname'>Christopher Rumpf</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-49831" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-49841">
				
						<section>
							<p>Ok, the problem I THINK is that the toImage() can&#39;t really be processed until the view is really &quot;on the canvas&quot;, so to speak.  You haven&#39;t added it yet to a window, so it hasn&#39;t been rendered, therefore no image snapshot can be taken of it.  That&#39;s my theory… can you try what it happens if you add the imageView first to the window then check to see if you can .toImage() it?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 6th 2010, 10:06:23 pm">May 6th 2010</span>
								by <span class='authorname'>Bill Dawson</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-49841" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-66741">
				
						<section>
							<p>Hi guys,<br>I&#39;m having the same problem I can&#39;t get the image dimensions on the Android.<br>Any suggestions?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 3rd 2010, 10:57:37 pm">June 3rd 2010</span>
								by <span class='authorname'>Daniele Sangalli</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-66741" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hey Daniele,<br>I never found a solution. As much as it pained me, I just hard-coded my image dimensions. &#x2F;sigh</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 4th 2010, 1:15:49 pm">June 4th 2010</span>
											by <span class='authorname'>Christopher Rumpf</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-89641">
				
						<section>
							<p>still no solution for android? Hardcoding is not a good solution….</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 23rd 2010, 2:44:36 pm">July 23rd 2010</span>
								by <span class='authorname'>daniel otto</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-89641" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>sorry, i solved the problem with this solution: </p>
<p>http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;33801&#x2F;position-vertical-labels</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2010, 2:56:23 pm">July 23rd 2010</span>
											by <span class='authorname'>daniel otto</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Have you used the size property of the view?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 23rd 2010, 8:45:43 pm">July 23rd 2010</span>
											by <span class='authorname'>Don Thorp</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-176631">
				
						<section>
							<p>9 months later and still no solution.</p>
<p>common, i think this would be worth resolving, no?</p>
<p>setting the width to auto is no good, cause it just sets the width to something like the width of the parent.<br>but as there isn&#39;t a horizontal layout in android, yet, there is no way to position dynamic elements side by side. also there is no way to center dynamic objects inside a view…</p>
<p>toImage() crashes on android, and the size property has the value of 0.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 11th 2011, 10:00:35 am">January 11th 2011</span>
								by <span class='authorname'>marcin kolonko</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-176631" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246089">
				
						<section>
							<p>I think you can use <strong>toBlob()</strong> instead to <strong>toImage()</strong> which returns the image as a Blob object.<br>Hope it help.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 27th 2012, 7:40:41 am">August 27th 2012</span>
								by <span class='authorname'>Xiang Wei Lee</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-246089" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-252695">
				
						<section>
							<p>For my Android 2.2, the view.toImage() indeed did not result in an image file. Following the suggestion by Christopher Stea I could solve this by adding .media. So you simply use view.toImage().media, and you will see the problem is solved.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 13th 2012, 2:00:04 pm">December 13th 2012</span>
								by <span class='authorname'>Eric Kirchner</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-252695" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-253295">
				
						<section>
							<p>What someone said earlier is absolutely correct.  You can&#39;t run a toImage on an Android view that hasn&#39;t actually been added to the screen yet.  My work around is creating a view &quot;dump receptacle&quot; that I place at the top of the screen or view somewhere at top: 0 - 1000.  That way you can use it as a desk of sorts to process the image.  Then the temporary view can be removed once the new view is ready to be placed to the screen.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 22nd 2012, 7:30:42 pm">December 22nd 2012</span>
								by <span class='authorname'>Francis Meetze</span><br>
								<a class="icon-bg icon-link" href="question/22961/calling-toimage-on-a-view-with-crashes-on-android-how-else-to-you-get-widthheight-from-an-image#answer-253295" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
