<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android - XHR write downloaded file throws IOException - Permission Denied » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android - XHR write downloaded file throws IOException - Permission Denied</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I am using the HttpClient in order to download a file from a server, and save it in the app_appdata folder in Android.</p>
<p>I simply used the code proposed in the Wiki and Kitchen Sink, and everything worked until yesterday…</p>
<p>Now everytime the I do<br><code>file.write(this.responseData)</code> in the http.onload part, I get the error as exposed in the stack trace below…</p>
<p>It is not a permission issue, since I have the rule <code>android.permission.WRITE_EXTERNAL_STORAGE</code> in my AndroidManifest.xml…</p>
<p>I also already tried to quit restart the emulator, or uninstall and reinstall the application, or start the emulator with the option &quot;wipe-out user data&quot;….but nothing worked…</p>
<p><strong>Do anyone know why I get this error ??</strong></p>
<p><strong>Any propositions ??</strong></p>
<p>I am using Android 2.3.3, with Mobile SDK 1.7.1 on Mac OS X 10.6.7.</p>
<p>Thanks for your help !</p>
<p>Error Stack Trace:</p>
<pre><code class="hljs">E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: (TiHttpClient-<span class="hljs-number">3</span>) [<span class="hljs-number">4997</span>,<span class="hljs-number">310689</span>] Error handling entity data
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Permission denied
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createNewFileImpl</span>(Native Method)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createNewFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1257</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createTempFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1322</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createTempFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1278</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">createFileResponseData</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">271</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleEntityData</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">289</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">248</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">170</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">657</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">637</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$ClientRunnable</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">1016</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.lang</span><span class="hljs-class">.Thread</span><span class="hljs-class">.run</span>(Thread<span class="hljs-class">.java</span>:<span class="hljs-number">1019</span>)
D/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: (TiHttpClient-<span class="hljs-number">3</span>) [<span class="hljs-number">13</span>,<span class="hljs-number">310702</span>] clearing the expired and idle connections
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: (TiHttpClient-<span class="hljs-number">3</span>) [<span class="hljs-number">7</span>,<span class="hljs-number">310709</span>] HTTP Error (org<span class="hljs-class">.mozilla</span><span class="hljs-class">.javascript</span><span class="hljs-class">.WrappedException</span>): Wrapped java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Permission denied
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: org<span class="hljs-class">.mozilla</span><span class="hljs-class">.javascript</span><span class="hljs-class">.WrappedException</span>: Wrapped java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Permission denied
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at org<span class="hljs-class">.mozilla</span><span class="hljs-class">.javascript</span><span class="hljs-class">.Context</span><span class="hljs-class">.throwAsScriptRuntimeEx</span>(Context<span class="hljs-class">.java</span>:<span class="hljs-number">1786</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">251</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">170</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">657</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at org<span class="hljs-class">.apache</span><span class="hljs-class">.http</span><span class="hljs-class">.impl</span><span class="hljs-class">.client</span><span class="hljs-class">.AbstractHttpClient</span><span class="hljs-class">.execute</span>(AbstractHttpClient<span class="hljs-class">.java</span>:<span class="hljs-number">637</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$ClientRunnable</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">1016</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.lang</span><span class="hljs-class">.Thread</span><span class="hljs-class">.run</span>(Thread<span class="hljs-class">.java</span>:<span class="hljs-number">1019</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: Caused by: java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Permission denied
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createNewFileImpl</span>(Native Method)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createNewFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1257</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createTempFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1322</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at java<span class="hljs-class">.io</span><span class="hljs-class">.File</span><span class="hljs-class">.createTempFile</span>(File<span class="hljs-class">.java</span>:<span class="hljs-number">1278</span>)
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">createFileResponseData</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">271</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleEntityData</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">289</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.network</span><span class="hljs-class">.TiHTTPClient</span><span class="hljs-variable">$LocalResponseHandler</span>.<span class="hljs-function"><span class="hljs-title">handleResponse</span><span class="hljs-params">(TiHTTPClient.java:<span class="hljs-number">248</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>:     ... <span class="hljs-number">5</span> more
I/<span class="hljs-function"><span class="hljs-title">TiHttpClient</span><span class="hljs-params">( <span class="hljs-number">2756</span>)</span></span>: (TiHttpClient-<span class="hljs-number">3</span>) [<span class="hljs-number">12</span>,<span class="hljs-number">310721</span>] Sending error Wrapped java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Permission denied
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 4th 2011, 8:42:58 am">August 4th 2011</span>
				by <span class='authorname'>abbdoul ab</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>file</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>ioexception</span></li>
					
						<li><span class='tagname'>write</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I narrowed down a bit, and in fact it is in the <code>xhr.send()</code> part that the IOException is throwed…..</p>
<p>Does anyone have an idea about this issue ?? (Paul ??)</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 4th 2011, 10:37:38 am">August 4th 2011</span>
								by <span class='authorname'>abbdoul ab</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>With SDK 1.7.1 I get the <strong>java.io.IOException : Permission Denied</strong> Error….</p>
<p>With SDK 1.7.2 I get the <strong>java.io.IOException : External Storage not mounted for writing</strong>…..</p>
<p>Why ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 4th 2011, 10:39:16 am">August 4th 2011</span>
								by <span class='authorname'>abbdoul ab</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-215408">
				
						<section>
							<p>On Android, I&#39;ve had to download large or multiple files to the SD card to avoid these errors.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 4th 2011, 9:46:33 am">August 4th 2011</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="../../question/123731/android---xhr-write-downloaded-file-throws-ioexception---permission-denied.html#answer-215408" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi, </p>
<p>Thanks for the tip, but what if the device does not have an SD card or that it couldn&#39;t be mounted…;(</p>
<p>In fact the file I try to download (a ZIP file) is only 800kb…And the same code was working a few days before with another file (around 100kb)…..</p>
<p>So I am really lost about the reason for this exception….</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 4th 2011, 10:41:02 am">August 4th 2011</span>
											by <span class='authorname'>abbdoul ab</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Bump<br>I&#39;m seeing this same issue when I try to download a ZIP file on the Nook Color. The download works on the Emulator as Ti&#x2F;Android requires the virtual sdcard to sideload the app.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 26th 2011, 1:41:52 pm">September 26th 2011</span>
											by <span class='authorname'>Pratik Patel</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-219550">
				
						<section>
							<p>It may still be related to the size of the file, even though only 800KB.</p>
<p>In iOS, there is a property called &quot;file&quot; you can set between the open and send calls, and the data will be written directly to that file.  This allows very large files to be downloaded because it avoids the need to use <code>f.write(xhr.responseData);</code> but that property is not (yet?) available in the android mobile SDK.</p>
<p>However, another user dug through the source code and came up with an effective alternative, and although he describes it as a hack, it works very well in my experience.  Try implementing the download method described in <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;35041&#x2F;large-file-download-on-mobile.html#answer-197841">this</a> post.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 26th 2011, 5:31:35 pm">September 26th 2011</span>
								by <span class='authorname'>Doug Handy</span><br>
								<a class="icon-bg icon-link" href="../../question/123731/android---xhr-write-downloaded-file-throws-ioexception---permission-denied.html#answer-219550" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
