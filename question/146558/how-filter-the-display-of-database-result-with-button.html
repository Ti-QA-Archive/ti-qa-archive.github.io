<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>how filter the display of database result with button » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>how filter the display of database result with button</h1>
		</header>
		<section>
			<p>hello,</p>
<p>i have a tableview with all the offers of my database. After i create TabbedBar with 4 buttons.<br> When i click on the button i must pass the choice into variable and refresh the tableview with news sql request .and result and display the new result with filter bids.</p>
<h2 id="this-is-my-code-">this is my code :</h2>
<p>var win = Titanium.UI.currentWindow;<br>win.hideTabBar();</p>
<p>win.backgroundImage =&#39;..&#x2F;iphone&#x2F;images&#x2F;bg.png&#39;;</p>
<p>&#x2F;&#x2F; fonction affichage des offres<br>function getOffres(){</p>
<p>var type_produit = win.produit;</p>
<p>&#x2F;&#x2F; ouverture et recherche dans la base<br>var rows = db.execute(&#39;SELECT  * FROM Offres WHERE Type_produit = ?&#39;, type_produit );<br>var results = [];</p>
<p>while(rows.isValidRow()){<br>    var Compagnie = rows.fieldByName(&#39;compagnie&#39;);<br>    var Conditions = rows.fieldByName(&#39;conditions&#39;);<br>    var Offre     = rows.fieldByName(&#39;offre&#39;);<br>    var quoteID   = rows.fieldByName(&#39;id&#39;);<br>    var Favoris   = rows.fieldByName(&#39;favoris&#39;);<br>    var Type_produit =  rows.fieldByName(&#39;type_produit&#39;)</p>
<pre><code class="hljs">/<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
</code></pre><p> Ti.API.info(Type_produit);<br> &#x2F;&#x2F;Nouvelle ligne<br>    var row = Ti.UI.createTableViewRow({ id:quoteID,height:80,backgroundColor:&#39;#fff&#39;});</p>
<pre><code class="hljs"><span class="hljs-comment">//mise en place des champs...</span>
<span class="hljs-comment">//titre</span>
 var Titre = Titanium.UI.createLabel({
         <span class="hljs-built_in">text</span>:Compagnie,
         <span class="hljs-comment">//textAlign: 'center',</span>
         font: {fontSize:<span class="hljs-number">16</span>, fontWeight: <span class="hljs-string">'bold'</span>},
         <span class="hljs-built_in">color</span>: <span class="hljs-string">'#0173BC'</span>,
         <span class="hljs-comment">//left: 120,</span>
         top: <span class="hljs-number">5</span>,
         <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
         <span class="hljs-comment">//width: 210</span>
     });
     row.<span class="hljs-built_in">add</span>(Titre);
</code></pre><p>   &#x2F;&#x2F; label offre<br>         var Offre = Titanium.UI.createLabel({<br>             text:Offre,<br>             textAlign: &#39;center&#39;,<br>             font: {fontSize:10, fontWeight: &#39;normal&#39;},<br>             color: &#39;#502C22&#39;,<br>             &#x2F;&#x2F;left: 100,<br>             top: 10,<br>             height: 40,<br>             &#x2F;&#x2F;width: 200<br>         });<br>         if (Offre.text == &#39;&#39;){<br>             Offre.text = &#39;Aucune offre&#39;;<br>         }<br>         row.add(Offre);</p>
<pre><code class="hljs">     <span class="hljs-comment">// label conditions</span>
     var Conditions = Titanium.UI.createLabel({
         <span class="hljs-built_in">text</span>:<span class="hljs-string">'* Conditions : '</span>+ Conditions,
         <span class="hljs-built_in">textAlign</span>: <span class="hljs-string">'center'</span>,
         font: {fontSize:<span class="hljs-number">8</span>, fontWeight: <span class="hljs-string">'normal'</span>},
         <span class="hljs-comment">//left: 70,</span>
         top: <span class="hljs-number">40</span>,
         <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
         <span class="hljs-comment">//width: 200</span>
     });

     row.<span class="hljs-built_in">add</span>(Conditions);

<span class="hljs-comment">//image</span>
var imgLabel = Ti.UI.createImageView({
    <span class="hljs-built_in">image</span>:<span class="hljs-string">'../imgs/axa.png'</span>,
    <span class="hljs-variable">height</span>:<span class="hljs-number">40</span>,
    <span class="hljs-variable">width</span>:<span class="hljs-number">40</span>,
    top:<span class="hljs-number">10</span>,
    left:<span class="hljs-number">10</span>,
    borderRadius:<span class="hljs-number">10</span>
});
row.<span class="hljs-built_in">add</span>(imgLabel);

<span class="hljs-keyword">if</span> (Favoris.toLowerCase() === <span class="hljs-string">'on'</span>) {
var FavorisImg = Ti.UI.createImageView({
    <span class="hljs-built_in">image</span>: <span class="hljs-string">'../imgs/favorisOn.png'</span>,
    <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">20</span>,
    top: <span class="hljs-number">10</span>,
    left: <span class="hljs-number">290</span>
});
row.<span class="hljs-built_in">add</span>(FavorisImg);
</code></pre><p>}<br>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;<br>    results.push(row);<br>    rows.next();<br>};<br>Ti.API.info(results);</p>
<p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;<br>&#x2F;&#x2F; création du tableview</p>
<p>var tableau = Ti.UI.createTableView({<br>    backgroundColor:&quot;white&quot;,<br>    separatorColor:&#39;#502C22&#39;,<br>    color:&#39;#502C22&#39;,<br>    editable:true,</p>
<pre><code class="hljs"><span class="hljs-comment">//footerView:</span>
<span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>,
<span class="hljs-attribute">width</span>: <span class="hljs-number">320</span>,
<span class="hljs-comment">//height : 400,</span>
<span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>,    
});
</code></pre><p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</p>
<p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;<br>tableau.addEventListener(&#39;click&#39;,function(e)<br>        {</p>
<pre><code class="hljs">        <span class="hljs-comment">//if(e.rowData.url)</span>
        <span class="hljs-comment">//{</span>
            <span class="hljs-keyword">var</span> w = Titanium.UI.createWindow({
                id:e.rowData.id,
                <span class="hljs-comment">//title:e.rowData.title,</span>
                <span class="hljs-comment">//url:e.rowData.url,</span>
                <span class="hljs-comment">//bacColor:'#502C22',</span>
                url:<span class="hljs-string">'fiche_offre.js'</span>,
                barImage: <span class="hljs-string">'../iphone/images/navbar.png'</span>,


            })
            <span class="hljs-keyword">var</span> btn = Titanium.UI.createButton({
    title:<span class="hljs-string">'Retour'</span>,
    style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN
});
w.setLeftNavButton(btn);
btn.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
</span>{
    w.close();
});
w.open({modal:<span class="hljs-literal">true</span>});

        <span class="hljs-comment">//}</span>
    });
</code></pre><p>tableau.setData([]);<br>tableau.setData(results);<br>win.add(tableau)<br>}</p>
<p>&#x2F;&#x2F;<br>&#x2F;&#x2F; TOOLBAR<br>&#x2F;&#x2F;<br>var tb2 = Titanium.UI.iOS.createTabbedBar({<br>    labels:[&#39;Mois offerts&#39;, &#39;Réduction&#39;, &#39;Cadeau&#39;, &#39;Parrainage&#39;],<br>    backgroundColor:&#39;#0368a4&#39;,<br>    height:50,<br>    width:320,<br>    &#x2F;&#x2F;index:2<br>});<br>var flexSpace = Titanium.UI.createButton({<br>    systemButton:Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE<br>});</p>
<p>win.setToolbar([flexSpace,tb2,flexSpace]);</p>
<p>tb2.addEventListener(&#39;click&#39;, function(e)<br>{<br>    &#x2F;&#x2F;headerLabel.text = &#39;You clicked index = &#39; + e.index;<br>    var choix = e.index;</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (choix ==<span class="hljs-string">'0'</span>)
{

    <span class="hljs-keyword">var</span> choix = <span class="hljs-string">'Mois offerts'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'1'</span>)
{
    <span class="hljs-keyword">var</span> choix = <span class="hljs-string">'Réduction'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'2'</span>)
{
    <span class="hljs-keyword">var</span> choix = <span class="hljs-string">'Cadeau'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'3'</span>)
{
    <span class="hljs-keyword">var</span> choix = <span class="hljs-string">'Parrainage'</span>;
    alert(choix);
}
</code></pre><p>});</p>
<p>&#x2F;&#x2F; on recharge la page pour rafraichir<br>win.addEventListener(&#39;focus&#39;, getOffres);</p>
<hr>
<p>thank you for your help</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 7th 2013, 4:27:24 pm">January 7th 2013</span>
				by <span class='authorname'>patrice aschenbrenner</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>button event</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>sql filter</span></li>
					
						<li><span class='tagname'>tableview</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Please repost the code using the proper markdown syntax. The syntax bar is attached to the textarea where you post your question&#x2F;comment. While you&#39;re at it, you should really post all information about your dev environment when you ask a question like this. If you have any questions regarding what info needs to be posted please see the <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;ask">Ask A Question Page</a> for more info.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 7th 2013, 5:49:42 pm">January 7th 2013</span>
								by <span class='authorname'>Anthony Decena</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>@Anthony i have foramted code for you now you can try it</p>
<pre><code class="hljs">var win = <span class="hljs-constant">Titanium</span>.<span class="hljs-constant">UI</span>.currentWindow; win.hideTabBar();

win.backgroundImage =<span class="hljs-string">'../iphone/images/bg.png'</span>;

<span class="hljs-regexp">//</span> fonction affichage des offres function getOffres(){

var type_produit = win.produit;

<span class="hljs-regexp">//</span> ouverture et recherche dans la base var rows = db.execute(<span class="hljs-string">'SELECT * FROM Offres WHERE Type_produit = ?'</span>, type_produit ); var results = [];

<span class="hljs-keyword">while</span>(rows.isValidRow()){ var <span class="hljs-constant">Compagnie</span> = rows.fieldByName(<span class="hljs-string">'compagnie'</span>); var <span class="hljs-constant">Conditions</span> = rows.fieldByName(<span class="hljs-string">'conditions'</span>); var <span class="hljs-constant">Offre</span> = rows.fieldByName(<span class="hljs-string">'offre'</span>); var quoteID = rows.fieldByName(<span class="hljs-string">'id'</span>); var <span class="hljs-constant">Favoris</span> = rows.fieldByName(<span class="hljs-string">'favoris'</span>); var <span class="hljs-constant">Type_produit</span> = rows.fieldByName(<span class="hljs-string">'type_produit'</span>)

/<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>

<span class="hljs-constant">Ti</span>.<span class="hljs-constant">API</span>.info(<span class="hljs-constant">Type_produit</span>); <span class="hljs-regexp">//</span><span class="hljs-constant">Nouvelle</span> ligne var row = <span class="hljs-constant">Ti</span>.<span class="hljs-constant">UI</span>.createTableViewRow({ <span class="hljs-symbol">id:</span>quoteID,<span class="hljs-symbol">height:</span><span class="hljs-number">80</span>,<span class="hljs-symbol">backgroundColor:</span><span class="hljs-string">'#fff'</span>});

<span class="hljs-regexp">//mise</span> en place des champs...
/<span class="hljs-regexp">/titre
 var Titre = Titanium.UI.createLabel({
        text:Compagnie,
        /</span><span class="hljs-regexp">/textAlign: 'center',
        font: {fontSize:16, fontWeight: 'bold'},
        color: '#0173BC',
        /</span><span class="hljs-regexp">/left: 120,
        top: 5,
        height: 20,
        /</span><span class="hljs-regexp">/width: 210
    });
    row.add(Titre);

/</span><span class="hljs-regexp">/ label offre var Offre = Titanium.UI.createLabel({ text:Offre, textAlign: 'center', font: {fontSize:10, fontWeight: 'normal'}, color: '#502C22', /</span><span class="hljs-regexp">/left: 100, top: 10, height: 40, /</span><span class="hljs-regexp">/width: 200 }); if (Offre.text == ''){ Offre.text = 'Aucune offre';
} row.add(Offre);

    /</span><span class="hljs-regexp">/ label conditions
    var Conditions = Titanium.UI.createLabel({
        text:'* Conditions : '+ Conditions,
        textAlign: 'center',
        font: {fontSize:8, fontWeight: 'normal'},
        /</span><span class="hljs-regexp">/left: 70,
        top: 40,
        height: 20,
        /</span><span class="hljs-regexp">/width: 200
    });

    row.add(Conditions);

/</span><span class="hljs-regexp">/image
var imgLabel = Ti.UI.createImageView({
    image:'../imgs</span><span class="hljs-regexp">/axa.png',
    height:40,
    width:40,
    top:10,
    left:10,
    borderRadius:10
});
row.add(imgLabel);

if (Favoris.toLowerCase() === 'on') {
var FavorisImg = Ti.UI.createImageView({
    image: '../imgs</span><span class="hljs-regexp">/favorisOn.png',
    height: 20,
    width: 20,
    top: 10,
    left: 290
});
row.add(FavorisImg);

} /</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span> results.push(row); rows.<span class="hljs-keyword">next</span>();
}; <span class="hljs-constant">Ti</span>.<span class="hljs-constant">API</span>.info(results);

<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/ /</span><span class="hljs-regexp">/ création du tableview

var tableau = Ti.UI.createTableView({ backgroundColor:"white", separatorColor:'#502C22', color:'#502C22', editable:true,

/</span><span class="hljs-regexp">/footerView:
top: 0,
width: 320,
/</span><span class="hljs-regexp">/height : 400,
bottom: 0,  
});

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span> tableau.addEventListener(<span class="hljs-string">'click'</span>,function(e) {

        <span class="hljs-regexp">//if</span>(e.rowData.url)
        /<span class="hljs-regexp">/{
            var w = Titanium.UI.createWindow({
                id:e.rowData.id,
                /</span><span class="hljs-regexp">/title:e.rowData.title,
                /</span><span class="hljs-regexp">/url:e.rowData.url,
                /</span><span class="hljs-regexp">/bacColor:'#502C22',
                url:'fiche_offre.js',
                barImage: '../iphone</span><span class="hljs-regexp">/images/navbar</span>.png<span class="hljs-string">',


            })
            var btn = Titanium.UI.createButton({
    title:'</span><span class="hljs-constant">Retour</span><span class="hljs-string">',
    style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN
});
w.setLeftNavButton(btn);
btn.addEventListener('</span>click<span class="hljs-string">',function()
{
    w.close();
});
w.open({modal:true});

        //}
    });

tableau.setData([]);
tableau.setData(results); win.add(tableau) }

// // TOOLBAR // var tb2 = Titanium.UI.iOS.createTabbedBar({ labels:['</span><span class="hljs-constant">Mois</span> offerts<span class="hljs-string">', '</span><span class="hljs-constant">R</span>éduction<span class="hljs-string">', '</span><span class="hljs-constant">Cadeau</span><span class="hljs-string">', '</span><span class="hljs-constant">Parrainage</span><span class="hljs-string">'], backgroundColor:'</span><span class="hljs-comment">#0368a4', height:50, width:320, //index:2 }); var flexSpace = Titanium.UI.createButton({ systemButton:Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE });</span>

win.setToolbar([flexSpace,tb2,flexSpace]);

tb2.addEventListener(<span class="hljs-string">'click'</span>, function(e) { <span class="hljs-regexp">//header</span>Label.text = <span class="hljs-string">'You clicked index = '</span> + e.index; var choix = e.index;

<span class="hljs-keyword">if</span> (choix ==<span class="hljs-string">'0'</span>)
{

    var choix = <span class="hljs-string">'Mois offerts'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'1'</span>)
{
    var choix = <span class="hljs-string">'Réduction'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'2'</span>)
{
    var choix = <span class="hljs-string">'Cadeau'</span>;
    alert(choix);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(choix ==<span class="hljs-string">'3'</span>)
{
    var choix = <span class="hljs-string">'Parrainage'</span>;
    alert(choix);
}

});

<span class="hljs-regexp">//</span> on recharge la page pour rafraichir
win.addEventListener(<span class="hljs-string">'focus'</span>, getOffres);
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 7th 2013, 6:43:14 pm">January 7th 2013</span>
								by <span class='authorname'>Muhammad Wahhab Mirza</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>hello sorry Muhammad but i dont understand what you wanted to do. your code does not good.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 8th 2013, 6:34:39 am">January 8th 2013</span>
								by <span class='authorname'>patrice aschenbrenner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Muhammad tried formatting your code correctly as you had not used the correct script formatting to make the code readable, however I think some of the code failed to format as many of the lines appear to run into comments and I suspect that was not in your original code and only looks this was as Muhammad copied from what was on the screen incorrectly formatted.</p>
<p>Please add your code as a comment by using 3 <strong>~</strong> on a blank line above your code and another 3 <strong>~</strong> below your code on a blank line. Check the content editor you type in and press the <strong>code</strong> link to see the example.</p>
<p>Also check my suggestion below.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 8th 2013, 6:54:58 am">January 8th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>ah ok  i must look for post correctly my code for another time ; )</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 8th 2013, 7:54:16 am">January 8th 2013</span>
								by <span class='authorname'>patrice aschenbrenner</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-254032">
				
						<section>
							<p>Hi</p>
<p>If all you are trying to do is run the same db query once on start and then again depending on the choice made on the toolbar - then the easiest way is to create a function to handle the db work where you pass in the filter variable and return the results, you can then use <strong>setData</strong> to update the table.</p>
<p>Concept example, fill in with your own code as necessary;</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRecords</span><span class="hljs-params">(strFilter)</span> </span>{
  <span class="hljs-comment">// open db</span>
  <span class="hljs-keyword">var</span> sql = <span class="hljs-string">'SELECT * FROM Offres WHERE Type_produit = ?;'</span>;
  db.execute(sql, strFilter);
  <span class="hljs-comment">// loop results</span>
  <span class="hljs-comment">// create each row</span>
  <span class="hljs-comment">// results.push(entry);</span>

  <span class="hljs-keyword">return</span> results;
}
</code></pre><p>You can then call this by the following;</p>
<pre><code class="hljs">var data = getRecords<span class="hljs-comment">(type_produit)</span>;
<span class="hljs-comment">// or</span>
Table.setData<span class="hljs-comment">(getRecords(choix)</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 7th 2013, 9:18:26 pm">January 7th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/146558/how-filter-the-display-of-database-result-with-button#answer-254032" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>yes it&#39;s solution for my problem but sorry i dont know how put this code into my code : (</p>
<p>it is possible to post the entire code with you function include  please. i tryed but it&#39; doesn&#39;t work</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2013, 8:12:25 am">January 8th 2013</span>
											by <span class='authorname'>patrice aschenbrenner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Try breaking your code into two blocks; part 1 and part 2</p>
<p>something like this;</p>
<p><strong>~~~</strong></p>
<p>your code - first half</p>
<p><strong>~~~</strong></p>
<p>Then another block;</p>
<p><strong>~~~</strong></p>
<p>your code - second half</p>
<p><strong>~~~</strong></p>
<p>This ONLY needs to be the specific section related to the problem (same as you tried first time).</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2013, 8:20:18 am">January 8th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you but my problem is not for the post but  to include your function getRecords in my code</p>
<p>i understand the process but i can not do.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2013, 10:53:09 am">January 8th 2013</span>
											by <span class='authorname'>patrice aschenbrenner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Can you post your correct code for the database section, so I can convert it and send it back to you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2013, 11:02:30 am">January 8th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Malcom,  do you need another code ?</p>
<p>i have a &#39; database.js &#39; file  with Ti.UI.datbase open()  ….<br>i include this at the begining of my window. Do yo need it ?</p>
<p>Patrice</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 9th 2013, 2:24:19 pm">January 9th 2013</span>
											by <span class='authorname'>patrice aschenbrenner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Patrice, as soon as I am near my dev machine I am on it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 9th 2013, 3:10:34 pm">January 9th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-254082">
				
						<section>
							<p>This is my code</p>
<pre><code class="hljs">
var win = <span class="hljs-constant">Titanium</span>.<span class="hljs-constant">UI</span>.currentWindow;
win.hideTabBar();

win.backgroundImage =<span class="hljs-string">'../iphone/images/bg.png'</span>;


<span class="hljs-regexp">//</span> fonction affichage des offres
function getOffres(){

<span class="hljs-regexp">//</span> the <span class="hljs-keyword">type</span> <span class="hljs-keyword">of</span> product <span class="hljs-keyword">type</span> selected in the previous page
var type_produit = win.produit;

<span class="hljs-regexp">//</span> ouverture et recherche dans la base
var rows = db.execute(<span class="hljs-string">'SELECT  * FROM Offres WHERE Type_produit = ?'</span>, type_produit );
var results = [];

<span class="hljs-keyword">while</span>(rows.isValidRow()){
    var <span class="hljs-constant">Compagnie</span> = rows.fieldByName(<span class="hljs-string">'compagnie'</span>);
    var <span class="hljs-constant">Conditions</span> = rows.fieldByName(<span class="hljs-string">'conditions'</span>);
    var <span class="hljs-constant">Offre</span>     = rows.fieldByName(<span class="hljs-string">'offre'</span>);
    var quoteID   = rows.fieldByName(<span class="hljs-string">'id'</span>);
    var <span class="hljs-constant">Favoris</span>   = rows.fieldByName(<span class="hljs-string">'favoris'</span>);
    var <span class="hljs-constant">Type_produit</span> =  rows.fieldByName(<span class="hljs-string">'type_produit'</span>)

    /<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>


 /<span class="hljs-regexp">/display row


    var row = Ti.UI.createTableViewRow({ id:quoteID,height:80,backgroundColor:'#fff'});

    /</span><span class="hljs-regexp">/mise en place des champs...
    /</span><span class="hljs-regexp">/titre
     var Titre = Titanium.UI.createLabel({
             text:Compagnie,
             /</span><span class="hljs-regexp">/textAlign: 'center',
             font: {fontSize:16, fontWeight: 'bold'},
             color: '#0173BC',
             /</span><span class="hljs-regexp">/left: 120,
             top: 5,
             height: 20,
             /</span><span class="hljs-regexp">/width: 210
         });
         row.add(Titre);

   /</span><span class="hljs-regexp">/ label offre
         var Offre = Titanium.UI.createLabel({
             text:Offre,
             textAlign: 'center',
             font: {fontSize:10, fontWeight: 'normal'},
             color: '#502C22',
             /</span><span class="hljs-regexp">/left: 100,
             top: 10,
             height: 40,
             /</span><span class="hljs-regexp">/width: 200
         });
         if (Offre.text == ''){
             Offre.text = 'Aucune offre';    
         }
         row.add(Offre);

         /</span><span class="hljs-regexp">/ label conditions
         var Conditions = Titanium.UI.createLabel({
             text:'* Conditions : '+ Conditions,
             textAlign: 'center',
             font: {fontSize:8, fontWeight: 'normal'},
             /</span><span class="hljs-regexp">/left: 70,
             top: 40,
             height: 20,
             /</span><span class="hljs-regexp">/width: 200
         });

         row.add(Conditions);

   /</span><span class="hljs-regexp">/ affichage du logo de la compagnie d'assurance
    var imgLabel = Ti.UI.createImageView({
        image:'../imgs</span><span class="hljs-regexp">/'+Compagnie+'.png',
        height:60,
        width:60,
        top:10,
        left:10,
        borderRadius:10
    });
    row.add(imgLabel);

     /</span><span class="hljs-regexp">/image favoris si offres dans les favoris       
    if (Favoris.toLowerCase() === 'on') {
    var FavorisImg = Ti.UI.createImageView({
        image: '../imgs</span><span class="hljs-regexp">/favorisOn.png',
        height: 20,
        width: 20,
        top: 10,
        left: 290
    });
    row.add(FavorisImg);
}/</span><span class="hljs-regexp">/fin


/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
    results.push(row);
    rows.<span class="hljs-keyword">next</span>();        
};
<span class="hljs-constant">Ti</span>.<span class="hljs-constant">API</span>.info(results);

<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
/</span><span class="hljs-regexp">/ création du tableview

var tableau = Ti.UI.createTableView({
    backgroundColor:"white",
    separatorColor:'#502C22',
    color:'#502C22',
    editable:true,

    /</span><span class="hljs-regexp">/footerView:
    top: 0,
    width: 320,
    /</span><span class="hljs-regexp">/height : 400,
    bottom: 0,    
    });

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
tableau.addEventListener(<span class="hljs-string">'click'</span>,function(e)
        {

            <span class="hljs-regexp">//if</span>(e.rowData.url)
            /<span class="hljs-regexp">/{
                var w = Titanium.UI.createWindow({
                    id:e.rowData.id,
                    /</span><span class="hljs-regexp">/title:e.rowData.title,
                    /</span><span class="hljs-regexp">/url:e.rowData.url,
                    /</span><span class="hljs-regexp">/bacColor:'#502C22',
                    url:'fiche_offre.js',
                    barImage: '../iphone</span><span class="hljs-regexp">/images/navbar</span>.png<span class="hljs-string">',


                })
                var btn = Titanium.UI.createButton({
        title:'</span><span class="hljs-constant">Retour</span><span class="hljs-string">',
        style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN
    });
    w.setLeftNavButton(btn);
    btn.addEventListener('</span>click<span class="hljs-string">',function()
    {
        w.close();
    });
    w.open({modal:true});

            //}
        });
tableau.setData([]);        
tableau.setData(results);
win.add(tableau)
}</span>
</code></pre><p>it&#39;s good for you  </p>
<p>and i put 4 button to bottom to choose filter<br>I must create the eventListener for the buttons and pass the variable for my function getRecords</p>
<pre><code class="hljs"><span class="xml">var flexSpace = Titanium.UI.createButton(</span><span class="hljs-expression">{
    <span class="hljs-variable">systemButton</span>:<span class="hljs-variable">Titanium.UI.iPhone.SystemButton.FLEXIBLE</span>_<span class="hljs-variable">SPACE</span>
    }</span><span class="xml">);


    var b1 = Titanium.UI.createButton(</span><span class="hljs-expression">{
        /<span class="hljs-end-block">/title</span>:'<span class="hljs-variable">Mois</span> <span class="hljs-variable">offerts</span>',
        /<span class="hljs-end-block">/style</span>:<span class="hljs-variable">Titanium.UI.iPhone.SystemButtonStyle.BORDERED</span>
        <span class="hljs-variable">width</span>: 80,
        <span class="hljs-variable">height</span>: 61,
        <span class="hljs-variable">backgroundDisabledImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundSelectedImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundImage</span>: '<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau.png</span>'
    }</span><span class="xml">);

    var b2 = Titanium.UI.createButton(</span><span class="hljs-expression">{
        <span class="hljs-variable">width</span>: 80,
        <span class="hljs-variable">height</span>: 61,
        <span class="hljs-variable">backgroundDisabledImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/reduction</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundSelectedImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/reduction</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundImage</span>: '<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/reduction.png</span>'
    }</span><span class="xml">);

    var b3 = Titanium.UI.createButton(</span><span class="hljs-expression">{
        <span class="hljs-variable">width</span>: 80,
        <span class="hljs-variable">height</span>: 61,
        <span class="hljs-variable">backgroundDisabledImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundSelectedImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundImage</span>: '<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/cadeau.png</span>'
    }</span><span class="xml">);

    var b4 = Titanium.UI.createButton(</span><span class="hljs-expression">{
        <span class="hljs-variable">width</span>: 80,
        <span class="hljs-variable">height</span>: 61,
        <span class="hljs-variable">backgroundDisabledImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/parrainage</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundSelectedImage</span>:'<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/parrainage</span>2<span class="hljs-variable">.png</span>',
        <span class="hljs-variable">backgroundImage</span>: '<span class="hljs-variable">..</span><span class="hljs-end-block">/images</span>/480<span class="hljs-variable">x</span>854<span class="hljs-end-block">/parrainage.png</span>'

    }</span><span class="xml">);

    win. barColor = "#000";
    win.setToolbar([flexSpace,b1,flexSpace,b2,flexSpace,b3,flexSpace,b4,flexSpace],</span><span class="hljs-expression">{<span class="hljs-variable">translucent</span>:<span class="hljs-variable">true</span>}</span><span class="xml">);



// refresh window    
win.addEventListener('focus', getOffres);</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 8th 2013, 11:28:43 am">January 8th 2013</span>
								by <span class='authorname'>patrice aschenbrenner</span><br>
								<a class="icon-bg icon-link" href="question/146558/how-filter-the-display-of-database-result-with-button#answer-254082" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
