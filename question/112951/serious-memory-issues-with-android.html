<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Serious Memory Issues with Android » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Serious Memory Issues with Android</h1>
		</header>
		<section>
			<p>Hi, I&#39;m using Android 2.2 APIs, and Titanium&#39;s 1.6.0 RC. I&#39;ve been trying to load around 20 images, each around 40Kb in size (on average) in a scroll view. </p>
<p>However, after a few loads &#x2F; refreshes, I get a memory problem. I&#39;ve copied part of the trace as shown below.</p>
<pre><code class="hljs">[TRACE] E/TiUIHelper( 809): (main) [7,62232] Unable to <span class="hljs-operator"><span class="hljs-keyword">load</span> <span class="hljs-keyword">bitmap</span>. <span class="hljs-keyword">Not</span> enough <span class="hljs-keyword">memory</span>: <span class="hljs-keyword">bitmap</span> <span class="hljs-keyword">size</span> exceeds VM budget
[<span class="hljs-keyword">TRACE</span>] <span class="hljs-keyword">E</span>/dalvikvm-<span class="hljs-keyword">heap</span>( <span class="hljs-number">809</span>): <span class="hljs-number">115200</span>-<span class="hljs-keyword">byte</span> <span class="hljs-keyword">external</span> allocation too <span class="hljs-keyword">large</span> <span class="hljs-keyword">for</span> this process.
[<span class="hljs-keyword">TRACE</span>] <span class="hljs-keyword">E</span>/GraphicsJNI( <span class="hljs-number">809</span>): VM won<span class="hljs-string">'t let us allocate 115200 bytes
[TRACE] D/skia ( 809): --- decoder-&gt;decode returned false</span></span>
</code></pre><p>Now, has anyone encountered the same problem? Care to share what steps can be done to avoid this? Its not a bug in 1.6.0 RC. I&#39;ve encountered it in 1.5.1 as well, and decided to move on to 1.6.0 in an attempt to try to solve the problem.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 16th 2011, 8:26:57 am">February 16th 2011</span>
				by <span class='authorname'>Zheng Da Clinton Goh</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>1.6.0rc</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>bitmap</span></li>
					
						<li><span class='tagname'>images</span></li>
					
						<li><span class='tagname'>memory</span></li>
					
						<li><span class='tagname'>scrollview</span></li>
					
						<li><span class='tagname'>vm</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-199021">
				
						<section>
							<p>You should try using a recycle method. What i mean is that you should load only the images that are visible on the screen at any given time, and the ones that are scrolled upwards or downwards and are no longer visible should be discarded to free up memory.</p>
<p>Try searching some solutions to recycle the scroll view, it was also presented in a keynote by a developer from Google. I am sure you will find it if you search a little, i gave it 2 minutes but i don&#39;t seem to find it right now. If i stumble on it, i will return with a link.</p>
<p>And don&#39;t assume android recycles the memory, try not to load all the images at once, do it incrementally and discard the ones that are not shown.</p>
<p>I hope it helps.</p>
<p>Alex</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 16th 2011, 10:54:41 pm">February 16th 2011</span>
								by <span class='authorname'>Alexandru Budin</span><br>
								<a class="icon-bg icon-link" href="question/112951/serious-memory-issues-with-android#answer-199021" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-199071">
				
						<section>
							<p>can you post your code somewhere?</p>
<p>I have created an application that holds many more images than that in a scroll view and I have no problems</p>
<p>Here is some code  that can be used to start off creating a view that only holds three images in memory at a time</p>
<p><a href="https:&#x2F;&#x2F;gist.github.com&#x2F;810171">https:&#x2F;&#x2F;gist.github.com&#x2F;810171</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 17th 2011, 12:20:01 am">February 17th 2011</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/112951/serious-memory-issues-with-android#answer-199071" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-199141">
				
						<section>
							<p>Hi Guys, thanks for your replies. Appreciate it.</p>
<p>@Aaron, I&#39;m afraid the code is really too complicated to be posted, but here&#39;s what it does:</p>
<ol>
<li>Create a custom table view (scrollView in a view).</li>
<li>Add views (row-headers) to the scrollView.</li>
<li>When a row-header is clicked, the contents listed under the header drop down. Imagine it as a &quot;insertRowsAt&quot; function.</li>
<li>When the expanded row-header is clicked again, the contents shown under the header fly-up. Imagine it as a &quot;deleteRowsFrom&quot; function.</li>
</ol>
<p>The aim is to create a drawer effect. Click on the row-header and you open the drawer, seeing its contents. Toggle it, and the drawer closes.</p>
<p>I use alot of scrollView.add() and scrollView.remove() methods. I realised that even though you call the function remove, it doesn&#39;t really remove the row, because it still remains painted on screen. What I do is to set the opacity to 0. </p>
<p>I think that this is the cause of my problem. Basically scrollView.remove() DOES NOT free up memory created by an object which has been added to the scrollView. I believe this problem has been reported somewhere else, and I was really hoping that in 1.6.0 it would be solved. Seems like that is not the case.</p>
<p>After a few &quot;opens&quot; and &quot;closes&quot;, I get an out of memory error. What I THINK is happening, is that because the instances are not destroyed, they remain in the window but are not visible. This clogs up the memory and causes my app to crash =(.</p>
<p>@Alex, will look into this. Thanks. Seems like an awfully tedious task to do though.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 17th 2011, 4:48:06 am">February 17th 2011</span>
								by <span class='authorname'>Zheng Da Clinton Goh</span><br>
								<a class="icon-bg icon-link" href="question/112951/serious-memory-issues-with-android#answer-199141" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
