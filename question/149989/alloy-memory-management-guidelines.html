<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Alloy Memory Management Guidelines » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Alloy Memory Management Guidelines</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I am new to Alloy developement and would like to know the guidelines which I must keep in mind while developing application so that they do not leak. Previous to alloy, we used to remove the controls from the window and set them to null while closing the window so that they could be garbage collected.</p>
<p>Would like to know what do we need to do in Alloy implementation.</p>
<p>Regards,<br>Soumya</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 25th 2013, 4:26:50 am">March 25th 2013</span>
				by <span class='authorname'>Soumya Kanti Kar</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>garbage collection</span></li>
					
						<li><span class='tagname'>memory</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Anything I posted here would be a repeat of the content found in the links below. Rick&#39;s presentation is particularly detailed and useful. In short, the same rules apply to Alloy as they do to traditional Titanium development.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 25th 2013, 9:30:42 am">March 25th 2013</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-259300">
				
						<section>
							<p>Hi Soumya</p>
<p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;146252&#x2F;alloy--memory-management">Refer this link</a></p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 25th 2013, 4:48:39 am">March 25th 2013</span>
								by <span class='authorname'>Sunny Patel</span><br>
								<a class="icon-bg icon-link" href="question/149989/alloy-memory-management-guidelines#answer-259300" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi,</p>
<p>Thank you for sharing the link. I have gone through this link but it does not as such give pointers as to what should be kept in mind while developing Alloy applications so that it does not leak.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 25th 2013, 5:01:58 am">March 25th 2013</span>
											by <span class='authorname'>Soumya Kanti Kar</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Refer This : </p>
<p><a href="http:&#x2F;&#x2F;zenborgium.blogspot.in&#x2F;2012&#x2F;04&#x2F;ultimate-answer-to-titanium-memory.html">Memory Leak</a></p>
<p>also</p>
<p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;127731&#x2F;appcelerator-application-memory-management"> Refer This </a></p>
</p>
										<div class="author">
											&mdash; commented <span title="March 25th 2013, 5:09:26 am">March 25th 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Soumya,</p>
<p>If this link help you then mark this answer as a best answer.</p>
<p>So, other can help from this Comments.</p>
<p>Thanks a lot.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 25th 2013, 5:11:25 am">March 25th 2013</span>
											by <span class='authorname'>Sunny Patel</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-259301">
				
						<section>
							<p>Hi Soumya   </p>
<p>Take a look at <strong>Rick Blalock</strong>: Your Apps are Leaking – Controlling Memory Leaks video. I think it will help you.</p>
<p><a href="http:&#x2F;&#x2F;vimeo.com&#x2F;29804284">Video</a></p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 25th 2013, 5:13:20 am">March 25th 2013</span>
								by <span class='authorname'>Dharmik Patel</span><br>
								<a class="icon-bg icon-link" href="question/149989/alloy-memory-management-guidelines#answer-259301" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-259302">
				
						<section>
							<p>Hi Soumya,</p>
<p>Refer this :<br><a href="https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Managing+Memory+and+Finding+Leaks">Managing Memory and Finding Leaks</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 25th 2013, 5:13:44 am">March 25th 2013</span>
								by <span class='authorname'>Jigar Maheshwari</span><br>
								<a class="icon-bg icon-link" href="question/149989/alloy-memory-management-guidelines#answer-259302" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>its not for Alloy but its for a Memory leaks. So, i provide to you.</p>
<p>May be it helpful</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 25th 2013, 5:14:40 am">March 25th 2013</span>
											by <span class='authorname'>Jigar Maheshwari</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-275663">
				
						<section>
							<p>Here is what I was able to come up in order to de-allocate&#x2F;free memory within an Alloy application:</p>
<pre><code class="hljs">Alloy.Globals.deallocate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_obj</span>)</span>{
    <span class="hljs-keyword">try</span>
    {
<span class="hljs-comment">// we know that waht we pass inside this function is going to be an object</span>
<span class="hljs-comment">// but let's check first</span>
        <span class="hljs-keyword">if</span>(_.isObject(_obj))
        {
    <span class="hljs-comment">// iterate through the object and deallocate memory from all the children</span>
            _.each(_obj, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">child</span>)</span>{
        <span class="hljs-comment">// children could be propeties, or other UI objects/controllers or functions</span>
                <span class="hljs-keyword">if</span>(_.isObject(child) &amp;&amp; !_.isFunction(child) &amp;&amp; !_.isEmpty(child))
                {
                <span class="hljs-comment">// repeat the process</span>
                    Alloy.Globals.deallocate(child);
                }
            });
        <span class="hljs-comment">// force garbage collection</span>
            _obj = <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'passed in _obj to be cleaned is not an object!'</span>);
        }
    }
    <span class="hljs-keyword">catch</span>(error)
    {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Error: '</span>+error);
    }
};
</code></pre><p>the _obj in this case would be the context you are trying to clean up, so in a controller you would call it like this:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroy</span>(<span class="hljs-params"></span>)</span>{
    $.myWindow.removeEventListener(<span class="hljs-string">'close'</span>, destroy);
    <span class="hljs-comment">// unbind any data collection you might have bound to the controller</span>
    $.destroy();
    <span class="hljs-comment">// remove the children</span>
    $.myWindow.removeAllChildren();
    <span class="hljs-comment">// run de-allocation</span>
    Alloy.Globals.deallocate($);
    <span class="hljs-comment">// set to null for garbage collection</span>
    $ = <span class="hljs-literal">null</span>;
}

$.myWindow.addEventListener(<span class="hljs-string">'close'</span>, destroy);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 25th 2014, 6:01:57 pm">February 25th 2014</span>
								by <span class='authorname'>Stevo Perisic</span><br>
								<a class="icon-bg icon-link" href="question/149989/alloy-memory-management-guidelines#answer-275663" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Your solution is generally unnecessary. It automates a few of the general principles of memory management. So I suppose it&#39;s not doing any harm. Basic good coding practices will accomplish the same thing.</p>
<ul>
<li>Don&#39;t use global variables. If you think you need global variables, think again. Always use &#39;var&#39; when declaring variables (they&#39;re globals if you don&#39;t).</li>
<li>Don&#39;t create references to objects (use anonymous object instantiated inline). If you do create references, null them out when you&#39;re done with them.</li>
<li>Encapsulate view creation in commonJS modules, which can be instantiated and then deallocated later. (Alloy helps with this because it is commonJS by default and a lot of older hand-rolled Classic code was not).</li>
<li>Destroy collections ($.destroy()) when using view&#x2F;model binding &amp; you&#39;re done with the associated view</li>
<li>Don&#39;t use, and watch out for implicitly-created closures unless you know what you&#39;re doing and later deallocate those objects.</li>
<li>Set global event listeners (Ti.App.addEventListener, Ti.Geolocation.addEventListener, etc.) with care – in your top-level controller, remove as soon as you can, never more than once, etc.</li>
<li>Learn JavaScript. It&#39;s not Java, C#, Ruby, etc. It works the way it works so be all zen-like and accept it. Learn about scoping, hoisting, prototypal inheritance, closures, etc. Yeah, it&#39;s a lot to learn. But you&#39;re a developer, you can do it.</li>
</ul>
<p>Most of those recommendations are pretty standard JavaScript principles. There are direct corollaries to web development in each of them. </p>
<p>There are nuances that your solution and the principles above perhaps don&#39;t fully cover.</p>
<p>Titanium is a dance between JavaScript and native code environments. Garbage collection (gc) and memory management techniques must account for the particulars of both. GC in JavaScript happens independently, and often more frequently than in the native side. The way it&#39;s handled on iOS, Android, MobileWeb, BlackBerry, etc. all differ. (Know your target platforms!)</p>
<p>Android, for example, can have problems when your code quickly allocates&#x2F;deallocates objects (e.g. in a tight loop). The JavaScript side can keep up, but Java&#39;s gc routines are notoriously lazy. You can end up with many objects ready to be deallocated (and even deallocated in the JavaScript environment) that Java doesn&#39;t get around to collecting. All of a sudden your app exhausts available memory (= crash) leaving you to blame Titanium for something that was your doing. </p>
<p>(Not strictly memory management related, but germane to the JS&#x2F;native discussion: The Titanium proxy objects (any object that begins with Ti.*) represent native objects. The kroll bridge maintains a link between the object living in JavaScript-land and the one (multiple actually) residing in native-land. Modifying the JavaScript version can break the link between &quot;lands&quot; or corrupt the native objects. We have for years recommended that developers avoid doing things like Ti.App.myCustomObject = &#39;stuff I want to be global&#39; but people do it all the time. Don&#39;t do it. This can cause a crash or hang your app. Also unrelated but so bad it&#39;s worth mentioning: don&#39;t use Window.url. There&#39;s no justifiable reason to use it.)</p>
<p>So are there leaks in Titanium? Yeah, probably a few. But when found and reported in Jira, such issues get prompt and high-priority attention. The last valid one I know of took less than two days from reporting to being fixed and in the nightly build, with much of that time verifying that it was a real bug and not a developer issue. In my personal experience, 99% of &quot;Titanium memory leaks&quot; have been the fault of developers doing unwise things with their code.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 26th 2014, 1:22:03 pm">February 26th 2014</span>
											by <span class='authorname'>Tim Poulsen</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Tim this bug report not closed about month https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-5648. Where hight priority?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 4th 2015, 10:19:26 am">September 4th 2015</span>
											by <span class='authorname'>Andrey Tkachenko</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
