<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>weird bug after clicking on textField » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>weird bug after clicking on textField</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>im developping a window (http:&#x2F;&#x2F;dzmob.net&#x2F;tags.png) which displays tags for a photo and allows to add a tag :</p>
<p>when there is no tags for a photo.</p>
<p>a click on textField which allows to write tag and add it generates this weird exception !!! :</p>
<pre><code class="hljs">[ERROR] The application has crashed with an uncaught exception <span class="hljs-string">'NSInternalInconsistencyException'</span>.
<span class="hljs-label">Reason:</span>
request for rect of invalid <span class="hljs-built_in">section</span> (-<span class="hljs-number">1</span>)
Stack trace:
<span class="hljs-number">0</span>   CoreFoundation                      <span class="hljs-number">0x03203022</span> __exceptionPreprocess + <span class="hljs-number">178</span>
<span class="hljs-number">1</span>   libobjc.A.dylib                     <span class="hljs-number">0x029f8cd6</span> objc_exception_throw + <span class="hljs-number">44</span>
<span class="hljs-number">2</span>   CoreFoundation                      <span class="hljs-number">0x031aba48</span> +[NSException raise:format:arguments:] + <span class="hljs-number">136</span>
<span class="hljs-number">3</span>   Foundation                          <span class="hljs-number">0x009f62cb</span> -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + <span class="hljs-number">116</span>
<span class="hljs-number">4</span>   UIKit                               <span class="hljs-number">0x00e9e972</span> -[UITableViewRowData rectForSection:] + <span class="hljs-number">188</span>
<span class="hljs-number">5</span>   UIKit                               <span class="hljs-number">0x00d4bdab</span> -[UITableView rectForSection:] + <span class="hljs-number">80</span>
<span class="hljs-number">6</span>   Seetch                              <span class="hljs-number">0x000c105e</span> -[TiUITableView keyboardDidShowAtHeight:] + <span class="hljs-number">430</span>
<span class="hljs-number">7</span>   Seetch                              <span class="hljs-number">0x001b0ad0</span> -[TiRootViewController handleNewKeyboardStatus] + <span class="hljs-number">864</span>
<span class="hljs-number">8</span>   Foundation                          <span class="hljs-number">0x0098585d</span> __NSFireDelayedPerform + <span class="hljs-number">389</span>
<span class="hljs-number">9</span>   CoreFoundation                      <span class="hljs-number">0x031d7936</span> __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + <span class="hljs-number">22</span>
<span class="hljs-number">10</span>  CoreFoundation                      <span class="hljs-number">0x031d73d7</span> __CFRunLoopDoTimer + <span class="hljs-number">551</span>
<span class="hljs-number">11</span>  CoreFoundation                      <span class="hljs-number">0x0313a790</span> __CFRunLoopRun + <span class="hljs-number">1888</span>
<span class="hljs-number">12</span>  CoreFoundation                      <span class="hljs-number">0x03139d84</span> CFRunLoopRunSpecific + <span class="hljs-number">212</span>
<span class="hljs-number">13</span>  CoreFoundation                      <span class="hljs-number">0x03139c9b</span> CFRunLoopRunInMode + <span class="hljs-number">123</span>
<span class="hljs-number">14</span>  GraphicsServices                    <span class="hljs-number">0x035cc7d8</span> GSEventRunModal + <span class="hljs-number">190</span>
<span class="hljs-number">15</span>  GraphicsServices                    <span class="hljs-number">0x035cc88a</span> GSEventRun + <span class="hljs-number">103</span>
<span class="hljs-number">16</span>  UIKit                               <span class="hljs-number">0x00cbd626</span> UIApplicationMain + <span class="hljs-number">1163</span>
<span class="hljs-number">17</span>  Seetch                              <span class="hljs-number">0x00003aa8</span> main + <span class="hljs-number">456</span>
<span class="hljs-number">18</span>  Seetch                              <span class="hljs-number">0x00002ef5</span> start + <span class="hljs-number">53</span>
<span class="hljs-number">2012</span>-<span class="hljs-number">11</span>-<span class="hljs-number">06</span> <span class="hljs-number">15</span>:<span class="hljs-number">40</span>:<span class="hljs-number">39.021</span> Seetch[<span class="hljs-number">8950</span>:1ac03] *** Terminating app due to uncaught exception <span class="hljs-string">'NSInternalInconsistencyException'</span>, reason: <span class="hljs-string">'request for rect of invalid section (-1)'</span>
*** First throw <span class="hljs-keyword">call</span> stack:
(<span class="hljs-number">0x3203022</span> <span class="hljs-number">0x29f8cd6</span> <span class="hljs-number">0x31aba48</span> <span class="hljs-number">0x9f62cb</span> <span class="hljs-number">0xe9e972</span> <span class="hljs-number">0xd4bdab</span> <span class="hljs-number">0xc105e</span> <span class="hljs-number">0x1b0ad0</span> <span class="hljs-number">0x98585d</span> <span class="hljs-number">0x31d7936</span> <span class="hljs-number">0x31d73d7</span> <span class="hljs-number">0x313a790</span> <span class="hljs-number">0x3139d84</span> <span class="hljs-number">0x3139c9b</span> <span class="hljs-number">0x35cc7d8</span> <span class="hljs-number">0x35cc88a</span> <span class="hljs-number">0xcbd626</span> <span class="hljs-number">0x3aa8</span> <span class="hljs-number">0x2ef5</span>)
terminate called throwing an exception
[INFO] Application started
[INFO] Seetch/<span class="hljs-number">1.0</span> (<span class="hljs-number">3.0</span><span class="hljs-string">.0</span>.v20120929141713.b66de42)
<span class="hljs-number">2012</span>-<span class="hljs-number">11</span>-<span class="hljs-number">06</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">29.699</span> Seetch[<span class="hljs-number">9632</span>:1ac03] [ERROR] Value was <span class="hljs-keyword">not</span> the value expected.   <span class="hljs-keyword">in</span> -[TiUITableView keyboardDidShowAtHeight:] (TiUITableView.m:<span class="hljs-number">2277</span>)
<span class="hljs-number">2012</span>-<span class="hljs-number">11</span>-<span class="hljs-number">06</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">29.699</span> Seetch[<span class="hljs-number">9632</span>:1ac03] *** Assertion failure <span class="hljs-keyword">in</span> -[UITableViewRowData rectForSection:], /SourceCache/UIKit_Sim/UIKit-<span class="hljs-number">1914.84</span>/UITableViewRowData.m:<span class="hljs-number">1449</span>
<span class="hljs-number">2012</span>-<span class="hljs-number">11</span>-<span class="hljs-number">06</span> <span class="hljs-number">15</span>:<span class="hljs-number">44</span>:<span class="hljs-number">29.701</span> Seetch[<span class="hljs-number">9632</span>:1ac03] *** Terminating app due to uncaught exception <span class="hljs-string">'NSInternalInconsistencyException'</span>, reason: <span class="hljs-string">'request for rect of invalid section (-1)'</span>
*** First throw <span class="hljs-keyword">call</span> stack:
(<span class="hljs-number">0x3203022</span> <span class="hljs-number">0x29f8cd6</span> <span class="hljs-number">0x31aba48</span> <span class="hljs-number">0x9f62cb</span> <span class="hljs-number">0xe9e972</span> <span class="hljs-number">0xd4bdab</span> <span class="hljs-number">0xc105e</span> <span class="hljs-number">0x1b0ad0</span> <span class="hljs-number">0x98585d</span> <span class="hljs-number">0x31d7936</span> <span class="hljs-number">0x31d73d7</span> <span class="hljs-number">0x313a790</span> <span class="hljs-number">0x3139d84</span> <span class="hljs-number">0x3139c9b</span> <span class="hljs-number">0x35cc7d8</span> <span class="hljs-number">0x35cc88a</span> <span class="hljs-number">0xcbd626</span> <span class="hljs-number">0x3aa8</span> <span class="hljs-number">0x2ef5</span>)
terminate called throwing an exception
[INFO] Application has exited from Simulator
</code></pre><p>my code : </p>
<pre><code class="hljs">exports.createWindow = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">idMedia</span>)</span>{

    <span class="hljs-keyword">var</span> L = <span class="hljs-built_in">require</span>(<span class="hljs-string">'BusinessLogic/languages'</span>);

    <span class="hljs-keyword">var</span> winAddTags = Ti.UI.createWindow({
        top: <span class="hljs-number">0</span>,
        height: Ti.Platform.displayCaps.platformHeight - <span class="hljs-number">44</span>,
        zIndex: <span class="hljs-number">3</span>
    });

    <span class="hljs-keyword">var</span> indicateur = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).createActivityIndicator(<span class="hljs-number">1</span>);    

    <span class="hljs-keyword">var</span> rows = [];

    <span class="hljs-keyword">var</span> header = Ti.UI.createView({
        layout: <span class="hljs-string">'horizontal'</span>,
        borderColor: <span class="hljs-string">'gray'</span>,
        backgroundColor: <span class="hljs-string">'white'</span>,
        height: <span class="hljs-number">50</span>
    });

    <span class="hljs-keyword">var</span> headerField = Ti.UI.createTextField({
        color:<span class="hljs-string">'gray'</span>,
        top: <span class="hljs-number">10</span>,
        hintText: <span class="hljs-string">'Ajoutez ici un mot clé'</span>,
        left: <span class="hljs-number">10</span>,
        width: <span class="hljs-number">225</span>,
        height: <span class="hljs-number">30</span>,
        autocorrect: <span class="hljs-literal">false</span>
    });
    <span class="hljs-keyword">var</span> headerBtn = Ti.UI.createButton({
        title:<span class="hljs-string">'Ajouter'</span>,
        style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,
        color:<span class="hljs-string">'#79797a'</span>,
        borderRadius: <span class="hljs-number">8</span>,
        backgroundColor: <span class="hljs-string">'#d7d8dc'</span>,
        top: <span class="hljs-number">10</span>,
        left: <span class="hljs-number">10</span>,
        width: <span class="hljs-number">70</span>,
        height: <span class="hljs-number">30</span>
    });

    headerBtn.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        indicateur.show();
        <span class="hljs-keyword">var</span> tag = headerField.value;
        <span class="hljs-keyword">if</span>(tag != <span class="hljs-string">''</span>){
            <span class="hljs-built_in">require</span>(<span class="hljs-string">'BusinessLogic/addTag'</span>).addTag(
                idMedia,
                tag.toLowerCase(),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">success</span>(<span class="hljs-params"></span>)</span>{
                    loadTags();
                    <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(L(<span class="hljs-string">'tag_added'</span>));
                    headerField.setValue(<span class="hljs-string">''</span>);
                    indicateur.hide();
                },
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params">msg</span>)</span>{
                    <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(msg);
                    indicateur.hide();
                }
            );    
        }
        <span class="hljs-keyword">else</span>{
            <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(L(<span class="hljs-string">'check_tag'</span>));
            indicateur.hide();
        }

    });

    header.add(headerField);
    header.add(headerBtn);

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadTags</span>(<span class="hljs-params"></span>)</span>{
        indicateur.show();
        rows = [];
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'BusinessLogic/getTagsForPhoto'</span>).getTagsForPhoto(
            idMedia,
            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params">tags</span>)</span>{
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;tags.length; i++){
                    <span class="hljs-keyword">var</span> tag = tags[i];

                    <span class="hljs-keyword">var</span> tagRow = Ti.UI.createTableViewRow({
                        height : <span class="hljs-number">40</span>
                      });

                    <span class="hljs-keyword">var</span> view = Ti.UI.createView({
                        layout: <span class="hljs-string">'horizontal'</span>
                    });

                    <span class="hljs-keyword">var</span> tagName = Ti.UI.createLabel({
                        left : <span class="hljs-number">10</span>,
                        height : <span class="hljs-number">40</span>,
                        width: <span class="hljs-number">260</span>,
                        text : tags[i],
                        color : <span class="hljs-string">'black'</span>,
                        touchEnabled  : <span class="hljs-literal">false</span>
                    });

                    <span class="hljs-keyword">var</span> tagDelBtn = Ti.UI.createButton({
                        style:Titanium.UI.iPhone.SystemButtonStyle.PLAIN,
                        backgroundImage: <span class="hljs-string">'images/deleteRow.png'</span>,
                        left: <span class="hljs-number">10</span>,
                        width: <span class="hljs-number">30</span>,
                        height: <span class="hljs-number">30</span>
                    });

                    view.add(tagName);
                    view.add(tagDelBtn);

                    tagDelBtn.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
                        <span class="hljs-built_in">require</span>(<span class="hljs-string">'BusinessLogic/deleteTag'</span>).deleteTag(
                            idMedia,
                            tag,
                            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">success</span>(<span class="hljs-params"></span>)</span>{
                                <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(L(<span class="hljs-string">'tag_deleted'</span>));
                                loadTags();
                            },
                            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params">msg</span>)</span>{
                                <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(msg);
                            }
                        );
                    });

                    tagRow.add(view);
                    rows.push(tagRow);
                }

                tableView.setData(rows);
                indicateur.hide();
               },
               <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params">msg</span>)</span>{
                   indicateur.hide();
                   <span class="hljs-built_in">require</span>(<span class="hljs-string">'ui/util'</span>).alertDialog(msg);
               }
           );                
    }

    winAddTags.addEventListener(<span class="hljs-string">'open'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        loadTags();
    })

    <span class="hljs-keyword">var</span> tableView = Titanium.UI.createTableView({
        top: <span class="hljs-number">44</span>,
        borderColor: <span class="hljs-string">'gray'</span>,
        selectionStyle: Titanium.UI.iPhone.TableViewCellSelectionStyle.NONE,
        data: rows,
        headerView: header
    });

    <span class="hljs-keyword">var</span> navBarContainer = Ti.UI.createView({
        height: <span class="hljs-number">44</span>,
        backgroundImage: <span class="hljs-string">'images/barImage.png'</span>,
        top: <span class="hljs-number">0</span>
    });

    <span class="hljs-keyword">var</span> backButton = Ti.UI.createButton({
        backgroundImage: <span class="hljs-string">'images/back.png'</span>,
        font: {fontWeight: <span class="hljs-string">'bold'</span>, fontSize: <span class="hljs-number">12</span>},
        color: <span class="hljs-string">'#ccc'</span>,
        width: <span class="hljs-built_in">require</span>(<span class="hljs-string">'BusinessLogic/util'</span>).getSizeTag(L(<span class="hljs-string">'back'</span>)) + <span class="hljs-number">20</span>,
        title: <span class="hljs-string">' '</span> + L(<span class="hljs-string">'back'</span>),
        height: <span class="hljs-number">28</span>,
        width: <span class="hljs-number">60</span>,
        left: <span class="hljs-number">10</span>
    });

    navBarContainer.add(backButton);

    backButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        winAddTags.close();
    });

    winAddTags.add(tableView);
    winAddTags.add(navBarContainer);
    winAddTags.add(indicateur);

    <span class="hljs-keyword">return</span> winAddTags;
};
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 6th 2012, 1:07:55 pm">November 6th 2012</span>
				by <span class='authorname'>Djamel ZAHAL</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>bug</span></li>
					
						<li><span class='tagname'>textfield</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>i cleaned and rebuilded the project but it doesn&#39;t change…</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 6th 2012, 1:08:32 pm">November 6th 2012</span>
								by <span class='authorname'>Djamel ZAHAL</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I had this issue also, in an Alloy project.  I&#39;ve seen a couple notes here &amp; there on setting height or setting the data.  I tried both, setting height has no effect, nor would I really expect it to based on the code within Titanium SDK that is throwing the problem.  Setting data to an empty array elicits the issue as well (as one would expect as well):</p>
<p>$.table.setData([]);</p>
<p>However, setting the data to an array with exactly one element avoids the problem.  Say for example you have rows that only have title properties, you could do something like:</p>
<p>$.table.setData([{&quot;title&quot;: &quot;&quot;}]);</p>
<p>Just be sure that when the fake row is clicked that you check for something in your handler code (like a title with length === 0 in this case), so that you don&#39;t inadvertently execute the rest of your handler logic on the fake row.  You probably want to treat it as if it did not exist is my guess. </p>
<p>Rgds….Matt</p>
</div>
							<div class="author">
								&mdash; commented <span title="April 15th 2013, 1:00:32 pm">April 15th 2013</span>
								by <span class='authorname'>Matt Mullens</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
