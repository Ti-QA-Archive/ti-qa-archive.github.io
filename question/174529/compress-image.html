<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Compress image » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Compress image</h1>
		</header>
		<section>
			<p>hello i am capturing image from camera after i get event media i need to compress the image for further purpose, any way to compress media image?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 26th 2014, 5:02:03 am">May 26th 2014</span>
				by <span class='authorname'>Shekhar Saraf</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>appcelerator</span></li>
					
						<li><span class='tagname'>titanium</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Good question - how to compress images should be more obvious - unfortunately it is not.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 26th 2014, 6:10:55 am">May 26th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>-2</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-279058">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>As part of the <a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules">Appcelertor Modules</a> you can find the <a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules&#x2F;tree&#x2F;master&#x2F;imagefactory">imagefactory module</a>.</p>
<p>The downloadable distributions are;</p>
<ul>
<li><a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules&#x2F;blob&#x2F;master&#x2F;imagefactory&#x2F;mobile&#x2F;android&#x2F;dist&#x2F;ti.imagefactory-android-2.2.1.zip">Android</a></li>
<li><a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules&#x2F;blob&#x2F;master&#x2F;imagefactory&#x2F;mobile&#x2F;ios&#x2F;ti.imagefactory-iphone-1.1.1.zip">iOS</a></li>
</ul>
<p><strong>Usage Example</strong> check the documentation for full details</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> ImageFactory = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.imagefactory'</span>);
<span class="hljs-comment">// takes an image and compress it to 25% quality</span>
compressedimage = ImageFactory.compress(originalimage, <span class="hljs-number">0.25</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 26th 2014, 6:07:39 am">May 26th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/174529/compress-image#answer-279058" rel="permalink">permalink</a>
							</div>

							<h5>8 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>@Malcom: Have you tried it with a captured image with high resolution? It will crash your application. </p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 6:52:54 am">May 26th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Sundeep please explain what circumstance you believe the module will fail under?</p>
<p>My comments were constructive and explained why each of the other answers failed to answer the actual question.  Your own answer ignored the request to compress an image and chose to change the dimensions - not the same thing.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:15:05 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Malcom: The module fails with HIGH RESOLUTION image after we capture photo (Samsung SIII&#x2F;SIV) and try to compress it. You once test it at your end if you still do coding and let me know if image compression works using ImageFactory module for high resolution image. </p>
<p>Giving high dose medicine (mugged up by an experienced doctor) doesn&#39;t matter to a patient. It is how to cure his disease with simple precaution. Let the patient speak up how he get cured!!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:23:59 am">May 26th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Sundeep I have just set up a test rig and tested it working as expected without issue.</p>
<p>Tested equipment;</p>
<ul>
<li>HTC Desire S (2.3.3) - even this worked</li>
<li>Google Nexus 4 (4.4.2)</li>
<li>Samsung Galaxy S4 (4.3)</li>
</ul>
<p>Image file;</p>
<ul>
<li>JPG</li>
<li>13 mega pixel </li>
<li>4160 x 3120</li>
<li>2,965KB physical file size</li>
</ul>
<p>Compression tests;</p>
<ul>
<li>90% quality worked without failure or memory issues</li>
<li>0.1% quality worked without failure or memory issues</li>
</ul>
<p>This also does not make use of the following property;</p>
<pre><code class="hljs"><span class="hljs-label">android:</span>largeHeap=<span class="hljs-string">"true"</span>
</code></pre><p>Entire test app code;</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> <span class="hljs-keyword">win</span> = Titanium.UI.createWindow({});
<span class="hljs-keyword">var</span> btn = Ti.UI.createButton({
    title: '<span class="hljs-keyword">Compress</span>',
    top: 20
});
<span class="hljs-keyword">var</span> img = Ti.UI.createImageView({
    bottom: 20,
    height: 300,
    width: 300
});
<span class="hljs-keyword">win</span>.add(btn);
<span class="hljs-keyword">win</span>.add(img);
btn.addEventListener('click', function (<span class="hljs-keyword">e</span>) {
    <span class="hljs-keyword">var</span> ImageFactory = require('ti.imagefactory');
    <span class="hljs-keyword">var</span> f = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, 'big1.jpg');
    <span class="hljs-keyword">var</span> blob = f.<span class="hljs-keyword">read</span>();
    newBlob = ImageFactory.<span class="hljs-keyword">compress</span>(blob, 0.9);
    <span class="hljs-keyword">var</span> filename = Titanium.Filesystem.applicationDataDirectory + <span class="hljs-string">"/compressed.jpg"</span>;
    f = Titanium.Filesystem.getFile(filename);
    f.write(newBlob);
    img.setImage(newBlob);
});
<span class="hljs-keyword">win</span>.<span class="hljs-keyword">open</span>();
</code></pre><p>So in answer to your questions;</p>
<ul>
<li>Have I tried it with a captured image - YES</li>
<li>Have I tried it with a high resolution image - YES</li>
<li>Does it work - YES</li>
<li>Do you need to change anything in the SDK source - NO</li>
<li>Do you need to change anything in the Module source - NO</li>
</ul>
<p>There are circumstances where the original images dimensions need a trim - so nothing wrong with doing that as well.</p>
<p>I have no idea why you decided to take everything so personally and get all your friends to mark me down - yes that is trackable.  I was only trying to give the correct information to the poor author of this question.</p>
<p>Having solved this problem before - I figured providing the correct information was the way to go</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 1:14:56 pm">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Malcom,</p>
<p>Sorry for late reply here. Could you please look at the below error log I found while executing your code with Samsung ACE and what can be the reason for this:</p>
<p>[INFO] :   I&#x2F;dalvikvm-heap: Grow heap (frag case) to 7.277MB for 522256-byte allocation</p>
<p>[INFO] :   I&#x2F;dalvikvm-heap: Grow heap (frag case) to 8.017MB for 1046544-byte allocation</p>
<p>[INFO] :   I&#x2F;dalvikvm-heap: Grow heap (frag case) to 9.517MB for 2095120-byte allocation</p>
<p>[INFO] :   I&#x2F;dalvikvm-heap: Grow heap (frag case) to 23.081MB for 15980560-byte allocation</p>
<p>[WARN] :   OpenGLRenderer: Bitmap too large to be uploaded into a texture (3264x2448, max=2048x2048)</p>
<p>[INFO] :   TiAnalyticsSvc: (Thread-4010) [25966,31055] Analytics Service Started</p>
<p>Hey I liked your straight forward responses and have never taken so personally. Infact I am learning from you. I don&#39;t know who are those friends of mine&#x2F;yours who have marked my responses&#x2F;queries &amp; those who are helping&#x2F;responding my responses&#x2F;queries down through out the Appcelerator community!! I am only trying to get perfect&#x2F;accurate solutions of the queries asked by poor authors.</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 27th 2014, 10:45:55 am">May 27th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Excellent - we are both dealing with facts which is what I am after.</p>
<p>The likely reason why the Samsung Galaxy Ace will not handle a 13 mega pixel image is the amount of memory available on the device which in this case is only 278 MB RAM.</p>
<p>The Desire S I used (my only remaining 2.3.x physical family test device) has 768 MB available.</p>
<p>When the apps are running on devices there a few things that affect the amount space OUR app has to play with.  Now whilst this is not always the case - this is a how the app is often provided memory of its own.</p>
<ul>
<li>Device memory</li>
<li>Less the OS in memory amount used</li>
<li>Less the required dependant apps</li>
<li>Less the services that handle background processes</li>
<li>Less the services that process push notifications</li>
<li>Basically less all services</li>
<li>Divide the remaining value by 10</li>
</ul>
<p>That is the starting point your app gets.  This can be higher and can be lower and changes during the lifetime of the app in memory.  Factors that change this are;</p>
<ul>
<li>How demanding other apps are using memory</li>
<li>How many apps are running</li>
<li>How many background services are running</li>
<li>If any updates of any kind are being processed</li>
</ul>
<p>You can do some checking using the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Platform-property-availableMemory">availableMemory</a> method.  Keep in mind you should monitor this during the app life cycle.  The new <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.App-event-memorywarning">memorywarning</a> event would be useful but currently only available for iOS.</p>
<p>Back to the image size maximum.  The size shown is 2048x2048 resolves down to a memory requirement of 16Mb per image.  Keep in mind this is NOT the file size it is the amount of memory required to display the image.  The operating system has decided that it is the maximum space per individual image it will handle.</p>
<p>Now here comes one of the wonderful things that makes Android so uniquely annoying.  The camera for the device is 5 MP, the images it creates are 2592?1944.  This means that whilst the app can show the image it just took it cannot create a memory space large enough for image handling.</p>
<p>Your example was bigger so I suspect that image was not taken on that camera - unless the specifications I just found were incorrect.  But either way, the image is too large in one or both directions - it only takes one to cause the problem.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 27th 2014, 11:50:55 am">May 27th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Superb!! you are a brilliant mobility detective who caught the crime. Now you &amp; me are on same page.</p>
<p>Your guess is absolutely right. But as you said it is the lack of sufficent memory due to which sometime it happned with me that on a mobile when I took photo and tried to compress or process (gray&#x2F;crop) the image it said bitmap is too large. </p>
<p>Then I reseached into the issue and found the only way to overcome the problem is to resize&#x2F;scale the image to a desired standard size so that image processing will not cause any crash issue. And I found the solution which I suggested at <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;174529&#x2F;compress-image#answer-279054">compress-image#comment-211398</a>. When Shekhar asked the question I thought he might be facing the same issue as I was so posted the answer without explaining in details. </p>
<p>So here I am expecting a nice conclusion from you, because you are expert (I really appericiate) in that. I accept resize and compress are NOT same as you said earlier. But we should resize the image before we compress&#x2F;process the image after capturing the photo. I hope our discussion on this post will help every one who will go through it no matter how many down votes we receive on this post.</p>
<p>@Malcom: please draw a line on the sand ;)</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 28th 2014, 3:51:16 am">May 28th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes I am with. Now it is very clear that Android sometimes and in some devices doesn&#39;t appear to be able to process an image equal to the size of its own camera then despite the wish to compress we are also forced to reduce.</p>
<p>So we are left with one problem; how to know when the reduce as well as compress?  I will ask around.</p>
<p>And yes; you and I are good.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 28th 2014, 4:51:42 am">May 28th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-279054">
				
						<section>
							<p>Hello Shekhar,</p>
<p>To compress&#x2F;resize the image after capturing, you can import&#x2F;use the below module:</p>
<p>https:&#x2F;&#x2F;github.com&#x2F;yagitoshiro&#x2F;ImageAsResized</p>
<p>Please let me know if you find any difficulty to integrate it.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 26th 2014, 5:26:58 am">May 26th 2014</span>
								by <span class='authorname'>Sundeep Mallick</span><br>
								<a class="icon-bg icon-link" href="question/174529/compress-image#answer-279054" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>@Sundeep the question asked for compression not reducing the size of the image - they are not the same thing.</p>
<p>Also the link you provided (even if it was related) is very out of date and unnecessary, <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Blob-method-imageAsResized">ImageAsResized</a> available since Ti SDK 3.0</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 6:00:19 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Malcom: If I will make the module work on higher version. Infact I have made it recently 1 week before. This is a good way to resize the high resolution image and then to process. </p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 6:55:14 am">May 26th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Sundeep the question is not make the image smaller - the question is how do I compress an image. Of course <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Blob-method-imageAsResized">ImageAsResized</a> (the correctly built in version) will reduce the size of an image - but if the image starts at 1000x1000 and the author wants the image to still be 1000x1000 but with a compression ratio - then making it 250x250 is just wrong.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:25:20 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>My dear Malcom, I can understand what you are saying. But your solution will not work although it&#39;s a right answer. Beacause I found the same issue 1 week before and resolved using that gihub code. Anyway let Shekhar speak up on it.</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:29:37 am">May 26th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did you add this property to your tiapp.xml?</p>
<pre><code class="hljs"><span class="hljs-label">android:</span>largeHeap=<span class="hljs-string">"true"</span>
</code></pre><p>Placed here;</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">android</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">manifest</span> <span class="hljs-attribute">...</span> /&gt;</span>
      <span class="hljs-comment">&lt;!-- this additional property --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">application</span> <span class="hljs-attribute">android:largeHeap</span>=<span class="hljs-value">"true"</span> /&gt;</span>
</code></pre><p>Known to help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:40:34 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes, but it didn&#39;t work as well!! Have you tried at your end?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 10:01:25 am">May 26th 2014</span>
											by <span class='authorname'>Sundeep Mallick</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-279055">
				
						<section>
							<p>Hello Shekhar,</p>
<p>Here is <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;154059&#x2F;image-size">Link</a>, i hope it will help you. Best Luck.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 26th 2014, 5:29:23 am">May 26th 2014</span>
								by <span class='authorname'>Ritesh Popat</span><br>
								<a class="icon-bg icon-link" href="question/174529/compress-image#answer-279055" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>@Ritesh the link you provided to a previous answer has two links, following either of these links ends up at a 404 page not found error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 6:09:41 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Shekhar, you can download Image Factory Module from this <a href="https:&#x2F;&#x2F;marketplace.appcelerator.com&#x2F;apps&#x2F;4973?restoreSearch=true#!overview">Link</a>.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:11:21 am">May 26th 2014</span>
											by <span class='authorname'>Ritesh Popat</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Ritesh good correction to your answer.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2014, 7:27:56 am">May 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
