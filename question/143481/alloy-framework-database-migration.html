<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Alloy Framework: Database Migration Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Alloy Framework: Database Migration</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>Can anyone have an example to use database migration. For example the first version looks like this</p>
<pre><code class="hljs">config: {
        <span class="hljs-string">"columns"</span>: {
            <span class="hljs-string">"name"</span>:<span class="hljs-string">"string"</span>,
            <span class="hljs-string">"contact"</span>:<span class="hljs-string">"string"</span>
        },
        <span class="hljs-string">"adapter"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"sql"</span>,
            <span class="hljs-string">"collection_name"</span>: <span class="hljs-string">"Sample"</span>
        }
    },
</code></pre><p>and the second version looks like this.</p>
<pre><code class="hljs">config: {
        <span class="hljs-string">"columns"</span>: {
            <span class="hljs-string">"name"</span>:<span class="hljs-string">"string"</span>,
            <span class="hljs-string">"contact"</span>:<span class="hljs-string">"string"</span>,
            <span class="hljs-string">"message:"</span><span class="hljs-built_in">string</span><span class="hljs-string">"
        },
        "</span>adapte<span class="hljs-string">r": {
            "</span>type<span class="hljs-string">": "</span>sql<span class="hljs-string">",
            "c</span>ollection_name<span class="hljs-string">": "</span>Sample<span class="hljs-string">"
        }
    },</span>
</code></pre><p>How can I do a migration so that the data in the first version would be copied into the second version before dropping the entire table and recreating it? Does alloy automatically perform this task? if not where should I place my codes? Can anyone post a sample code.</p>
<p>Thanks!!!</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 14th 2012, 5:49:39 am">October 14th 2012</span>
				by <span class='authorname'>Mark Anthony Sabandal</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>migration</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-256536">
				
						<section>
							<p>http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;guide&#x2F;Alloy_Sync_Adapters_and_Migrations</p>
<p>Look there, near the bottom.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 11th 2013, 1:59:42 pm">February 11th 2013</span>
								by <span class='authorname'>Mark Gerecht</span><br>
								<a class="icon-bg icon-link" href="../../question/143481/alloy-framework-database-migration.html#answer-256536" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This is causing an error for me. My newer-version Model has a new field &quot;directions&quot; and I created a migration like this:</p>
<pre><code class="hljs">
migration.<span class="hljs-keyword">up</span> = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(migrator)</span> {</span>
    migrator.db.<span class="hljs-keyword">execute</span>(<span class="hljs-string">'ALTER TABLE '</span> + migrator.table + <span class="hljs-string">' ADD COLUMN directions TEXT;'</span>);
};
// <span class="hljs-keyword">is</span> migration.down required?
</code></pre><p>When I clean&#x2F;build, the following error happens when the app tries to migrate before creating my &quot;sql&quot; adapter database.</p>
<pre><code class="hljs">[<span class="hljs-keyword">ERROR</span>] A SQLite database <span class="hljs-keyword">error</span> occurred <span class="hljs-keyword">on</span> database '/Users/joebeuckman/Library/Application Support/iPhone Simulator/6.1/Applications/471CE5BA-4F51-47C5-9A7F-40E093CE47E0/Library/Private Documents/_alloy_.sql': <span class="hljs-keyword">Error</span> Domain=com.plausiblelabs.pldatabase Code=3 <span class="hljs-string">"An error occured parsing the provided SQL statement."</span> UserInfo=0xa778c90 {com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.vendor.code=1, NSLocalizedDescription=<span class="hljs-keyword">An</span> <span class="hljs-keyword">error</span> occured parsing the provided SQL statement., com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.<span class="hljs-keyword">query</span>.string=ALTER <span class="hljs-keyword">TABLE</span> BusStops ADD COLUMN directions TEXT;, com.plausiblelabs.pldatabase.<span class="hljs-keyword">error</span>.vendor.string=<span class="hljs-keyword">no</span> such <span class="hljs-keyword">table</span>: BusStops} (SQLite #1: <span class="hljs-keyword">no</span> such <span class="hljs-keyword">table</span>: BusStops) (<span class="hljs-keyword">query</span>: 'ALTER <span class="hljs-keyword">TABLE</span> BusStops ADD COLUMN directions TEXT;')
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="April 19th 2013, 12:23:30 am">April 19th 2013</span>
											by <span class='authorname'>Joseph Beuckman</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Also, a note about the Migration documentation: the example date uses 77 seconds in the datestamp.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 19th 2013, 12:26:57 am">April 19th 2013</span>
											by <span class='authorname'>Joseph Beuckman</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-270054">
				
						<section>
							<p>Check this Alloy Migration Tutorial <a href="http:&#x2F;&#x2F;bit.ly&#x2F;AlloyMigration">AlloyMigrationExample</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 16th 2013, 10:24:25 am">October 16th 2013</span>
								by <span class='authorname'>Prakash M</span><br>
								<a class="icon-bg icon-link" href="../../question/143481/alloy-framework-database-migration.html#answer-270054" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This example doesn&#39;t show how to migrate ONE column. It uses create table as migration.up and drop table as migration.down</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 24th 2014, 11:17:23 pm">May 24th 2014</span>
											by <span class='authorname'>f fabreti</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
