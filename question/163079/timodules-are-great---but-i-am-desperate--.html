<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Ti.Modules are great - but I am desperate! : / » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Ti.Modules are great - but I am desperate! : /</h1>
		</header>
		<section>
			<p>Hey : &#x2F;</p>
<p>I am trying since 4 days to build a Ti.Module based on this awesome iOS Library &quot;TSMessages&quot;.<br>https:&#x2F;&#x2F;github.com&#x2F;toursprung&#x2F;TSMessages</p>
<p>In my module &quot;.m&quot; file I already created this function: </p>
<pre><code class="hljs">
#<span class="hljs-atom">pragma</span> <span class="hljs-name">Public</span> <span class="hljs-name">APIs</span>

-(<span class="hljs-atom">void</span>)<span class="hljs-atom">showNotification</span>:(<span class="hljs-atom">id</span>) <span class="hljs-atom">args</span>
{
    <span class="hljs-name">ENSURE_SINGLE_ARG</span>(<span class="hljs-atom">args</span>, <span class="hljs-name">NSDictionary</span>);

    [<span class="hljs-name">TSMessage</span> <span class="hljs-atom">showNotificationInViewController</span>:<span class="hljs-atom">self</span>
                                          <span class="hljs-atom">title</span>:[<span class="hljs-name">TiUtils</span> <span class="hljs-atom">stringValue</span>:[<span class="hljs-atom">args</span> <span class="hljs-atom">objectForKey</span>:@<span class="hljs-string">"title"</span>]]
                                       <span class="hljs-atom">subtitle</span>:[<span class="hljs-name">TiUtils</span> <span class="hljs-atom">stringValue</span>:[<span class="hljs-atom">args</span> <span class="hljs-atom">objectForKey</span>:@<span class="hljs-string">"subtitle"</span>]]
                                          <span class="hljs-atom">image</span>:<span class="hljs-atom">nil</span>
                                           <span class="hljs-atom">type</span>:<span class="hljs-name">TSMessageNotificationTypeMessage</span>
                                       <span class="hljs-atom">duration</span>:<span class="hljs-name">TSMessageNotificationDurationAutomatic</span>
                                       <span class="hljs-atom">callback</span>:<span class="hljs-atom">nil</span>
                                    <span class="hljs-atom">buttonTitle</span>:[<span class="hljs-name">TiUtils</span> <span class="hljs-atom">stringValue</span>:[<span class="hljs-atom">args</span> <span class="hljs-atom">objectForKey</span>:@<span class="hljs-string">"buttonTitle"</span>]]
                                 <span class="hljs-atom">buttonCallback</span>:^{
                                     [<span class="hljs-name">TSMessage</span> <span class="hljs-atom">showNotificationWithTitle</span>:[<span class="hljs-name">TiUtils</span> <span class="hljs-atom">stringValue</span>:[<span class="hljs-atom">args</span> <span class="hljs-atom">objectForKey</span>:@<span class="hljs-string">"showNWT"</span>]]
                                                                     <span class="hljs-atom">type</span>:<span class="hljs-name">TSMessageNotificationTypeSuccess</span>];
                                 }
                                     <span class="hljs-atom">atPosition</span>:<span class="hljs-name">TSMessageNotificationPositionTop</span>
                            <span class="hljs-atom">canBeDismisedByUser</span>:<span class="hljs-name">YES</span>];
}
</code></pre><p>Every required class is already imported correctly. But I cannot get this to work? How can I pass the ViewController from JS to my module? </p>
<p>In JS I try this: </p>
<pre><code class="hljs"><span class="hljs-tag">MyModule</span><span class="hljs-class">.showNotification</span>({
    <span class="hljs-attribute">title </span>: <span class="hljs-string">"Example"</span>,
    <span class="hljs-attribute">subtitle </span>: <span class="hljs-string">"It's my first module."</span>,
    <span class="hljs-attribute">buttonTitle </span>: <span class="hljs-string">"It works!"</span>,
    <span class="hljs-attribute">showNWT </span>: <span class="hljs-string">"This is a Ti.Module"</span>
});
</code></pre><p>Please help me. I&#39;ve searched the whole internet and didn&#39;t found after dozens of trying any working solution. Maybe somebody can get this to work? I would be very grateful if somebody also could send here a link to a simple iOS module with a simple view that passed from ObjectiveC to JS. I also tried that and with the proxies and so on but without success!</p>
<p>The official Appcelerator documentation doesn&#39;t worked for me…</p>
<p>Thank you very much!<br>Best regards from Germany</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 1st 2014, 6:13:18 am">March 1st 2014</span>
				by <span class='authorname'>Fotios Botosakis</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>module</span></li>
					
						<li><span class='tagname'>view</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-275821">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi Alex, </p>
<p>to get the viewcontroller you have to pass the window to your module, then cast this ViewProxy object to TiWindowProxy and call the hostingController method, which returns its UIViewController instance.</p>
<pre><code class="hljs">-(<span class="hljs-typename">void</span>)<span class="hljs-string">showNotification:</span>(id) args
{
    ENSURE_SINGLE_ARG(args, NSDictionary);
    TiViewProxy* proxy = [args <span class="hljs-string">objectForKey:</span>@<span class="hljs-string">"window"</span>]    ;
    UIViewController *viewController;
    <span class="hljs-keyword">if</span> ([proxy <span class="hljs-string">isKindOfClass:</span>[TiWindowProxy <span class="hljs-class"><span class="hljs-keyword">class</span>]]) {</span>
        viewController =  [(TiWindowProxy*)proxy hostingController];
    }    
    <span class="hljs-keyword">if</span> (!viewController) {
    NSLog(@<span class="hljs-string">"[INFO] cannot cast window to UIViewController, make sure you have passed a TiUIWindow object"</span>);
    <span class="hljs-keyword">return</span>;
    }

    [TSMessage <span class="hljs-string">showNotificationInViewController:</span>viewController
    ...
</code></pre><p>in js<br>~~~<br>MyModule.showNotification({<br>    title : &quot;Example&quot;,<br>    window:someWin,<br>    subtitle : &quot;It&#39;s my first module.&quot;,<br>    buttonTitle : &quot;It works!&quot;,<br>    showNWT : &quot;This is a Ti.Module&quot;<br>});</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 1st 2014, 8:56:07 am">March 1st 2014</span>
								by <span class='authorname'>Moritz Knecht</span><br>
								<a class="icon-bg icon-link" href="question/163079/timodules-are-great---but-i-am-desperate--#answer-275821" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-275825">
				
						<section>
							<p>Hey Moritz, thanks for your answer. Do I have to create a TiProxy .h and .m file for this? At this time I just generated an empty module and inserted the library into the standard module.m file. </p>
<p>So I don&#39;t need any additional proxy and view classes?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 1st 2014, 12:00:59 pm">March 1st 2014</span>
								by <span class='authorname'>Fotios Botosakis</span><br>
								<a class="icon-bg icon-link" href="question/163079/timodules-are-great---but-i-am-desperate--#answer-275825" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>no i don&#39;t think so. but you have to import the view and windowproxy headers in your module</p>
<pre><code class="hljs"><span class="hljs-id">#import</span> <span class="hljs-string">"TiViewProxy.h"</span>
<span class="hljs-id">#import</span> <span class="hljs-string">"TiWindowProxy.h"</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 1st 2014, 12:32:49 pm">March 1st 2014</span>
											by <span class='authorname'>Moritz Knecht</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-275850">
				
						<section>
							<p>Okay.. now when I start my app after this changes on my Simulator, I got this error:</p>
<pre><code class="hljs"><span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:  Script Error {
[ERROR] :      backtrace = <span class="hljs-string">"#0 () at :0"</span>;</span>
<span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:      line = <span class="hljs-number">245</span>;</span>
<span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:      message = <span class="hljs-string">"data parameter is nil"</span>;</span>
<span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:      sourceId = <span class="hljs-number">361995344</span>;</span>
<span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:      sourceURL = <span class="hljs-string">"file:///Users/alex/Library/Application%20Support/iPhone%20Simulator/7.0.3-64/Applications/DF0B60DE-2770-4830-9069-1843A6E4C666/Sample.app/app.js"</span>;</span>
<span class="hljs-attr_selector">[ERROR]</span> <span class="hljs-value">:  }
[ERROR] :  ErrorController is up. ABORTING open</span>
</code></pre><p>In my app.js file I call my module like this:</p>
<pre><code class="hljs"><span class="hljs-tag">TSMessages</span><span class="hljs-class">.example</span>(<span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">display </span>:<span class="hljs-value"> mainWindow
</span></span></span>});
</code></pre><p>My ModuleTSMessagesModule.m file:</p>
<pre><code class="hljs"><span class="hljs-comment">/**
 * Your Copyright Here
 *
 * Appcelerator Titanium is Copyright (c) 2009-2010 by Appcelerator, Inc.
 * and licensed under the Apache Public License (version 2)
 */</span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"ModuleTSMessagesModule.m"</span></span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"TiBase.h"</span></span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"TiHost.h"</span></span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"TiUtils.h"</span></span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"TiViewProxy.h"</span></span>
<span class="hljs-preprocessor">#import <span class="hljs-title">"TiWindowProxy.h"</span></span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">ModuleTSMessagesModule</span></span>

<span class="hljs-preprocessor">#pragma mark Internal</span>

<span class="hljs-comment">// this is generated for your module, please do not change it</span>
-(<span class="hljs-keyword">id</span>)moduleG<span class="hljs-built_in">UID</span>
{
    <span class="hljs-keyword">return</span> <span class="hljs-string">@"ae84668c-18cd-4864-a3d2-fb73b1f78c21"</span>;
}

<span class="hljs-comment">// this is generated for your module, please do not change it</span>
-(<span class="hljs-built_in">NSString</span>*)moduleId
{
    <span class="hljs-keyword">return</span> <span class="hljs-string">@"module.tsmessages"</span>;
}

<span class="hljs-preprocessor">#pragma mark Lifecycle</span>

-(<span class="hljs-keyword">void</span>)startup
{
    <span class="hljs-comment">// this method is called when the module is first loaded</span>
    <span class="hljs-comment">// you *must* call the superclass</span>
    [<span class="hljs-keyword">super</span> startup];

    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"[INFO] %@ loaded"</span>,<span class="hljs-keyword">self</span>);
}

-(<span class="hljs-keyword">void</span>)shutdown:(<span class="hljs-keyword">id</span>)sender
{
    <span class="hljs-comment">// this method is called when the module is being unloaded</span>
    <span class="hljs-comment">// typically this is during shutdown. make sure you don't do too</span>
    <span class="hljs-comment">// much processing here or the app will be quit forceably</span>

    <span class="hljs-comment">// you *must* call the superclass</span>
    [<span class="hljs-keyword">super</span> shutdown:sender];
}

<span class="hljs-preprocessor">#pragma mark Cleanup </span>

-(<span class="hljs-keyword">void</span>)dealloc
{
    <span class="hljs-comment">// release any resources that have been retained by the module</span>
    [<span class="hljs-keyword">super</span> dealloc];
}

<span class="hljs-preprocessor">#pragma mark Internal Memory Management</span>

-(<span class="hljs-keyword">void</span>)didReceiveMemoryWarning:(<span class="hljs-built_in">NSNotification</span>*)notification
{
    <span class="hljs-comment">// optionally release any resources that can be dynamically</span>
    <span class="hljs-comment">// reloaded once memory is available - such as caches</span>
    [<span class="hljs-keyword">super</span> didReceiveMemoryWarning:notification];
}

<span class="hljs-preprocessor">#pragma mark Listener Notifications</span>

-(<span class="hljs-keyword">void</span>)_listenerAdded:(<span class="hljs-built_in">NSString</span> *)type count:(<span class="hljs-keyword">int</span>)count
{
    <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span> &amp;&amp; [type isEqualToString:<span class="hljs-string">@"my_event"</span>])
    {
        <span class="hljs-comment">// the first (of potentially many) listener is being added </span>
        <span class="hljs-comment">// for event named 'my_event'</span>
    }
}

-(<span class="hljs-keyword">void</span>)_listenerRemoved:(<span class="hljs-built_in">NSString</span> *)type count:(<span class="hljs-keyword">int</span>)count
{
    <span class="hljs-keyword">if</span> (count == <span class="hljs-number">0</span> &amp;&amp; [type isEqualToString:<span class="hljs-string">@"my_event"</span>])
    {
        <span class="hljs-comment">// the last listener called for event named 'my_event' has</span>
        <span class="hljs-comment">// been removed, we can optionally clean up any resources</span>
        <span class="hljs-comment">// since no body is listening at this point for that event</span>
    }
}

<span class="hljs-preprocessor">#pragma Public APIs</span>

-(<span class="hljs-keyword">id</span>)example:(<span class="hljs-keyword">id</span>)args
{
    E<span class="hljs-built_in">NSURE_SINGLE_ARG</span>(args, <span class="hljs-built_in">NSDictionary</span>);

    TiViewProxy* proxy = [args objectForKey:<span class="hljs-string">@"display"</span>];
    <span class="hljs-built_in">UIViewController</span> *viewController;
    <span class="hljs-keyword">if</span> ([proxy isKindOfClass:[TiWindowProxy class]]) {
        viewController =  [(TiWindowProxy*)proxy hostingController];
    }

    <span class="hljs-keyword">if</span> (!viewController) {
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"[INFO] cannot cast window to UIViewController, make sure you have passed a TiUIWindow object"</span>);
        <span class="hljs-keyword">return</span>;
    }

    [TSMessage setDefaultViewController:viewController];
    [TSMessage showNotificationWithTitle:<span class="hljs-string">@"Something"</span>
                                subtitle:<span class="hljs-string">@"This is the subtitle..."</span>
                                    type:TSMessageNotificationTypeWarning];
}

<span class="hljs-keyword">@end</span>
</code></pre><p>What am I a doing wrong?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 2nd 2014, 9:36:41 pm">March 2nd 2014</span>
								by <span class='authorname'>Fotios Botosakis</span><br>
								<a class="icon-bg icon-link" href="question/163079/timodules-are-great---but-i-am-desperate--#answer-275850" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Maybe somebody can send me a working module from TSMessages?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 2nd 2014, 10:15:27 pm">March 2nd 2014</span>
											by <span class='authorname'>Fotios Botosakis</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hey Alex, i don&#39;t have the time to look into details. But after a quick look, i have noticed that the TSMessage Library uses a JSON file to configure. Seems like the reading process of this File fails. You&#39;ll have to modify TSMessages to fit the needs of Titanium Module Assets, or implement your own logic to handle those Style Configuration files. This might be the solution, but the problem also could be a far more complex issue, something memory or thread related.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 3rd 2014, 8:32:16 am">March 3rd 2014</span>
											by <span class='authorname'>Moritz Knecht</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-275820">
				
						<section>
							<p>I know this is not answering your question, but why don&#39;t you make all this in Ti?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 1st 2014, 6:51:34 am">March 1st 2014</span>
								by <span class='authorname'>Dan Tamas</span><br>
								<a class="icon-bg icon-link" href="question/163079/timodules-are-great---but-i-am-desperate--#answer-275820" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Because we plan to use external libraries for iOS that are not available for Appcelerator Titanium - like many ad - and other useful libraries. It&#39;s like an exercise for the future.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2014, 7:00:55 am">March 1st 2014</span>
											by <span class='authorname'>Fotios Botosakis</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Makes sense :)<br>I though you are trying to get only this effect.</p>
<p>I think the best way would be to find modules that are made this way and have a look at them.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2014, 7:14:27 am">March 1st 2014</span>
											by <span class='authorname'>Dan Tamas</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
