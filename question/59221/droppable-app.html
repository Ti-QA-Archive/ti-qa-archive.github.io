<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Droppable app? » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Droppable app?</h1>
		</header>
		<section>
			<p>I can&#39;t find anything about building a droppable app (I&#39;m on Mac but Windows and, I believe, Linux have this capability … I&#39;m not sure it&#39;s applicable for mobile apps).</p>
<p>However, I&#39;m working on a video conversion app. I want to be able to drag a video onto the app then read the path info to convert that file.</p>
<p>Titanium built apps seem to accept the dropped file but I haven&#39;t been able to find the path info of the dropped file.</p>
<p>Thanks, Mike</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 8th 2010, 1:19:17 pm">September 8th 2010</span>
				by <span class='authorname'>Mike Casto</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>desktop</span></li>
					
						<li><span class='tagname'>droppable</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Interesting to see that a &#39;standard&#39; HTML broswer-based droppable area wouldn&#39;t work. Hmm… That&#39;s a shame.</p>
<p>(I too have been looking at doing a conversion tool. I did one a while ago for Windows (but not with Titanium) using ffmpeg.exe bundled in the app)</p>
<p>Recently I&#39;ve been building a Mac based app with some Flash video content in it, but have run up against a (now) known bug where Flash files can be &#39;seen but not heard&#39;. They&#39;re working on a WebKit fix&#x2F;update to address this.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 8th 2011, 4:08:53 pm">March 8th 2011</span>
								by <span class='authorname'>Kosso</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-203881">
				
						<section>
							<p>I figured out a solution. It&#39;s not as neat as I would have liked but it&#39;s functional - at least for Mac desktop apps.</p>
<p>I would prefer a Titanium solution but until I find one this works for now.</p>
<p>There&#39;s a handy little tool called &quot;Platypus&quot; for Mac: http:&#x2F;&#x2F;www.sveinbjorn.org&#x2F;platypus</p>
<p>This allows you to bundle scripts (shell, php, perl, ruby, etc.) as a Mac application.</p>
<p>With Platypus I was able to do the following (I used PHP but any script that Platypus can handle could be used).</p>
<p>I created a Platypus app and made it droppable, run in background, no output and doesn&#39;t remain running after execution. I then dragged my Titanium app to the resources folder.</p>
<p>In the script in Platypus I grabbed the command line arguments (specifically $argv[1] in PHP … the first argument [0] is the Platypus application name) I then called to shell to execute the actual executable within the Titanium app bundle &amp; send it that command line argument.</p>
<p>Reading this it may seem complicated but, honestly, I think it took me longer to write this post than it did to build the Platypus bundle with my Titanium app.</p>
<p>I built a proof of concept that you can download here: http:&#x2F;&#x2F;castoware.com&#x2F;dropTest.zip</p>
<p>Unzip &amp; drag a file to the app (it has the default Platypus icon). First time you do this you&#39;ll have some of the standard first run things (i.e.: This was downloaded, are you sure you want to run it?). Also the Titanium Installer will likely run.</p>
<p>All this app does is display a popup (javascript alert, specifically) of the command line argument (i.e.: the path &amp; filename of the file you dragged to the app).</p>
<p>Once you have that file info, though, you can do whatever you want with it in your Titanium app. I&#39;m going to use this method, for instance, to put together an app that I can drag a video file to &amp; the app ask for details (used in metadata) then convert that video file to an FLV file (with included metadata) that I can then upload to my website.</p>
<p>Obviously, you can dig around in the app package and look at all the code. There&#39;s nothing real amazing or surprising.</p>
<p>As I said, I would prefer a Titanium only solution for this but this will suffice for the time being.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 8th 2011, 1:31:43 pm">March 8th 2011</span>
								by <span class='authorname'>Mike Casto</span><br>
								<a class="icon-bg icon-link" href="question/59221/droppable-app#answer-203881" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-203888">
				
						<section>
							<p>This should be possible.</p>
<p>I just tried it with a simple form text field (so it should be possible using other &#39;standard&#39; html browser-based drag and drop solutions.)</p>
<p>Add this text field (for example) to a test app:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'text'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">'file'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">'file'</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">'width:100px;height:50px;'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre><p>then drag a file in to it. You&#39;ll see that when you do, you get the file path. You could then add an onChange listener to this to tell the app code where the file is.</p>
<p>hth.<br>Kosso</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 8th 2011, 4:16:24 pm">March 8th 2011</span>
								by <span class='authorname'>Kosso</span><br>
								<a class="icon-bg icon-link" href="question/59221/droppable-app#answer-203888" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Yup. That would work but it&#39;s not what I&#39;m actually after. In my specific application I want to be able to drag a video file to the icon for the app (the app isn&#39;t running yet). When I drop the file on the app icon the app opens &amp; processes the file that was dropped on the icon.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 8th 2011, 9:07:51 pm">March 8th 2011</span>
											by <span class='authorname'>Mike Casto</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-238797">
				
						<section>
							<p>after playing around for many hours I found that the problem on windows is that the dataTransfer.effectAllowed property is read only meaning that you cannot set it to &quot;copy&quot; or &quot;all&quot; to indicate that you can drop files. So I have produced a work around by storing the files you are going to drop on the ondragenter event and then detecting the drop in the onmouseover event instead. The end result is that we can detect a drop of files and get hold of all of the file information. Here is a full file that will work on windows (developed using studio 2.0).</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Drag and Drop in Titanium Desktop!<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">style</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/css"</span>&gt;</span><span class="css">
        <span class="hljs-id">#holder</span>
        <span class="hljs-rules">{
            <span class="hljs-rule"><span class="hljs-attribute">border</span>:<span class="hljs-value"> <span class="hljs-number">10px</span> dashed <span class="hljs-hexcolor">#ccc</span></span></span>;
            <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">300px</span></span></span>;
            <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">300px</span></span></span>;
            <span class="hljs-rule"><span class="hljs-attribute">margin</span>:<span class="hljs-value"> <span class="hljs-number">20px</span> auto</span></span>;
        }</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-title">style</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">/**
         * bug fix since dataTransfer.effectAllowed seems to be read only.
         * Therefore have to "steal" data from the drag enter event and then detect a drop. 
         */</span>
        <span class="hljs-keyword">var</span> acceptDrop = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">var</span> acceptFiles =[];
        <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> div = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'holder'</span>);
            div.ondragenter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                acceptDrop = <span class="hljs-literal">true</span>;
                <span class="hljs-comment">//acceptFiles = e.dataTransfer.files;</span>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; e.dataTransfer.files.length; i++) { <span class="hljs-comment">// e.dataTransfer is a DataTransfer object (https://developer.mozilla.org/En/DragDrop/DataTransfer), e.dataTransfer.files is a FileList object (https://developer.mozilla.org/en/DOM/FileList)</span>
                       <span class="hljs-keyword">var</span> file = e.dataTransfer.files[i]; 
                       <span class="hljs-keyword">var</span> fileInfoCopy = {};
                       <span class="hljs-keyword">for</span>(f <span class="hljs-keyword">in</span> file) {
                           fileInfoCopy[f] = file[f];
                    }
                    acceptFiles.push(fileInfoCopy);
                   }
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            div.onmouseout = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
                <span class="hljs-comment">//cancel drop since left the div</span>
                acceptDrop = <span class="hljs-literal">false</span>;          
            }
            div.onmouseover = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
                <span class="hljs-keyword">if</span> (acceptDrop) {
                    acceptDrop = <span class="hljs-literal">false</span>;
                    <span class="hljs-comment">//once you let go of the dragged files then this event is triggered.</span>
                    <span class="hljs-comment">//so handle as if it was the ondrop.</span>
                    <span class="hljs-keyword">var</span> out = [];
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; acceptFiles.length; i++) { <span class="hljs-comment">// e.dataTransfer is a DataTransfer object (https://developer.mozilla.org/En/DragDrop/DataTransfer), e.dataTransfer.files is a FileList object (https://developer.mozilla.org/en/DOM/FileList)</span>
                        <span class="hljs-keyword">var</span> file = acceptFiles[i]; <span class="hljs-comment">// file is a File object (https://developer.mozilla.org/en/DOM/File)</span>

                        <span class="hljs-keyword">for</span>(f <span class="hljs-keyword">in</span> file) {
                            out.push(f+<span class="hljs-string">"="</span>+file[f]+<span class="hljs-string">"&lt;br/&gt;"</span>);
                        }
                        out.push(<span class="hljs-string">"====="</span>);
                        <span class="hljs-comment">//var tiFile = Titanium.Filesystem.getFile(file.path);</span>
                        <span class="hljs-comment">// log the browser file</span>
                        <span class="hljs-comment">//console.log(file);</span>
                        <span class="hljs-comment">// log the Titanium wrapped version of this file, and that it exists</span>
                        <span class="hljs-comment">//console.log(tiFile, tiFile.exists());</span>
                        <span class="hljs-comment">// log the contents of the file, with '' appended to force the blob to convert to a string</span>
                        <span class="hljs-comment">//console.log(tiFile.read() + '');</span>
                    }
                    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'debug'</span>).innerHTML = out.join(<span class="hljs-string">''</span>);
                }
            }
            div.ondragover = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
                <span class="hljs-comment">//e.preventDefault();</span>
                <span class="hljs-comment">//e.dataTransfer.effectAllowed ='all';</span>
                <span class="hljs-comment">//console.info('dragover:'+e.dataTransfer.effectAllowed);</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            div.ondrop = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
                <span class="hljs-keyword">var</span> out = [];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; e.dataTransfer.files.length; i++) { <span class="hljs-comment">// e.dataTransfer is a DataTransfer object (https://developer.mozilla.org/En/DragDrop/DataTransfer), e.dataTransfer.files is a FileList object (https://developer.mozilla.org/en/DOM/FileList)</span>
                    <span class="hljs-keyword">var</span> file = e.dataTransfer.files[i]; <span class="hljs-comment">// file is a File object (https://developer.mozilla.org/en/DOM/File)</span>

                    <span class="hljs-keyword">var</span> tiFile = Titanium.Filesystem.getFile(file.path);
                    <span class="hljs-keyword">for</span>(f <span class="hljs-keyword">in</span> file) {
                        out.push(f+<span class="hljs-string">"="</span>+file[f]+<span class="hljs-string">"&lt;br/&gt;"</span>);
                    }
                    out.push(<span class="hljs-string">"====="</span>);
                    <span class="hljs-comment">// log the browser file</span>
                    <span class="hljs-comment">//console.log(file);</span>
                    <span class="hljs-comment">// log the Titanium wrapped version of this file, and that it exists</span>
                    <span class="hljs-comment">//console.log(tiFile, tiFile.exists());</span>
                    <span class="hljs-comment">// log the contents of the file, with '' appended to force the blob to convert to a string</span>
                    <span class="hljs-comment">//console.log(tiFile.read() + '');</span>
                }
                <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'debug'</span>).innerHTML = out.join(<span class="hljs-string">''</span>);
                e.preventDefault();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"holder"</span>&gt;</span>
        Drop files here<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"debug"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 16th 2012, 7:01:33 pm">May 16th 2012</span>
								by <span class='authorname'>si test</span><br>
								<a class="icon-bg icon-link" href="question/59221/droppable-app#answer-238797" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
