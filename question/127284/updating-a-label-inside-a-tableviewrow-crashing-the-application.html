<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Updating a label inside a tableViewRow, crashing the application Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Updating a label inside a tableViewRow, crashing the application</h1>
		</header>
		<section>
			<p>I developed an application with 1.7.2 and later 1.7.3 (for iPhone) which worked great. I then found out that Facebook didn&#39;t work with either of these SDK&#39;s so I downloaded the latest 1.8. And now my application crashes at one point when I&#39;m trying to update a label inside a tableViewRow, it both crash sometimes and sometimes it just behave strange, deleting all content in the wrong tableViewRow for example.</p>
<p>Maybe I can write this code in another way to make it work? The problem is that I need to be able to delete rows at the same time I have text inputs on each row as well.</p>
<p>I&#39;ve done a clean project here to demonstrate my problem.</p>
<p>app.js - http:&#x2F;&#x2F;pastebin.com&#x2F;hjcHsJ4C</p>
<p>window1.js - http:&#x2F;&#x2F;pastebin.com&#x2F;Q6vJ41kx</p>
<p>It&#39;s row 72 in window1.js that creates the problem, if I uncomment that row the application won&#39;t crash or behave strange. But it ofc doesn&#39;t update the label either.</p>
<p>This problem didn&#39;t exist in 1.7.2 or 1.7.3 afaik. </p>
<p>I&#39;m using iOS SDK 5.0, but it&#39;s the same problem if I use iOS SDK 4.3</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 24th 2011, 6:02:59 am">October 24th 2011</span>
				by <span class='authorname'>Ted Sundin</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>1.8, iphone, crash,</span></li>
					
				</ul>
			

			<section>
				<h5>7 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you confirm that you are receiving the IDs you would expect in the affected event handler (<code>blur</code>) and that the ID is within the range of the <code>priceTotal</code> array?</p>
<p>You can just use TI.API.debug() to get the values in the handler. It would be interesting to know what those values are before one of your failures.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 10:46:44 am">October 24th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Yes I&#39;m recieving the expected IDs in the blur event handler for example.</p>
<p>The thing is if I just change the values my text inputs, after a while one of the rows will go totally blank, all labels and everything will vanish. If I then delete one row and edit another the application will crash with this message:</p>
<pre><code class="hljs"><span class="hljs-number">2011</span>-<span class="hljs-number">10</span>-<span class="hljs-number">24</span> <span class="hljs-number">14</span>:<span class="hljs-number">50</span>:<span class="hljs-number">46.573</span> MyApplication1<span class="hljs-string">.0</span>[<span class="hljs-number">62937</span>:<span class="hljs-number">17903</span>] *** Assertion failure <span class="hljs-keyword">in</span> -[_UITableViewUpdateSupport _computeRowUpdates], /SourceCache/UIKit_Sim/UIKit-<span class="hljs-number">1912.3</span>/UITableViewSupport.m:<span class="hljs-number">386</span>

[ERROR] The application has crashed with an unhandled exception. Stack trace:



<span class="hljs-number">0</span>   CoreFoundation                      <span class="hljs-number">0x02e60052</span> __exceptionPreprocess + <span class="hljs-number">178</span>

<span class="hljs-number">1</span>   libobjc.A.dylib                     <span class="hljs-number">0x02c80d0a</span> objc_exception_throw + <span class="hljs-number">44</span>

<span class="hljs-number">2</span>   CoreFoundation                      <span class="hljs-number">0x02e08a78</span> +[NSException raise:format:arguments:] + <span class="hljs-number">136</span>

<span class="hljs-number">3</span>   Foundation                          <span class="hljs-number">0x009492db</span> -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + <span class="hljs-number">116</span>

<span class="hljs-number">4</span>   UIKit                               <span class="hljs-number">0x00e6bb49</span> -[_UITableViewUpdateSupport(Private) _computeRowUpdates] + <span class="hljs-number">1038</span>

<span class="hljs-number">5</span>   UIKit                               <span class="hljs-number">0x00e790e3</span> -[_UITableViewUpdateSupport initWithTableView:updateItems:oldRowData:newRowData:oldRowRange:newRowRange:context:] + <span class="hljs-number">379</span>

<span class="hljs-number">6</span>   UIKit                               <span class="hljs-number">0x00c92e3a</span> -[UITableView(_UITableViewPrivate) _endCellAnimationsWithContext:] + <span class="hljs-number">7242</span>

<span class="hljs-number">7</span>   UIKit                               <span class="hljs-number">0x00c9e82a</span> -[UITableView _updateRowsAtIndexPaths:updateAction:withRowAnimation:] + <span class="hljs-number">295</span>

<span class="hljs-number">8</span>   UIKit                               <span class="hljs-number">0x00c9e8ec</span> -[UITableView reloadRowsAtIndexPaths:withRowAnimation:] + <span class="hljs-number">66</span>

<span class="hljs-number">9</span>   MyApplication1<span class="hljs-string">.0</span>                     <span class="hljs-number">0x0009e5f1</span> -[TiUITableView dispatchAction:] + <span class="hljs-number">657</span>

<span class="hljs-number">10</span>  MyApplication1<span class="hljs-string">.0</span>                     <span class="hljs-number">0x001359a1</span> -[TiUITableViewRowProxy updateRow:] + <span class="hljs-number">113</span>

<span class="hljs-number">11</span>  CoreFoundation                      <span class="hljs-number">0x02e61e72</span> -[NSObject performSelector:withObject:] + <span class="hljs-number">66</span>

<span class="hljs-number">12</span>  Foundation                          <span class="hljs-number">0x008d89ef</span> __NSThreadPerformPerform + <span class="hljs-number">254</span>

<span class="hljs-number">13</span>  CoreFoundation                      <span class="hljs-number">0x02e3497f</span> __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + <span class="hljs-number">15</span>

<span class="hljs-number">14</span>  CoreFoundation                      <span class="hljs-number">0x02d97b73</span> __CFRunLoopDoSources0 + <span class="hljs-number">243</span>

<span class="hljs-number">15</span>  CoreFoundation                      <span class="hljs-number">0x02d97454</span> __CFRunLoopRun + <span class="hljs-number">1012</span>

<span class="hljs-number">16</span>  CoreFoundation                      <span class="hljs-number">0x02d96db4</span> CFRunLoopRunSpecific + <span class="hljs-number">212</span>

<span class="hljs-number">17</span>  CoreFoundation                      <span class="hljs-number">0x02d96ccb</span> CFRunLoopRunInMode + <span class="hljs-number">123</span>

<span class="hljs-number">18</span>  GraphicsServices                    <span class="hljs-number">0x02abf879</span> GSEventRunModal + <span class="hljs-number">207</span>

<span class="hljs-number">19</span>  GraphicsServices                    <span class="hljs-number">0x02abf93e</span> GSEventRun + <span class="hljs-number">114</span>

<span class="hljs-number">20</span>  UIKit                               <span class="hljs-number">0x00c0fa9b</span> UIApplicationMain + <span class="hljs-number">1175</span>

<span class="hljs-number">21</span>  MyApplication1<span class="hljs-string">.0</span>                     <span class="hljs-number">0x0000452a</span> main + <span class="hljs-number">442</span>

<span class="hljs-number">22</span>  MyApplication1<span class="hljs-string">.0</span>                     <span class="hljs-number">0x00002f15</span> start + <span class="hljs-number">53</span>


<span class="hljs-number">2011</span>-<span class="hljs-number">10</span>-<span class="hljs-number">24</span> <span class="hljs-number">14</span>:<span class="hljs-number">50</span>:<span class="hljs-number">46.659</span> MyApplication1<span class="hljs-string">.0</span>[<span class="hljs-number">62937</span>:<span class="hljs-number">17903</span>] *** Terminating app due to uncaught exception <span class="hljs-string">'NSInternalInconsistencyException'</span>, reason: <span class="hljs-string">'Invalid table view update.  The application has requested an update to the table view that is inconsistent with the state provided by the data source.'</span>

*** First throw <span class="hljs-keyword">call</span> stack:

(<span class="hljs-number">0x2e60052</span> <span class="hljs-number">0x2c80d0a</span> <span class="hljs-number">0x2e08a78</span> <span class="hljs-number">0x9492db</span> <span class="hljs-number">0xe6bb49</span> <span class="hljs-number">0xe790e3</span> <span class="hljs-number">0xc92e3a</span> <span class="hljs-number">0xc9e82a</span> <span class="hljs-number">0xc9e8ec</span> <span class="hljs-number">0x9e5f1</span> <span class="hljs-number">0x1359a1</span> <span class="hljs-number">0x2e61e72</span> <span class="hljs-number">0x8d89ef</span> <span class="hljs-number">0x2e3497f</span> <span class="hljs-number">0x2d97b73</span> <span class="hljs-number">0x2d97454</span> <span class="hljs-number">0x2d96db4</span> <span class="hljs-number">0x2d96ccb</span> <span class="hljs-number">0x2abf879</span> <span class="hljs-number">0x2abf93e</span> <span class="hljs-number">0xc0fa9b</span> <span class="hljs-number">0x452a</span> <span class="hljs-number">0x2f15</span>)

terminate called throwing an exception
[DEBUG] App Spec: &lt;DTiPhoneSimulatorApplicationSpecifier <span class="hljs-number">0x100402190</span>&gt; specified by path /Users/Ted/Documents/Titanium Studio Workspace/MyApplication1<span class="hljs-string">.0</span>/build/iphone/build/Debug-iphonesimulator/MyApplication1<span class="hljs-string">.0</span>.app
[DEBUG] SDK Root: &lt;DTiPhoneSimulatorSystemRoot <span class="hljs-number">0x100401230</span>&gt; path=/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5<span class="hljs-string">.0</span>.sdk version=<span class="hljs-number">5.0</span> name=Simulator - iOS <span class="hljs-number">5.0</span>
[DEBUG] using device family iphone
[DEBUG] Session started
[DEBUG] Session did end with error (null)
[INFO] Application has exited from Simulator
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 10:55:59 am">October 24th 2011</span>
								by <span class='authorname'>Ted Sundin</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>The error and behavior sounds like there&#39;s an indexing issue of some kind, like the indexes you are using in the event handler aren&#39;t of the some range as the row you are handling. Would it be possible for you to create a small app.js that can reproduce this issue? That way I can test it and we can rule out any other app logic that might be complicating this issue.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 11:01:38 am">October 24th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hmm maybe it is an indexing problem after all when it crashes. I tried SDK 1.7.2 again and it crashes if I remove a row and then update another row (first or last row).</p>
<p>But with 1.8 SDK I get another problem as described above, it deletes all contents in the row above when I update a row.</p>
<p>Anyway I have created a simple app.js that demonstrates this:<br>Can be found here at pastebin: http:&#x2F;&#x2F;pastebin.com&#x2F;Q6vJ41kx</p>
<p>Please try the latest 1.8 SDK as well to see what my other problem is.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 11:15:44 am">October 24th 2011</span>
								by <span class='authorname'>Ted Sundin</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ted, I was able to replicate your issue with the lastest 1.8.0, but some of the prior ones did not exhibit the issue. You have to understand that the 1.8.0 CI builds are the bleeding edge and are going to have regressions until the code is locked for a release, which has not yet occurred. If you must use the 1.8.0 builds, try using an earlier version.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 11:47:03 am">October 24th 2011</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Okey, the thing was that the earlier 1.8.0 CI builds didn&#39;t have the Facebook fix in them, couldn&#39;t post to facebook in them without an error. Maybe the new 1.7.4 does though?</p>
<p>But is it an index problem when you delete a row and then change the first&#x2F;last row again and it crashes? I got that in 1.7.2 also.<br>Even though imo the indexes works as expected.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2011, 12:45:28 pm">October 24th 2011</span>
								by <span class='authorname'>Ted Sundin</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Ted,</p>
<p>Did you managed to resolve this issue?</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 17th 2012, 11:37:47 pm">February 17th 2012</span>
								by <span class='authorname'>Shamsul Azhar Ahmad Shamsuddin</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
