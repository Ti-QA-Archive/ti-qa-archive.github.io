<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>get XML from webview Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>get XML from webview</h1>
		</header>
		<section>
			<p>Is it possible to retrieve XML data from the WebView object (iOS and Android)? Tried to get the data with getHtml() method, but it returns empty string. There is no direct link to the XML file, it is generated dynamically on server side as a response from submitted form.</p>
<p>I&#39;m using Titanium SDK 3.1.0.GA</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 14th 2013, 9:50:00 am">August 14th 2013</span>
				by <span class='authorname'>Arnis Lielturks</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>webview</span></li>
					
						<li><span class='tagname'>xml</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-267215">
				
						<section>
							<p>I ask me why you are using a webview. Try to use a http client and convert the xml data to json with David Bankiers <a href="https:&#x2F;&#x2F;github.com&#x2F;dbankier&#x2F;XMLTools-For-Appcelerator-Titanium">XMLTool</a>. It is all.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 14th 2013, 10:00:28 am">August 14th 2013</span>
								by <span class='authorname'>Rainer Schleevoigt</span><br>
								<a class="icon-bg icon-link" href="question/155982/get-xml-from-webview#answer-267215" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Because the web page that I&#39;m opening in webview is very complex and cannot be opened trough http client object. The user have to go trough few steps to sucessfully get to the xml page.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 14th 2013, 11:21:15 am">August 14th 2013</span>
											by <span class='authorname'>Arnis Lielturks</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-267220">
				
						<section>
							<p>Found the solution myself!</p>
<pre><code class="hljs"><span class="hljs-built_in">var</span> webview = Ti<span class="hljs-built_in">.</span>UI<span class="hljs-built_in">.</span>createWebView({
        url:<span class="hljs-string">'someUrlToOpen'</span>,
    });
    <span class="hljs-built_in">self</span><span class="hljs-built_in">.</span>add(webview);
</code></pre><p>The url opens a login page. Login page include simple login (username field and password field) and also allows me to login with facebook, twitter, etc. Because of the SSO mechanisms I cannot use http client element for login and retrieving XML data.</p>
<p>The XML file that I want to acces looks like this</p>
<pre><code class="hljs"><span class="hljs-pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">MobileCookieResponse</span> <span class="hljs-attribute">xmlns:xsd</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">Status</span>&gt;</span>OK<span class="hljs-tag">&lt;/<span class="hljs-title">Status</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">Cookies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">MobileCookie</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Name</span>&gt;</span>.ASPXAUTHPublicToken<span class="hljs-tag">&lt;/<span class="hljs-title">Name</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Value</span>&gt;</span>sajdlkjkl21j3lk21j3lk12jelkdji2je128312391rufosakjjdkfy3902pi2rklqjfehrn32ru09327br0fuew0<span class="hljs-tag">&lt;/<span class="hljs-title">Value</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Domain</span>&gt;</span>some.site.com<span class="hljs-tag">&lt;/<span class="hljs-title">Domain</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Path</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-title">Path</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">HttpOnly</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">HttpOnly</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Secure</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">Secure</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">MobileCookie</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">MobileCookie</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Name</span>&gt;</span>ASP.NET_SessionIdForUser<span class="hljs-tag">&lt;/<span class="hljs-title">Name</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Value</span>&gt;</span>j3j21k321l312ljk321lkj3ljk2l1jk3l2jk1<span class="hljs-tag">&lt;/<span class="hljs-title">Value</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Domain</span>&gt;</span>some.site.com<span class="hljs-tag">&lt;/<span class="hljs-title">Domain</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Path</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-title">Path</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">HttpOnly</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">HttpOnly</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">Secure</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">Secure</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">MobileCookie</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">Cookies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">MobileCookieResponse</span>&gt;</span>
</code></pre><p>To obtain this XML file I used setInterval method to check if the webview has the XML document in it. When the user is succesfully loged in, the function retrieves the xml file and stops the setInterval function for further execution. Of course you can modify this function to check whether the obtained xml file is valid etc.</p>
<pre><code class="hljs">var interval = setInterval<span class="hljs-list">(<span class="hljs-keyword">function</span><span class="hljs-list">(<span class="hljs-keyword">e</span>)</span> {
            var evalJS = <span class="hljs-quoted">'((document.getElementsByTagName(<span class="hljs-string">"MobileCookieResponse"</span>).length != <span class="hljs-number">0</span>) ? (new XMLSerializer()).serializeToString(document.getElementsByTagName(<span class="hljs-string">"MobileCookieResponse"</span>)[<span class="hljs-number">0</span>]) : <span class="hljs-string">"empty"</span>)</span>'<span class="hljs-comment">;</span>

            var xml = webview.evalJS<span class="hljs-list">(<span class="hljs-keyword">evalJS</span>)</span><span class="hljs-comment">;</span>
            if<span class="hljs-list">(<span class="hljs-keyword">xml</span> != <span class="hljs-quoted">'empty</span>' <span class="hljs-keyword">&amp;&amp;</span> xml != null)</span> {
                clearInterval<span class="hljs-list">(<span class="hljs-keyword">interval</span>)</span><span class="hljs-comment">;</span>
            }

        // }
    }, <span class="hljs-number">1000</span>)</span><span class="hljs-comment">;</span>
</code></pre><p>Hope this will be useful for someone.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 14th 2013, 11:34:32 am">August 14th 2013</span>
								by <span class='authorname'>Arnis Lielturks</span><br>
								<a class="icon-bg icon-link" href="question/155982/get-xml-from-webview#answer-267220" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
