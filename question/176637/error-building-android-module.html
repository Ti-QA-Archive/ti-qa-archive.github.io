<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Error Building Android Module » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Error Building Android Module</h1>
		</header>
		<section>
			<p>I&#39;m trying to extend the android WebView so I can enable file dialogs.  Here&#39;s my Proxy class.</p>
<pre><code class="hljs"><span class="hljs-comment">/**
 * This file was auto-generated by the Titanium Module SDK helper for Android
 * Appcelerator Titanium Mobile
 * Copyright (c) 2009-2010 by Appcelerator, Inc. All Rights Reserved.
 * Licensed under the terms of the Apache Public License
 * Please see the LICENSE included with this distribution for details.
 *
 */</span>
package com.liveon.android;

<span class="hljs-keyword">import</span> org.appcelerator.kroll.KrollDict;
<span class="hljs-keyword">import</span> org.appcelerator.kroll.KrollProxy;
<span class="hljs-keyword">import</span> org.appcelerator.kroll.annotations.Kroll;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.*;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.util.Log;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.util.TiConfig;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.util.TiConvert;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.proxy.TiViewProxy;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.view.TiCompositeLayout;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.view.TiCompositeLayout.LayoutArrangement;
<span class="hljs-keyword">import</span> org.appcelerator.titanium.view.TiUIView;
<span class="hljs-keyword">import</span> ti.modules.titanium.ui.widget.webview.*;
<span class="hljs-keyword">import</span> ti.modules.titanium.ui.WebViewProxy;
<span class="hljs-keyword">import</span> android.webkit.*;
<span class="hljs-keyword">import</span> android.net.*;
<span class="hljs-keyword">import</span> android.content.Intent;

<span class="hljs-keyword">import</span> android.app.*;


<span class="hljs-comment">// This proxy can be created by calling LiveonAndroid.createExample({message: "hello world"})</span>
@<span class="hljs-type">Kroll</span>.proxy(creatableInModule=<span class="hljs-type">LiveonAndroidModule</span>.<span class="hljs-keyword">class</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTML5WebViewProxy</span> <span class="hljs-title">extends</span> <span class="hljs-title">WebViewProxy</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-type">TAG</span> = <span class="hljs-string">"HTML5WebViewProxy"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-type">HTML5WebViewProxy</span>() {
        <span class="hljs-keyword">super</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">HTML5WebViewProxy</span>(<span class="hljs-type">TiContext</span> context)
    {
        this();
    }

    @<span class="hljs-type">Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">TiUIView</span> createView(<span class="hljs-keyword">final</span> <span class="hljs-type">Activity</span> activity)
    {
        <span class="hljs-type">TiUIWebView</span> view = (<span class="hljs-type">TiUIWebView</span>) <span class="hljs-keyword">super</span>.createView(activity);
        <span class="hljs-type">WebView</span> webView = view.getWebView();
         webView.setWebChromeClient(new <span class="hljs-type">WebChromeClient</span>() {

             <span class="hljs-keyword">public</span> void openFileChooser(<span class="hljs-type">ValueCallback</span>&lt;<span class="hljs-type">Uri</span>&gt; uploadMsg, <span class="hljs-type">String</span> acceptType)  
            {  

                <span class="hljs-type">Intent</span> i = new <span class="hljs-type">Intent</span>(<span class="hljs-type">Intent</span>.<span class="hljs-type">ACTION_GET_CONTENT</span>);  
                i.addCategory(<span class="hljs-type">Intent</span>.<span class="hljs-type">CATEGORY_OPENABLE</span>);  
                i.setType(<span class="hljs-string">"image/*"</span>);  
                activity.startActivityForResult( <span class="hljs-type">Intent</span>.createChooser( i, <span class="hljs-string">"File Chooser"</span> ), <span class="hljs-number">1</span> );  
            }

            <span class="hljs-comment">// For Android &lt; 3.0</span>
            <span class="hljs-keyword">public</span> void openFileChooser( <span class="hljs-type">ValueCallback</span>&lt;<span class="hljs-type">Uri</span>&gt; uploadMsg ) 
            {
                openFileChooser( uploadMsg, <span class="hljs-string">""</span> );
            }


        });
        <span class="hljs-keyword">return</span> view;
    }



}
</code></pre><p>When I try to build I get this error.</p>
<pre><code class="hljs"><span class="hljs-label">ndk.build</span>:
     [copy] Copying <span class="hljs-number">11</span> files to /var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated
</span>     [exec] <span class="hljs-keyword">Android </span>NDK: WARNING:jni/<span class="hljs-keyword">Android.mk:com.liveon.android: </span>non-system libraries in linker flags: -lkroll-<span class="hljs-literal">v8</span>    
     [exec] <span class="hljs-keyword">Android </span>NDK:     This is likely to result in incorrect <span class="hljs-keyword">builds. </span>Try using LOCAL_STATIC_LIBRARIES    
     [exec] <span class="hljs-keyword">Android </span>NDK:     or LOCAL_SHARED_LIBRARIES instead to list the library dependencies of the    
     [exec] <span class="hljs-keyword">Android </span>NDK:     current module    
     [exec] jni/<span class="hljs-keyword">Android.mk:35: </span>warning: overriding commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/KrollGeneratedBindings.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:35: </span>warning: ignoring old commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/KrollGeneratedBindings.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:38: </span>warning: overriding commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/BootstrapJS.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:38: </span>warning: ignoring old commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/BootstrapJS.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:35: </span>warning: overriding commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/KrollGeneratedBindings.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:35: </span>warning: ignoring old commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/KrollGeneratedBindings.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:38: </span>warning: overriding commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/BootstrapJS.cpp'
</span>     [exec] jni/<span class="hljs-keyword">Android.mk:38: </span>warning: ignoring old commands for target `/private/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T/<span class="hljs-keyword">bgkittrell/liveon-android-generated/BootstrapJS.cpp'
</span>     [exec] <span class="hljs-keyword">Android </span>NDK: WARNING:jni/<span class="hljs-keyword">Android.mk:com.liveon.android: </span>non-system libraries in linker flags: -lkroll-<span class="hljs-literal">v8</span>    
     [exec] <span class="hljs-keyword">Android </span>NDK:     This is likely to result in incorrect <span class="hljs-keyword">builds. </span>Try using LOCAL_STATIC_LIBRARIES    
     [exec] <span class="hljs-keyword">Android </span>NDK:     or LOCAL_SHARED_LIBRARIES instead to list the library dependencies of the    
     [exec] <span class="hljs-keyword">Android </span>NDK:     current module    
     [exec] <span class="hljs-keyword">Android </span>NDK: WARNING:jni/<span class="hljs-keyword">Android.mk:com.liveon.android: </span>non-system libraries in linker flags: -lkroll-<span class="hljs-literal">v8</span>    
     [exec] <span class="hljs-keyword">Android </span>NDK:     This is likely to result in incorrect <span class="hljs-keyword">builds. </span>Try using LOCAL_STATIC_LIBRARIES    
     [exec] <span class="hljs-keyword">Android </span>NDK:     or LOCAL_SHARED_LIBRARIES instead to list the library dependencies of the    
     [exec] <span class="hljs-keyword">Android </span>NDK:     current module    
     [exec] [armeabi] Compile++ <span class="hljs-preprocessor">thumb</span>: com.liveon.<span class="hljs-keyword">android </span>&lt;= com.liveon.<span class="hljs-keyword">android.HTML5WebViewProxy.cpp
</span>     [exec] jni/com.liveon.<span class="hljs-keyword">android.HTML5WebViewProxy.cpp: </span>In static member <span class="hljs-preprocessor">function</span> <span class="hljs-string">'static void com::liveon::android::liveonandroid::HTML5WebViewProxy::dispose()'</span>:
     [exec] jni/com.liveon.<span class="hljs-keyword">android.HTML5WebViewProxy.cpp:62:2: </span>error: <span class="hljs-string">'WebViewProxy'</span> has not <span class="hljs-keyword">been </span>declared
     [exec] jni/com.liveon.<span class="hljs-keyword">android.HTML5WebViewProxy.cpp: </span>In static member <span class="hljs-preprocessor">function</span> <span class="hljs-string">'static v8::Handle&lt;v8::FunctionTemplate&gt; com::liveon::android::liveonandroid::HTML5WebViewProxy::getProxyTemplate()'</span>:
     [exec] jni/com.liveon.<span class="hljs-keyword">android.HTML5WebViewProxy.cpp:80:3: </span>error: <span class="hljs-string">'WebViewProxy'</span> has not <span class="hljs-keyword">been </span>declared
     [exec] make: *** [/var/folders/<span class="hljs-literal">r3</span>/dhhfjncx3g9_bt_9qrwcctj80000gn/T//<span class="hljs-keyword">bgkittrell/liveon-android-generated/obj/local/armeabi/objs/com.liveon.android/com.liveon.android.HTML5WebViewProxy.o] </span>Error <span class="hljs-number">1</span>

<span class="hljs-keyword">BUILD </span>FAILED
/Users/<span class="hljs-keyword">bgkittrell/Library/Application </span>Support/Titanium/mobilesdk/osx/<span class="hljs-number">3</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.GA/module/<span class="hljs-keyword">android/build.xml:326: </span>The following error occurred <span class="hljs-preprocessor">while</span> executing this line:
/Users/<span class="hljs-keyword">bgkittrell/Library/Application </span>Support/Titanium/mobilesdk/osx/<span class="hljs-number">3</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.GA/module/<span class="hljs-keyword">android/build.xml:281: </span>exec returned: <span class="hljs-number">2</span>
</code></pre><p>I don&#39;t know enough C++ to debug this.  Any thoughts would be very helpful.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 30th 2014, 1:35:14 pm">July 30th 2014</span>
				by <span class='authorname'>Ben Kittrell</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>module</span></li>
					
						<li><span class='tagname'>proxy</span></li>
					
						<li><span class='tagname'>webview</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Here&#39;s the generated cpp</p>
<pre><code class="hljs"><span class="hljs-comment">/**
 * Appcelerator Titanium Mobile
 * Copyright (c) 2011-2013 by Appcelerator, Inc. All Rights Reserved.
 * Licensed under the terms of the Apache Public License
 * Please see the LICENSE included with this distribution for details.
 */</span>

<span class="hljs-comment">/** This code is generated, do not edit by hand. **/</span>

<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"com.liveon.android.HTML5WebViewProxy.h"</span></span>

<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"AndroidUtil.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"EventEmitter.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"JNIUtil.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"JSException.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Proxy.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ProxyFactory.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"TypeConverter.h"</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"V8Util.h"</span></span>


<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ti.modules.titanium.ui.WebViewProxy.h"</span></span>

<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> TAG <span class="hljs-string">"HTML5WebViewProxy"</span></span>

<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> v8;

        <span class="hljs-keyword">namespace</span> com {
        <span class="hljs-keyword">namespace</span> liveon {
        <span class="hljs-keyword">namespace</span> android {
            <span class="hljs-keyword">namespace</span> liveonandroid {


Persistent&lt;FunctionTemplate&gt; HTML5WebViewProxy::proxyTemplate = Persistent&lt;FunctionTemplate&gt;();
jclass HTML5WebViewProxy::javaClass = <span class="hljs-literal">NULL</span>;

HTML5WebViewProxy::HTML5WebViewProxy(jobject javaObject) : titanium::Proxy(javaObject)
{
}

<span class="hljs-keyword">void</span> HTML5WebViewProxy::bindProxy(Handle&lt;Object&gt; exports)
{
    <span class="hljs-keyword">if</span> (proxyTemplate.IsEmpty()) {
        getProxyTemplate();
    }

    <span class="hljs-comment">// use symbol over string for efficiency</span>
    Handle&lt;String&gt; nameSymbol = String::NewSymbol(<span class="hljs-string">"HTML5WebView"</span>);

    Local&lt;Function&gt; proxyConstructor = proxyTemplate-&gt;GetFunction();
    exports-&gt;Set(nameSymbol, proxyConstructor);
}

<span class="hljs-keyword">void</span> HTML5WebViewProxy::dispose()
{
    LOGD(TAG, <span class="hljs-string">"dispose()"</span>);
    <span class="hljs-keyword">if</span> (!proxyTemplate.IsEmpty()) {
        proxyTemplate.Dispose();
        proxyTemplate = Persistent&lt;FunctionTemplate&gt;();
    }

    WebViewProxy::dispose();
}

Handle&lt;FunctionTemplate&gt; HTML5WebViewProxy::getProxyTemplate()
{
    <span class="hljs-keyword">if</span> (!proxyTemplate.IsEmpty()) {
        <span class="hljs-keyword">return</span> proxyTemplate;
    }

    LOGD(TAG, <span class="hljs-string">"GetProxyTemplate"</span>);

    javaClass = titanium::JNIUtil::findClass(<span class="hljs-string">"com/liveon/android/HTML5WebViewProxy"</span>);
    HandleScope scope;

    <span class="hljs-comment">// use symbol over string for efficiency</span>
    Handle&lt;String&gt; nameSymbol = String::NewSymbol(<span class="hljs-string">"HTML5WebView"</span>);

    Handle&lt;FunctionTemplate&gt; t = titanium::Proxy::inheritProxyTemplate(
        WebViewProxy::getProxyTemplate()
, javaClass, nameSymbol);

    proxyTemplate = Persistent&lt;FunctionTemplate&gt;::New(t);
    proxyTemplate-&gt;Set(titanium::Proxy::inheritSymbol,
        FunctionTemplate::New(titanium::Proxy::inherit&lt;HTML5WebViewProxy&gt;)-&gt;GetFunction());

    titanium::ProxyFactory::registerProxyPair(javaClass, *proxyTemplate, <span class="hljs-literal">true</span>);

    <span class="hljs-comment">// Method bindings --------------------------------------------------------</span>

    Local&lt;ObjectTemplate&gt; prototypeTemplate = proxyTemplate-&gt;PrototypeTemplate();
    Local&lt;ObjectTemplate&gt; instanceTemplate = proxyTemplate-&gt;InstanceTemplate();

    <span class="hljs-comment">// Delegate indexed property get and set to the Java proxy.</span>
    instanceTemplate-&gt;SetIndexedPropertyHandler(titanium::Proxy::getIndexedProperty,
        titanium::Proxy::setIndexedProperty);

    <span class="hljs-comment">// Constants --------------------------------------------------------------</span>

    <span class="hljs-comment">// Dynamic properties -----------------------------------------------------</span>

    <span class="hljs-comment">// Accessors --------------------------------------------------------------</span>

    <span class="hljs-keyword">return</span> proxyTemplate;
}

<span class="hljs-comment">// Methods --------------------------------------------------------------------</span>

<span class="hljs-comment">// Dynamic property accessors -------------------------------------------------</span>


            } <span class="hljs-comment">// namespace liveonandroid</span>
        } <span class="hljs-comment">// android</span>
        } <span class="hljs-comment">// liveon</span>
        } <span class="hljs-comment">// com</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 30th 2014, 2:31:11 pm">July 30th 2014</span>
								by <span class='authorname'>Ben Kittrell</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>In most cases is avoiding of web view a good solution. Please explain us your goal.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 30th 2014, 3:07:10 pm">July 30th 2014</span>
								by <span class='authorname'>Rainer Schleevoigt</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I ended up giving up on this and using openPhotoGallery for image uploads.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 7th 2014, 3:41:29 pm">August 7th 2014</span>
								by <span class='authorname'>Ben Kittrell</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
