<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Mobile: Does removing Memory Leaks on iOS also remove leaks on Android? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Mobile: Does removing Memory Leaks on iOS also remove leaks on Android?</h1>
		</header>
		<section>
			<p>Hi all,</p>
<p>I&#39;ve read a lot about Memory Leaks in Wiki <a href="https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Managing+Memory+and+Finding+Leaks">Managing Memory Leaks</a> and Forum posts.</p>
<p>I removed nearly all memory leaks in my app. At least on iOS. It&#39;s very easy to monitor them on iOS. But on Android, the heap &#x2F; memory usage is always growing and nothing is released (and least it seems so). I&#39;m not sure whether it&#39;s caused by a few Titanium issues ( eg <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-4367">TableViewRow Leak</a> ) or whether it&#39;s my code.</p>
<p>Thus my question. If I removed all my memory leaks on iOS. Does this also remove my memory leaks on Android? Granted that the code is the same.</p>
<p>I&#39;m not sure whether the Garbage Collector in JavaScriptCore and v8 works similar.</p>
<p>Thx + Greetings</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 5th 2012, 7:51:32 pm">February 5th 2012</span>
				by <span class='authorname'>Jicks Steen</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>memory</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>There is no tool in android to find this like in iOS. You can only come to know this when it will force close because of memory leaks.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 5th 2012, 11:40:48 pm">February 5th 2012</span>
								by <span class='authorname'>Yogin Bhungalia</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Actually, I get a force close after some actions at the moment. I&#39;ll wait now till the memory issues are fixed.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 6th 2012, 3:09:03 pm">February 6th 2012</span>
								by <span class='authorname'>Jicks Steen</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Latest Titanium Build 1.9.0 fixes my memory leaks. Hope the fix will be merged into Titanium 1.8.2 branch. Thx for your repsonse.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 9th 2012, 7:49:37 pm">February 9th 2012</span>
								by <span class='authorname'>Jicks Steen</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-229493">
				
						<section>
							<p>Hi Jicks </p>
<p>Well in android the garbage collection is maintain automatically and we dont have to code anything separately for that i guess that the default nature of java. Well but i am not sure with the v8 functionality. But memory leaks in android is not an issue unless your app is using a lot of memory where its not even needed.</p>
<p>Regards</p>
<p>Nikunj</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 6th 2012, 1:41:36 am">February 6th 2012</span>
								by <span class='authorname'>Nikunj Sakhrelia</span><br>
								<a class="icon-bg icon-link" href="question/131693/mobile-does-removing-memory-leaks-on-ios-also-remove-leaks-on-android#answer-229493" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-229511">
				
						<section>
							<p>Hi Jicks.</p>
<p>When looking for memory leaks on Android, people are usually over-paranoid. The thing is that memory management and GC (garbage collection) is very sensitive action in terms of performance and Android handles this very randomly (GC occurs when there are enough free resources in system). Garbage collector will clean memory when it thinks that it should and it releases it as much as it thinks it should.</p>
<p>So, because of that, people usually are paranoid because they released an object (variable = null;) but memory has not been released. Nulling a variable is just like you said to GC - I don&#39;t need this memory anymore (and most people think they said - free this memory at once! :D ). That does not guarantee anything in terms of free memory. To see do you have memory leaks, run your app for some time and see how free memory levels behave. If free memory is constant over time, you can say that you don&#39;t have memory leaks.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 6th 2012, 7:09:30 am">February 6th 2012</span>
								by <span class='authorname'>Ivan Škugor</span><br>
								<a class="icon-bg icon-link" href="question/131693/mobile-does-removing-memory-leaks-on-ios-also-remove-leaks-on-android#answer-229511" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-230239">
				
						<section>
							<p>I guys I am also having a similar issue. I have nulled all variables and removed everything in my iOS version, so in theory that should also clean up memory in my Android version. None of the above post really answered the original question. In my Android version the memory only gets cleaned up a little bit but over time continues to grow and crash the app, this does not happen in my iOS version. Does anyone else have similar behavior?? I am using single context with 1 window and views that get created and removed as needed. Which version of 1.9 may fix this issue? Thanks for any input.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 14th 2012, 4:35:37 am">February 14th 2012</span>
								by <span class='authorname'>sean sean</span><br>
								<a class="icon-bg icon-link" href="question/131693/mobile-does-removing-memory-leaks-on-ios-also-remove-leaks-on-android#answer-230239" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hey I&#39;m struggling with the same issue on Android. I&#39;ve tried all the known workarounds for tidying up memory in Appcelerator Views (including this one http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;116867&#x2F;this-is-a-solution-to-your-memory-woes#comment-114508). </p>
<p>Using the DDMS tool with the Android Emulator I see apps memory increase rapidly as viewed in the &#39;SysInfo&#39; tab. Interestingly that actual Java VM heap memory is not the problem as the stats from the &#39;VM Heap&#39; tab in DDMS show no real growth in the heap usage. </p>
<p>What I think is happening is that the native memory allocated to the view by Titanium is not being freed until the Java VM heap is garbage collected. It&#39;s only a theory but I did see an article stating that TI&#39;s proxy objects don&#39;t release all their native memory until the objects are GC&#39;ed. This would make perfect sense as if I use the DDMS tool to force a garbage collect the memory gets freed.</p>
<p>Unfortunately as yet I can&#39;t figure out an easy solution to this problem. There doesn&#39;t seem to be a way to force garbage collection from the Javascript code (and forcing a GC is not a very nice way to fix it anyway).</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 7:25:22 pm">February 16th 2012</span>
											by <span class='authorname'>Andy Potter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Andy,</p>
<p>My issue is that they (Appcelerator) say that if you remove and null objects they will be GCd by the Android OS and we should have to force any garbage collection. I wrote my app first in iOS and used Instruments to check for all memory leaks. I then ported the same code to Android (with some minor mods to properties to adjust for differences) and its leaking memory like crazy. It would be nice if Appcelerator provided some sort of sample program that could demonstrate memory being cleaned up in Android just see the objects actually getting cleared up. That way you could run that sample with every new release and verify that nothing has been broken.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 8:24:09 pm">February 16th 2012</span>
											by <span class='authorname'>sean sean</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Setting a variable to &#39;null&#39; does NOT force the object to be immediately garbage collected. It just tells the VM that you no longer need the object in this scope, if there are other references elsewhere to the object then it will NOT be garbage collected. And even if you &#39;null&#39; the only reference to the object you can&#39;t be sure when the garbage collector will next run. But I think the garbage collection is not the issue, it&#39;s the fact that the Ti Proxy objects have native memory allocations outside the VM which are not freed until the Proxy objects are GC&#39;ed.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 8:53:19 pm">February 16th 2012</span>
											by <span class='authorname'>Andy Potter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>UPDATE - I&#39;ve narrowed the source of my issue down to the &#39;backgroundImage&#39; property. It seems if you use this on a view (any kind of view, plain, button, imageview, etc) and then you remove the view and null the reference you get a nice big leak in native memory. This leak does get freed when the GC runs, but because it leaks so much (nearly 1MB per view in my case), you can easily get the device to run out of memory and force close your app before the GC kicks in (NB: You don&#39;t always get killed, sometimes you just start getting OutOfMemory exceptions in the log).</p>
<p>Changing my app to use &#39;ImageView&#39; instead of a plain &#39;View&#39; AND using the &#39;image&#39; property instead of the &#39;backgroundImage&#39; property fixes the leak. However this doesn&#39;t entirely help me because I need my images stretched to fit the screen, but the ImageView always maintains aspect ratio if you specify the image via the &#39;image&#39; property. </p>
<p>So I&#39;m still a bit stuck, the investigation continues…</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 8:53:45 pm">February 16th 2012</span>
											by <span class='authorname'>Andy Potter</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hmmm, that might help my issue. If you have global variables and then null them out later in the program, will they ever get cleaned up? Im guessing not from your previous post.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 9:24:54 pm">February 16th 2012</span>
											by <span class='authorname'>sean sean</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-230600">
				
						<section>
							<p>NB: SDK 1.7.5 on Android, haven&#39;t tried any other SDK versions and don&#39;t know if this affects iOS - This doesn&#39;t necessarily answer all memory leaks&#x2F;out of memory scenario&#39;s but certainly this one caused me a big headache and the workaround is NOT obvious at all. See my comments on &#39;sean sean&#39; post above for the background but basically if you use the &#39;backgroundImage&#39; property of any type of view and you then &#39;remove&#39; that view from it&#39;s parent you will get a lot of native memory left unfreed until the next GC. This can result in you&#39;re app getting OutOfMemory errors in the log or even a &#39;Force Close&#39;.</p>
<p>Long story short to workaround this issue you can do one of two things:</p>
<p>1 - If you don&#39;t need your image stretched to fit the view then use an &#39;ImageView&#39; and set the &#39;image&#39; property instead of the &#39;backgroundImage&#39; property. Then when you want to remove your view and free the memory be sure to remove it from it&#39;s parent view, set the &#39;image&#39; property to empty string and then &#39;null&#39; your reference variable. e.g.</p>
<pre><code class="hljs">win.remove(imgView)<span class="hljs-comment">;</span>
imgView.image = ''<span class="hljs-comment">;</span>
imgView = null<span class="hljs-comment">;</span>
</code></pre><p>2 - If you do need your image stretched to fit then because &#39;ImageView&#39; maintains aspect ratio you have to use a bit of a hack. Basically you can use a &#39;Button&#39; view but make it disabled (i.e. enabled = false), set &#39;style = 0&#39;, and &#39;width&#39; and &#39;height&#39; to 100% otherwise it won&#39;t expand to fill the parent. Then use the &#39;backgroundDisabledImage&#39; property to set your desired image. Then you want to remove your view and free the memory it&#39;s the same as above but you set the &#39;backgroundDisabledImage&#39; to an empty string, e.g.</p>
<pre><code class="hljs">win.remove(<span class="hljs-keyword">button</span>);
<span class="hljs-keyword">button</span>.backgroundDisabledImage = <span class="hljs-string">''</span>;
<span class="hljs-keyword">button</span> = null;
</code></pre><p>NB: For tracking this problem down the DDMS tools was absolutely essential. Strongly recommend you know how to use this tool effectively for investigating memory leaks.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 16th 2012, 9:25:07 pm">February 16th 2012</span>
								by <span class='authorname'>Andy Potter</span><br>
								<a class="icon-bg icon-link" href="question/131693/mobile-does-removing-memory-leaks-on-ios-also-remove-leaks-on-android#answer-230600" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Andy,</p>
<p>There are still plenty of memory issues I think. I am using the latest studio version 1.0.8.1 and a very recent build of SDK version 1.9.0. I created a very simple test case to show the memory issues. </p>
<ol>
<li>Create a new project</li>
<li>Modify app.js with the following.<br>app.js<br>~~~<br>var rootWin = Titanium.UI.createWindow(<br>{<br> &#x2F;&#x2F;backgroundImage: &#39;&#x2F;images&#x2F;background2.jpg&#39;,<br> backgroundColor: &#39;white&#39;,<br> top:0,<br> left:0,<br> width:Ti.Platform.displayCaps.platformWidth,<br> height:Ti.Platform.displayCaps.platformHeight,<br> fullscreen:false,<br> navBarHidden:true,<br> exitOnClose:true<br>});<br>rootWin.orientationModes=[Titanium.UI.PORTRAIT];</li>
</ol>
<p>var createViews = Ti.UI.createButton({<br>    title: &quot;Create Views&quot;,<br>    top: 10,<br>});</p>
<p>createViews.addEventListener(&#39;click&#39;,function(e)<br>{<br>    Ti.include(&#39;selfCalling.js&#39;);<br>    &#x2F;&#x2F;alert(&#39;views created&#39;);<br>});</p>
<p>rootWin.add(createViews);</p>
<p>var releaseView = Ti.UI.createButton({<br>    title: &quot;Release Views&quot;<br>});</p>
<p>releaseView.addEventListener(&#39;click&#39;,function(e)<br>{<br>    mainViews = null;<br>    &#x2F;&#x2F;alert(&#39;views Cleared&#39;);<br>});</p>
<p>rootWin.add(releaseView);</p>
<p>rootWin.open();</p>
<pre><code class="hljs">
Then <span class="hljs-built_in">create</span> another js <span class="hljs-built_in">file</span> called selfCalling.js <span class="hljs-operator">with</span> <span class="hljs-operator">the</span> following code:

selfCalling.js
</code></pre><p>(function mainViews()<br>{<br>    var views =[];<br>    var view = null;</p>
<pre><code class="hljs">for (<span class="hljs-built_in">var</span> i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {


    <span class="hljs-built_in">view</span> = Titanium.UI.createView(
    {
        <span class="hljs-comment">//backgroundImage: '/images/background2.jpg',</span>
        <span class="hljs-comment">//backgroundColor: 'blue',</span>
        top:<span class="hljs-number">0</span>,
        left:<span class="hljs-number">0</span>,
        width:Ti.Platform.displayCaps.platformWidth,
        height:<span class="hljs-number">200</span>,

    });

    <span class="hljs-built_in">views</span>.push(<span class="hljs-built_in">view</span>);

};
<span class="hljs-comment">//alert(views.length);</span>
<span class="hljs-built_in">views</span> =[];
<span class="hljs-built_in">views</span> = <span class="hljs-built_in">null</span>;  
<span class="hljs-built_in">view</span> = <span class="hljs-built_in">null</span>;
<span class="hljs-comment">//alert(views.length);</span>
</code></pre><p>}());</p>
<p>~~~</p>
<p>If you run this with the DDMS tool you will see that the memory never gets cleaned up or garbage collected even though right after I create the array with views I null the variable out.</p>
<p>Do you think this is a valid test case to prove memory leaks?</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 17th 2012, 6:05:15 pm">February 17th 2012</span>
											by <span class='authorname'>sean sean</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I have just tested the above code on a mac with the latest Studio version and sdk 1.9.0.(1.9.0.v20120131141634). It works as expected, it creates the objects and properly cleans up the memory automatically. (Proved it using instruments) Does anyone know why this would only work on iOS? On Android the memory just keeps climbing until it crashes.</p>
<p>This is about as &quot;hello world&quot; as it gets!!!</p>
<p>Any ideas would be greatly appreciated.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 17th 2012, 7:19:29 pm">February 17th 2012</span>
											by <span class='authorname'>sean sean</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-269748">
				
						<section>
							<p>good. thank ! <a href="http:&#x2F;&#x2F;xinh.hay.la">hinh anh girl xinh de thuong</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 8th 2013, 6:32:03 am">October 8th 2013</span>
								by <span class='authorname'>thai thai</span><br>
								<a class="icon-bg icon-link" href="question/131693/mobile-does-removing-memory-leaks-on-ios-also-remove-leaks-on-android#answer-269748" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
