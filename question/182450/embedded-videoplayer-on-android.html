<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Embedded VideoPlayer on Android » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Embedded VideoPlayer on Android</h1>
		</header>
		<section>
			<p>NOT A QUESTION! JUST LETTING YOU KNOW!</p>
<p>Hi, I was trying to get an embedded video player working on Android (and in the future iOS, but I have no iOS devices for testing at the moment) and ran into a few problems. If you run into problems, feel free to use the following code to make sure it&#39;s running OK.</p>
<p>I am using Alloy version 1.5.1 and Titanium SDK 4.0.0.RC4, but it works the same with SDK 3.5.1.GA.</p>
<p>So, to get a video running:</p>
<ol>
<li>Make sure that the video is in the correct folder (ex. app&#x2F;assets&#x2F;video.mp4) and in the correct format! Decoding that SHOULD be supported by android devices is listed here: http:&#x2F;&#x2F;developer.android.com&#x2F;guide&#x2F;appendix&#x2F;media-formats.html#core</li>
</ol>
<p>Note that H.264 AVC DOES NOT WORK! Even though they list it as a supported format, android 4.1 and android 5 cannot display the video. Get the Kitchen Sink examples and there&#39;s a video file. Try to match your video&#39;s codec to the video provided there. I suggest using MediaInfo packed with K-Lite Codec Pack to identify your video&#39;s codec. Convert your video to MPEG4 with AAC sound. Ideally media info should return something like this:</p>
<pre><code class="hljs">General
Complete <span class="hljs-string">name               :</span> <span class="hljs-string">D:</span>\Projects\videotest\app\assets\mpeg4.mp4
<span class="hljs-string">Format                      :</span> MPEG-<span class="hljs-number">4</span>
Format <span class="hljs-string">profile              :</span> Base Media
Codec <span class="hljs-string">ID                    :</span> isom
File <span class="hljs-string">size                   :</span> <span class="hljs-number">2.43</span> MiB
<span class="hljs-string">Duration                    :</span> <span class="hljs-number">35</span>s <span class="hljs-number">680</span>ms
Overall bit rate <span class="hljs-string">mode       :</span> Constant
Overall bit <span class="hljs-string">rate            :</span> <span class="hljs-number">572</span> Kbps

Video
<span class="hljs-string">ID                          :</span> <span class="hljs-number">1</span>
<span class="hljs-string">Format                      :</span> MPEG-<span class="hljs-number">4</span> Visual
Format <span class="hljs-string">profile              :</span> Simple<span class="hljs-annotation">@L</span>3
Format settings, <span class="hljs-string">BVOP       :</span> No
Format settings, <span class="hljs-string">QPel       :</span> No
Format settings, <span class="hljs-string">GMC        :</span> No warppoints
Format settings, <span class="hljs-string">Matrix     :</span> Default (H<span class="hljs-number">.263</span>)
Codec <span class="hljs-string">ID                    :</span> <span class="hljs-number">20</span>
<span class="hljs-string">Duration                    :</span> <span class="hljs-number">35</span>s <span class="hljs-number">680</span>ms
Bit rate <span class="hljs-string">mode               :</span> Constant
Bit <span class="hljs-string">rate                    :</span> <span class="hljs-number">450</span> Kbps
<span class="hljs-string">Width                       :</span> <span class="hljs-number">368</span> pixels
<span class="hljs-string">Height                      :</span> <span class="hljs-number">208</span> pixels
Display aspect <span class="hljs-string">ratio        :</span> <span class="hljs-number">16</span>:<span class="hljs-number">9</span>
Frame rate <span class="hljs-string">mode             :</span> Constant
Frame <span class="hljs-string">rate                  :</span> <span class="hljs-number">25.000</span> fps
Color <span class="hljs-string">space                 :</span> YUV
Chroma <span class="hljs-string">subsampling          :</span> <span class="hljs-number">4</span>:<span class="hljs-number">2</span>:<span class="hljs-number">0</span>
Bit <span class="hljs-string">depth                   :</span> <span class="hljs-number">8</span> bits
Scan <span class="hljs-string">type                   :</span> Progressive
Compression <span class="hljs-string">mode            :</span> Lossy
Bits/(Pixel*Frame)          : <span class="hljs-number">0.235</span>
Stream <span class="hljs-string">size                 :</span> <span class="hljs-number">1.89</span> MiB (<span class="hljs-number">78</span>%)
<span class="hljs-string">Language                    :</span> English

Audio
<span class="hljs-string">ID                          :</span> <span class="hljs-number">2</span>
<span class="hljs-string">Format                      :</span> AAC
Format/<span class="hljs-string">Info                 :</span> Advanced Audio Codec
Format <span class="hljs-string">profile              :</span> LC
Codec <span class="hljs-string">ID                    :</span> <span class="hljs-number">40</span>
<span class="hljs-string">Duration                    :</span> <span class="hljs-number">35</span>s <span class="hljs-number">550</span>ms
Bit rate <span class="hljs-string">mode               :</span> Constant
Bit <span class="hljs-string">rate                    :</span> <span class="hljs-number">123</span> Kbps
Nominal bit <span class="hljs-string">rate            :</span> <span class="hljs-number">64.0</span> Kbps
Channel(s)                  : <span class="hljs-number">2</span> channels
Channel <span class="hljs-string">positions           :</span> <span class="hljs-string">Front:</span> L R
Sampling <span class="hljs-string">rate               :</span> <span class="hljs-number">44.1</span> KHz
Compression <span class="hljs-string">mode            :</span> Lossy
Stream <span class="hljs-string">size                 :</span> <span class="hljs-number">533</span> KiB (<span class="hljs-number">21</span>%)
<span class="hljs-string">Language                    :</span> English
</code></pre><ol>
<li>Do NOT put your video in a ScrollView. It screws up rendering and you might see just a black square. Try working around it… Here&#39;s an explanation: http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;4312585&#x2F;androidvideoview-inside-a-scrollview</li>
</ol>
<ol>
<li><p>The Alloy markup is then easy (naturally inside a Window tag, but I think that&#39;s irrelevant):</p>
<pre><code class="hljs">&lt;VideoPlayer 
 <span class="hljs-property">id</span>=<span class="hljs-string">"video"</span> 
 url=<span class="hljs-string">"/mpeg4.mp4"</span> 
 /&gt;
</code></pre></li>
<li><p>And the styling (depending on how you want to embed):</p>
<pre><code class="hljs">"<span class="hljs-id">#video</span>" : <span class="hljs-rules">{
 <span class="hljs-rule"><span class="hljs-attribute">ns</span>:<span class="hljs-value"> Titanium.Media,
 autoplay: true,
 repeatMode: Titanium.Media.VIDEO_REPEAT_MODE_NONE,
 mediaControlStyle: Titanium.Media.VIDEO_CONTROL_NONE,
 mediaTypes: Titanium.Media.VIDEO_MEDIA_TYPE_VIDEO,
 width: Titanium.UI.FILL,
 height: Titanium.UI.SIZE,
</span></span></span>}
</code></pre></li>
</ol>
<ol>
<li>Here&#39;s the controller code that will output all possible events regarding the video:<br>~~~<br>$.video.addEventListener(&#39;click&#39;, function(e)<br>{<br> Ti.API.log(&quot;Video.click&quot;);<br> if ($.video.playing)<br> {<pre><code class="hljs"> Ti.API.<span class="hljs-keyword">log</span>(<span class="hljs-string">"Video is playing. Stopping..."</span>);
 <span class="hljs-variable">$.</span>video.stop();
</code></pre> }<br> Ti.API.log(&quot;Playing video…&quot;);<br> $.video.play();<br>});</li>
</ol>
<p>$.video.addEventListener(&#39;durationavailable&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.durationavailable: &quot; + e.duration);<br>});</p>
<p>$.video.addEventListener(&#39;error&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.error: (code &quot; + e.code + &quot;) - &quot; + e.error);</p>
<p>});</p>
<p>$.video.addEventListener(&#39;load&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.load&quot;);<br>});</p>
<p>$.video.addEventListener(&#39;complete&#39;, function(e)<br>{<br>    var reasonString = &quot;Unknown reason&quot;;<br>    switch (e.reason)<br>    {<br>    case Titanium.Media.VIDEO_FINISH_REASON_PLAYBACK_ENDED:<br>        reasonString = &quot;VIDEO_FINISH_REASON_PLAYBACK_ENDED&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_FINISH_REASON_PLAYBACK_ERROR:<br>        reasonString = &quot;VIDEO_FINISH_REASON_PLAYBACK_ERROR&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_FINISH_REASON_USER_EXITED:<br>        reasonString = &quot;VIDEO_FINISH_REASON_USER_EXITED&quot;;<br>        break;<br>    }<br>    Ti.API.log(&quot;Video.complete: reason = &quot; + reasonString);</p>
<p>});</p>
<p>$.video.addEventListener(&#39;loadstate&#39;, function(e)<br>{<br>    var loadString = &quot;Unknown&quot;;<br>    switch (e.loadState)<br>    {<br>    case Titanium.Media.VIDEO_LOAD_STATE_PLAYABLE:<br>        loadString = &quot;VIDEO_LOAD_STATE_PLAYABLE&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_LOAD_STATE_PLAYTHROUGH_OK:<br>        loadString = &quot;VIDEO_LOAD_STATE_PLAYTHROUGH_OK&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_LOAD_STATE_STALLED:<br>        loadString = &quot;VIDEO_LOAD_STATE_STALLED&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_LOAD_STATE_UNKNOWN:<br>        loadString = &quot;VIDEO_LOAD_STATE_UNKNOWN&quot;;<br>        break;<br>    }<br>    Ti.API.log(&quot;Video.loadstate: &quot; + loadString);<br>});</p>
<p>$.video.addEventListener(&#39;preload&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.preload&quot;);<br>});</p>
<p>$.video.addEventListener(&#39;fullscreen&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.fullscreen: Entering = &quot; + e.entering);<br>});</p>
<p>$.video.addEventListener(&#39;mediatypesavailable&#39;, function(e)<br>{<br>    var mediaString = &quot;Unknown&quot;;<br>    switch (e.mediaTypes)<br>    {<br>    case Titanium.Media.VIDEO_MEDIA_TYPE_NONE:<br>        mediaString = &quot;VIDEO_MEDIA_TYPE_NONE&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_MEDIA_TYPE_AUDIO:<br>        mediaString = &quot;VIDEO_MEDIA_TYPE_AUDIO&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_MEDIA_TYPE_VIDEO:<br>        mediaString = &quot;VIDEO_MEDIA_TYPE_VIDEO&quot;;<br>        break;<br>    }<br>    Ti.API.log(&quot;Video.mediatypesavailable: mediaTypes = &quot; + mediaString);<br>});</p>
<p>$.video.addEventListener(&#39;naturalsizeavailable&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.naturalsizeavailable: naturalSize = &quot; + e.naturalSize);<br>});</p>
<p>$.video.addEventListener(&#39;playbackstate&#39;, function(e)<br>{<br>    var playbackString = &quot;Unknown&quot;;<br>    switch (e.playbackState)<br>    {<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_INTERRUPTED&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_PAUSED:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_PAUSED&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_PLAYING:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_PLAYING&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_SEEKING_BACKWARD:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_SEEKING_BACKWARD&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_SEEKING_FORWARD:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_SEEKING_FORWARD&quot;;<br>        break;<br>    case Titanium.Media.VIDEO_PLAYBACK_STATE_STOPPED:<br>        playbackString = &quot;VIDEO_PLAYBACK_STATE_STOPPED&quot;;<br>        break;<br>    }<br>    Ti.API.log(&quot;Video.playbackstate: playbackState = &quot; + playbackString);<br>});</p>
<p>$.video.addEventListener(&#39;playing&#39;, function(e)<br>{<br>    Ti.API.log(&quot;Video.playing: url = &quot; + e.url);<br>});</p>
<p>&#x2F;&#x2F; IMPORTANT - stop video when closing window!<br>$.win.addEventListener(&#39;close&#39;, function()<br>{<br>    $.video.stop();<br>});</p>
<pre><code class="hljs">
So basically, I just<span class="hljs-instruction"> check </span>ALL related events<span class="hljs-instruction"> and </span>output human readable strings. A <span class="hljs-string">"healthy"</span> output should look like this after opening the window:
</code></pre><p>[INFO] :   Video.loadstate: VIDEO_LOAD_STATE_UNKNOWN<br>[INFO] :   Choreographer: Skipped 130 frames!  The application may be doing too much work on its main thread.<br>[INFO] :   Video.durationavailable: 1333<br>[INFO] :   Video.preload<br>[INFO] :   MediaPlayer: sendBroadcast android.media.IMediaPlayer.videoexist<br>[INFO] :   Video.load<br>[INFO] :   Video.loadstate: VIDEO_LOAD_STATE_PLAYABLE<br>[INFO] :   Video.playbackstate: playbackState = VIDEO_PLAYBACK_STATE_PLAYING<br>[INFO] :   Video.playing: url = &#x2F;video&#x2F;mpeg4.mp4<br>[INFO] :   MediaPlayer: sendBroadcast android.media.IMediaPlayer.videoexist<br>[INFO] :   Video.playbackstate: playbackState = VIDEO_PLAYBACK_STATE_PLAYING<br>[INFO] :   Video.playbackstate: playbackState = VIDEO_PLAYBACK_STATE_STOPPED<br>[INFO] :   Video.complete: reason = VIDEO_FINISH_REASON_PLAYBACK_ENDED<br>~~~</p>
<p>If any of the event listeners report an unknown error, something went wrong. Most probably the video&#x2F;audio format is not compatible.</p>
<p>Hope this helps, as I&#39;ve spent about 12 hours trying to figure all this out. And really an unknown error does not help a lot.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 20th 2015, 11:34:16 am">May 20th 2015</span>
				by <span class='authorname'>Michal Ferko</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>media</span></li>
					
						<li><span class='tagname'>video</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
