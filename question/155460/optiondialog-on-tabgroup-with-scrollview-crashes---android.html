<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>OptionDialog on TabGroup with ScrollView crashes - Android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>OptionDialog on TabGroup with ScrollView crashes - Android</h1>
		</header>
		<section>
			<p>Ran into a problem with my android app and just made a small test app to prove the point.  What I have is a tabGroup with ScrollViews in each tab.  From there I need to be able to open OptionDialogs from each tab, but when I open the optionDialog on tab1, then open it on tab2 the app crashes.</p>
<p>Here&#39;s the code I just created in a small test app to show the problem.  Perhaps someone can point out if I&#39;m doing something wrong.</p>
<p>I&#39;m using Ti Studio 3.1.1.201306112235 with Ti SDK 3.1.1.GA.<br>Doesn&#39;t seem to matter which android API I target or which version I deploy to, it still does it.  Windows 8 x64 if that matters.</p>
<p>Interestingly, if I drop the scrollviews it works fine.  But they are necessary in my main app.</p>
<p>Steps to recreate my problem:</p>
<ol>
<li>Create new project with the following files and code</li>
<li>Build to Android emulator or device, doesn&#39;t matter</li>
<li>Click options button on tab 1 and select any option to close it</li>
<li>Click options button on tab 2, app crashes</li>
</ol>
<p>index.xml</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">TabGroup</span> <span class="hljs-attribute">navBarHidden</span>=<span class="hljs-value">"true"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Tab</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"TabgroupTab1"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tab1"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Require</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"view"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"tab1"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"Tab1"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Tab</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Tab</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"TabgroupTab2"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tab2"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Require</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"view"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"tab2"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"Tab2"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Tab</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">TabGroup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>index.js</p>
<pre><code class="hljs"><span class="hljs-variable">$.</span><span class="hljs-keyword">index</span>.<span class="hljs-keyword">open</span>();
</code></pre><p>tab1.xml</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"Tab1"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"vertical"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">OptionDialog</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"opTab1Options"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Options</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test1<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test2<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test3<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">Options</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">OptionDialog</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">ScrollView</span> <span class="hljs-attribute">showVerticalScrollIndicator</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">contentHeight</span>=<span class="hljs-value">"auto"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">height</span>=<span class="hljs-value">"Titanium.UI.SIZE"</span> <span class="hljs-attribute">width</span>=<span class="hljs-value">"98%"</span> <span class="hljs-attribute">top</span>=<span class="hljs-value">"5dip"</span> <span class="hljs-attribute">borderRadius</span>=<span class="hljs-value">"10"</span> <span class="hljs-attribute">backgroundColor</span>=<span class="hljs-value">"white"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"vertical"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Button</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"btnTab1"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Options 1"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"btnTab1Click"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">Button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollView</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>tab1.js</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">btnTab1Click</span>(<span class="hljs-params"></span>)</span>{
    $.opTab1Options.show();
}
</code></pre><p>tab2.xml</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"tab2"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"vertical"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">OptionDialog</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"opTab2Options"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Options</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test1<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test2<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Option</span>&gt;</span>Test3<span class="hljs-tag">&lt;/<span class="hljs-title">Option</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">Options</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">OptionDialog</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">ScrollView</span> <span class="hljs-attribute">showVerticalScrollIndicator</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">contentHeight</span>=<span class="hljs-value">"auto"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">height</span>=<span class="hljs-value">"Titanium.UI.SIZE"</span> <span class="hljs-attribute">width</span>=<span class="hljs-value">"98%"</span> <span class="hljs-attribute">top</span>=<span class="hljs-value">"5dip"</span> <span class="hljs-attribute">borderRadius</span>=<span class="hljs-value">"10"</span> <span class="hljs-attribute">backgroundColor</span>=<span class="hljs-value">"white"</span> <span class="hljs-attribute">layout</span>=<span class="hljs-value">"vertical"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Button</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"btnTab2"</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Options 2"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"btnTab2Click"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">Button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">View</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">ScrollView</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>tab2.js</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">btnTab2Click</span>(<span class="hljs-params"></span>)</span>{
    $.opTab2Options.show();
}
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 30th 2013, 7:12:57 pm">July 30th 2013</span>
				by <span class='authorname'>Adam Parker</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>optiondialog</span></li>
					
						<li><span class='tagname'>scrollview</span></li>
					
						<li><span class='tagname'>tabgroup</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hello,</p>
<p>I ran your test case in a Xperia Tipo Dual, with 4.0.3 and … didn&#39;t crash. </p>
<p>Where is crashing and how do you force it to happen? I mean, give me steps to reproduce your crash, like: install the app, go back and forth from tab1 to tab2, etc. </p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 30th 2013, 7:56:54 pm">July 30th 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Start app, click Options 1 button in Tab1, select an option then go to Tab2 and click Options 2 and it crashes.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 31st 2013, 12:43:28 am">July 31st 2013</span>
								by <span class='authorname'>Adam Parker</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I have just done some more testing with the following results.</p>
<p>4.2.1 Emulator - Crash</p>
<p>2.3.4 Emulator - Crash</p>
<p>4.2.2 Galaxy Nexus - Crash</p>
<p>4.3 Galaxy Nexus - Crash</p>
<p>4.2.2 HTC Desire - NO Crash</p>
<p>Tried building and deploying from OSX just in case, same results.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 31st 2013, 1:48:23 am">July 31st 2013</span>
								by <span class='authorname'>Adam Parker</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-266635">
				
						<section>
							<p>I believe I&#39;ve found a solution to this.  I have moved the creation of the optionDialog from Alloy to JS code within the controllers, on the click function of the button that shows it.  Then on the click event for the optionDialog I reset the variable to null.  This method is working well for me on emulator and device.</p>
<p>tab1.js</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> dialogVal = <span class="hljs-number">0</span>; <span class="hljs-comment">// Holds the value of the option dialog so it is not blank each time you create/show it</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">btnTab1Click</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Create the option dialog</span>
    <span class="hljs-keyword">var</span> dialog = Ti.UI.createOptionDialog({title:<span class="hljs-string">'Test'</span>,options:[<span class="hljs-string">'Test1'</span>,<span class="hljs-string">'Test2'</span>,<span class="hljs-string">'Test3'</span>],selectedIndex:dialogVal});
    <span class="hljs-comment">// Add the click event listener for the option dialog</span>
    dialog.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        dialogVal = e.index;
        dialog.hide();
        dialog = <span class="hljs-literal">null</span>; <span class="hljs-comment">// clear the reference to the option dialog, new one has to be created each time we need it</span>
    });
    dialog.show();
}
</code></pre><p>I see that people have been having problems with the optionDialog for a long time and most threads just end without a working solution.  I hope my solution helps someone.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 31st 2013, 7:19:08 pm">July 31st 2013</span>
								by <span class='authorname'>Adam Parker</span><br>
								<a class="icon-bg icon-link" href="../../question/155460/optiondialog-on-tabgroup-with-scrollview-crashes---android.html#answer-266635" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thank you Adam. This solution fixed this problem for me and saved me a lot of time and hassle.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2013, 11:42:24 pm">December 2nd 2013</span>
											by <span class='authorname'>Dr Caroline Wilkins</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Adam Parker Hi Adam, this solution does seem to work, however, in my case I have two option dialogs. The first is populated off the results of a web service and then, once an option is chosen, a second web service is called to create the options for the second option dialog. So I cannot only create the option dialogs on the click event of the button, because the user would have to wait for a web service to be called and respond every time they click a button :&#x2F; is there any other solutions you have come across?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 26th 2014, 7:53:08 am">June 26th 2014</span>
											by <span class='authorname'>thomas lynch</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks you! Works for me… saved my day :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 27th 2014, 4:45:52 pm">August 27th 2014</span>
											by <span class='authorname'>Zoltán Rácz</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>3</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
