<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>SDK 1.8.1 Android modules problem » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>SDK 1.8.1 Android modules problem</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I&#39;m using the c2dm module that was converted to 1.8.0.1 (<a href="https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm">https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm</a>).</p>
<p>On SDK 1.8.0.1 it was working fine.</p>
<p>I&#39;ve upgraded my SDK to 1.8.1 and re-compiled the module under SDK 1.8.1. Since then the app started crashing whenever it recieves a c2dm callback.</p>
<p>I traced it with DDMS and got the following output regarding the crash:</p>
<pre><code class="hljs"><span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>): (IntentService[C2DMBaseReceiver]) [<span class="hljs-number">1</span>,<span class="hljs-number">26804</span>] Sending event: exception on thread: IntentService[C2DMBaseReceiver] msg:java.lang.NoSuchMethodError: org.appcelerator.kroll.KrollFunction.call; Titanium <span class="hljs-number">1.8</span><span class="hljs-number">.1</span>,<span class="hljs-number">2012</span>/<span class="hljs-number">01</span>/<span class="hljs-number">27</span> <span class="hljs-number">17</span>:<span class="hljs-number">31</span>,a24502a
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>): java.lang.NoSuchMethodError: org.appcelerator.kroll.KrollFunction.call
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at com.findlaw.c2dm.C2dmModule.sendMessage(C2dmModule.java:<span class="hljs-number">99</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at com.findlaw.c2dm.C2DMReceiver.onMessage(C2DMReceiver.java:<span class="hljs-number">87</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at com.google.android.c2dm.C2DMBaseReceiver.onHandleIntent(C2DMBaseReceiver.java:<span class="hljs-number">101</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:<span class="hljs-number">59</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at android.os.Handler.dispatchMessage(Handler.java:<span class="hljs-number">99</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at android.os.Looper.loop(Looper.java:<span class="hljs-number">123</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.289</span>: E/TiApplication(<span class="hljs-number">3627</span>):     at android.os.HandlerThread.run(HandlerThread.java:<span class="hljs-number">60</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>): FATAL EXCEPTION: IntentService[C2DMBaseReceiver]
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>): java.lang.NoSuchMethodError: org.appcelerator.kroll.KrollFunction.call
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at com.findlaw.c2dm.C2dmModule.sendMessage(C2dmModule.java:<span class="hljs-number">99</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at com.findlaw.c2dm.C2DMReceiver.onMessage(C2DMReceiver.java:<span class="hljs-number">87</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at com.google.android.c2dm.C2DMBaseReceiver.onHandleIntent(C2DMBaseReceiver.java:<span class="hljs-number">101</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:<span class="hljs-number">59</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at android.os.Handler.dispatchMessage(Handler.java:<span class="hljs-number">99</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at android.os.Looper.loop(Looper.java:<span class="hljs-number">123</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.304</span>: E/AndroidRuntime(<span class="hljs-number">3627</span>):     at android.os.HandlerThread.run(HandlerThread.java:<span class="hljs-number">60</span>)
<span class="hljs-number">02</span>-<span class="hljs-number">05</span> <span class="hljs-number">18</span>:<span class="hljs-number">29</span>:<span class="hljs-number">54.308</span>: E/(<span class="hljs-number">1945</span>): Dumpstate &gt; /data/<span class="hljs-built_in">log</span>/dumpstate_app_error
</code></pre><p>Main thing (in my opinion) being this: org.appcelerator.kroll.KrollFunction.call - NoSuchMethodError.</p>
<p>Anyone knows how to fix that? did something change regarding module development in 1.8.1 since 1.8.0.1?</p>
<p>Thanks</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 5th 2012, 2:39:48 pm">February 5th 2012</span>
				by <span class='authorname'>Ophir &#39;Shlomi&#39; Oren</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>c2dm</span></li>
					
						<li><span class='tagname'>java</span></li>
					
						<li><span class='tagname'>module</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Same here. Any ideas on how to fix it?</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 21st 2012, 9:18:45 am">February 21st 2012</span>
								by <span class='authorname'>Robert Schmidt</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Robert,</p>
<p>It doesn&#39;t happen to me anymore. To be honest - I don&#39;t remember what solved it.</p>
<p>What is the error you&#39;re getting?</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 23rd 2012, 5:41:53 am">February 23rd 2012</span>
								by <span class='authorname'>Ophir &#39;Shlomi&#39; Oren</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Thanks for your replay. I went back to 1.8.0.1 but realized that the message callback was not triggered. I could trace (in the module) it to the point where the kroll function is called:</p>
<pre><code class="hljs"><span class="hljs-keyword">public</span> <span class="hljs-literal">void</span> sendMessage(HashMap messageData) {
    <span class="hljs-keyword">if</span>(messageCallback != <span class="hljs-built_in">null</span>) {
        HashMap <span class="hljs-built_in">data</span> = <span class="hljs-literal">new</span> HashMap();
        <span class="hljs-built_in">data</span><span class="hljs-built_in">.</span>put(<span class="hljs-string">"data"</span>, messageData);
        <span class="hljs-keyword">Log</span><span class="hljs-built_in">.</span>d(LCAT, <span class="hljs-string">"Trigger callback"</span>);
        messageCallback<span class="hljs-built_in">.</span>call(getKrollObject(),<span class="hljs-built_in">data</span>);
    }
}
</code></pre><p>The &quot;Trigger callback&quot; is written to the log, but the callback is not called.</p>
<p>Since I needed a solution till today I moved the callback logic into the module and started the intent from the Java-Module. This is working for me though it is not the best solution. When I have some time left, I will focus on this problem again. I guess there still is something strange with the KrollFunction class which replaced KrollCallback since 1.8.0.1.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 23rd 2012, 6:07:25 am">February 23rd 2012</span>
								by <span class='authorname'>Robert Schmidt</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello Robert, i am getting a success push, but i still m not able to see any notification on my device or emulator.<br>can u tell me how to trace this log.d in emulator using ddbm, also did u find the solition of the above mention problem</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 22nd 2012, 12:02:11 pm">March 22nd 2012</span>
								by <span class='authorname'>shyam shroff</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>6</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>6 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-234680">
				
						<section>
							<p>http:&#x2F;&#x2F;technoblog-bhushan.blogspot.in&#x2F;2012&#x2F;03&#x2F;looking-at-all-possible-solution-for.html</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 29th 2012, 7:42:01 am">March 29th 2012</span>
								by <span class='authorname'>bhushan T</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-234680" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-231835">
				
						<section>
							<p>Hello friends I am new for c2dm I need to add push notification for android in my Titanium project please give me steps from scratch for SDK 1.8.1 for that I downloaded (https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm) what should I do next suggest for the same ..thanks.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 29th 2012, 2:40:59 am">February 29th 2012</span>
								by <span class='authorname'>veibhav d</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-231835" rel="permalink">permalink</a>
							</div>

							<h5>9 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>A guide from the start would be much appreciated, especially considering those who do not know how to re-compile modules for 1.8.1.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 7:27:53 am">February 29th 2012</span>
											by <span class='authorname'>Zane Wright</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It is not that difficult:</p>
<ol>
<li>Clone project from github</li>
<li>Find build.properties</li>
<li>Modify all paths to fit the paths (and versions) in your environment</li>
<li>Optionally you need to download and install the android ndk from here http:&#x2F;&#x2F;developer.android.com&#x2F;sdk&#x2F;ndk&#x2F;index.html</li>
<li>Open console in module root and type <code>ant</code> and hit enter</li>
<li>The build process should end with something like <code>build successfully</code></li>
<li>In the module directory, you will find the build result in the dist folder</li>
<li>Open that folder, unzip the <code>com.findlaw.c2dm-android-0.1.zip</code></li>
<li>A folder is created: <code>modules&amp;#x2F;android&amp;#x2F;com.findlaw.c2dm&amp;#x2F;0.1</code></li>
<li>copy the content of <code>modules&amp;#x2F;android&amp;#x2F;com.findlaw.c2dm&amp;#x2F;0.1</code> to the folder <code>[your_project]&amp;#x2F;modules&amp;#x2F;android&amp;#x2F;com.findlaw.c2dm&amp;#x2F;</code></li>
<li>Copy timodule.xml to the root folder of your project (where the tiapp.xml is located)</li>
<li>Open tiapp.xml and replace all occurences of <code>com.findlaw.c2dm</code> with your app id, except of the line including this: <code>com.findlaw.c2dm.C2DMReceiver</code></li>
<li>Register the module in tiapp.xml:<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">modules</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">module</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"android"</span> <span class="hljs-attribute">version</span>=<span class="hljs-value">"0.1"</span>&gt;</span>com.findlaw.c2dm<span class="hljs-tag">&lt;/<span class="hljs-title">module</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">modules</span>&gt;</span>
</code></pre></li>
<li>Use the module in your code as described in the example of the module</li>
</ol>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 8:01:06 am">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you for your quick reply! Does ant come shipped with titanium? I cannot run ant in my command window…</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:13:53 am">February 29th 2012</span>
											by <span class='authorname'>Zane Wright</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>use ant command from terminal&#x2F;command-prompt while you reach at  build.properties path.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:23:32 am">February 29th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Zane Wright: What OS are you using, Windows? For Mac and linux, ant should be available, but for Windows I guess you need to install it manually:</p>
<p>http:&#x2F;&#x2F;ant.apache.org&#x2F;manual&#x2F;install.html</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:29:21 am">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>When I type use ant at the build.properties location I get this error: ant is not recognized as an internal or external command. Do I need to install ant from somewhere first?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:36:01 am">February 29th 2012</span>
											by <span class='authorname'>Zane Wright</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I will install it and give it a try!</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:37:09 am">February 29th 2012</span>
											by <span class='authorname'>Zane Wright</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Actually I am using Mac osx 10.6.8.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 10:44:36 am">February 29th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Cool I have ant installed and have modified the build.properties file to contain the path to my titanium sdk, android sdk, google api, and android.npk. When I build the module, it finds the module&#39;s build.xml, but it looks in my android sdk folder for &quot;module\android\build.xml&quot; and cannot find it. What should this file be?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 12:11:43 pm">February 29th 2012</span>
											by <span class='authorname'>Zane Wright</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-231876">
				
						<section>
							<p>Hello Thanks for your quick response . </p>
<p>I am in third step where I am not getting proper path for Titanium so when I use ant and hit enter getting path error for Titanium. </p>
<p>And also please suggest for which Clone project from github I have to use for 1.8.1.. Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 29th 2012, 9:29:10 am">February 29th 2012</span>
								by <span class='authorname'>veibhav d</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-231876" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I tried building the code from https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm with the 1.8.1 SDK of Titanium. I do not know, what OS you are working on, on my Mac the build.properties looks like this:</p>
<pre><code class="hljs">titanium.platform=<span class="hljs-regexp">/Library/</span>Application\ Support<span class="hljs-regexp">/Titanium/</span>mobilesdk<span class="hljs-regexp">/osx/</span><span class="hljs-number">1.8</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/android
android.platform=<span class="hljs-regexp">/Users/</span>my_username<span class="hljs-regexp">/Development/</span>etc<span class="hljs-regexp">/android-sdk-mac_x86/</span>platforms/android-<span class="hljs-number">8</span>
google.apis=<span class="hljs-regexp">/Users/</span>my_username<span class="hljs-regexp">/Development/</span>etc<span class="hljs-regexp">/android-sdk-mac_x86/</span>add-ons/addon_google_apis_google_inc_-<span class="hljs-number">8</span>
android.ndk=<span class="hljs-regexp">/Users/</span>my_username<span class="hljs-regexp">/Development/</span>etc/android-ndk-r7
</code></pre><p>For the android API paths, it is the path you installed the SDK or NDK in.</p>
<p>But:<br>I could not get it running in 1.8.1, so I switched back to 1.8.0.1 and did some modifications on module to handle the message callback directly in the module. But the build process was not the problem, I had problems in runtime. (See my post above regarding this.) But others had success even with the 1.8.1 SDK, so just give it a try.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 9:42:55 am">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Robert Schmidt thanks for your response path of titanium found and working but when I use ant command getting below issue:<br>BUILD FAILED<br>&#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.1&#x2F;module&#x2F;android&#x2F;build.xml:59: &#x2F;Vaibhav&#x2F;TITENIUM&#x2F;c2d&#x2F;Kuraturpa&#x2F;lib does not exist.</p>
<p>is it due to 1.8.1?? or if any other than please suggest and should I add clone project to my working project ?? please suggest me.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 9:54:08 am">February 29th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-231891">
				
						<section>
							<p>Ah yes, there was this issue with the lib directory. Just create an empty directory called <code>lib</code> in the module dicrectory.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 29th 2012, 10:03:23 am">February 29th 2012</span>
								by <span class='authorname'>Robert Schmidt</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-231891" rel="permalink">permalink</a>
							</div>

							<h5>26 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Robert Schmidt Thanks for your quick response :-</p>
<p>Uncaught TypeError: Object [object Object] has no method &#39;register&#39; when I use com.findlaw.c2dm in .js file.</p>
<p>And if i change in js file from com.findlaw.c2dm to com.findlaw.titanium.c2dm<br> getting error like Requested module not found: com.findlaw.titanium.c2dm</p>
<p>Please suggest me right now I am using 1.8.1 so how can I switched back to 1.8.0.1 ??</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:24:46 am">February 29th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>For your first error: In JS do not use <code>register: function()..</code> but <code>registerC2dm: function()..</code></p>
<p>If you can&#39;t get it work and want to get back to 1.8.0.1, than you just  need to modify your build.properties to use the SDK path of 1.8.0.1 and build again.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:31:59 am">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi should I have to use c2dm.register(senderId, {… in place of register ??</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:37:30 am">4 years ago</span>
											by <a href="/devlink/profile/1380618/veibhav-d"><span class="">veibhav d</span></a>
										</div>
									</li>
								
									<li class="comment">
										<p><p>sorry please ignore last one..<br>my question is should I change from  c2dm.register(senderId, {… to c2dm.registerC2dm(senderId, {..??</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:39:31 am">4 years ago</span>
											by <a href="/devlink/profile/1380618/veibhav-d"><span class="">veibhav d</span></a>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Exactly!</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:47:28 am">4 years ago</span>
											by <a href="/devlink/profile/178071/robert-schmidt"><span class="">Robert Schmidt</span></a>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry but I am getting below error when I used registerC2dm.. please suggest for this..</p>
<p>Message: Uncaught Error: Not allowed to start service Intent { act=com.google.android.c2dm.intent.REGISTER pkg=com.google.android.gsf (has extras) } without permission com.google.android.c2dm.permission.RECEIVE</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 12:26:24 pm">February 29th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ensure to have the following permissions defined in your tiapp.xml:</p>
<pre><code class="hljs">...
<span class="hljs-tag">&lt;<span class="hljs-title">android</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">manifest</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">permission</span>
                <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"[your_app_id].permission.C2D_MESSAGE"</span> <span class="hljs-attribute">android:protectionLevel</span>=<span class="hljs-value">"signature"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"[your_app_id].permission.C2D_MESSAGE"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.c2dm.permission.RECEIVE"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.WAKE_LOCK"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.VIBRATE"</span>/&gt;</span>
...
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 12:34:29 pm">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Robert I added permissions but getting error by that which mentioned below:-</p>
<p>&lt;manifest&gt;<br>&lt;permission android:name=&quot;com.myApp.permission.C2D_MESSAGE&quot; android:protectionLevel=&quot;signature&quot;&#x2F;&gt;<br>&lt;uses-permission android:name=&quot;com.myApp.permission.C2D_MESSAGE&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;com.google.android.c2dm.permission.RECEIVE&quot;&#x2F;&gt;<br>&lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot;&#x2F;&gt;<br>&lt;uses-permission android:name=&quot;android.permission.VIBRATE&quot;&#x2F;&gt;<br>&lt;&#x2F;manifest&gt;</p>
<p>error is :Error starting Fastdev server: unbound prefix: line 40, column 8</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 2:48:16 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Actually I don&#39;t know but my app is not even launching :-<br>below the error is…please suggest if you have any idea..<br>Traceback (most recent call last):<br>  File &quot;&#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.1&#x2F;iphone&#x2F;builder.py&quot;, line 1537, in &lt;module&gt;<br>    main(sys.argv)<br>  File &quot;&#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.1&#x2F;iphone&#x2F;builder.py&quot;, line 643, in main<br>    ti = TiAppXML(tiapp_xml)<br>  File &quot;&#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.1&#x2F;iphone&#x2F;..&#x2F;tiapp.py&quot;, line 54, in <strong>init</strong><br>    self.dom = parseString(data.read().encode(&#39;utf-8&#39;))<br>  File &quot;&#x2F;System&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;2.6&#x2F;lib&#x2F;python2.6&#x2F;xml&#x2F;dom&#x2F;minidom.py&quot;, line 1928, in parseString<br>    return expatbuilder.parseString(string)<br>  File &quot;&#x2F;System&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;2.6&#x2F;lib&#x2F;python2.6&#x2F;xml&#x2F;dom&#x2F;expatbuilder.py&quot;, line 940, in parseString<br>    return builder.parseString(string)<br>  File &quot;&#x2F;System&#x2F;Library&#x2F;Frameworks&#x2F;Python.framework&#x2F;Versions&#x2F;2.6&#x2F;lib&#x2F;python2.6&#x2F;xml&#x2F;dom&#x2F;expatbuilder.py&quot;, line 223, in parseString<br>    parser.Parse(string, True)<br>xml.parsers.expat.ExpatError: mismatched tag: line 40, column 3</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 3:04:58 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sounds like a problem with your xml. Did you close the android and manifest tag?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 5:48:38 am">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes it&#39;s resolved . Its appear when I put permissions <strong>tiapp.xml</strong> and its resolve when I remove permissions from that file. And permissions are already present in <strong>timodule.xml</strong>..</p>
<hr>
<p>callback:function(e) &#x2F;&#x2F; called when a push notification is received<br>    {<br>        Ti.API.info(&#39;JS message event: &#39; + JSON.stringify(e.data));</p>
<pre><code class="hljs">    <span class="hljs-variable"><span class="hljs-keyword">var</span> intent</span> = Ti.Android.createIntent({
        action: Ti.Android.ACTION_MAIN,
        flags: Ti.Android.FLAG_ACTIVITY_NEW_TASK | Ti.Android.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED,
        <span class="hljs-class"><span class="hljs-keyword">class</span>-<span class="hljs-title">name</span>:<span class="hljs-typename">**WHAT SHOULD I PUT HERE?? currently I put appid.YourActivity**</span></span>
        packageName: 'com.findlaw.c2dm'
    });
</code></pre><hr>
<p>And also Please suggest me how can I resolve below error..</p>
<p>Permission Denial: Accessing service ComponentInfo{com.google.android.gsf&#x2F;com.google.android.gsf.gtalkservice.PushMessagingRegistrar} from pid=60, uid=1000 requires com.google.android.c2dm.permission.RECEIVE<br>E&#x2F;TiJSError(  317): (main) [297,1738] —– Titanium Javascript Runtime Error —–<br>E&#x2F;TiJSError(  317): (main) [0,1738] - In Login.js:53,6<br>E&#x2F;TiJSError(  317): (main) [1,1739] - Message: Uncaught Error: Not allowed to start service Intent { act=com.google.android.c2dm.intent.REGISTER pkg=com.google.android.gsf (has extras) } without permission com.google.android.c2dm.permission.RECEIVE<br>E&#x2F;TiJSError(  317): (main) [0,1739] - Source: c2dm.registerC2dm(senderId, {<br>W&#x2F;ActivityManager(   60): Launch timeout has expired, giving up wake lock!<br>E&#x2F;V8Exception(  317): Exception occurred at Login.js:53: Uncaught Error: Not allowed to start service Intent { act=com.google.android.c2dm.intent.REGISTER pkg=com.google.android.gsf (has extras) } without permission com.google.android.c2dm.permission.RECEIVE</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 6:03:45 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It should be like this:</p>
<pre><code class="hljs"><span class="hljs-component">var intent = Ti.Android.createIntent({
        action: Ti<span class="hljs-string">.Android.ACTION_MAIN</span>,
        flags: Ti<span class="hljs-string">.Android.FLAG_ACTIVITY_NEW_TASK</span> | Ti<span class="hljs-string">.Android.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED</span>,
        className: [your_app_id].[your_main_activity]
        packageName: [your_app_id]
    }</span>);
</code></pre><p>You can find the main activtiy when you navigate to the build folder of your app, goto android&#x2F;gen&#x2F;[your_app_id]. Find the file containing &quot;Activity&quot;. This filename (without extension) is your main activity.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 6:20:13 am">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Robert , Apps is running without error .. But how to check push notification in it?? Please suggest me..</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 8:06:41 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Do you have a push server to send messages from? Do you have a google c2dm account already? If so, just send messages to your device. Use ddms (found in android sdk tools) and Ti.API.info to track callback triggering.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 8:15:46 am">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Robert, thanks for Great help..Push notification working in iPhone for that, we are sending device token to server and receiving push notification on device..</p>
<p>For <strong>android</strong> I created google c2dm account and about push server … is push server for send messages would be the same like iPhone ?? and what about device token for Android…please suggest me..</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 9:30:37 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Here is an example on how to create a c2dm server with php:<br>http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;4121508&#x2F;c2dm-implementation-php-code</p>
<p>Implement this! Then in our app in success-callback send a request to your c2dm server to save registration id of the user. Use this registration id to send messages to the phone.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 9:43:57 am">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>For ios we already having server in dot net so can we use same for Android?? or if no than are you having any code for . net also??</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 10:52:25 am">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The sending process is different from Apple PushService. Have a look at this, it may help you:</p>
<p>https:&#x2F;&#x2F;github.com&#x2F;Redth&#x2F;C2DM-Sharp</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 11:19:12 am">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for quick response . Is there any way to conform that my client side code is perfect for push notification is there any way?? or any online push notification server??</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 1:00:27 pm">March 1st 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not that I am aware of. But for PHP it took me only 1-2 hours to get a test server running, which was sending messages. It is not that difficult. Basically it is a simple http request, which is sent to the google server to do the delivery to the phone.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 1st 2012, 1:07:48 pm">March 1st 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Robert Thanks for Great help and now its working with Php server as you send url and also its working fine on Titanium 1.8.1.. </p>
<p>If you get anything for Asp dotnet than please send me…Thanks again..</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 3rd 2012, 5:17:31 am">March 3rd 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Robert are you know how to open application when click on push notification message in Android in Titanium,…!</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 3rd 2012, 7:20:15 am">March 3rd 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Robert every thing is working fine just one more help that  badge one(1) is always displaying on application logo in iPhone.. Normally badge (1) should remove after some time … so how can Badge should remove after push notification??</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 6th 2012, 10:19:47 am">March 6th 2012</span>
											by <span class='authorname'>veibhav d</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hello Robert, i am getting a success push, but i still m not able to see any notification on my device or emulator also the callback function in my .js is not called</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 12:00:47 pm">March 22nd 2012</span>
											by <span class='authorname'>shyam shroff</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Try to use ddms (in your android-sdk tools directory) and watch, what errors you get, when the module is trying to receive the push message. That might help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 12:11:17 pm">March 22nd 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hello Robert,actually i m stuck on how the send registrationid to server-side, on referring to some blog i am doing this</p>
<pre><code class="hljs">success:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    ...    

    <span class="hljs-comment">// TODO for you: send e.registrationId to your server-side database</span>
    <span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
    xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ex</span>) </span>{
        Ti.API.error(<span class="hljs-string">'XHR Error in registering PNS : '</span> + <span class="hljs-built_in">JSON</span>.stringify(ex));
    };
    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.readyState == <span class="hljs-number">4</span> &amp;&amp; <span class="hljs-keyword">this</span>.status == <span class="hljs-number">200</span>) {
            Ti.API.info(<span class="hljs-string">'Push success'</span>+<span class="hljs-keyword">this</span>.responseData);
        }
    };

     xhr.open(<span class="hljs-string">'POST'</span>, <span class="hljs-string">'https://android.apis.google.com/c2dm/send?registration_id='</span> +e.registrationId + <span class="hljs-string">'&amp;data.message=hello tear&amp;collapse_key=0'</span>);
     xhr.setRequestHeader(<span class="hljs-string">"Content-Type"</span>,<span class="hljs-string">"application/x-www-form-urlencoded;charset=UTF-8"</span>);
    xhr.setRequestHeader(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"GoogleLogin auth="</span>+ auth_token);
     xhr.send();
     Ti.API.info(<span class="hljs-string">'finish success caqllback'</span>);
}
</code></pre><p>now when i debug it in ddms i get a &quot;push successid=<strong>*</strong>&quot;<br>but i dont get any notification on my device&#x2F;emulator.<br>Also i have some info log is callback function like error n callback, but none of them are executed.<br>So plz can u tell me where m i going wrong.<br>i m using 1.8.1 sdk and android 2.2</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 23rd 2012, 3:25:27 am">March 23rd 2012</span>
											by <span class='authorname'>shyam shroff</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234593">
				
						<section>
							<p>Looking at all possible solution for C2dm Android Push Notification on various communities ,i would like to contribute best approach which i have been successfully able to implement .</p>
<p>1.<br>I have used Titanium 1.7.5 and 1.8.0.1 earlier ,which don&#39;t  work and give various errors,which are due to deprecated methods and absence of libraries used in C2dm,i would suggest either to add those libraries in you project by creating a lib folder ,else directly use 1.8.2(best SDK version) and create an empty lib folder.So execute command below in ur MAC Terminal,an alias will be created for ur SDK.<br>alias titanium=&quot;Library&#x2F;Application\ Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.2&#x2F;titanium.py&quot;.<br>You can check if it is created by using following Command,<br>cd Titanium<br>This will give you<br>Appcelerator Titanium<br>Copyright (c) 2010-2011 by Appcelerator, Inc.</p>
<p>commands:</p>
<p>  create      - create a project<br>  run         - run an existing project<br>  emulator    - start the emulator (android)<br>  docgen      - generate html docs for a module (android)<br>  fastdev     - management for the Android fastdev server<br>  help        - get help</p>
<p>2.Now create a module from your project,by using common below,<br>(Your_root)$ titanium create –platform=android –type=module –name=c2dmmod –id=com.Yourcompany.c2dmmod –android=Documents&#x2F;android-sdk-mac_x86.</p>
<p>3.Once your module is created in your root directory,u need to change build.properties based on path your machine uses,my machine uses following</p>
<p>titanium.platform=&#x2F;Users&#x2F;Yourpath&#x2F;Library&#x2F;Application Support&#x2F;Titanium&#x2F;mobilesdk&#x2F;osx&#x2F;1.8.2&#x2F;android<br>android.platform=&#x2F;Users&#x2F;Yourpath&#x2F;Documents&#x2F;android-sdk-mac_x86&#x2F;platforms&#x2F;android-8<br>google.apis=&#x2F;Users&#x2F;Yourpath&#x2F;Documents&#x2F;android-sdk-mac_x86&#x2F;add-ons&#x2F;addon-google_apis-google<em>inc</em>-8<br>android.ndk=&#x2F;Users&#x2F;Yourpath&#x2F;Documents&#x2F;android-ndk-r7b</p>
<p>Make sure to have ndk,addon-google_apis-google<em>inc</em>-8 on ur machine and give respective paths.</p>
<p>4.Download https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm ,we just need src folder from here replace Source folder of your module with src folder of newly downloaded project from link above.</p>
<p>5.Now we are set with Module which has your build properties(as per your machine),src replaced,wince they have find law and google code which help us execute c2dm.</p>
<p>6.We have to build ant for newly created module,add an empty folder called lib in your module if it doesn&#39;t exists.</p>
<p>7.Now before running ant command get into your module directory ,in our case we have created a c2dm module called c2dmmod,<br>so my terminal would look something like<br>(Your_root)-Mac-mini-6:c2dmmod Yourroot$ ant</p>
<p>just get into module&#39;s directory and run ant.</p>
<p>8.Once you run ant if every thing is perfect you will get a message saying Build Successful message .Now you will find a new folder called dist(Distribution) has been created in to your module project,with a jar and a zip file of your project(This zip is what we are going to use in our Titanium Project).</p>
<p>9.Now get back into your project where you want to use C2dm and do following</p>
<p>a.<br>Add zip of your Module project to this Titanium Project at Root level,at the same level as tiapp.xml.<br>In our case for module create zip file will be com.findlaw.c2dmmod-android-0.1.zip.</p>
<p>b.<br>In your tiapp.xml add,following</p>
<p>&lt;android xmlns:android=&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;&gt;<br>        &lt;manifest&gt;<br>            &lt;permission<br>                android:name=&quot;YourAppid.permission.C2D_MESSAGE&quot; android:protectionLevel=&quot;signature&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;YourAppid.permission.C2D_MESSAGE&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;com.google.android.c2dm.permission.RECEIVE&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.VIBRATE&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.GET_ACCOUNTS&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.USE_CREDENTIALS&quot;&#x2F;&gt;<br>            &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot;&#x2F;&gt;<br>            &lt;application&gt;</p>
<pre><code class="hljs">            <span class="hljs-tag">&lt;<span class="hljs-title">service</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.findlaw.c2dm.C2DMReceiver"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">receiver</span>
                <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.c2dm.C2DMBroadcastReceiver"</span> <span class="hljs-attribute">android:permission</span>=<span class="hljs-value">"com.google.android.c2dm.permission.SEND"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.c2dm.intent.RECEIVE"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"YourAppid"</span>/&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.BOOT_COMPLETED"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.HOME"</span>/&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.c2dm.intent.REGISTRATION"</span>/&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"YourAppid"</span>/&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">receiver</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">application</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">manifest</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">android</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">modules</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">module</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"android"</span> <span class="hljs-attribute">version</span>=<span class="hljs-value">"0.1"</span>&gt;</span>com.findlaw.c2dmmod<span class="hljs-tag">&lt;/<span class="hljs-title">module</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">modules</span>&gt;</span>
</code></pre><p>  com.findlaw.c2dmmod in module being your module name.</p>
<p>c.<br>Register for c2dm at http:&#x2F;&#x2F;code.google.com&#x2F;android&#x2F;c2dm&#x2F;signup.html.</p>
<p>D.<br>From downloaded example of https:&#x2F;&#x2F;github.com&#x2F;Kuraturpa&#x2F;titanium-c2dm,you can use same app.js file in your Titanium project,replace<br>var senderId = &#39;Your registered Gmail id&#39;;<br>var c2dm = require(&#39;Your module name); </p>
<p>e.<br>Change Class name and package name based on your project settings<br>className: &#39;Your_Appid.YourActivity_name&#39;  (Your Activity name can be found at YourProject&#x2F;Build&#x2F;Android&#x2F;Gen&#x2F;Your module&#x2F;Activity.java(Activity name would be based on your project id,just pick name of file with name as activity,don&#39;t copy .java just name is enough).<br>packageName: &#39;Your App_id&#39;(Can be seem in tiapp.xml).</p>
<p>10.Once you run this project as per steps above you will receive a Device id from Google,which we will use in our Server Call.This need to be passed to server<br>11.Once your done this ,we need to execute php service from Server end,following is code which you will need to execute,</p>
<hr>
<p>&lt;?php<br>&#x2F;<em>
</em></p>
<ul>
<li>$username - your gmail email address you white listed with the c2dm service</li>
<li>$password - password for above gmail account.<br>*&#x2F;</li>
</ul>
<p>function googleAuthenticate($username, $password, $source=&quot;Company-AppName-Version&quot;, $service=&quot;ac2dm&quot;) {     </p>
<pre><code class="hljs">@session_start(); 

<span class="hljs-keyword">if</span>( isset($_SESSION[<span class="hljs-string">'google_auth_id'</span>]) &amp;&amp; $_SESSION[<span class="hljs-string">'google_auth_id'</span>] != null)     
    <span class="hljs-keyword">return</span> $_SESSION[<span class="hljs-string">'google_auth_id'</span>];  



// get an authorization token 

<span class="hljs-variable">$ch</span> = curl_init(); 

<span class="hljs-keyword">if</span>(!<span class="hljs-variable">$ch</span>){ 

    return <span class="hljs-string">''</span>; 
} 




curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-string">"https://www.google.com/accounts/ClientLogin"</span>); 

<span class="hljs-variable">$post</span>_fields = <span class="hljs-string">"accountType="</span> . urlencode(<span class="hljs-string">'HOSTED_OR_GOOGLE'</span>) 
    . <span class="hljs-string">"&amp;Email="</span> . urlencode(<span class="hljs-variable">$username</span>) 
    . <span class="hljs-string">"&amp;Passwd="</span> . urlencode(<span class="hljs-variable">$password</span>) 
    . <span class="hljs-string">"&amp;source="</span> . urlencode(<span class="hljs-variable">$source</span>) 
    . <span class="hljs-string">"&amp;service="</span> . urlencode(<span class="hljs-variable">$service</span>); 


curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-literal">true</span>); 
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_POST, <span class="hljs-literal">true</span>); 
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="hljs-variable">$post</span>_fields); 
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-literal">true</span>); 
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_FRESH_CONNECT, <span class="hljs-literal">true</span>);     
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_HTTPAUTH, CURLAUTH_ANY); 
curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="hljs-literal">false</span>); 

// <span class="hljs-keyword">for</span> debugging the request 
//curl_setopt(<span class="hljs-variable">$ch</span>, CURLINFO_HEADER_OUT, <span class="hljs-literal">true</span>); // <span class="hljs-keyword">for</span> debugging the request 

<span class="hljs-variable">$response</span> = curl_exec(<span class="hljs-variable">$ch</span>); 


//echo <span class="hljs-variable">$response</span>;   


//var_dump(curl_getinfo(<span class="hljs-variable">$ch</span>)); //<span class="hljs-keyword">for</span> debugging the request 
//var_dump(<span class="hljs-variable">$response</span>); 

curl_close(<span class="hljs-variable">$ch</span>); 

<span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$response</span>, <span class="hljs-string">'200 OK'</span>) === <span class="hljs-literal">false</span>) { 

    echo <span class="hljs-string">"200 Not Ok"</span>;
    return <span class="hljs-string">''</span>; 
} 

// find the auth code 
preg_match(<span class="hljs-string">"/(Auth=)([\w|-]+)/"</span>, <span class="hljs-variable">$response</span>, <span class="hljs-variable">$matches</span>); 

<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$matches</span>[<span class="hljs-number">2</span>]) { 
    echo <span class="hljs-string">"No Match"</span>;
    return <span class="hljs-string">''</span>; 
} 

$_SESSION[<span class="hljs-string">'google_auth_id'</span>] = <span class="hljs-variable">$matches</span>[<span class="hljs-number">2</span>]; 

 <span class="hljs-keyword">return</span> <span class="hljs-variable">$matches</span>[<span class="hljs-number">2</span>]; 

 //<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
</code></pre><p>} </p>
<p>&#x2F;<em>
</em></p>
<ul>
<li>$authCode - the authcode returned when you ran the googleAuthenticate function</li>
<li>$deviceRegistrationId - registrationID returned by the device receiving the message</li>
<li>$$msgType - can be anything i.e. &#39;chat message&#39;</li>
<li>$messageText - text to be sent<br>*&#x2F;</li>
</ul>
<p>function sendMessageToPhone($authCode, $deviceRegistrationId, $msgType, $messageText) { </p>
<pre><code class="hljs">    <span class="hljs-variable">$headers</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">'Authorization: GoogleLogin auth='</span> . <span class="hljs-variable">$authCode</span>); 
    <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>( 
        <span class="hljs-string">'registration_id'</span> =&gt; <span class="hljs-variable">$deviceRegistrationId</span>, 
        <span class="hljs-string">'collapse_key'</span> =&gt; <span class="hljs-variable">$msgType</span>, 
        <span class="hljs-string">'data.message'</span> =&gt; <span class="hljs-variable">$messageText</span> //TODO Add more params with just simple data instead            
    ); 

    <span class="hljs-variable">$ch</span> = curl_init(); 

    curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-string">"https://android.apis.google.com/c2dm/send"</span>); 

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$headers</span>) 
        curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="hljs-variable">$headers</span>); 
    curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_SSL_VERIFYPEER, <span class="hljs-literal">false</span>); 
    curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_POST, <span class="hljs-literal">true</span>); 
    curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-literal">true</span>); 
    curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="hljs-variable">$data</span>); 


    <span class="hljs-variable">$response</span> = curl_exec(<span class="hljs-variable">$ch</span>); 

    curl_close(<span class="hljs-variable">$ch</span>); 

    echo <span class="hljs-variable">$response</span>; 

    //var_dump(<span class="hljs-variable">$response</span>);
</code></pre><p>} </p>
<p>$msgType = &#39;chat message111&#39;;<br>$message = &#39;Friend Request111!&#39;;</p>
<p>  $regID=&#39;Your Device regestration ID&#39;;</p>
<p>$auth = googleAuthenticate(&quot;Your Registered Email Id&quot;,&quot;Yourmessage&quot;,&quot;Your Titanium project&#39;s App ID&quot;);<br>sendMessageToPhone($auth, $regID, $msgType, $message);</p>
<p>?&gt;</p>
<hr>
<p>12.Once you run this from server you will get Notification on your device ,which while have message as sent,this will redirect you to your app when clicked.</p>
<p>13.I have checked all possible solutions,and finally been able to get Notifications following steps above.<br>I would suggest to use 1.8.2 SDK,1.8.0.1 has many bugs hence i would&#39;t advice you that.</p>
<p>14.Thanks all communities which have inspired me to write this and given me a strong urge to share what we receive.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 28th 2012, 8:37:56 am">March 28th 2012</span>
								by <span class='authorname'>bhushan T</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-234593" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Any idea on how to take the C2dm registrationID and register it with UrbanAirship?<br>Otherwise.. this was an awesome tutorial.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 21st 2012, 5:27:34 pm">June 21st 2012</span>
											by <span class='authorname'>Gary Stock</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-231899">
				
						<section>
							<p>I have a strange problem… In the java source I changed the strings for the notification (tickerText, contentTitle and contentText vitiable values) and still when I recompile and put it in my app I still see the old values… anyone knows the cause?</p>
<p>thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 29th 2012, 11:27:25 am">February 29th 2012</span>
								by <span class='authorname'>Ophir &#39;Shlomi&#39; Oren</span><br>
								<a class="icon-bg icon-link" href="question/131680/sdk-181-android-modules-problem#answer-231899" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>The notification used in the java module is only triggered if the module is not found and the JS-callback can not be triggered.</p>
<p>This condition checks wether the module is accessible or not:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (C2dmModule.getInstance() == <span class="hljs-literal">null</span>) {
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:34:50 am">February 29th 2012</span>
											by <span class='authorname'>Robert Schmidt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I know…</p>
<p>It was a &#39;Clean Project&#39; type of problem</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 29th 2012, 11:50:25 am">February 29th 2012</span>
											by <span class='authorname'>Ophir &#39;Shlomi&#39; Oren</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I have the same problem while receiving the notification and get &quot;C2dmModule.getInstance() == null&quot; in the java module. Does anyone know how to fix it ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2012, 7:17:58 am">May 25th 2012</span>
											by <span class='authorname'>Darren Shen</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-1</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
