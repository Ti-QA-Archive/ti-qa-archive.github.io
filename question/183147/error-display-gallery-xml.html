<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>error display gallery xml Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>error display gallery xml</h1>
		</header>
		<section>
			<p>Good evening, I have a problem with this gallery (codeboxed). I load images via XML files. where am I wrong?</p>
<p>var ImageGallery = require(&#39;com.codeboxed.imagegallery&#39;);</p>
<p>var views=[];<br>var xhr = Ti.Network.createHTTPClient();<br>xhr.open(&#39;GET&#39;, urlXml);<br>xhr.onload = function() {<br>    var doc = this.responseXML.documentElement;<br>    Titanium.API.info(doc);<br>    var items = doc.getElementsByTagName(&quot;luogo&quot;);<br>    Titanium.API.info(items.length);<br>    for (var c = 0; c &lt; items.length; c++) {<br>        var item = items.item(c);<br>        var id=item.getElementsByTagName(&quot;id&quot;).item(0).textContent;<br>            var denominazione=item.getElementsByTagName(&quot;denominazione&quot;).item(0).textContent;<br>            var descrizione_breve=item.getElementsByTagName(&quot;descrizione_breve&quot;).item(0).textContent;<br>            var descrizione=      item.getElementsByTagName(&quot;descrizione&quot;).item(0).textContent;<br>            var link_img=item.getElementsByTagName(&quot;link_img&quot;).item(0).textContent;</p>
<pre><code class="hljs">var _images = [
{<span class="hljs-string">path:</span><span class="hljs-string">'link_image'</span>, <span class="hljs-string">caption:</span><span class="hljs-string">'denominazione'</span>},
</code></pre><p>];<br>    }</p>
<p>&#x2F;&#x2F; Initialize the Image Gallery</p>
<p>var imageGallery = create({<br>    images: _images,<br>    columns: 4, &#x2F;&#x2F; Set the numbers of columns (optional). Default is 4<br>    thumbSize: 75, &#x2F;&#x2F; Set the thumb image size (optional). Default is 75<br>    thumbPadding: 5 &#x2F;&#x2F; Set the thumb image padding (optional). Default is 5<br>});</p>
<p>var _viewArray=[];<br>var _imageWin= null;<br>var _isGesture = true;<br>var _isFullscreen = false;<br>&#x2F;&#x2F; Add it to the current window<br>Ti.API.info(&quot;ciao&quot;);</p>
<p>$.contenitore.add(imageGallery);<br>function create(properties) {<br>    var<br>    &#x2F;**</p>
<pre><code class="hljs"> * The rows pointer
 * @property _rows
 * @type Number
 */ 
_rows                 = <span class="hljs-number">0</span>,

<span class="hljs-comment">/**
 * The columns pointer
 * <span class="hljs-doctag">@property</span> _columns
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_columns             = <span class="hljs-number">0</span>,

<span class="hljs-comment">/**
 * The row position pointer
 * <span class="hljs-doctag">@property</span> _rowPosition
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_rowPosition         = <span class="hljs-number">2</span>,

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _rowPositionReset
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_rowPositionReset     = <span class="hljs-number">2</span>,

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _columnPosition
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_columnPosition     = <span class="hljs-number">15</span>,

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _images
 * <span class="hljs-doctag">@type</span> Array
 */</span>
<span class="hljs-comment">//_images             = imagesArray, </span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _win
 * <span class="hljs-doctag">@type</span> Titanium.UI.Window
 */</span>
_win                = properties.win,

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _noColumns
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_noColumns                = properties.columns || <span class="hljs-number">4</span>,

<span class="hljs-comment">/**
 * The thumb size property
 * <span class="hljs-doctag">@property</span> _thumbSize
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_thumbSize            = properties.thumbSize || <span class="hljs-number">75</span>,

<span class="hljs-comment">/**
 * The thumb padding property
 * <span class="hljs-doctag">@property</span> _thumbPadding
 * <span class="hljs-doctag">@type</span> Number
 */</span>
_thumbPadding         = properties.thumbPadding || <span class="hljs-number">5</span>,

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _isFullscreen
 * <span class="hljs-doctag">@type</span> Boolean
 */</span>
<span class="hljs-comment">//_isFullscreen         = false,</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _isGesture
 * <span class="hljs-doctag">@type</span> Boolean
 */</span>
<span class="hljs-comment">//_isGesture             = true,</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _viewArray
 * <span class="hljs-doctag">@type</span> Array
 */</span>
<span class="hljs-comment">//_viewArray             = [],</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _imageWin
 * <span class="hljs-doctag">@type</span> Titanium.UI.Window
 */</span>
<span class="hljs-comment">//_imageWin            = null, </span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@property</span> _scrollView
 * <span class="hljs-doctag">@type</span> Titanium.UI.ScrollView
 */</span>
_scrollView            = <span class="hljs-keyword">null</span>;    

<span class="hljs-comment">/**
 * Return the device family
 * 
 * <span class="hljs-doctag">@method</span> _getDeviceFamily
 * <span class="hljs-doctag">@return</span> {String} The device family
 */</span>

<span class="hljs-comment">// Overwrite the default properties for iPad (if no defined by user)</span>
<span class="hljs-keyword">if</span> (_getDeviceFamily() === <span class="hljs-string">'ipad'</span>) {
    <span class="hljs-keyword">if</span> (properties.rows === undefined) {
        _noColumns = <span class="hljs-number">9</span>;    
    }

    <span class="hljs-keyword">if</span> (properties.thumbPadding === undefined) {
        _thumbPadding = <span class="hljs-number">10</span>;
    }
}

<span class="hljs-comment">// Create ScrollView</span>
_scrollView = Ti.UI.createScrollView({
    contentWidth: <span class="hljs-string">'100%'</span>,
    contentHeight: <span class="hljs-string">'auto'</span>,
    top: <span class="hljs-number">0</span>,
    backgroundColor: <span class="hljs-string">'#000'</span>,
    showVerticalScrollIndicator: <span class="hljs-keyword">true</span>,
    showHorizontalScrollIndicator: <span class="hljs-keyword">false</span>
});

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, b = _images.length; i &lt; b; i++) {
    <span class="hljs-keyword">var</span> _img;

    <span class="hljs-comment">// Display the thumbs on 4 collumns</span>
    <span class="hljs-keyword">if</span> (_columns % _noColumns === <span class="hljs-number">0</span> &amp;&amp; _rows !== <span class="hljs-number">0</span>) {
        _columnPosition += _thumbSize + _thumbPadding;
        _rowPosition = _rowPositionReset;
    }

    <span class="hljs-comment">// Create the thumb as a label with a background image</span>
    _img = Ti.UI.createImageView({
        backgroundImage: _images[i].path,
        width: _thumbSize,
        height: _thumbSize,
        myID: i,
        left: _rowPosition,
        top: _columnPosition
    });

    <span class="hljs-comment">// Set the thumbs properties</span>
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Properties should be sent as an option</span>
    _img.borderColor                 = <span class="hljs-keyword">null</span>;
    _img.borderWidth                 = <span class="hljs-number">0</span>;
    _img.backgroundPaddingLeft         = <span class="hljs-number">0</span>;
    _img.backgroundPaddingRight     = <span class="hljs-number">0</span>;
    _img.backgroundPaddingTop         = <span class="hljs-number">0</span>;
    _img.backgroundPaddingBottom    = <span class="hljs-number">0</span>;
    _img.backgroundLeftCap             = <span class="hljs-number">0</span>;
    _img.backgroundTopCap             = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// Attach click listener to each thumb</span>
    _img.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> </span>{
        <span class="hljs-comment">// Create a new window and show the image selected</span>
        _imageWin = Ti.UI.createWindow({
            backgroundColor: <span class="hljs-string">'#000'</span>,
            title: e.source.myID + <span class="hljs-number">1</span> + <span class="hljs-string">' of '</span> + _images.length
        });

        <span class="hljs-comment">// Add elements to the window </span>
        _createImageWin(e.source.myID);

        <span class="hljs-comment">// Push the window in the tabbar controller</span>
        _imageWin.open();
</code></pre><p>&#x2F;&#x2F;            Ti.UI.currentTab.open(_imageWin);<br>        });</p>
<pre><code class="hljs">    <span class="hljs-comment">// Add thumb to the scrollview</span>
    _scrollView.add(_img);

    <span class="hljs-comment">// Increment pointers</span>
    _columns += <span class="hljs-number">1</span>;
    _rows += <span class="hljs-number">1</span>;
    _rowPosition += _thumbSize + _thumbPadding;
}

<span class="hljs-keyword">return</span> _scrollView;
</code></pre><p>}<br>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;<br>      function _getDeviceFamily() {<br>        var deviceName = null;</p>
<pre><code class="hljs">    <span class="hljs-keyword">switch</span> (Ti.Platform.name) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'android'</span>:
            deviceName = <span class="hljs-string">'android'</span>;
        <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">'iPhone OS'</span>:
            <span class="hljs-keyword">if</span> (Ti.Platform.displayCaps.dpi === <span class="hljs-number">130</span>) {
                deviceName = <span class="hljs-string">'ipad'</span>;
            } <span class="hljs-keyword">else</span> {
                deviceName = <span class="hljs-string">'iphone'</span>;    
            }
        <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-keyword">return</span> deviceName;
};
</code></pre><p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;<br>    &#x2F;**</p>
<pre><code class="hljs"> * Add elements to image window
 * 
 * @method _createImageWin
 * @param {Number} The image to start with ID
 */
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_createImageWin</span><span class="hljs-params">(myID)</span> </span>{
    <span class="hljs-keyword">var</span> photosView,
        descriptionLabel,
        view,
        flexSpace,
        leftButton,
        rightButton,
        toolbar;

    photosView = Ti.UI.createScrollableView({
        width: <span class="hljs-string">'100%'</span>,
        height: <span class="hljs-string">'100%'</span>,
        top: <span class="hljs-number">0</span>,
        showPagingControl: <span class="hljs-keyword">false</span>,
        pagingControlColor: <span class="hljs-string">'#fff'</span>,
        minZoomScale: <span class="hljs-number">1.0</span>,
        maxZoomScale: <span class="hljs-number">8.0</span>,
        currentPage: <span class="hljs-number">0</span>,


    });

    descriptionLabel = Ti.UI.createLabel({
        text: _images[myID].caption,
        width: <span class="hljs-string">'100%'</span>,
        bottom: <span class="hljs-number">45</span>,
        height: <span class="hljs-string">'auto'</span>,
        backgroundColor: <span class="hljs-string">'#000'</span>,
        font: {
            fontSize: <span class="hljs-number">14</span>,
            fontWeight: <span class="hljs-string">'bold'</span>
        },
        color: <span class="hljs-string">'#FFF'</span>,
        zIndex: <span class="hljs-number">2</span>,
        opacity: <span class="hljs-number">0.5</span>
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, b = _images.length; i &lt; b; i++) {
        viewForZoom = Ti.UI.createScrollView({
            backgroundColor: <span class="hljs-string">'#000'</span>,
            <span class="hljs-comment">//width: '100%',</span>
            <span class="hljs-comment">//height: '100%',</span>
            <span class="hljs-comment">//top: 20,</span>
            zoomScale:<span class="hljs-string">'1.0'</span>,
            minZoomScale:<span class="hljs-string">'1.0'</span>,
            maxZoomScale:<span class="hljs-string">'5.0'</span>

        });

        view = Ti.UI.createImageView({
            backgroundColor: <span class="hljs-string">'#000'</span>,
            image: _images[i].path,
            width: <span class="hljs-string">'100%'</span>,
            height: Ti.UI.SIZE,
            <span class="hljs-comment">//top: 20,</span>

        });
        viewForZoom.add(view);

        _viewArray[i] = viewForZoom;
    }

    photosView.views = _viewArray;
    photosView.currentPage = myID;

    _imageWin.add(photosView);

    _imageWin.hideTabBar();

    flexSpace = Ti.UI.createButton({
        systemButton: Ti.UI.iPhone.SystemButton.FLEXIBLE_SPACE
    });

    leftButton = Ti.UI.createButton({
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Allow to pass the leftButton image as an option </span>
        systemButton: Ti.UI.iPhone.SystemButton.REWIND
    });

    leftButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// Defined the boundries</span>
        <span class="hljs-keyword">var</span> index = (photosView.currentPage - <span class="hljs-number">1</span> &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">0</span>: photosView.currentPage - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">var</span> view = photosView.views[index];

        _isGesture = <span class="hljs-keyword">false</span>;

        photosView.scrollToView(view);
    });

    rightButton = Ti.UI.createButton({
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Allow to pass the rightButton image as an option</span>
        systemButton: Ti.UI.iPhone.SystemButton.FAST_FORWARD
    });

    rightButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// Defined the boundries</span>
        <span class="hljs-keyword">var</span> index = (photosView.currentPage + <span class="hljs-number">1</span> &gt;= photosView.views.length) ? photosView.currentPage: photosView.currentPage + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">var</span> view = photosView.views[index];

        _isGesture = <span class="hljs-keyword">false</span>;

        photosView.scrollToView(view);
    });


    centralButton = Ti.UI.createButton({
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Allow to pass the rightButton image as an option</span>
        systemButton: Ti.UI.iPhone.SystemButton.CANCEL
    });

    centralButton.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        _imageWin.close();
    });


    toolbar = Titanium.UI.iOS.createToolbar({
        items: [flexSpace, leftButton, flexSpace,centralButton,flexSpace, rightButton, flexSpace],
        bottom: <span class="hljs-number">0</span>,
        borderTop: <span class="hljs-keyword">true</span>,
        borderBottom: <span class="hljs-keyword">true</span>,
        barColor: <span class="hljs-string">'#000'</span>,
        opacity: <span class="hljs-string">'0.5'</span>,
    });

    _imageWin.add(toolbar);

    photosView.addEventListener(<span class="hljs-string">'singletap'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// If the view is fullscreen the exit fullscreen</span>
        <span class="hljs-comment">// else go fullscreen</span>

        <span class="hljs-keyword">if</span> (_isFullscreen) {
            <span class="hljs-comment">// Exit fullscreen</span>
            <span class="hljs-comment">//Ti.UI.iPhone.showStatusBar();</span>
            _imageWin.fullscreen=<span class="hljs-keyword">false</span>;
            _imageWin.showNavBar();
            toolbar.show();
            descriptionLabel.show();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Go fullscreen</span>
            <span class="hljs-comment">//Ti.UI.iPhone.hideStatusBar();</span>
            _imageWin.fullscreen=<span class="hljs-keyword">true</span>;
            _imageWin.hideNavBar();
            toolbar.hide();
            descriptionLabel.hide();
        }

        _isFullscreen = !_isFullscreen;
    });

    photosView.addEventListener(<span class="hljs-string">'scroll'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
        <span class="hljs-keyword">if</span> (_isGesture) {
            <span class="hljs-comment">//Ti.UI.iPhone.hideStatusBar();</span>
            _imageWin.fullscreen=<span class="hljs-keyword">true</span>;
            _imageWin.hideNavBar();
            toolbar.hide();
            descriptionLabel.hide();

            _isFullscreen = <span class="hljs-keyword">true</span>;
        } <span class="hljs-keyword">else</span> {
            _isGesture = <span class="hljs-keyword">true</span>;
        }
        Ti.API.info(e.currentPage);
        <span class="hljs-keyword">if</span>(e.currentPage!=<span class="hljs-keyword">null</span>){
            descriptionLabel.text = _images[e.currentPage].caption;
        }
        <span class="hljs-comment">//_imageWin.title = e.currentPage + 1 + ' of ' + _images.length;</span>
    });

    _imageWin.add(descriptionLabel);
};
</code></pre><p>&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 17th 2015, 6:41:54 pm">September 17th 2015</span>
				by <span class='authorname'>giuseppe viscomi</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>appcelerator</span></li>
					
						<li><span class='tagname'>error</span></li>
					
						<li><span class='tagname'>gallery</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
