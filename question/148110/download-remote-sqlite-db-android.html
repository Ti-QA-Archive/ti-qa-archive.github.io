<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Download Remote SQLITE DB Android Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Download Remote SQLITE DB Android</h1>
		</header>
		<section>
			<p>I Dont no my mistake hope someone can help me. </p>
<p>Here is my code </p>
<pre><code class="hljs">
<span class="hljs-keyword">var</span> dbProd = Ti.Database.install(<span class="hljs-string">'/db/gastroapp.db'</span>,<span class="hljs-string">'gastroapp'</span>);


btnUpdateProdDB.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{


<span class="hljs-comment">//function UpdateDB() {</span>

    <span class="hljs-comment">//var osha    = Ti.Database.install('/db/gastroapp.db', 'gastroapp');</span>
    <span class="hljs-keyword">if</span> ( Ti.Platform.osname == <span class="hljs-string">'android'</span> ) {
      <span class="hljs-keyword">var</span>  dbPath = <span class="hljs-string">'file:///data/data/'</span> + Ti.App.getID() + <span class="hljs-string">'/databases/'</span>;
         <span class="hljs-keyword">var</span> fileProdukteDB = Ti.Filesystem.getFile( dbPath + <span class="hljs-string">'gastroapp.db'</span> ); 
}
<span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span>    dbPath = Ti.Filesystem.applicationSupportDirectory;
     <span class="hljs-keyword">var</span>   fileProdukteDB = Ti.Filesystem.getFile( dbPath + <span class="hljs-string">'gastroapp.db'</span> );
}

    <span class="hljs-comment">//var fileProdukteDB = Ti.Filesystem.getFile(Ti.Filesystem.applicationSupportDirectory,'/database/' +'gastroapp.db');</span>

    <span class="hljs-keyword">var</span> c = Ti.Network.createHTTPClient();

    c.setTimeout(<span class="hljs-number">10000</span>);
    c.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        <span class="hljs-keyword">var</span> dbProd = Ti.Database.open(<span class="hljs-string">'gastroapp'</span>);
        dbProd.close();

        <span class="hljs-keyword">if</span> ( fileProdukteDB.exists() ) {
            Ti.API.info(<span class="hljs-string">"File deleted."</span>);
            fileProdukteDB.deleteFile();
        }
        <span class="hljs-comment">//fileProdukteDB.createFile();</span>
        fileProdukteDB.write(c.responseData);
        <span class="hljs-comment">//var dbProd = Ti.Database.install('gastroapp.db','gastroapp');</span>



        <span class="hljs-keyword">var</span> dbProd = Ti.Database.open(<span class="hljs-string">'gastroapp'</span>);
        Ti.API.info(<span class="hljs-string">"ONLOAD = "</span> + c.status + e);
        Ti.API.info(<span class="hljs-string">"Found category: "</span>+dbrows.fieldByName(<span class="hljs-string">'name'</span>)+<span class="hljs-string">" ["</span>+dbrows.fieldByName(<span class="hljs-string">'id'</span>)+<span class="hljs-string">"]"</span>);
        Ti.UI.createAlertDialog({title:<span class="hljs-string">'Info'</span>, message:<span class="hljs-string">'Database installed'</span>, buttonNames: [<span class="hljs-string">'OK'</span>]}).show();
    };
    c.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        Ti.UI.createAlertDialog({title:<span class="hljs-string">'Error'</span>, message:<span class="hljs-string">'Error: '</span> + e.error, buttonNames: [<span class="hljs-string">'OK'</span>]}).show();
    };
    c.open(<span class="hljs-string">'GET'</span>,<span class="hljs-string">"http://zabbix.deinfo.eu/gastroapp.db"</span>);

    c.send();
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 11th 2013, 9:19:05 am">February 11th 2013</span>
				by <span class='authorname'>Axel Grimm</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>download</span></li>
					
						<li><span class='tagname'>remote</span></li>
					
						<li><span class='tagname'>sqlite</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Axel could you elaborate what problem you are facing what is that your code is not doing what you think need to be done</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 11th 2013, 10:31:59 am">February 11th 2013</span>
								by <span class='authorname'>Muhammad Wahhab Mirza</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Missing from you question are several pieces of information that will help you obtain a speedy and accurate answer, please provide the following details;</p>
<ul>
<li>Titanium SDK Version?</li>
<li>Target platform<ul>
<li>Android only?</li>
</ul>
</li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="February 11th 2013, 7:51:59 pm">February 11th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-256560">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>Try changing this line;</p>
<pre><code class="hljs"><span class="hljs-tag">fileProdukteDB</span><span class="hljs-class">.write</span>(<span class="hljs-tag">c</span><span class="hljs-class">.responseData</span>);
</code></pre><p>To this;</p>
<pre><code class="hljs"><span class="hljs-tag">fileProdukteDB</span><span class="hljs-class">.write</span>(<span class="hljs-tag">this</span><span class="hljs-class">.responseData</span>);
</code></pre><p>If this does not fix the problem provide a full description of what problem you are actually experiencing and where the code fails.  (As Muhammad asked earlier).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 11th 2013, 7:51:05 pm">February 11th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/148110/download-remote-sqlite-db-android.html#answer-256560" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>As you are only using Android for now, we will concentrate on that only for now as they both handle database deletion differently.</p>
<p>Do not try an delete the DB file manually, with Android you actually have a command to achieve that.</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> dbProd</span> = Ti.Database.<span class="hljs-keyword">open</span>('gastroapp');
dbProd.remove();
dbProd = <span class="hljs-literal">null</span>;
</code></pre><p>This will delete the previous database.</p>
<p>Download the new DB to the temp folder, install (not open it)  from there and then delete the old file.</p>
<pre><code class="hljs">var filedb = <span class="hljs-type">Ti</span>.<span class="hljs-type">Filesystem</span>.getFile(<span class="hljs-type">Ti</span>.<span class="hljs-type">Filesystem</span>.getTempDirectory<span class="hljs-literal">()</span>, <span class="hljs-symbol">'gastroapp</span>.db');
filedb.write(c.responseData);
var dbProd = <span class="hljs-type">Ti</span>.<span class="hljs-type">Database</span>.install(<span class="hljs-type">Ti</span>.<span class="hljs-type">Filesystem</span>.getTempDirectory<span class="hljs-literal">()</span> + <span class="hljs-symbol">'gastroapp</span>.db', <span class="hljs-symbol">'gastroapp'</span>);
dbProd.close<span class="hljs-literal">()</span>;
filedb = null;
</code></pre><p>The updated database will now be available using the standard <strong>Ti.Database.open(&#39;gastroapp&#39;);</strong> method.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 8:00:21 am">February 12th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi thx for fast replays. </p>
<p>i got this errors </p>
<pre><code class="hljs">(KrollRuntimeThread) [<span class="hljs-number">9</span>,<span class="hljs-number">88205</span>] Unable <span class="hljs-built_in">to</span> <span class="hljs-built_in">write</span> <span class="hljs-built_in">to</span> <span class="hljs-operator">an</span> unrecognized <span class="hljs-built_in">file</span> type
(KrollRuntimeThread) [<span class="hljs-number">1</span>,<span class="hljs-number">88206</span>] Error installing database: gastroapp msg=/data/data/test.deinfo.eu/cache/<span class="hljs-title">_tmpgastroapp</span>.db: <span class="hljs-built_in">open</span> failed: ENOENT (No such <span class="hljs-built_in">file</span> <span class="hljs-operator">or</span> <span class="hljs-built_in">directory</span>)
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 8:39:08 am">February 12th 2013</span>
											by <span class='authorname'>Axel Grimm</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Please supply your revised code.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 8:42:11 am">February 12th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Here </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> currentWin = Ti.UI.currentWindow;


<span class="hljs-keyword">var</span> btnUpdateProdDB = Titanium.UI.createButton({
        title: <span class="hljs-string">'Update'</span>,
        fontSize: <span class="hljs-number">20</span>,
        backgroundColor:<span class="hljs-string">'#21B8EB'</span>,
        color: <span class="hljs-string">'#ffffff'</span>,
        width:<span class="hljs-number">250</span>,
        height:<span class="hljs-number">70</span>,
        top:<span class="hljs-number">300</span>
    });

    currentWin.add(btnUpdateProdDB);



<span class="hljs-keyword">var</span> dbProd = Ti.Database.install(<span class="hljs-string">'/db/gastroapp.db'</span>,<span class="hljs-string">'gastroapp'</span>);


btnUpdateProdDB.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{




    <span class="hljs-keyword">var</span> c = Ti.Network.createHTTPClient();

    c.setTimeout(<span class="hljs-number">10000</span>);
    c.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        <span class="hljs-keyword">var</span> dbProd = Ti.Database.open(<span class="hljs-string">'gastroapp'</span>);
        dbProd.remove();
        dbProd = <span class="hljs-literal">null</span>;



        <span class="hljs-keyword">var</span> filedb = Ti.Filesystem.getFile(Ti.Filesystem.getTempDirectory(), <span class="hljs-string">'gastroapp.db'</span>);
        filedb.write(c.responseData);
        <span class="hljs-keyword">var</span> dbProd = Ti.Database.install(Ti.Filesystem.getTempDirectory() + <span class="hljs-string">'gastroapp.db'</span>, <span class="hljs-string">'gastroapp'</span>);
        dbProd.close();
        filedb = <span class="hljs-literal">null</span>;




        <span class="hljs-keyword">var</span> dbProd = Ti.Database.open(<span class="hljs-string">'gastroapp'</span>);

        Ti.API.info(<span class="hljs-string">"Found category: "</span>+dbrows.fieldByName(<span class="hljs-string">'name'</span>)+<span class="hljs-string">" ["</span>+dbrows.fieldByName(<span class="hljs-string">'id'</span>)+<span class="hljs-string">"]"</span>);

    };
    c.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
        Ti.UI.createAlertDialog({title:<span class="hljs-string">'Error'</span>, message:<span class="hljs-string">'Error: '</span> + e.error, buttonNames: [<span class="hljs-string">'OK'</span>]}).show();
    };
    c.open(<span class="hljs-string">'GET'</span>,<span class="hljs-string">"http://zabbix.deinfo.eu/gastroapp.db"</span>);

    c.send();




});
currentWin.open();
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 8:48:15 am">February 12th 2013</span>
											by <span class='authorname'>Axel Grimm</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I should have added my own previous tweak back into your code.  </p>
<p>Change this lineâ¦</p>
<pre><code class="hljs"><span class="hljs-tag">fileProdukteDB</span><span class="hljs-class">.write</span>(<span class="hljs-tag">c</span><span class="hljs-class">.responseData</span>);
</code></pre><p>â¦to thisâ¦</p>
<pre><code class="hljs"><span class="hljs-tag">fileProdukteDB</span><span class="hljs-class">.write</span>(<span class="hljs-tag">this</span><span class="hljs-class">.responseData</span>);
</code></pre><p>If this does not fix it I will mock it up at my end.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 8:59:52 am">February 12th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi it works now. </p>
<p>Here is my new code </p>
<p>And thx a lot for help. </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> filedb = Ti.Filesystem.getFile( <span class="hljs-string">'file:///data/data/test.deinfo.eu/databases/'</span> + <span class="hljs-string">'gastroapp.db'</span> );

        filedb.write(<span class="hljs-keyword">this</span>.responseData);
        <span class="hljs-keyword">var</span> dbProd = Ti.Database.install(<span class="hljs-string">'file:///data/data/test.deinfo.eu/databases/'</span> + <span class="hljs-string">'gastroapp.db'</span>, <span class="hljs-string">'gastroapp'</span>);
        dbProd.close();
        filedb = <span class="hljs-literal">null</span>;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 9:53:52 am">February 12th 2013</span>
											by <span class='authorname'>Axel Grimm</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are welcome.  Do not forget to mark the question answered.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 10:06:14 am">February 12th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-256611">
				
						<section>
							<p>Titanium Studio, build: 3.0.1.201212181159</p>
<p>for the first test android only later i need it for iphone too. </p>
<p>I want download the remote gastroapp.db to the phone replace it with the pre installed DB and install it again.</p>
<p>i dont know is this correct for android ? </p>
<pre><code class="hljs"><span class="hljs-title">var</span>  dbPath = 'file:///<span class="hljs-typedef"><span class="hljs-keyword">data</span>/<span class="hljs-keyword">data</span>/' + <span class="hljs-type">Ti</span>.<span class="hljs-type">App</span>.getID<span class="hljs-container">()</span> + '/databases/';</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 12th 2013, 7:16:01 am">February 12th 2013</span>
								by <span class='authorname'>Axel Grimm</span><br>
								<a class="icon-bg icon-link" href="question/148110/download-remote-sqlite-db-android.html#answer-256611" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Quick tip; please comment on the related answer or the actual question if there is no answer - rather than creating a whole new answer which is really a comment - it makes it harder in the future to work out threads if answers scores change or other answers are added. (You are not being told off)</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 7:30:34 am">February 12th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
