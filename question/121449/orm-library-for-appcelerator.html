<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>ORM Library for Appcelerator » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>ORM Library for Appcelerator</h1>
		</header>
		<section>
			<p>This is not a question, much of an <strong>ANSWER</strong> in advance for a question.</p>
<p>I just completed this simple, easy to use ORM tool and I felt I should share it. If you are looking for something very bare bones, here is your tool.</p>
<p>###Sample Code</p>
<p>####Include the single entity.js file<br><code>Ti.include(&amp;#39;yORM&amp;#x2F;entity.js&amp;#39;);</code></p>
<p>####Declare a function like this</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserEntity</span><span class="hljs-params">()</span> </span>{
};
</code></pre><p>####Then extend BaseEntity like this</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> dbName = <span class="hljs-string">"Your Database Name"</span>;
<span class="hljs-keyword">var</span> tableName = <span class="hljs-string">"Your Table Name (used in the database)"</span>;
<span class="hljs-keyword">var</span> fields = {
    <span class="hljs-symbol">'field</span>1': <span class="hljs-symbol">'SQLLite_DataTyp</span>e',
    <span class="hljs-symbol">'field2</span>: <span class="hljs-symbol">'SQLLite_DataTyp</span>e',
    <span class="hljs-symbol">'field3</span>: <span class="hljs-symbol">'SQLLite_DataTyp</span>e'
};
<span class="hljs-type">UserEntity</span>.prototype = <span class="hljs-keyword">new</span> <span class="hljs-type">BaseEntity</span>(dbName, tableName, fields);
</code></pre><p>####The rest is easy</p>
<pre><code class="hljs">var user = new UserEntity()<span class="hljs-comment">;</span>
user.field1 = 'field1_value'<span class="hljs-comment">;</span>
user.field2 = 'field2_value'<span class="hljs-comment">;</span>
user.field2 = 'field3_value'<span class="hljs-comment">;</span>

user.save()<span class="hljs-comment">;</span>
Ti.API.info(user.id)<span class="hljs-comment">;</span>
</code></pre><p>Code is hosted here <a href="http:&#x2F;&#x2F;gitorious.org&#x2F;yorm">yORM</a>.<br>Wiki is here <a href="https:&#x2F;&#x2F;gitorious.org&#x2F;yorm&#x2F;pages&#x2F;Home">yORM wiki</a>.</p>
<p><em>Disclaimer: I really don&#39;t have anything against the current ORM tools. This is more of an academic exercise rather than <strong>trying to replace something</strong>. One reason I decided to build my own ORM tool is because I think the ones we have are doing <strong>too much</strong>. This one does one thing and one thing only, abstract away your SQL statements nicely.</em></p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 22nd 2011, 5:46:11 pm">June 22nd 2011</span>
				by <span class='authorname'>Akintayo Olusegun</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>desktop</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>orm</span></li>
					
						<li><span class='tagname'>sqlite</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>code is now moved to github <a href="https:&#x2F;&#x2F;github.com&#x2F;segun&#x2F;yORM">yORM</a>.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 3rd 2011, 9:27:43 am">July 3rd 2011</span>
								by <span class='authorname'>Akintayo Olusegun</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>4</span> Votes</div>
			<div class="answers"><span>5</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>5 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-211481">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi Akintayo.</p>
<p>I have few comments regarding your ORM tool.</p>
<p>First, do you really need to use &quot;eval&quot; function? For example:</p>
<pre><code class="hljs"><span class="hljs-built_in">eval</span> ( <span class="hljs-string">'(this.'</span> + field + <span class="hljs-string">'= null)'</span> )<span class="hljs-comment">;</span>
</code></pre><p>Why not just use:</p>
<pre><code class="hljs"><span class="hljs-keyword">this</span>[field] = <span class="hljs-literal">null</span>;
</code></pre><p>Maybe you forgot about square bracket notation? :)</p>
<p>Second, IMHO, &quot;UserEntity&quot; function is not necessary because you&#39;re not using that function constructor in any meaningful way (~ to extend &quot;BaseEntity&quot; functionality). &quot;BaseEntity&quot; is factory method used to create different database model types and there is no need to extend it via prototype in this case. You can just use:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> userEntity= <span class="hljs-keyword">new</span> BaseEntity(dbName, tableName, fields);
</code></pre><p>Third, simpler and faster way to generate CSV is to use array and &quot;join&quot;.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> csvArray = [];
<span class="hljs-keyword">for</span>(field <span class="hljs-keyword">in</span> fields) {
  csvArray.push(fields[field]);
}
<span class="hljs-keyword">var</span> csv = csvArray.<span class="hljs-keyword">join</span>(<span class="hljs-string">','</span>);
</code></pre><p>Forth, field names should be validated with regular expression. Yes, they cannot contain space, but that&#39;s not proper validation. I recommend that you validate fields in constructor with regular expression.</p>
<p>Anyway, I like it because it&#39;s simple. You can have a look at <a href="https:&#x2F;&#x2F;github.com&#x2F;xavierlacot&#x2F;joli.js">Joli ORM tool</a>, I&#39;ve use it a bit and then used it to write my own ORM (Joli lacked some features that I required).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 27th 2011, 7:19:12 am">June 27th 2011</span>
								by <span class='authorname'>Ivan Škugor</span><br>
								<a class="icon-bg icon-link" href="question/121449/orm-library-for-appcelerator#answer-211481" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>My JS is not as good actually.<br>The reason for the user entity is if you need to define something on a particular entity that is unique to that entity alone….</p>
<p>I have noted the suggestions and will make necessary changes.</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 27th 2011, 11:43:57 am">June 27th 2011</span>
											by <span class='authorname'>Akintayo Olusegun</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-211092">
				
						<section>
							<p>Interesting stuff … thanks for sharing.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 22nd 2011, 7:09:07 pm">June 22nd 2011</span>
								by <span class='authorname'>Anthony Decena</span><br>
								<a class="icon-bg icon-link" href="question/121449/orm-library-for-appcelerator#answer-211092" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-211137">
				
						<section>
							<p>what about sql injection in query?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 23rd 2011, 9:44:03 am">June 23rd 2011</span>
								by <span class='authorname'>Emrah Mehmedov</span><br>
								<a class="icon-bg icon-link" href="question/121449/orm-library-for-appcelerator#answer-211137" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-211141">
				
						<section>
							<p>Technically injection should not be possible.<br>There are two ways to inject SQL into the SQL statements generated by yORM</p>
<ol>
<li>Using the tableName args <code>UserEntity.prototype = new BaseEntity(dbName, tableName, fields);</code></li>
<li>Using the fields args <code>UserEntity.prototype = new BaseEntity(dbName, tableName, fields);</code></li>
<li>Using the clauses args. </li>
</ol>
<p>&gt; The tableName arg is passed directly to <code>CREATE TABLE IF NOT EXISTS *tableName* (....)</code> I presently don&#39;t know any SQL statements that can come in there.</p>
<p>&gt; The fields args can not contain spaces. </p>
<pre><code class="hljs"> <span class="hljs-number">37</span>    <span class="hljs-keyword">for</span>(field in fields) {
 <span class="hljs-number">38</span>         <span class="hljs-keyword">if</span>(field.indexOf(<span class="hljs-string">' '</span>) &gt; <span class="hljs-number">0</span>) {
 <span class="hljs-number">39</span>             <span class="hljs-keyword">throw</span> <span class="hljs-string">"field names can not contain spaces in "</span> + field;
 <span class="hljs-number">40</span>             <span class="hljs-keyword">break</span>;
 <span class="hljs-number">41</span>         }
</code></pre><p>&gt; The clauses args is supposed to contain sql constraints used in <code>find</code> methods. This is the only place where a smart person, who <strong>really</strong> hates you, knows that you use yORM and have <strong>probably</strong> seen your code can inject something. Still the injection will be done from your code so if you check the fields you are passing to yORM well, then we might not have a problem.</p>
<p>&gt; Finally, please check the yORM source code, it is just a single file. Your concern should be the <code>find</code> methods. If you see any way that SQL can be injected, then let me know. </p>
<p><a href="mailto:akintayo.segun@gmail.com">my email address</a>.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 23rd 2011, 10:07:26 am">June 23rd 2011</span>
								by <span class='authorname'>Akintayo Olusegun</span><br>
								<a class="icon-bg icon-link" href="question/121449/orm-library-for-appcelerator#answer-211141" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thank you for your fast reply, i will test this when i go to my home.</p>
<p>thank you for sharing also.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 23rd 2011, 10:29:10 am">June 23rd 2011</span>
											by <span class='authorname'>Emrah Mehmedov</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-283618">
				
						<section>
							<p>Can we use this ORM with Alloy frameWork?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 5th 2014, 9:45:28 am">November 5th 2014</span>
								by <span class='authorname'>Omer Obaid</span><br>
								<a class="icon-bg icon-link" href="question/121449/orm-library-for-appcelerator#answer-283618" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
