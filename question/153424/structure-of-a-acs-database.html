<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Structure of a ACS &#34;&#34;database&#34;&#34; » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Structure of a ACS &#34;&#34;database&#34;&#34;</h1>
		</header>
		<section>
			<p>Hey,</p>
<p>i am building an acs app as a backend for my mobile app. </p>
<p>let&#39;s see following case:</p>
<p>There are different Groups and Users in an acs… Now the user wants to know in which groups he is in, and the groups wanna know which users are in it.<br>On SQL this would be a typically join etc… but i don&#39;t know exactly how to solve this with appcelerator acs. Should i save it as a custom property, typed as array?</p>
<p>So on the user side i save the id&#39;s of all groups he&#x2F;she is in in a property called &quot;groups&quot; (ex)</p>
<p>And for groups the same with the id&#39;s of members?</p>
<p>What do you think is the best way to achieve this?</p>
<p>best,<br>nico</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 10th 2013, 5:36:05 am">June 10th 2013</span>
				by <span class='authorname'>Nico Barelmann</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>acs</span></li>
					
						<li><span class='tagname'>database</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-264149">
				
						<section>
							<p>Hi Nico,</p>
<p>I think you can define a group on custom field, then query as {&quot;group&quot;:[&quot;group name&quot;,…more group names..]}</p>
<p>Example:<br>Create 3 users with custom field group assigned.<br>usr1 and usr2 in grp1, usr3 in grp2</p>
<pre><code class="hljs">$ curl -X POST --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"email=usr1@foo.com"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"first_name=usr1"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"last_name=usr1"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password_confirmation=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">'custom_fields={"group":["grp1"]}'</span> <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/create.json?key=&lt;API KEY&gt;"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"createUser"</span>,
    <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"2ZyCjdX1CEsOaYi1kiqnLmiTcbE"</span>
  },
  <span class="hljs-string">"response"</span>: {
    <span class="hljs-string">"users"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"51b7bd36b8811039b7000086"</span>,
        <span class="hljs-string">"first_name"</span>: <span class="hljs-string">"usr1"</span>,
        <span class="hljs-string">"last_name"</span>: <span class="hljs-string">"usr1"</span>,
        <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2013-06-12T00:13:45+0000"</span>,
        <span class="hljs-string">"updated_at"</span>: <span class="hljs-string">"2013-06-12T00:13:45+0000"</span>,
        <span class="hljs-string">"external_accounts"</span>: [

        ],
        <span class="hljs-string">"confirmed_at"</span>: <span class="hljs-string">"2013-06-12T00:13:42+0000"</span>,
        <span class="hljs-string">"email"</span>: <span class="hljs-string">"usr1@foo.com"</span>,
        <span class="hljs-string">"admin"</span>: <span class="hljs-string">"false"</span>,
        <span class="hljs-string">"custom_fields"</span>: {
          <span class="hljs-string">"group"</span>: [
            <span class="hljs-string">"grp1"</span>
          ]
        },
        <span class="hljs-string">"stats"</span>: {
          <span class="hljs-string">"photos"</span>: {
            <span class="hljs-string">"total_count"</span>: <span class="hljs-number">0</span>
          },
          <span class="hljs-string">"storage"</span>: {
            <span class="hljs-string">"used"</span>: <span class="hljs-number">0</span>
          }
        }
      }
    ]
  }
}

$ curl -X POST --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"email=usr2@foo.com"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"first_name=usr2"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"last_name=usr2"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password_confirmation=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">'custom_fields={"group":["grp1"]}'</span> <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/create.json?key=&lt;API KEY&gt;"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"createUser"</span>,
    <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"2ZyCjdX1CEsOaYi1kiqnLmiTcbE"</span>
  },
  <span class="hljs-string">"response"</span>: {
    <span class="hljs-string">"users"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"51b7bd36b8811039b7000086"</span>,
        <span class="hljs-string">"first_name"</span>: <span class="hljs-string">"usr2"</span>,
        ...
        <span class="hljs-string">"custom_fields"</span>: {
          <span class="hljs-string">"group"</span>: [
            <span class="hljs-string">"grp1"</span>
          ]
        ...
        },
      }
    ]
  }
}


$ curl -X POST --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"email=usr3@foo.com"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"first_name=usr3"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"last_name=usr3"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">"password_confirmation=pass"</span> --<span class="hljs-keyword">data</span>-urlencode <span class="hljs-string">'custom_fields={"group":["grp2"]}'</span> <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/create.json?key=&lt;API KEY&gt;"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"createUser"</span>,
    <span class="hljs-string">"session_id"</span>: <span class="hljs-string">"2ZyCjdX1CEsOaYi1kiqnLmiTcbE"</span>
  },
  <span class="hljs-string">"response"</span>: {
    <span class="hljs-string">"users"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"51b7bd36b8811039b7000086"</span>,
        <span class="hljs-string">"first_name"</span>: <span class="hljs-string">"usr3"</span>,
        ...
        <span class="hljs-string">"custom_fields"</span>: {
          <span class="hljs-string">"group"</span>: [
            <span class="hljs-string">"grp2"</span>
          ]
        ...
        },
      }
    ]
  }
}
</code></pre><p>On query you can query by group</p>
<pre><code class="hljs">curl -X GET --data-urlencode <span class="hljs-string">'where={"group": { "$in":["grp2"]} }'</span> <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/query.json?key=&lt;API KEY&gt;"</span>
{
  <span class="hljs-string">"meta"</span>: {
    <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-string">"method_name"</span>: <span class="hljs-string">"queryUsers"</span>,
    <span class="hljs-string">"page"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"per_page"</span>: <span class="hljs-number">10</span>,
    <span class="hljs-string">"total_pages"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">"total_results"</span>: <span class="hljs-number">2</span>
  },
  <span class="hljs-string">"response"</span>: {
    <span class="hljs-string">"users"</span>: [
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"51b7bd40b8811039b700008c"</span>,
        <span class="hljs-string">"first_name"</span>: <span class="hljs-string">"usr2"</span>,
        <span class="hljs-string">"last_name"</span>: <span class="hljs-string">"usr2"</span>,
        <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2013-06-12T00:13:54+0000"</span>,
        <span class="hljs-string">"updated_at"</span>: <span class="hljs-string">"2013-06-12T00:13:55+0000"</span>,
        <span class="hljs-string">"external_accounts"</span>: [

        ],
        <span class="hljs-string">"email"</span>: <span class="hljs-string">"usr2@foo.com"</span>,
        <span class="hljs-string">"admin"</span>: <span class="hljs-string">"false"</span>,
        <span class="hljs-string">"custom_fields"</span>: {
          <span class="hljs-string">"group"</span>: [
            <span class="hljs-string">"grp1"</span>
          ]
        }
      },
      {
        <span class="hljs-string">"id"</span>: <span class="hljs-string">"51b7bd36b8811039b7000086"</span>,
        <span class="hljs-string">"first_name"</span>: <span class="hljs-string">"usr1"</span>,
        <span class="hljs-string">"last_name"</span>: <span class="hljs-string">"usr1"</span>,
        <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2013-06-12T00:13:45+0000"</span>,
        <span class="hljs-string">"updated_at"</span>: <span class="hljs-string">"2013-06-12T00:13:45+0000"</span>,
        <span class="hljs-string">"external_accounts"</span>: [

        ],
        <span class="hljs-string">"email"</span>: <span class="hljs-string">"usr1@foo.com"</span>,
        <span class="hljs-string">"admin"</span>: <span class="hljs-string">"false"</span>,
        <span class="hljs-string">"custom_fields"</span>: {
          <span class="hljs-string">"group"</span>: [
            <span class="hljs-string">"grp1"</span>
          ]
        }
      }
    ]
  }
}
</code></pre><p>If you want to query users in group grp1, grp 2</p>
<pre><code class="hljs">curl -X GET --data-urlencode 'where={<span class="hljs-string">"group"</span>: { <span class="hljs-string">"<span class="hljs-variable">$in</span>"</span>:[<span class="hljs-string">"grp2"</span>,<span class="hljs-string">"grp1"</span>]} }' <span class="hljs-string">"http://api.cloud.appcelerator.com/v1/users/query.json?key=&lt;API KEY&gt;"</span>
</code></pre><p>Hope this helps.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 11th 2013, 10:22:33 pm">June 11th 2013</span>
								by <span class='authorname'>peter lee</span><br>
								<a class="icon-bg icon-link" href="../../question/153424/structure-of-a-acs-database.html#answer-264149" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
