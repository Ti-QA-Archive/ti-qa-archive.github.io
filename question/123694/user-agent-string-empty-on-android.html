<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>User-agent string empty on Android Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>User-agent string empty on Android</h1>
		</header>
		<section>
			<p>I&#39;ve found that the user agent string is empty on Android.  A workaround is to set the user agent string manually before making the connection with:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> androidUserAgent = <span class="hljs-string">'Mozilla/5.0 (Linux; U; '</span> + Ti.<span class="hljs-keyword">Platform</span>.name + <span class="hljs-string">' '</span> + Ti.<span class="hljs-keyword">Platform</span>.version + <span class="hljs-string">'; '</span> + Ti.Locale.currentLocale + <span class="hljs-string">'; '</span> + Ti.<span class="hljs-keyword">Platform</span>.model + <span class="hljs-string">' AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'</span>;
xhr.setRequestHeader(<span class="hljs-string">'User-Agent'</span>, androidUserAgent);
</code></pre><p>However, I&#39;m trying to use Google Analytics from within a webview.  It works perfectly fine for iPhone, but I get nothing from Android and I believe it&#39;s because the user agent string is again reset to empty when connecting to Google.  Is there a way to get around this?  Can I set the user agent string permanently for all connections somewhere?</p>
<p>Thanks,<br>Brad</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 3rd 2011, 5:48:35 pm">August 3rd 2011</span>
				by <span class='authorname'>Brad Proctor</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>google analytics</span></li>
					
						<li><span class='tagname'>setrequestheader</span></li>
					
						<li><span class='tagname'>user-agent</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Just realized there could be another cause why Google Analytics data is not showing up.  The bug where Titanium tries to interpret .js files as part of the app, whether they actually are or not.  For jquery I had to rename jquery.js to jquery.txt to get around this bug.  This bug also only appears on Android.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 3rd 2011, 6:11:20 pm">August 3rd 2011</span>
								by <span class='authorname'>Brad Proctor</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-215364">
				
						<section>
							<ul>
<li>Ti.Platform.model + &#39; AppleWebKit&#x2F;533.1 (KHTML, like Gecko)</li>
</ul>
<p>You need a ) and should look like &#39;) AppleWebKit</p>
<p>By the way, i did not manage to get my iphone nor android custom vars recorded. Do you have any idea why?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 4th 2011, 2:45:22 am">August 4th 2011</span>
								by <span class='authorname'>zhang jin</span><br>
								<a class="icon-bg icon-link" href="../../question/123694/user-agent-string-empty-on-android.html#answer-215364" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246800">
				
						<section>
							<p>I would add that in my case the &#39;user-agent&#39; variable empty resulted in the error &#39;forbidden&#39; while doing a login post request on a drupal server.</p>
<p>The exact same request was working for iphone so I analysed packets send with wireshark, and found a couple of differencies but setting the &#39;User-agent&#39; solved the android problem and didn&#39;t create any new one on iphone</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="September 6th 2012, 10:29:23 am">September 6th 2012</span>
								by <span class='authorname'>clement chazarra</span><br>
								<a class="icon-bg icon-link" href="../../question/123694/user-agent-string-empty-on-android.html#answer-246800" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
