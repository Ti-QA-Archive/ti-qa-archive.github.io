<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Passing passing cookie across with webView » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Passing passing cookie across with webView</h1>
		</header>
		<section>
			<p>I&#39;m having trouble passing an authentication cookie across with a webview (note this problem is an Android problem only because with iOS the cookie is passed across automatically and I don&#39;t need to retrieve it at all).</p>
<p>I retrieve the cookie at the time I log in to my server:</p>
<pre><code class="hljs"><span class="hljs-tag">Titanium</span><span class="hljs-class">.App</span><span class="hljs-class">.Properties</span><span class="hljs-class">.setString</span>("<span class="hljs-tag">Cookie</span>", <span class="hljs-tag">login</span><span class="hljs-class">.getResponseHeader</span>("<span class="hljs-tag">Set-Cookie</span>"));
</code></pre><p>I have checked that the cookie is being retrieved and stored ok.  It&#39;s value is:</p>
<p>SessionID=CZYA90NB7L; path=&#x2F;</p>
<p>However, when I try and pass this across to the webView using the beforeLoad event I get an error.  This is my code:</p>
<pre><code class="hljs">webView = Titanium.UI.createWebView({
    url : myURL;
});

webView.addEventListener(<span class="hljs-string">'beforeload'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
<span class="hljs-keyword">var</span> cookie = Titanium.App.Properties.getString(<span class="hljs-string">"Cookie"</span>);
webView.evalJS(<span class="hljs-string">"document.cookie = "</span> + cookie + <span class="hljs-string">";"</span>);
});
</code></pre><p>The error I get when I do this is:</p>
<p>W&#x2F;ActivityManager(   60): Launch timeout has expired, giving up wake lock!</p>
<p>Has anyone tried this (or something very similar) and got it working (for Android) ??</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 1st 2011, 9:07:23 am">November 1st 2011</span>
				by <span class='authorname'>Richard Shergold</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>beforeload</span></li>
					
						<li><span class='tagname'>cookies</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>webview</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-222692">
				
						<section>
							<p>This seems related to a fastdev problem in the Android emulator, have you tried switching it off and&#x2F;or testing on a device ?</p>
<p><a href="http:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Fastdev+Reference+for+Android">FastDev Wiki Reference</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 6th 2011, 12:27:34 pm">November 6th 2011</span>
								by <span class='authorname'>Marco Del Tongo</span><br>
								<a class="icon-bg icon-link" href="question/127629/passing-passing-cookie-across-with-webview.html#answer-222692" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I will try that Marco, thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 9th 2011, 6:41:11 am">November 9th 2011</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Marco.  I disabled fastdev and still get the same error.  I&#39;d really just like to know if it is possible to load a webView with a cookie (in Android) so that I know if I&#39;m wasting my time or not.  Some working code would be great but as yet I&#39;ve not seen any from anyone. This is a bit of a show stopper for us unfortunately as we need the app to be working on Android just as it does on iOS (and in iOS all this works fine).</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 9th 2011, 9:23:42 am">November 9th 2011</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Richard did you find a solution?</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 18th 2012, 10:22:54 pm">September 18th 2012</span>
											by <span class='authorname'>B R</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did anyone ever get this working?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 11th 2013, 12:10:41 am">February 11th 2013</span>
											by <span class='authorname'>Chad Stachowicz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes I did.  It wasn&#39;t easy but I ended up building a custom SDK by merging in the changes here: https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_mobile&#x2F;pull&#x2F;1162</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 12th 2013, 9:55:03 pm">February 12th 2013</span>
											by <span class='authorname'>B R</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-222693">
				
						<section>
							<p>This seems related to a fastdev problem in the Android emulator, have you tried switching it off and&#x2F;or testing on a device ?</p>
<p><a href="http:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Fastdev+Reference+for+Android">FastDev Wiki Reference</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 6th 2011, 12:27:37 pm">November 6th 2011</span>
								by <span class='authorname'>Marco Del Tongo</span><br>
								<a class="icon-bg icon-link" href="question/127629/passing-passing-cookie-across-with-webview.html#answer-222693" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-264166">
				
						<section>
							<p>Midnight VIP es una aplicación gratuita para móviles que llega para revolucionar el ocio nocturno de Madrid, presentando ofertas y descuentos de un amplio listado de locales. Midnight VIP hace posible que te puedas apuntar en las listas de las discotecas. Disponible gratuitamente en App Store y Google Play.</p>
<p>http:&#x2F;&#x2F;www.midnightvip.com</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 12th 2013, 7:58:36 am">June 12th 2013</span>
								by <span class='authorname'>a a</span><br>
								<a class="icon-bg icon-link" href="question/127629/passing-passing-cookie-across-with-webview.html#answer-264166" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-281826">
				
						<section>
							<p>I know this is an old post but I had a similar issue with evalJS on Android, API &gt;=16.  The solution was to fire an event to pass the data into the WebView, namely Ti.App.fireEvent, Titanium&#39;s pub &#x2F; sub pattern.  You can then listen for this event on the html page and set the document.cookie.</p>
<p>Please note, Titanium&#39;s pub&#x2F;sub pattern will only work if load your content locally.  </p>
<p>Great, you’ve now got your cookie set in the WebView but you’ll notice this cookie will not be included in subsequent HttpXmlRequests.  The reason is the Origin header.  </p>
<p>If you look at the request in fiddler you’ll see your login request does not have an Origin header set while any request made from the WebView will have the Origin header set to file:&#x2F;&#x2F; (this was true in my case).  The solution is simply, when you make your login request use the setRequestHeader function to add the Origin header.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 21st 2014, 9:27:37 am">August 21st 2014</span>
								by <span class='authorname'>Adrian Holmes</span><br>
								<a class="icon-bg icon-link" href="question/127629/passing-passing-cookie-across-with-webview.html#answer-281826" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
