<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Pulling JSON Data (Data does not appear) Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Pulling JSON Data (Data does not appear)</h1>
		</header>
		<section>
			<p>I am trying to pull some json data from my webpage and for some reason it is not appearing in my table. There are also no error messages. Here is my code:</p>
<pre><code class="hljs">var win =Titanium.UI.currentWindow;

var data = [];

var xhr = Titanium.Network.createHTTPClient();

var barList = Titanium.UI.createTableView({
    <span class="hljs-variable">height</span>:<span class="hljs-number">366</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">320</span>,
    top:<span class="hljs-number">0</span>,
    left:<span class="hljs-number">0</span>
});

win.<span class="hljs-built_in">add</span>(barList);

xhr.onload = function() {

    var jsonObject = JSON.parse(<span class="hljs-keyword">this</span>.responseText);

     Ti.API.info(jsonObject.query.results.item.length);


         <span class="hljs-keyword">for</span>(var i = <span class="hljs-number">0</span>; i &lt; jsonObject.query.results.item.length; i++) {

              var row = Titanium.UI.createTableViewRow({
 hasChild: <span class="hljs-keyword">true</span>,
  className: <span class="hljs-string">'bar-row'</span>,
  <span class="hljs-built_in">filter</span>: jsonObject.query.results.item[i].name
       });

       var titleLabel = Titanium.UI.createLabel({
  <span class="hljs-built_in">text</span>: jsonObject.query.results.item[i].name,
  font:  {fontSize: <span class="hljs-number">14</span>, fontWeight: <span class="hljs-string">'bold'</span>},
  left: <span class="hljs-number">70</span>,
  top: <span class="hljs-number">5</span>,
  <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
  <span class="hljs-variable">width</span>: <span class="hljs-number">210</span>
});
row.<span class="hljs-built_in">add</span>(titleLabel);



var addressLabel = Titanium.UI.createLabel({
  <span class="hljs-built_in">text</span>: jsonObject.query.results.item[i].address,
  font: {fontSize: <span class="hljs-number">10</span>, fontWeight: <span class="hljs-string">'normal'</span>},
  left: <span class="hljs-number">70</span>,
  top: <span class="hljs-number">25</span>,
  <span class="hljs-variable">height</span>: <span class="hljs-number">40</span>,
  <span class="hljs-variable">width</span>: <span class="hljs-number">200</span>
});

  row.<span class="hljs-built_in">add</span>(addressLabel);


  var iconImage = Titanium.UI.createImageView({
    <span class="hljs-built_in">image</span>: <span class="hljs-string">'images/foodicon.jpg'</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">50</span>,
    <span class="hljs-variable">height</span>: <span class="hljs-number">50</span>,
    left: <span class="hljs-number">10</span>,
top: <span class="hljs-number">10</span> });
  row.<span class="hljs-built_in">add</span>(iconImage);

              data.push(row);
      }

barList.data = data;

};

xhr.<span class="hljs-built_in">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://site.com/db.json'</span>);

xhr.send();
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 13th 2013, 6:42:54 pm">February 13th 2013</span>
				by <span class='authorname'>Connor Phillips</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>data</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>json</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Can you post a copy of the json?</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 13th 2013, 6:49:01 pm">February 13th 2013</span>
								by <span class='authorname'>Adam Paxton</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>json snippet:</p>
<pre><code class="hljs">[{<span class="hljs-comment">"bar"</span>:{<span class="hljs-comment">"address"</span>:<span class="hljs-comment">"5916 York Road"</span>,<span class="hljs-comment">"city"</span>:<span class="hljs-comment">"Baltimore"</span>,<span class="hljs-comment">"created_at"</span>:<span class="hljs-comment">"2012-04-13T17:59:44-04:00"</span>,<span class="hljs-comment">"description"</span>:<span class="hljs-comment">"Serving authentic Tex-Mex and American comfort classics everyday of the week!  So come on down to the Cantina, sit back and relax and enjoy a beverage or two and some great home cooked food and friendly service in our funky and colorful surroundings.  All are welcome!  Happy Hour is Monday through Friday, 4PM to 7PM.  Plus, we serve $2 Miller Lites during O's games."</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="February 13th 2013, 6:58:25 pm">February 13th 2013</span>
								by <span class='authorname'>Connor Phillips</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>The issue most likely lies in how you are traversing the json, so posting a snippet of what I&#39;m guessing is an object in the <code>item</code> array isn&#39;t going to help.  If it is too long, try posting a link to a pastie. If the bar descriptions are top secret :) you may need to clean them up first.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 13th 2013, 7:10:04 pm">February 13th 2013</span>
								by <span class='authorname'>Adam Paxton</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>And one quick tip to clean the json use the add on  jsonview in Mozilla</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 13th 2013, 7:24:01 pm">February 13th 2013</span>
								by <span class='authorname'>Muhammad Wahhab Mirza</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Here is a link to the data http:&#x2F;&#x2F;pastie.org&#x2F;private&#x2F;eyp9m5il6hrulbds76a8q</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 13th 2013, 7:41:23 pm">February 13th 2013</span>
								by <span class='authorname'>Connor Phillips</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-256748">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>The reason you are not getting any error messages is because you have not asked to receive any in your code.  You have a load event for a success but not an error handler for when things go wrong.</p>
<pre><code class="hljs">...
xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    alert(<span class="hljs-built_in">JSON</span>.stringify(e));
};
xhr.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://site.com/db.json'</span>);
xhr.send();
</code></pre><p>At this stage you do not know if there is any data coming back, if the data that might be coming back actually is valid and if the structure you have code to expect is correct.  So you will need some more error handling to work out where a successful receipt of data is working or failing.</p>
<p>Add these lines of code in the <strong>onload</strong> event;</p>
<pre><code class="hljs">xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    Ti.API.info(<span class="hljs-string">'raw: '</span> + <span class="hljs-keyword">this</span>.responseText);
    <span class="hljs-keyword">var</span> jsonObject = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);
    Ti.API.info(<span class="hljs-string">'object: '</span> + <span class="hljs-built_in">JSON</span>.stringify(jsonObject));
    ...
};
</code></pre><p>When you get data back you will need to provide at least one full branch as the data above has nowhere near enough data to verify fields and where they appear in the object tree.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 13th 2013, 7:26:05 pm">February 13th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/148245/pulling-json-data-data-does-not-appear.html#answer-256748" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Just noticed a typo in my error code;</p>
<pre><code class="hljs">...
xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{ <span class="hljs-comment">// missed the 'e'</span>
    alert(<span class="hljs-built_in">JSON</span>.stringify(e));
};
xhr.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://site.com/db.json'</span>);
xhr.send();
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 13th 2013, 7:43:23 pm">February 13th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Your revised onload event using the correct syntax from your json object.</p>
<pre><code class="hljs">xhr.onload = function () {
    var json = JSON.parse(<span class="hljs-keyword">this</span>.responseText);
    Ti.API.info(json.length);
    <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>; i &lt; json.length; i++) {
        var row = Titanium.UI.createTableViewRow({
            hasChild: <span class="hljs-keyword">true</span>,
            className: <span class="hljs-string">'bar-row'</span>,
            <span class="hljs-built_in">filter</span>: json[i].bar.name
        });
        var titleLabel = Titanium.UI.createLabel({
            <span class="hljs-built_in">text</span>: json[i].bar.name,
            font: {
                fontSize: <span class="hljs-number">14</span>,
                fontWeight: <span class="hljs-string">'bold'</span>
            },
            left: <span class="hljs-number">70</span>,
            top: <span class="hljs-number">5</span>,
            <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
            <span class="hljs-variable">width</span>: <span class="hljs-number">210</span>
        });
        row.<span class="hljs-built_in">add</span>(titleLabel);
        var addressLabel = Titanium.UI.createLabel({
            <span class="hljs-built_in">text</span>: json[i].bar.address,
            font: {
                fontSize: <span class="hljs-number">10</span>,
                fontWeight: <span class="hljs-string">'normal'</span>
            },
            left: <span class="hljs-number">70</span>,
            top: <span class="hljs-number">25</span>,
            <span class="hljs-variable">height</span>: <span class="hljs-number">40</span>,
            <span class="hljs-variable">width</span>: <span class="hljs-number">200</span>
        });
        row.<span class="hljs-built_in">add</span>(addressLabel);
        var iconImage = Titanium.UI.createImageView({
            <span class="hljs-built_in">image</span>: <span class="hljs-string">'images/foodicon.jpg'</span>,
            <span class="hljs-variable">width</span>: <span class="hljs-number">50</span>,
            <span class="hljs-variable">height</span>: <span class="hljs-number">50</span>,
            left: <span class="hljs-number">10</span>,
            top: <span class="hljs-number">10</span>
        });
        row.<span class="hljs-built_in">add</span>(iconImage);
        data.push(row);
    }
    barList.data = data;
};
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 13th 2013, 8:10:27 pm">February 13th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did you try this code yet? It does use the corrected versions of your object references now we know what they are.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 14th 2013, 1:33:27 pm">February 14th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That worked perfectly! Thanks.  I had jsonObject and thats where I kept running into the error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 14th 2013, 8:02:25 pm">February 14th 2013</span>
											by <span class='authorname'>Connor Phillips</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-256750">
				
						<section>
							<p>If <a href="http:&#x2F;&#x2F;pastie.org&#x2F;private&#x2F;eyp9m5il6hrulbds76a8q">this</a> is all the data you are receiving, then cut out any references to <code>query.results.item</code>.  Example:</p>
<pre><code class="hljs">var jsonObject = JSON.parse(this.responseText);

Ti.API.info(jsonObject.<span class="hljs-built_in">length</span>);

<span class="hljs-keyword">for</span>(var <span class="hljs-built_in">i</span> = <span class="hljs-number">0</span>; <span class="hljs-built_in">i</span> &lt; jsonObject.<span class="hljs-built_in">length</span>; <span class="hljs-built_in">i</span>++) <span class="hljs-cell">{
 Ti.API.info(jsonObject[i].bar.name);
}</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 13th 2013, 7:58:42 pm">February 13th 2013</span>
								by <span class='authorname'>Adam Paxton</span><br>
								<a class="icon-bg icon-link" href="question/148245/pulling-json-data-data-does-not-appear.html#answer-256750" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>So you are saying I should do something along the lines of this?</p>
<p>Currently, there is a syntax error for the text:jsonObject.[i].bar.name</p>
<pre><code class="hljs">xhr.onload = function() {

    var jsonObject = JSON.parse(<span class="hljs-keyword">this</span>.responseText);

    Ti.API.info(jsonObject.length);

       <span class="hljs-keyword">for</span>(var i = <span class="hljs-number">0</span>; i &lt; jsonObject.length; i++)  {

               Ti.API.info(jsonObject[i].bar.name);
}

              var row = Titanium.UI.createTableViewRow({
 hasChild: <span class="hljs-keyword">true</span>,
  className: <span class="hljs-string">'bar-row'</span>,
       });

       var titleLabel = Titanium.UI.createLabel({
  <span class="hljs-built_in">text</span>: jsonObject.[i].name,
  font:  {fontSize: <span class="hljs-number">14</span>, fontWeight: <span class="hljs-string">'bold'</span>},
  left: <span class="hljs-number">70</span>,
  top: <span class="hljs-number">5</span>,
  <span class="hljs-variable">height</span>: <span class="hljs-number">20</span>,
  <span class="hljs-variable">width</span>: <span class="hljs-number">210</span>
});
row.<span class="hljs-built_in">add</span>(titleLabel);


var addressLabel = Titanium.UI.createLabel({
  <span class="hljs-built_in">text</span>: jsonObject.[i].address,
  font: {fontSize: <span class="hljs-number">10</span>, fontWeight: <span class="hljs-string">'normal'</span>},
  left: <span class="hljs-number">70</span>,
  top: <span class="hljs-number">25</span>,
  <span class="hljs-variable">height</span>: <span class="hljs-number">40</span>,
  <span class="hljs-variable">width</span>: <span class="hljs-number">200</span>
});

  row.<span class="hljs-built_in">add</span>(addressLabel);


  var iconImage = Titanium.UI.createImageView({
    <span class="hljs-built_in">image</span>: <span class="hljs-string">'images/foodicon.jpg'</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">50</span>,
    <span class="hljs-variable">height</span>: <span class="hljs-number">50</span>,
    left: <span class="hljs-number">10</span>,
top: <span class="hljs-number">10</span> });
  row.<span class="hljs-built_in">add</span>(iconImage);

              data.push(row);
      }

barList.data = data;

};
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="February 13th 2013, 8:13:36 pm">February 13th 2013</span>
											by <span class='authorname'>Connor Phillips</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Put all of the row creation back inside the <code>for</code> loop like you had it before.  You are also not referencing the jsonObject in each of the text properties the way I did in the example.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 13th 2013, 8:26:57 pm">February 13th 2013</span>
											by <span class='authorname'>Adam Paxton</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-256798">
				
						<section>
							<p>So you are saying the text properties should be text: jsonObject.[i].bar.name or text: jsonObject.[i].bar.address? I dont believe that is it because I have error for those lines and then the }; after barList.data = data;</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 14th 2013, 1:12:34 pm">February 14th 2013</span>
								by <span class='authorname'>Connor Phillips</span><br>
								<a class="icon-bg icon-link" href="question/148245/pulling-json-data-data-does-not-appear.html#answer-256798" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
