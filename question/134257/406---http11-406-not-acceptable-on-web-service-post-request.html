<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>406 - HTTP/1.1 406 Not Acceptable on Web Service POST request » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>406 - HTTP/1.1 406 Not Acceptable on Web Service POST request</h1>
		</header>
		<section>
			<p>I have a real problem.  I&#39;m trying to post data back to a web service. The exact same request works when it is made via a web browser but when I make the call in Titanium I get the error:</p>
<pre><code class="hljs"><span class="hljs-number">406</span> - HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">406</span> Not Acceptable
</code></pre><p>This is my code:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> xhr</span> = Ti.Network.createHTTPClient({
        enableKeepAlive : <span class="hljs-literal">false</span>
});

xhr.<span class="hljs-keyword">open</span>('POST', myURL);

<span class="hljs-variable"><span class="hljs-keyword">var</span> contentType</span> = <span class="hljs-string">"application/json"</span>;

<span class="hljs-comment">// app.globals.token contains my athorization token</span>
xhr.setRequestHeader(<span class="hljs-string">"Authorization"</span>, app.globals.token);
xhr.setRequestHeader(<span class="hljs-string">"Accept"</span>, contentType);
xhr.setRequestHeader(<span class="hljs-string">"Content-Type"</span>, contentType);

<span class="hljs-variable"><span class="hljs-keyword">var</span> _pData</span> = {
    <span class="hljs-string">"__Type"</span> : <span class="hljs-string">"UserDetails"</span>,
    <span class="hljs-string">"Forename"</span> : <span class="hljs-string">"John"</span>,
    <span class="hljs-string">"Surname"</span> : <span class="hljs-string">"Smith"</span>,
    <span class="hljs-string">"DateOfBirth"</span> : <span class="hljs-string">"01/03/1988"</span>,
    <span class="hljs-string">"Email"</span> : <span class="hljs-string">"john@johnsmith.com"</span>,
    <span class="hljs-string">"Title"</span>:<span class="hljs-string">"Mr"</span>,
    <span class="hljs-string">"MiddleNames"</span>:<span class="hljs-string">"Arthur"</span>,
    <span class="hljs-string">"Gender"</span>:<span class="hljs-string">"M"</span>,
    <span class="hljs-string">"NationalInsuranceNo"</span>:<span class="hljs-string">"JM12345D"</span>,
    <span class="hljs-string">"MobilePhoneNo"</span>:<span class="hljs-string">"07970 111 222"</span>,
    <span class="hljs-string">"Username"</span>:<span class="hljs-string">"jsmith"</span>,
    <span class="hljs-string">"Password"</span>:<span class="hljs-string">"pa$$word"</span>
};

xhr.send(_pData);
</code></pre><p>I&#39;m wondering if it has something to do with setting the &quot;Accept&quot; header because if I remove this the error changes to Error 500 Server Error.  However I need to set this and the vendors of the web service have tested out the example above on my web server and it works for them.  So is there something in the above code that Titanium does not like?  I&#39;d be very grateful if anyone was to help!</p>
<p>Richard</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 22nd 2012, 12:48:19 pm">March 22nd 2012</span>
				by <span class='authorname'>Richard Shergold</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>406 not acceptable</span></li>
					
						<li><span class='tagname'>post</span></li>
					
						<li><span class='tagname'>web service</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>build your data as a string in the url open… and declare your headers before the open.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 22nd 2012, 2:01:23 pm">March 22nd 2012</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Trevor, when you say build the data as a string in the url open, what do you mean?  The data is always passed as a paramater to the xhr.send isn&#39;t it ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 22nd 2012, 2:49:21 pm">March 22nd 2012</span>
								by <span class='authorname'>Richard Shergold</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I switched the headers to before the Open but I get an error of &quot;Not Authorized&quot; which implies that the Authorization header is not being set I think if I do it that way round.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 22nd 2012, 3:02:41 pm">March 22nd 2012</span>
								by <span class='authorname'>Richard Shergold</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Sorry completely miss understood when you define parameters like that it will format them in the send as a web url send…</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 22nd 2012, 3:45:35 pm">March 22nd 2012</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-234103">
				
						<section>
							<p>hi Richard,</p>
<p>try to set this </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> contentType = <span class="hljs-string">'application/json;  charset=utf-8'</span>;
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 22nd 2012, 1:04:26 pm">March 22nd 2012</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="question/134257/406---http11-406-not-acceptable-on-web-service-post-request.html#answer-234103" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Mitul.  Thanks but it had no affect I&#39;m afraid.  Still get the 406 error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 1:20:58 pm">March 22nd 2012</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok you want json response right…?</p>
<p>so when you pass your dictionary as json format in .send() method then it returns as json so comment <strong>xhr.setRequestHeader(&quot;Accept&quot;, contentType);</strong> this line and test it again</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 1:25:09 pm">March 22nd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>when I try that I get a different error </p>
<pre><code class="hljs">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">500</span> Internal Server Error
</code></pre><p>I will get the server Admin to check the logs but presumably that error is the result of me passing JSON across to the Web Service and not spefifying in the header that it will be accepting JSON ?????</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 1:36:08 pm">March 22nd 2012</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m wondering if Titanium does not like combining contentType and Authorization in the headers (or something like that) ??</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 1:45:18 pm">March 22nd 2012</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234113">
				
						<section>
							<p>try this</p>
<pre><code class="hljs">xhr.setRequestHeader(<span class="hljs-string">"Accept"</span>, '<span class="hljs-type">text</span>/plain, <span class="hljs-type">text</span>/json');
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 22nd 2012, 3:10:36 pm">March 22nd 2012</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="question/134257/406---http11-406-not-acceptable-on-web-service-post-request.html#answer-234113" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>or</p>
<pre><code class="hljs">xhr.setRequestHeader(<span class="hljs-string">"Accept"</span>, <span class="hljs-symbol">'text</span>/json');
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 3:11:44 pm">March 22nd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi - tried both.  Still get the 406 Not Acceptable error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 3:17:51 pm">March 22nd 2012</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>try to pass this json with the &#39;text&#x2F;json&#39; as Accept header</p>
<pre><code class="hljs">var _pData = {    
    <span class="hljs-string">Forename :</span> <span class="hljs-string">"John"</span>,
    <span class="hljs-string">Surname :</span> <span class="hljs-string">"Smith"</span>,
    <span class="hljs-string">DateOfBirth :</span> <span class="hljs-string">"01/03/1988"</span>,
    <span class="hljs-string">Email :</span> <span class="hljs-string">"john@johnsmith.com"</span>,
    <span class="hljs-string">Title :</span> <span class="hljs-string">"Mr"</span>,
    <span class="hljs-string">MiddleNames :</span> <span class="hljs-string">"Arthur"</span>,
    <span class="hljs-string">Gender :</span> <span class="hljs-string">"M"</span>,
    <span class="hljs-string">NationalInsuranceNo :</span> <span class="hljs-string">"JM12345D"</span>,
    <span class="hljs-string">MobilePhoneNo :</span> <span class="hljs-string">"07970 111 222"</span>,
    <span class="hljs-string">Username :</span> <span class="hljs-string">"jsmith"</span>,
    <span class="hljs-string">Password :</span> <span class="hljs-string">"password"</span>
};
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 3:26:07 pm">March 22nd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi - same error!  406 Not Acceptable</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 3:30:41 pm">March 22nd 2012</span>
											by <span class='authorname'>Richard Shergold</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-234120">
				
						<section>
							<p>Trevor and Mitul</p>
<p>Thanks for looking at this with me - much appreciated.</p>
<p>I got it to work with a very simple change.</p>
<pre><code class="hljs"><span class="hljs-tag">xhr</span><span class="hljs-class">.send</span>(<span class="hljs-tag">JSON</span><span class="hljs-class">.stringify</span>(_<span class="hljs-tag">pData</span>));
</code></pre><p>thanks again, Richard</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 22nd 2012, 4:30:39 pm">March 22nd 2012</span>
								by <span class='authorname'>Richard Shergold</span><br>
								<a class="icon-bg icon-link" href="question/134257/406---http11-406-not-acceptable-on-web-service-post-request.html#answer-234120" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>oh….<br>very small mistake..</p>
<p>anyway the point is you solved problem yourself….that is much appreciated you</p>
<p>good luck</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 22nd 2012, 4:36:45 pm">March 22nd 2012</span>
											by <span class='authorname'>Mitul Bhalia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
