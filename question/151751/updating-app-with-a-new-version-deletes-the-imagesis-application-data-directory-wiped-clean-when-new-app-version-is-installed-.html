<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>updating app with a new version deletes the images,is application data directory wiped clean when new app version is installed ? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>updating app with a new version deletes the images,is application data directory wiped clean when new app version is installed ?</h1>
		</header>
		<section>
			<p>I am storing the photos in application data directory.</p>
<p>Whenever I install newer version, I dont see the previous images anymore.<br>Where should I store the images such that they don&#39;t get deleted when I update with newer app version.<br>Is installing newer app different when doing it from titanium studio and app store, or the behavior will be same </p>
<pre><code class="hljs">var filename = Titanium.Filesystem.applicationDataDirectory + <span class="hljs-string">"/"</span> + 'camera_photo' + new Date().getTime() + <span class="hljs-string">".png"</span>;
            var f = Titanium.Filesystem.getFile(filename);
            <span class="hljs-keyword">if</span> (f.exists()) {
                Ti.API.info('The <span class="hljs-type">file</span> exists, trying <span class="hljs-keyword">to</span> delete <span class="hljs-keyword">it</span> <span class="hljs-keyword">before</span> using <span class="hljs-keyword">it</span> :' + f.deleteFile());
                f = Titanium.Filesystem.getFile(filename);
            }
            f.<span class="hljs-command">write</span>(image);
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 30th 2013, 2:53:56 am">April 30th 2013</span>
				by <span class='authorname'>sri hari</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>data directory</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-261864">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>are you updating or deleting and reinstalling the app?</p>
<p>If the first, then your images should be there.</p>
<p>If the second then yes all data associated with the application will be gone</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 30th 2013, 5:07:02 am">April 30th 2013</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="question/151751/updating-app-with-a-new-version-deletes-the-imagesis-application-data-directory-wiped-clean-when-new-app-version-is-installed-#answer-261864" rel="permalink">permalink</a>
							</div>

							<h5>13 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I am not deleting app<br>Just updating, but still the images are not there<br>I am storing the image path in a SQL lite database, does the database data changed in any way ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 30th 2013, 5:24:49 am">April 30th 2013</span>
											by <span class='authorname'>sri hari</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I concur with Trevor… Files stored in applicationDataDirectory are not deleted unless the app is uninstalled, or you (or, on Android, the user) specifically delete them.</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 30th 2013, 12:26:37 pm">April 30th 2013</span>
											by <span class='authorname'>Matt Apperson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>this weirdly happens only on the device but not on the simulator .</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 2nd 2013, 11:25:49 pm">May 2nd 2013</span>
											by <span class='authorname'>sri hari</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>what are you using to update the app on the device ?..</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 3rd 2013, 1:48:39 pm">May 3rd 2013</span>
											by <span class='authorname'>Trevor Ward</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>titanium studio. there is an option to run on device. but it launches itunes software, which then syncs the app to the phone.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 3rd 2013, 1:58:04 pm">May 3rd 2013</span>
											by <span class='authorname'>sri hari</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK so it seems that for some reason the app maybe uninstalling from the device before installing. That really is the only reason why it would delete data. iTunes sync is the way to go on this, and you need to look at that to see what is happening …</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 3rd 2013, 2:10:41 pm">May 3rd 2013</span>
											by <span class='authorname'>Trevor Ward</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i found the problem, i was storing the full native path instead of relative path from the application directory.</p>
<p>the application root directory keeps changing whenever app is updated.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 20th 2013, 4:14:44 am">May 20th 2013</span>
											by <span class='authorname'>sri hari</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi Sri, I&#39;m running in to the same problem you mentioned. How did you change the path to relative?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 28th 2013, 4:49:04 am">June 28th 2013</span>
											by <span class='authorname'>Tim Mueller</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>just store the GUID as the file name without including the application directory itself.<br>because application directory changes each time the app is updated with a new version.</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> filename</span> = Ti.Platform.createUUID();
            <span class="hljs-variable"><span class="hljs-keyword">var</span> filehandle</span> = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory, filename);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="June 28th 2013, 5:24:38 am">June 28th 2013</span>
											by <span class='authorname'>easy returns</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>hi easy returns, I&#39;m having some trouble implementing this.</p>
<pre><code class="hljs">Titanium.Media.showCamera({

        success:function(<span class="hljs-keyword">event</span>)
        {
            <span class="hljs-keyword">var</span> cropRect = <span class="hljs-keyword">event</span>.cropRect;
            <span class="hljs-keyword">var</span> image = <span class="hljs-keyword">event</span>.media;
            <span class="hljs-keyword">var</span> filename = <span class="hljs-keyword">new</span> Date().getTime();
            Titanium.App.Properties.setString(<span class="hljs-string">"filename"</span>, filename);

            <span class="hljs-keyword">var</span> filehandle = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory, filename);

            <span class="hljs-keyword">if</span> (filehandle.exists()) {
                Ti.API.info(<span class="hljs-string">'The file exist , trying to delete it before using it :'</span> + imageSaved.deleteFile());
                filehandle = Titanium.Filesystem.getFile(filename);
            }

            filehandle.write(<span class="hljs-keyword">event</span>.media.imageAsCropped({x:<span class="hljs-number">0</span>,y:<span class="hljs-number">600</span>,width:<span class="hljs-number">2448</span>,height:<span class="hljs-number">1200</span>}));
</code></pre><p>I then write filename to the db, and retrieve that to show the picture in another view. But it doesn&#39;t seem to work. Any ideas?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 28th 2013, 6:36:39 am">June 28th 2013</span>
											by <span class='authorname'>Tim Mueller</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>HI Hari please say how to change to relative path from native path.<br>Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 30th 2013, 4:35:43 am">September 30th 2013</span>
											by <span class='authorname'>Prashaanth N.G.S</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Prashanth, </p>
<p>when storing the filename, store only the filename, not the native path.</p>
<p>i.e dont save filehandle.NativePath</p>
<p>when you are reading it, you again call the getFile method and pass in the file name and reconstruct the file handle. got it ?</p>
<p>Anything after the last &#x2F; is the file name. Anything before that is the directory.  </p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> filename</span> = Ti.Platform.createUUID();
            <span class="hljs-variable"><span class="hljs-keyword">var</span> filehandle</span> = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory, filename);
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="September 30th 2013, 11:57:15 pm">September 30th 2013</span>
											by <span class='authorname'>easy returns</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for responding easy returns, here is my code, please suggests the chnages and can u send me please.</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> image</span> = event.media;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> thumbnail</span> = event.thumbnail;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> cropRect</span> = event.cropRect;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> mime_type</span> = image.mimeType;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Titanium.Database.<span class="hljs-keyword">open</span>('test');
        <span class="hljs-variable"><span class="hljs-keyword">var</span> dbRows</span>=db.execute('Select max(photo_id) from my_photos');
        <span class="hljs-variable"><span class="hljs-keyword">var</span> imgsPath</span> = Ti.Filesystem.applicationDataDirectory + 'images' + Ti.Filesystem.separator;
        <span class="hljs-variable"><span class="hljs-keyword">var</span> userDir</span> = Ti.Filesystem.getFile(imgsPath);
        userDir.createDirectory();
        <span class="hljs-variable"><span class="hljs-keyword">var</span> filename</span> = 'Image'+new Date().getTime()+'.png';
        <span class="hljs-variable"><span class="hljs-keyword">var</span> f</span> = Ti.Filesystem.getFile(userDir.nativePath,filename);
        Titanium.API.info(f.nativePath);
        db.execute('INSERT INTO my_photos(<span class="hljs-string">"a_id"</span>,<span class="hljs-string">"b_id"</span>,<span class="hljs-string">"c_id"</span>,<span class="hljs-string">"image_id"</span>) Values (<span class="hljs-string">"'+Ti.App.aId.aDesc+'"</span>,<span class="hljs-string">"'+Ti.App.bId.bDesc+'"</span>,<span class="hljs-string">"'+Ti.App.cact.csact+'"</span>,<span class="hljs-string">"'+f.nativePath+'"</span>)');
            <span class="hljs-comment">//alert(filename);</span>
            <span class="hljs-keyword">if</span> (f.exists()) {
                <span class="hljs-comment">//alert(f.getDirectoryListing().eval);</span>
                Ti.API.info('The file exist , trying to delete it before using it :' + f.deleteFile());
                f = Titanium.Filesystem.getFile(userDir.nativePath,filename);
            }
            f.write(image);
</code></pre><p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 1st 2013, 3:15:56 am">October 1st 2013</span>
											by <span class='authorname'>Prashaanth N.G.S</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
