<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Test for Valid JSON returned from httpClient request Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Test for Valid JSON returned from httpClient request</h1>
		</header>
		<section>
			<p>I have a small problem related to parsing JSON documents returned from a server.</p>
<p>I have a system that is working perfectly when the user has a normal internet connection. </p>
<p>However, if the user is using a wifi hotspot that requires a browser based login e.g. in a hotel, cafe etc, and they have not yet logged in, then when my app makes the http request it will receive the HTML login page for the hotspot instead of the JSON from my server.</p>
<p>When this happens the JSON.parse method throws an error because of the unexpected characters in the text it is attempting to parse.</p>
<p>What I need to do is check the response data before parsing, however I cannot find a method for doing this in the documentation.</p>
<p>Has anyone else faced and solved this problem.</p>
<p>I could check that the first non-white space character is an open brace, but I thought that there might be a more elegant and robust solution.</p>
<p>Cheers<br>John</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 8th 2012, 10:46:53 am">May 8th 2012</span>
				by <span class='authorname'>John Hawkins</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>hotspot</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>network connection</span></li>
					
						<li><span class='tagname'>parse error</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-238089">
				
						<section>
							<p>did you try: try &amp; catch?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 8th 2012, 11:05:07 am">May 8th 2012</span>
								by <span class='authorname'>Alexander Bauer</span><br>
								<a class="icon-bg icon-link" href="question/136646/test-for-valid-json-returned-from-httpclient-request.html#answer-238089" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-238090">
				
						<section>
							<p>You can do a try&#x2F;catch around the parse function</p>
<pre><code class="hljs"><span class="hljs-keyword">try</span>{
                    <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);
                }<span class="hljs-keyword">catch</span>(e){
                    alert(<span class="hljs-string">'Couldnt parse the data, not a valid json'</span>);

                }
</code></pre><p>This solution could also mean that the json wasn&#39;t valid so if your connection was interrupted you could get ans invalid json</p>
<p>another check you can do before parsing the json is to see if the string has <code>&amp;lt;body&amp;gt;</code> tag or some other tag. </p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &lt; <span class="hljs-keyword">this</span>.responseText.indexOf(<span class="hljs-string">'&lt;body&gt;'</span>)){
                    alert(<span class="hljs-string">'Couldnt parse the data, it is html'</span>);
                }
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 8th 2012, 11:06:38 am">May 8th 2012</span>
								by <span class='authorname'>Arian Caraballo</span><br>
								<a class="icon-bg icon-link" href="question/136646/test-for-valid-json-returned-from-httpclient-request.html#answer-238090" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
