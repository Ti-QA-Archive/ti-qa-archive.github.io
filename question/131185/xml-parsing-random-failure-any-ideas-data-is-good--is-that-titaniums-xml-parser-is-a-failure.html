<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>XML PARSING random failure, any ideas? data is good ... is that Titanium&#39;s XML parser is a failure? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>XML PARSING random failure, any ideas? data is good ... is that Titanium&#39;s XML parser is a failure?</h1>
		</header>
		<section>
			<pre><code class="hljs"><span class="hljs-keyword">var</span> call = <span class="hljs-string">"GET"</span>;
    <span class="hljs-keyword">var</span> url = url = <span class="hljs-string">'http://webservices2.eneighborhoods.com/listingdataservice/PropertySearch.svc/SearchPropertiesPaging?SecurityToken=KZpgpGhZoXngt mg4QeRxNYLh kfn3v0WPX7OMuHKOPPiJbvRLbLxDAZFwXNzbKL&amp;city=toledo&amp;state=oh&amp;AdditionalSearchParameters=sortorder:ListingDate'</span>;
    <span class="hljs-keyword">var</span> parseData = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span>
    </span>{        


            <span class="hljs-keyword">var</span>    listings = [];
            <span class="hljs-keyword">var</span> xml = data.documentElement;
            <span class="hljs-keyword">var</span> properties = xml.getElementsByTagName(<span class="hljs-string">"WsProperty"</span>);
            Ti.API.info(<span class="hljs-string">"properties.length = "</span> + properties.length);
            <span class="hljs-keyword">var</span> dataLength = properties.length;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;dataLength;i++)
            {
                <span class="hljs-keyword">var</span>    property = properties.item(i);

                <span class="hljs-keyword">var</span>                    image=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    beds=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    baths=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    sqfeet=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    listingId=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    address=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    city=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                 state=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    zip=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    price=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    lotarea=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    lat=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    lng=<span class="hljs-string">''</span>;
                <span class="hljs-keyword">var</span>                    numPhotos=<span class="hljs-string">''</span>;

                <span class="hljs-comment">//Set our data based on xml</span>
                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'ListingID'</span>).length&gt;<span class="hljs-number">0</span>);
                    listingId = property.getElementsByTagName(<span class="hljs-string">'ListingID'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  listingId = '</span> + listingId);
                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'IDXPhotoRef'</span>).length&gt;<span class="hljs-number">0</span>)
                    image = property.getElementsByTagName(<span class="hljs-string">'IDXPhotoRef'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  image = '</span> + image);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Bedrooms'</span>).length&gt;<span class="hljs-number">0</span>)
                    beds = property.getElementsByTagName(<span class="hljs-string">'Bedrooms'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  beds = '</span> + beds);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Bathrooms'</span>).length&gt;<span class="hljs-number">0</span>)
                    baths = property.getElementsByTagName(<span class="hljs-string">'Bathrooms'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  baths = '</span> + baths);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'SqFt'</span>).length&gt;<span class="hljs-number">0</span>)
                    sqfeet = property.getElementsByTagName(<span class="hljs-string">'SqFt'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  sqfeet = '</span> + sqfeet);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Address'</span>).length &gt; <span class="hljs-number">0</span>)
                    address = property.getElementsByTagName(<span class="hljs-string">'Address'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  address = '</span> + address);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'City'</span>).length&gt;<span class="hljs-number">0</span>)
                    city = property.getElementsByTagName(<span class="hljs-string">'City'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  city = '</span> + city);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'State'</span>).length&gt;<span class="hljs-number">0</span>)
                    state = property.getElementsByTagName(<span class="hljs-string">'State'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  state = '</span> + state);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Zip'</span>).length&gt;<span class="hljs-number">0</span>)
                    zip = property.getElementsByTagName(<span class="hljs-string">'Zip'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  zip = '</span> + zip);


                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Price'</span>).length&gt;<span class="hljs-number">0</span>)
                    price = property.getElementsByTagName(<span class="hljs-string">'Price'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  price = '</span> + price);

                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'LotArea'</span>).length&gt;<span class="hljs-number">0</span>)
                    lotarea = property.getElementsByTagName(<span class="hljs-string">'LotArea'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  lotarea = '</span> + lotarea);

                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Lat'</span>).length&gt;<span class="hljs-number">0</span>)
                    lat = property.getElementsByTagName(<span class="hljs-string">'Lat'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  lat = '</span> + lat);

                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'Long'</span>).length&gt;<span class="hljs-number">0</span>)
                    lng = property.getElementsByTagName(<span class="hljs-string">'Long'</span>).item(<span class="hljs-number">0</span>).text;
                    Ti.API.info(i + <span class="hljs-string">'  lng = '</span> + lng);

                <span class="hljs-keyword">if</span>(property.getElementsByTagName(<span class="hljs-string">'NumPhotos'</span>).length&gt;<span class="hljs-number">0</span>)
                    numPhotos = property.getElementsByTagName(<span class="hljs-string">'NumPhotos'</span>).item(<span class="hljs-number">0</span>).text;
            }

        alert(properties.length)

    }

    <span class="hljs-keyword">var</span> makeCall = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
        xhr.setTimeout(<span class="hljs-number">30000</span>);
        xhr.enableKeepAlive=<span class="hljs-literal">false</span>;
        <span class="hljs-comment">//Error </span>
        xhr.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err)</span>
        </span>{
            Ti.UI.createAlertDialog({message: err.error,title:<span class="hljs-string">"Remote Connection Error"</span>});
        };

        <span class="hljs-comment">//Completed</span>
        xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
        </span>{
            parseData(<span class="hljs-keyword">this</span>.responseXML);
        };

        xhr.open(call, url);
        xhr.send();
    };


    <span class="hljs-keyword">var</span> refresh = Ti.UI.createButton({width:<span class="hljs-number">100</span>,height:<span class="hljs-number">20</span>,title:<span class="hljs-string">'CALL DATA'</span>})
    self.add(refresh);

    refresh.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
    </span>{
        makeCall();
    });
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 25th 2012, 10:08:34 pm">January 25th 2012</span>
				by <span class='authorname'>Brian Wells</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>xml</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>it will work sometimes, and then sometimes not work … weird.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 10:09:36 pm">January 25th 2012</span>
								by <span class='authorname'>Brian Wells</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello!</p>
<p>One hint: Please try to get only what you gonna use. This is, if you can enable your webservice to get only pages with  10 o 20 hits, your app will work a lot better, since it will transfer less data, and will process less XML as well. </p>
<p>If you are getting errors, would be nice to see the build.log and friends. </p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 10:32:20 pm">January 25th 2012</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>We have done limits on the data … Plus, been using this url to test as well. </p>
<p>http:&#x2F;&#x2F;wellsayd.com&#x2F;badData.xml</p>
<p>Next, I can limit the loop to 25 and it still fails at time with no errors, just stops parsing. It is never a specific point. It will happen randomly in different spots.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 25th 2012, 10:59:17 pm">January 25th 2012</span>
								by <span class='authorname'>Brian Wells</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-228566">
				
						<section>
							<p>I have the same issue.  I&#39;m using Titanium SDK 1.8.0.1, XCode 4.2, iOS SDK 4.3.</p>
<p>Like Brian Wells&#39; example, I am looping through nodes (items) and parsing multiple elements for each node.</p>
<p>The code doesn&#39;t crash like it did with SDK &gt;= 1.7.2 &amp; SDK &lt; 1.8.0.1 but will just stop in the middle of parsing the multiple elements in a node.  It doesn&#39;t stop at the same place (neither the same node nor the same element in the node).  It seems to be random although it happens more frequently for larger numbers of nodes.  Currently I pull back a max of 60 nodes but it happens even with only 20 nodes.</p>
<p>What is weird is repeating the same call again will parse through a few more nodes.  And repeating the call will continue to parse more nodes until it parses all of them.</p>
<p>Here are some potentially relevant posts and bugs:</p>
<p>http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;129361&#x2F;large-xml-response-parsing-crashes-ipone-app—memory-leak</p>
<p>http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-4751</p>
<p>http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-4610</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 25th 2012, 11:22:16 pm">January 25th 2012</span>
								by <span class='authorname'>Brian Yoon</span><br>
								<a class="icon-bg icon-link" href="question/131185/xml-parsing-random-failure-any-ideas-data-is-good--is-that-titaniums-xml-parser-is-a-failure#answer-228566" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>By the way, SDK 1.6.2 doesn&#39;t have this problem.  I had to uninstall&#x2F;reinstall an older version of XCode (4.0.2) in order to build with SDK 1.6.2.  That is is the only way I know of to get XML parsing to work with out random errors.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 27th 2012, 5:35:23 pm">January 27th 2012</span>
											by <span class='authorname'>Brian Yoon</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-228569">
				
						<section>
							<p>Yep, its Titanium breaking … not cool you all. I use this url that loops thru a hundred. It works great in desktop browser, mobile browser and even a webview within Titanium. But it chokes when you try and parse it straight in Titanium. See http:&#x2F;&#x2F;wellsayd.com&#x2F;xmlTest.html</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 26th 2012, 1:01:55 am">January 26th 2012</span>
								by <span class='authorname'>Brian Wells</span><br>
								<a class="icon-bg icon-link" href="question/131185/xml-parsing-random-failure-any-ideas-data-is-good--is-that-titaniums-xml-parser-is-a-failure#answer-228569" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-228573">
				
						<section>
							<p>Hi Brian</p>
<p>Dont know whether its titanium breaking or what but i prefer to use the JSON instead of xml, its more faster and i have tested about 1000 of data fetching too and works great.</p>
<p>Regards</p>
<p>Nikunj</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 26th 2012, 2:01:51 am">January 26th 2012</span>
								by <span class='authorname'>Nikunj Sakhrelia</span><br>
								<a class="icon-bg icon-link" href="question/131185/xml-parsing-random-failure-any-ideas-data-is-good--is-that-titaniums-xml-parser-is-a-failure#answer-228573" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Yes, same here.  The XML parser will choke on a random node when iterating through the XML document.  Same document with same data, works 9x out of 10 then fails.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2012, 6:49:26 am">January 26th 2012</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It is Titanium failing. No doubt about it. We are having to convert our API returns from XML to JSON. </p>
<p>However, we wasted ALOT of time to come to this conclusion. Luckily, the API is within a division of our company and the engineers are gracious enough to convert it over.</p>
<p>Think about it though, what if you had to interface with a 3rd party API that had XML returns. You would then have to create another interface viA PHP or whatever language to convert the XML to JSON. This should not be the case at all.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2012, 12:34:59 pm">January 26th 2012</span>
											by <span class='authorname'>Brian Wells</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeah @Brian we dont have any other choice right now until the TI solve the xml issue. Well but to make the work faster we should have to think with our own solution. I really think the JSON will somehow solve your issue.</p>
<p>Regards</p>
<p>Nikunj</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 27th 2012, 1:35:08 am">January 27th 2012</span>
											by <span class='authorname'>Nikunj Sakhrelia</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
