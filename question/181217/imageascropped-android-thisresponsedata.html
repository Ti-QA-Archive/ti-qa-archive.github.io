<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>imageAsCropped.  Android.  this.responseData » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>imageAsCropped.  Android.  this.responseData</h1>
		</header>
		<section>
			<p>So I&#39;m trying to cast imageAsCropped on a downloaded thumbnail.</p>
<p>Here&#39;s my current spellcraft:</p>
<pre><code class="hljs">var getThumb = Titanium.Network.createHTTPClient({
        <span class="hljs-string">onload :</span> function(e) {

            var tmp = Ti.UI.createImageView({
                <span class="hljs-string">image :</span> <span class="hljs-keyword">this</span>.responseData,
                <span class="hljs-string">width :</span> <span class="hljs-number">256</span>,
                <span class="hljs-string">height :</span> Ti.UI.SIZE
            });

            obj.image = tmp.toBlob().imageAsCropped({
                <span class="hljs-string">width :</span> <span class="hljs-number">256</span>,
                <span class="hljs-string">height :</span> <span class="hljs-number">256</span>
            });
            tmp = <span class="hljs-literal">null</span>;

            <span class="hljs-comment">// obj.image = this.responseData;</span>

        }
    });
</code></pre><p>Titanium throws errors and gang signs claiming the blob has nothing for me.</p>
<pre><code class="hljs">[ERROR] :  TiBlob: (KrollRuntimeThread) [<span class="hljs-number">284</span>,<span class="hljs-number">4323</span>] Unable to crop the image. Illegal Argument: x must be &gt;= <span class="hljs-number">0</span>
[ERROR] :  TiBlob: java<span class="hljs-class">.lang</span><span class="hljs-class">.IllegalArgumentException</span>: x must be &gt;= <span class="hljs-number">0</span>
[ERROR] :  TiBlob:     at android<span class="hljs-class">.graphics</span><span class="hljs-class">.Bitmap</span><span class="hljs-class">.checkXYSign</span>(Bitmap<span class="hljs-class">.java</span>:<span class="hljs-number">364</span>)
[ERROR] :  TiBlob:     at android<span class="hljs-class">.graphics</span><span class="hljs-class">.Bitmap</span><span class="hljs-class">.createBitmap</span>(Bitmap<span class="hljs-class">.java</span>:<span class="hljs-number">669</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.titanium</span><span class="hljs-class">.TiBlob</span><span class="hljs-class">.imageAsCropped</span>(TiBlob<span class="hljs-class">.java</span>:<span class="hljs-number">574</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.runtime</span><span class="hljs-class">.v8</span><span class="hljs-class">.V8Object</span><span class="hljs-class">.nativeCallProperty</span>(Native Method)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.runtime</span><span class="hljs-class">.v8</span><span class="hljs-class">.V8Object</span><span class="hljs-class">.callProperty</span>(V8Object<span class="hljs-class">.java</span>:<span class="hljs-number">73</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.KrollProxy</span><span class="hljs-class">.handleMessage</span>(KrollProxy<span class="hljs-class">.java</span>:<span class="hljs-number">1121</span>)
[ERROR] :  TiBlob:     at android<span class="hljs-class">.os</span><span class="hljs-class">.Handler</span><span class="hljs-class">.dispatchMessage</span>(Handler<span class="hljs-class">.java</span>:<span class="hljs-number">98</span>)
[ERROR] :  TiBlob:     at android<span class="hljs-class">.os</span><span class="hljs-class">.Looper</span><span class="hljs-class">.loop</span>(Looper<span class="hljs-class">.java</span>:<span class="hljs-number">135</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.KrollRuntime</span><span class="hljs-variable">$KrollRuntimeThread</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(KrollRuntime.java:<span class="hljs-number">112</span>)</span></span>
</code></pre><p>Last compile it did a drive by on my neighbor.  All thug life and stuff.</p>
<p>Does imageAsCropped not work on Android, or am I missing something?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 4th 2015, 3:25:19 pm">March 4th 2015</span>
				by <span class='authorname'>Dooley P</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>blob</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>imageascropped</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-286262">
				
						<section>
							<p>To answer your direct question… imageAsCropped works when you pass it what it needs.</p>
<p><code>imageAsCropped({height:256,width:256,x:0,y:0});</code> &lt;&lt; You forgot to pass in your starting x&#x2F;y point for the crop.</p>
<p>That said, you&#39;re wasting memory. <code>this.responseData</code> is already a Ti.Blob, so just use it. Also, I&#39;m going out on a limb here, and I think you want to create a thumbnail, not use imageAsCropped.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> getThumb = Titanium.Network.createHTTPClient({
        onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{

            obj.image = <span class="hljs-keyword">this</span>.responseData.imageAsThumbnail(<span class="hljs-number">256</span>);

        }
    });
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 4th 2015, 3:48:04 pm">March 4th 2015</span>
								by <span class='authorname'>Shannon Hicks</span><br>
								<a class="icon-bg icon-link" href="question/181217/imageascropped-android-thisresponsedata#answer-286262" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>omg, you totally had me.  I can&#39;t believe I never tried that or read any of the documentation.<br>Here&#39;s my final code:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoadThumb</span><span class="hljs-params">(obj, url)</span> </span>{
    <span class="hljs-keyword">var</span> getThumb = Titanium.Network.createHTTPClient({
        onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{

            obj.image = <span class="hljs-keyword">this</span>.responseData.imageAsCropped({
                width : <span class="hljs-number">256</span>,
                height : <span class="hljs-number">256</span>,
                x : <span class="hljs-number">0</span>,
                y : <span class="hljs-number">0</span>
            });

            <span class="hljs-comment">// obj.image = this.responseData;</span>
        }
    });
    getThumb.open(<span class="hljs-string">'GET'</span>, url);
    getThumb.send();
    Ti.API.info(<span class="hljs-string">"Attempting : "</span> + url);
};
</code></pre><p>And here&#39;s the result.</p>
<pre><code class="hljs">[ERROR] :  TiBlob: (KrollRuntimeThread) [<span class="hljs-number">4043</span>,<span class="hljs-number">4043</span>] Unable to crop the image. Illegal Argument: x + <span class="hljs-attribute">width</span> must be &lt;= bitmap.<span class="hljs-function"><span class="hljs-title">width</span><span class="hljs-params">()</span></span>
[ERROR] :  TiBlob: java<span class="hljs-class">.lang</span><span class="hljs-class">.IllegalArgumentException</span>: x + <span class="hljs-attribute">width</span> must be &lt;= bitmap.<span class="hljs-function"><span class="hljs-title">width</span><span class="hljs-params">()</span></span>
[ERROR] :  TiBlob:     at android<span class="hljs-class">.graphics</span><span class="hljs-class">.Bitmap</span><span class="hljs-class">.createBitmap</span>(Bitmap<span class="hljs-class">.java</span>:<span class="hljs-number">672</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.titanium</span><span class="hljs-class">.TiBlob</span><span class="hljs-class">.imageAsCropped</span>(TiBlob<span class="hljs-class">.java</span>:<span class="hljs-number">574</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.runtime</span><span class="hljs-class">.v8</span><span class="hljs-class">.V8Object</span><span class="hljs-class">.nativeCallProperty</span>(Native Method)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.runtime</span><span class="hljs-class">.v8</span><span class="hljs-class">.V8Object</span><span class="hljs-class">.callProperty</span>(V8Object<span class="hljs-class">.java</span>:<span class="hljs-number">73</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.KrollProxy</span><span class="hljs-class">.handleMessage</span>(KrollProxy<span class="hljs-class">.java</span>:<span class="hljs-number">1121</span>)
[ERROR] :  TiBlob:     at android<span class="hljs-class">.os</span><span class="hljs-class">.Handler</span><span class="hljs-class">.dispatchMessage</span>(Handler<span class="hljs-class">.java</span>:<span class="hljs-number">98</span>)
[ERROR] :  TiBlob:     at android<span class="hljs-class">.os</span><span class="hljs-class">.Looper</span><span class="hljs-class">.loop</span>(Looper<span class="hljs-class">.java</span>:<span class="hljs-number">135</span>)
[ERROR] :  TiBlob:     at org<span class="hljs-class">.appcelerator</span><span class="hljs-class">.kroll</span><span class="hljs-class">.KrollRuntime</span><span class="hljs-variable">$KrollRuntimeThread</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(KrollRuntime.java:<span class="hljs-number">112</span>)</span></span>
</code></pre><p>Sarcasm ;)</p>
<p>As I said previously:  The blob has nothing for me.  I did try this earlier, and according to the documentation, leaving the x, and y out will default the crop to the centre of the image but clearly that&#39;s further confusion.</p>
<p>The reason I&#39;m &#39;wasting memory&#39; is because several times now as I&#39;ve tried to pass blobs from response to function, I&#39;ve had to recreate the image so Titanium knows what I&#39;m on about.  Otherwise it says I&#39;m a null and I should kroll myself a blob.</p>
<p>The reason I&#39;m using cropped as opposed to thumbnail is because I want the final image squared.</p>
<p>I can just do it server side if the Android side of Titanium is lacking.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 4th 2015, 4:02:07 pm">March 4th 2015</span>
											by <span class='authorname'>Dooley P</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>imageAsThumbnail(size) &lt;&lt; returns a square image. It makes the source image bigger, smaller, and&#x2F;or center crops it to fit.</p>
<p>The error you posted above is just as straightforward as the error you posted before… &quot;x + width must be &lt;= bitmap.width()&quot;</p>
<p>It means that x+width (in your case 0+256) is bigger than the image width. Your image is too small. Just use imageAsThumbnail() like I said and solve all your problems. :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 4th 2015, 4:05:14 pm">March 4th 2015</span>
											by <span class='authorname'>Shannon Hicks</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well I&#39;ll be buggered.  So imageAsCropped will work, but will throw a fat error if the image is smaller than the crop size request.</p>
<p>imageAsThumbnail works, but does not increase the size of the image to the width I need.</p>
<p>Crud.  Well, at least there&#39;s radius borders!  I can make circles!</p>
<p>Thanks for the heads up on the glitch I was causing.  Nothing like the obvious to make a man feel dumb :)</p>
<p>Now I have to decide what I want to rewrite to get the effect I need.</p>
<p>In the meantime:  I can make circles, so everything is awesome!</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 4th 2015, 4:14:46 pm">March 4th 2015</span>
											by <span class='authorname'>Dooley P</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
