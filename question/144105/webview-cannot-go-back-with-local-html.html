<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Webview cannot go back with local html » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Webview cannot go back with local html</h1>
		</header>
		<section>
			<p>I am not able to go back in the webview with local html. The canGoBack() function is returning false. Before this i had another problem where the titanium object was not available once the webview url changed. I resolved that issue from the solutiion provided by this url <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;133609&#x2F;linking-to-another-page-within-webview-loses-access-to-the-titanium-javascript-object">http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;133609&#x2F;linking-to-another-page-within-webview-loses-access-to-the-titanium-javascript-object</a>. I am not sure if the issue could be related to that in any way. </p>
<p>There is an html button, onclick of this button a Titanium event is being fired which handles the back functionality.</p>
<pre><code class="hljs"><span class="hljs-type">Ti</span>.<span class="hljs-type">App</span>.addEventListener(<span class="hljs-symbol">'webviewBack'</span>, function <span class="hljs-literal">()</span> {
    <span class="hljs-type">Titanium</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'trying</span> to go back');
    <span class="hljs-keyword">if</span> (webView.canGoBack<span class="hljs-literal">()</span>) {
           <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'can</span> go back'); 
       webView.goBack<span class="hljs-literal">()</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'can</span>\<span class="hljs-symbol">'t</span> go back'); 
    }
});
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 29th 2012, 2:12:56 pm">October 29th 2012</span>
				by <span class='authorname'>Faizan Sattar</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>webview</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-250145">
				
						<section>
							<p>Probably not the answer you&#39;re looking for, but take a peek at <a href="https:&#x2F;&#x2F;github.com&#x2F;Nyvra&#x2F;TiMiniBrowser">TiMiniBrowser</a>, just in case it fits your needs.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 29th 2012, 2:18:57 pm">October 29th 2012</span>
								by <span class='authorname'>Shannon Hicks</span><br>
								<a class="icon-bg icon-link" href="../../question/144105/webview-cannot-go-back-with-local-html.html#answer-250145" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-250146">
				
						<section>
							<p>what are these function you are pointing in the question…<br><strong>webView.canGoBack()</strong> and <strong>webView.goBack();</strong> </p>
<p>there is no such standard function… so what are they returning its personal implementation.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 29th 2012, 2:21:42 pm">October 29th 2012</span>
								by <span class='authorname'>Ashish Nigam</span><br>
								<a class="icon-bg icon-link" href="../../question/144105/webview-cannot-go-back-with-local-html.html#answer-250146" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p><a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;2.1&#x2F;#!&#x2F;api&#x2F;Titanium.UI.WebView">http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;2.1&#x2F;#!&#x2F;api&#x2F;Titanium.UI.WebView</a></p>
<p>If you check the documentation you will see that the titanium webview api has these methods.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 29th 2012, 2:37:40 pm">October 29th 2012</span>
											by <span class='authorname'>Faizan Sattar</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>oohh.. sorry for mistake i checked properties instead of methods… ok so how do you change the url of web view… that may affect the behavior or back button functionality…</p>
<p>if you put some dummy but testable code which i can try then better i can say whats the exact problem.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 29th 2012, 2:46:33 pm">October 29th 2012</span>
											by <span class='authorname'>Ashish Nigam</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well all the html and related assets are stored locally. The index.html contains relative urls to other html file and that is how the url is changed. I have pasted the app.js code below and also some other js code which is being included in every html page.</p>
<p>app.s</p>
<pre><code class="hljs">
var webView = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createWebView({
    url:<span class="hljs-string">"xhtml/index.html"</span>
});


var window = <span class="hljs-type">Ti</span>.<span class="hljs-type">UI</span>.createWindow<span class="hljs-literal">()</span>; 
window.add(webView); 

window.<span class="hljs-keyword">open</span>({
    modal:<span class="hljs-literal">false</span>
});

<span class="hljs-type">Ti</span>.<span class="hljs-type">App</span>.addEventListener(<span class="hljs-symbol">'webviewBack'</span>, function <span class="hljs-literal">()</span> {
    <span class="hljs-type">Titanium</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'trying</span> to go back');
    <span class="hljs-keyword">if</span> (webView.canGoBack<span class="hljs-literal">()</span>) {
           <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'can</span> go back'); 
       webView.goBack<span class="hljs-literal">()</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.log(<span class="hljs-symbol">'can</span>\<span class="hljs-symbol">'t</span> go back'); 
    }
});
</code></pre><p>Put the code below inside a js file and include it in all pages. This code ensures the availability of the Titanium object in every html file.</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> ti_injection_id = <span class="hljs-string">'__ti_injection'</span>;

<span class="hljs-comment">// find the Titanium script tag</span>
<span class="hljs-keyword">var</span> ti_injection = <span class="hljs-built_in">document</span>.getElementById(ti_injection_id);
<span class="hljs-keyword">if</span> (ti_injection === <span class="hljs-keyword">null</span>) {
    <span class="hljs-comment">// if it's not already on the page, then check the localstorage</span>
    ti_injection = localStorage.getItem(<span class="hljs-string">'ti_injection'</span>);
    <span class="hljs-keyword">if</span> (ti_injection !== <span class="hljs-keyword">null</span>) {
        <span class="hljs-comment">// create a script tag</span>
        <span class="hljs-keyword">var</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
        script.type = <span class="hljs-string">"text/javascript"</span>;  
        script.id = ti_injection_id;
        script.innerHTML = ti_injection;
        script.async = <span class="hljs-keyword">true</span>;
        <span class="hljs-comment">//insertAfter - place the titanium script tag right after the current script tag</span>
        script_tag=<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'script'</span>)[(<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'script'</span>).length-<span class="hljs-number">1</span>)];
        script_tag.parentNode.insertBefore( script, script_tag.nextSibling );
    }
    <span class="hljs-keyword">else</span> {
        alert(<span class="hljs-string">"ti_injection not in page and not in localStorage"</span>);
    }
}
<span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// save the titanium script tag</span>
    localStorage.setItem(<span class="hljs-string">"ti_injection"</span>, ti_injection.innerHTML);   
}
</code></pre><p>This is the code that fires the titanium event. I am using jquery so it requires you to include jquery you can obviously do it without jquery. If you decide to use jquery just a heads up do not use the minified version it causes problems and wont work.</p>
<pre><code class="hljs">$(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-string">'.back_btn'</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        alert(<span class="hljs-string">'back clicked'</span>);
        Ti.App.fireEvent(<span class="hljs-string">'webviewBack'</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    });
});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="October 29th 2012, 4:58:44 pm">October 29th 2012</span>
											by <span class='authorname'>Faizan Sattar</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>that is fair enough, by looking at the code i would suggest u to check the current url of the web view when you move forward… in the <strong>load event</strong>… if the url stack is updated then canGoBack should also work… if your url is not being updated in the load event when you move forward the canGoBack will return false… you can also understand that.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 30th 2012, 11:36:34 am">October 30th 2012</span>
											by <span class='authorname'>Ashish Nigam</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I checked the current url in the load event of the webview and the url was correct. I did some more research and found another post where the person mentioned that the back and forward does not work with local html. I tried an experiment where i proxied the url click and fired a custom event which explicitly loaded the new url using the setUrl method of the webview. The back and forward still did not work. However this resolved the other issue of the titanium object not being available and having to load it my self. In conclusion i ended up implementing my own back and forward functionality which is fairly straight forward in it self. I am new in titanium and this has been quite a hassle. I hope the development experience improves as i go.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2012, 10:10:59 pm">October 31st 2012</span>
											by <span class='authorname'>Faizan Sattar</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for all your help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2012, 10:11:17 pm">October 31st 2012</span>
											by <span class='authorname'>Faizan Sattar</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-3</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
