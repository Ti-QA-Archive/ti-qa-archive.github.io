<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Use variable outside of  JSON onload function » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Use variable outside of  JSON onload function</h1>
		</header>
		<section>
			<p>How i use a variable outside of JSON onload function?<br>My code:</p>
<pre><code class="hljs">
        var posicion<span class="hljs-comment">;</span>
        var item_no<span class="hljs-comment">;</span>

        sendit = Ti.Network.createHTTPClient()<span class="hljs-comment">;</span>
        sendit.open('GET', 'http://xxxxxxx/json/json.ashx')<span class="hljs-comment">;</span>
        sendit.send(params)<span class="hljs-comment">;</span>
        sendit.onload = function(){
            var json = JSON.parse(this.responseText)<span class="hljs-comment">;</span>
            if (!json){
                alert('Error')<span class="hljs-comment">;</span>
                return<span class="hljs-comment">;</span>
            }
            json = json.level<span class="hljs-comment">;</span>
            posicion = json[0].pro_posicion<span class="hljs-comment">;</span>
            item_no = json[0].pro_item_no<span class="hljs-comment">;</span>

        }<span class="hljs-comment">;</span>

alert(posicion)<span class="hljs-comment">;</span>
</code></pre><p>The alert is null, anyone knows why i can solved this?</p>
<p>Thanks!, and sorry my english.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 26th 2011, 5:54:44 pm">May 26th 2011</span>
				by <span class='authorname'>Miguel Angel López</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>onload</span></li>
					
						<li><span class='tagname'>outside</span></li>
					
						<li><span class='tagname'>variable</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-208613">
				
						<section>
							<p>This is more about JavaScript then anything else… Javascript is running the http request and WHILE its doing that it will continue with the rest of your code… if you wish to run something with the results of your http request it is best to wrap it in a function that you call from your onload event</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 26th 2011, 5:57:54 pm">May 26th 2011</span>
								by <span class='authorname'>Matt Apperson</span><br>
								<a class="icon-bg icon-link" href="question/120222/use-variable-outside-of-json-onload-function#answer-208613" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I understand, but the problem is when I need that variable to compare with each other and call another function within that JSON JSON, something like:</p>
<pre><code class="hljs">sendit.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            <span class="hljs-keyword">var</span> json = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);

            json = json.nivelPicking;
            posicion = json[<span class="hljs-number">0</span>].pro_posicion;
            item_no = json[<span class="hljs-number">0</span>].pro_item_no;

                        <span class="hljs-keyword">if</span> (posicion != <span class="hljs-string">"1"</span>){
                                        sendit = Ti.Network.createHTTPClient();
                sendit.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://xxxxxx/json/json.ashx'</span>);
                sendit.send(params);
                sendit.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ 
                                <span class="hljs-comment">// etc...</span>
                                }
                        }

        };
</code></pre><p>There are times I get no response, perhaps by using JSON Call Ringtone overload, do not know.</p>
<p>So I want the variable outside the function to another function occupy</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 26th 2011, 6:10:15 pm">May 26th 2011</span>
											by <span class='authorname'>Miguel Angel López</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
