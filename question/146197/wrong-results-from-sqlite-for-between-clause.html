<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Wrong results from Sqlite for BETWEEN clause » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Wrong results from Sqlite for BETWEEN clause</h1>
		</header>
		<section>
			<p>I have a sqlite database which has three fields i.e name, latitude, longitude. The sample data in db is as follows:</p>
<ol>
<li>(&#39;abc&#39;,40.7306208,-74.0043034);</li>
<li>(&#39;def,40.751365,-73.984272);</li>
<li>(&#39;ghi&#39;,40.7567283,-73.9740641);</li>
<li>(&#39;jkl&#39;,40.7716975,-73.9794106);</li>
<li>(&#39;mno&#39;,40.7802076,-73.9557811);</li>
<li>(&#39;pqr&#39;,40.769459,-73.961935);</li>
<li>(&#39;xyz&#39;,40.774506,-73.965109);</li>
</ol>
<p>The sql that I m using to fetch data around the location of the user is as follows:</p>
<pre><code class="hljs"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>,latitude,longitude <span class="hljs-keyword">FROM</span> table_name <span class="hljs-keyword">where</span> latitude <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">20.216624</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">64.115245</span> <span class="hljs-keyword">and</span> longitude <span class="hljs-keyword">BETWEEN</span> -<span class="hljs-number">0.456955</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">31.183669</span></span>
</code></pre><p>As you can see, non of the sample data fulfills the condition of the sql statement, but it is returning all of the above data. I have tried the same query with a sqlite database outside of Titanium Appcelerator and there it returns no data, as it should be.</p>
<p>I cannot, for the love of God figure out what is going on??? Could anybody point me to any sort of solution or understanding of what is going on and what I am doing wrong?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 27th 2012, 8:55:45 am">December 27th 2012</span>
				by <span class='authorname'>Sagar Maharjan</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>appcelerator</span></li>
					
						<li><span class='tagname'>between</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>sqlite</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>there is problem in  printing the resultset. Post your code where you are printing values</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 27th 2012, 10:38:32 am">December 27th 2012</span>
								by <span class='authorname'>Muhammad Adnan</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-253477">
				
						<section>
							<p>Hi</p>
<p>I have just tried the same thing at it works for me;</p>
<p>This was my test sql;</p>
<pre><code class="hljs"><span class="hljs-operator"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">"loc"</span>;</span>
<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">"loc"</span> (<span class="hljs-string">"Title"</span> <span class="hljs-built_in">TEXT</span>, <span class="hljs-string">"Lat"</span> <span class="hljs-built_in">FLOAT</span>, <span class="hljs-string">"Lon"</span> <span class="hljs-built_in">FLOAT</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'abc'</span>,<span class="hljs-number">40.7306208</span>,-<span class="hljs-number">74.0043034</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'def'</span>,<span class="hljs-number">40.751365</span>,-<span class="hljs-number">73.984272</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'ghi'</span>,<span class="hljs-number">40.7567283</span>,-<span class="hljs-number">73.9740641</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'jkl'</span>,<span class="hljs-number">40.7716975</span>,-<span class="hljs-number">73.9794106</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'mno'</span>,<span class="hljs-number">40.7802076</span>,-<span class="hljs-number">73.9557811</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'pqr'</span>,<span class="hljs-number">40.769459</span>,-<span class="hljs-number">73.961935</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"loc"</span> <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'xyz'</span>,<span class="hljs-number">40.774506</span>,-<span class="hljs-number">73.965109</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> title,lat, lon <span class="hljs-keyword">FROM</span> loc <span class="hljs-keyword">where</span> (lat <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">20.216624</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">64.115245</span>) <span class="hljs-keyword">and</span> (lon <span class="hljs-keyword">BETWEEN</span> -<span class="hljs-number">0.456955</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">31.183669</span>);</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 27th 2012, 9:19:11 am">December 27th 2012</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="../../question/146197/wrong-results-from-sqlite-for-between-clause.html#answer-253477" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hey Malcolm… thanks for the quick response…</p>
<p>I changed the sql script like you did, but sadly it is giving me the same kind of issue  :(</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 27th 2012, 9:30:15 am">December 27th 2012</span>
											by <span class='authorname'>Sagar Maharjan</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi</p>
<p>Here is my full test code for Titanium.</p>
<pre><code class="hljs">var db = Ti.Database.open(<span class="hljs-string">'latlon'</span>);
<span class="hljs-comment">//db.execute('DROP TABLE IF EXISTS "loc";</span><span class="hljs-string">');
db.execute('</span>DROP TABLE <span class="hljs-string">"loc"</span>;<span class="hljs-string">');
db.execute('</span>CREATE TABLE <span class="hljs-string">"loc"</span> (<span class="hljs-string">"Title"</span> TEXT, <span class="hljs-string">"Lat"</span> FLOAT, <span class="hljs-string">"Lon"</span> FLOAT);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"abc"</span>,<span class="hljs-number">40</span><span class="hljs-number">.7306208</span>,-<span class="hljs-number">74</span><span class="hljs-number">.0043034</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"def"</span>,<span class="hljs-number">40</span><span class="hljs-number">.751365</span>,-<span class="hljs-number">73</span><span class="hljs-number">.984272</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"ghi"</span>,<span class="hljs-number">40</span><span class="hljs-number">.7567283</span>,-<span class="hljs-number">73</span><span class="hljs-number">.9740641</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"jkl"</span>,<span class="hljs-number">40</span><span class="hljs-number">.7716975</span>,-<span class="hljs-number">73</span><span class="hljs-number">.9794106</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"mno"</span>,<span class="hljs-number">40</span><span class="hljs-number">.7802076</span>,-<span class="hljs-number">73</span><span class="hljs-number">.9557811</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"pqr"</span>,<span class="hljs-number">40</span><span class="hljs-number">.769459</span>,-<span class="hljs-number">73</span><span class="hljs-number">.961935</span>);<span class="hljs-string">');
db.execute('</span>INSERT INTO <span class="hljs-string">"loc"</span> VALUES(<span class="hljs-string">"xyz"</span>,<span class="hljs-number">40</span><span class="hljs-number">.774506</span>,-<span class="hljs-number">73</span><span class="hljs-number">.965109</span>);<span class="hljs-string">');
//var rs = db.execute('</span><span class="hljs-keyword">SELECT</span> title,lat, lon FROM loc where (lat BETWEEN <span class="hljs-number">20</span><span class="hljs-number">.216624</span> and  <span class="hljs-number">64</span><span class="hljs-number">.115245</span>) and (lon BETWEEN -<span class="hljs-number">0</span><span class="hljs-number">.456955</span> and  <span class="hljs-number">31</span><span class="hljs-number">.183669</span>);<span class="hljs-string">');
var rs = db.execute('</span><span class="hljs-keyword">SELECT</span> title,lat, lon FROM loc;<span class="hljs-string">');
var strLine = '</span><span class="hljs-string">';
while (rs.isValidRow()) {
    strLine = '</span><span class="hljs-string">';
    strLine = strLine + '</span>title: <span class="hljs-string">' + rs.fieldByName('</span>title<span class="hljs-string">') + '</span>, <span class="hljs-string">';
    strLine = strLine + '</span>lat: <span class="hljs-string">' + rs.fieldByName('</span>lat<span class="hljs-string">') + '</span>, <span class="hljs-string">';
    strLine = strLine + '</span>lon: <span class="hljs-string">' + rs.fieldByName('</span>lon<span class="hljs-string">') + '</span>, <span class="hljs-string">';
    Ti.API.info('</span>strLine<span class="hljs-string">', strLine);
    rs.next();
}
rs.close();
db.close();</span>
</code></pre><p>There are two <strong>select</strong> lines, the first uses your parameters, shows NO results, the second asks for all results, shows ALL results.</p>
<p>Simply comment and uncomment to see the difference.</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 27th 2012, 10:26:17 am">December 27th 2012</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hey Malcolm… Thanks for all the effort… Really appreciate it… I actually found the problem and solved it.. it was a rookie mistake… the datatype I used for latitude, longitude were TEXT instead of NUM&#x2F;FLOAT.. It was throwing error while comparing BETWEEN clause…. </p>
<p>Thanks again for the quick response :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 28th 2012, 2:51:43 am">December 28th 2012</span>
											by <span class='authorname'>Sagar Maharjan</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-253482">
				
						<section>
							<pre><code class="hljs">var db = Titanium.Database.open('mydb');

db.execute('<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> myTable ( <span class="hljs-keyword">NAME</span> <span class="hljs-built_in">TEXT</span>,longitude <span class="hljs-built_in">REAL</span> ,latitude <span class="hljs-built_in">REAL</span> )<span class="hljs-string">');

db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>abc<span class="hljs-string">',40.7306208,-74.0043034);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span><span class="hljs-keyword">def</span><span class="hljs-string">',40.751365,-73.984272);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>ghi<span class="hljs-string">',40.7567283,-73.9740641);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>jkl<span class="hljs-string">',40.7716975,-73.9794106);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>mno<span class="hljs-string">',40.7802076,-73.9557811);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>pqr<span class="hljs-string">',40.769459,-73.961935);
db.execute('</span><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> myTable(<span class="hljs-keyword">NAME</span>,longitude,latitude) <span class="hljs-keyword">VALUES</span>(?,?,?)<span class="hljs-string">','</span>xyz<span class="hljs-string">',40.774506,-73.965109);

// getting values 

var resultSet= db.execute('</span><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NAME</span>,longitude,latitude <span class="hljs-keyword">FROM</span> myTable <span class="hljs-keyword">where</span> (latitude <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">20.216624</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">64.115245</span>) <span class="hljs-keyword">and</span> (longitude <span class="hljs-keyword">BETWEEN</span> -<span class="hljs-number">0.456955</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">31.183669</span>) <span class="hljs-string">')
Ti.API.info('</span> <span class="hljs-keyword">Query</span> <span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> : \<span class="hljs-keyword">n</span> <span class="hljs-string">');
while (resultSet.isValidRow())
{
    Titanium.API.info('</span> <span class="hljs-keyword">NAME</span>: <span class="hljs-string">' + resultSet.fieldByName('</span><span class="hljs-keyword">NAME</span><span class="hljs-string">') + 
    '</span>  longitude : <span class="hljs-string">' + resultSet.fieldByName('</span>longitude<span class="hljs-string">')+ '</span> latitude :<span class="hljs-string">'+ resultSet.fieldByName('</span>latitude<span class="hljs-string">'));
    resultSet.next();
}

resultSet.close();
db.close(); // close db when</span></span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 27th 2012, 9:53:51 am">December 27th 2012</span>
								by <span class='authorname'>Muhammad Adnan</span><br>
								<a class="icon-bg icon-link" href="../../question/146197/wrong-results-from-sqlite-for-between-clause.html#answer-253482" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>resultset shows nothing, also tried this your query in above database</p>
<pre><code class="hljs">var resultSet= db.execute('<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NAME</span>,longitude,latitude <span class="hljs-keyword">FROM</span> myTable <span class="hljs-keyword">where</span> latitude <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">20.216624</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">64.115245</span> <span class="hljs-keyword">and</span> longitude <span class="hljs-keyword">BETWEEN</span> -<span class="hljs-number">0.456955</span> <span class="hljs-keyword">and</span>  <span class="hljs-number">31.183669</span><span class="hljs-string">')</span></span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 27th 2012, 10:05:36 am">December 27th 2012</span>
											by <span class='authorname'>Muhammad Adnan</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-253484">
				
						<section>
							<p>Hi, try this code :</p>
<pre><code class="hljs">var lat1 = <span class="hljs-number">20.216624</span><span class="hljs-comment">;</span>
var lat2 = <span class="hljs-number">64.115245</span><span class="hljs-comment">;</span>
var long1  = -<span class="hljs-number">0.456955</span><span class="hljs-comment">;</span>
var long2  =  <span class="hljs-number">31.183669</span><span class="hljs-comment">;</span>

db = Ti.Database.open('database_name')<span class="hljs-comment">;</span>
db.execute("SELECT name,latitude,longitude FROM table_name where latitude BETWEEN  ? and  ? and longitude BETWEEN ? and ?" , lat1,lat2,long1,long2)<span class="hljs-comment">;</span>
</code></pre><p>I think this will provide you proper result.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 27th 2012, 9:57:51 am">December 27th 2012</span>
								by <span class='authorname'>Moiz Chhatriwala</span><br>
								<a class="icon-bg icon-link" href="../../question/146197/wrong-results-from-sqlite-for-between-clause.html#answer-253484" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-253490">
				
						<section>
							<p>hi,</p>
<p>i also get the same result as others get.</p>
<p>so just try to delete your app from simulator and test again because sometimes <strong>it returns the result from cached database</strong> so <strong>remove app and then install fresh app and try again.</strong></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 27th 2012, 10:48:08 am">December 27th 2012</span>
								by <span class='authorname'>Mitul Bhalia</span><br>
								<a class="icon-bg icon-link" href="../../question/146197/wrong-results-from-sqlite-for-between-clause.html#answer-253490" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
