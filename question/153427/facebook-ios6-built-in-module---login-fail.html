<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Facebook iOS6 built-in module - Login fail » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Facebook iOS6 built-in module - Login fail</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I want to use iOS6 built-in Facebook module to log in Facebook users.</p>
<p>My code is pretty simple but I always have either success false for login request using authorize method and &quot;login&quot; event or either I have a HTTP status code 400 on request with error <code>The operation couldn’t be completed. (com.facebook.sdk error 5.)</code></p>
<p>Here is the basic code :</p>
<pre><code class="hljs">var fb = <span class="hljs-built_in">require</span>(<span class="hljs-string">'facebook'</span>);

bk.vendors.facebook.id = <span class="hljs-string">"APP_ID"</span>;

fb.appid = bk.vendors.facebook.id;
fb.permissions = [<span class="hljs-string">'read_stream'</span>];
fb.forceDialogAuth = <span class="hljs-keyword">false</span>;

bk.vendors.facebook.registerEventForSingleSignOn = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> {

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">facebookEvent</span><span class="hljs-params">(e)</span></span> {
        Ti.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"login -&gt; "</span> + fb.loggedIn);
        Ti.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"uid -&gt; "</span> + fb.uid + <span class="hljs-string">" | accesstoken -&gt; "</span> + fb.accessToken);
        Ti.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"event -&gt; "</span> + JSON.stringify(e));
    }

    fb.addEventListener(<span class="hljs-string">'login'</span>, facebookEvent);     
};

bk.vendors.facebook.registerEventForSingleSignOn();
fb.authorize();
</code></pre><p>Have you an explanation of what it doesn&#39;t work in my code ?</p>
<p>Thank you.</p>
<p>PS :</p>
<ul>
<li><p><strong>Facebook Module version</strong> : 3.1.1</p>
</li>
<li><p><strong>Titanium SDK version</strong> : 3.1.0</p>
</li>
<li><p><strong>Device used</strong> : Simulator</p>
</li>
</ul>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 10th 2013, 7:40:17 am">June 10th 2013</span>
				by <span class='authorname'>Jeffrey Muller</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>authentication</span></li>
					
						<li><span class='tagname'>built-in</span></li>
					
						<li><span class='tagname'>facebook</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>login</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-264040">
				
						<section>
							<p>In order to use iOS facebook single-sign on you must go into your developer section on facebook and ensure you set the ios bundle id to your App Name (eg com.site.app.name) instead of the facebook App Id</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 10th 2013, 7:43:29 am">June 10th 2013</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="../../question/153427/facebook-ios6-built-in-module---login-fail.html#answer-264040" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Jeffrey - Dont start a new answer when commenting (you are not being told off!) - It makes it easier for others if you follow the thread of a question&#x2F;answer</p>
<p>This is the correct behaviour - Once a user removes rights to an app to use Facebook then THEY must enable it again, you can&#39;t do that from code yourself.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 8:28:58 am">June 10th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok, excuse me and thank you for your help. I agree, user have to enable rights again, but Facebook module should display classic popup which asks user if he wants to gave app some permissions, no ? Instead of this behaviour I have the error I mentioned below.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 8:42:52 am">June 10th 2013</span>
											by <span class='authorname'>Jeffrey Muller</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not if the user has removed the access rights. If you look at other apps they put up an alert asking the user to check the permissions for Facebook are enabled.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 8:45:00 am">June 10th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>If you feel this has answered your question, then feel free to mark this answer as correct so other might find it later on</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 11:42:11 am">June 10th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>By saying &quot;removed access rights&quot;, I mean removed Facebook from authorized apps as if it never give rights to the app.<br>In this case, the module seems buggy <code>The operation couldn’t be completed. (com.facebook.sdk error 5.)</code>.I need to remove and reinstall the iPhone app to prevent that issue… Is there a solution for that ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 13th 2013, 10:52:33 am">June 13th 2013</span>
											by <span class='authorname'>Jeffrey Muller</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I had the same issue, but I was getting a result from Facebook :<br>Could not parse server response: (null)</p>
<p>Setting the bundle id fixed the issue, wish Facebook would return something useful like &quot;unknown bundle id&quot; !!!</p>
<p>Chris</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 20th 2013, 2:40:02 pm">December 20th 2013</span>
											by <span class='authorname'>Christian Ribe</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-264044">
				
						<section>
							<p>Okay, it seems to work but I still have an issue.<br>If a user delete my app from his &quot;authorized&quot; apps on Facebook, and try to log in once again I get the famous error : <code>The operation couldn’t be completed. (com.facebook.sdk error 5.)</code></p>
<p>Is there a solution against this ?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 10th 2013, 8:26:00 am">June 10th 2013</span>
								by <span class='authorname'>Jeffrey Muller</span><br>
								<a class="icon-bg icon-link" href="../../question/153427/facebook-ios6-built-in-module---login-fail.html#answer-264044" rel="permalink">permalink</a>
							</div>

							<h5>9 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>+1 I have the same error after check Facebook integration with my application. Any news about how fix it?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 11:14:44 am">June 17th 2013</span>
											by <span class='authorname'>Carlos Luis Seva</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>According to <a href="http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;13496007&#x2F;facebook-sdk-3-1-com-facebook-sdk-error-5-when-authenticating-with-facebook-a">this</a> StackOverFlow post, you can test for permissions with a call to requestWithGraphPath -&gt; &quot;me&#x2F;permissions&quot;. (I haven&#39;t tried it myself)</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 11:21:43 am">June 17th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Nick. That call returns this in my case:</p>
<pre><code class="lang-{data:[{publish_stream:1,">     <span class="hljs-attribute">publish_actions</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">installed</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">status_update</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">create_note</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">share_item</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">read_stream</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">photo_upload</span>:<span class="hljs-number">1</span>,
     <span class="hljs-attribute">video_upload</span>:<span class="hljs-number">1</span>}]}
</code></pre>
<p>Everything seems fine, but does not work … I&#39;m lost: (</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 11:36:29 am">June 17th 2013</span>
											by <span class='authorname'>Carlos Luis Seva</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Always the same bug for me… Problem is that the popup does not display again if user remove permissions to app in Facebook.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 12:12:57 pm">June 17th 2013</span>
											by <span class='authorname'>Jeffrey Muller</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did you try a request to me&#x2F;permissions ?  I would be interested to see if they are the same as Digitalico Spain</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 12:21:37 pm">June 17th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Mmm.. I&#39;ve created a new Facebook account and I&#39;ve tested everything again after reinstall app on my iPhone too and result the same error! How can be this? Facebook blocks my application for anyone? I don&#39;t understand this error, really</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 12:42:05 pm">June 17th 2013</span>
											by <span class='authorname'>Carlos Luis Seva</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Did you try a <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Modules.Facebook-method-reauthorize">reauthorize</a> using some [read] permissions ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 12:53:52 pm">June 17th 2013</span>
											by <span class='authorname'>Nick Milner</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Nick, I reauthorized it again with [&#39;publish_stream&#39;] permission and this is what has happened:</p>
<ul>
<li><p>If I publish text+photo in albums, works correctly with:</p>
<pre><code class="hljs">facebook.requestWithGraphPath(<span class="hljs-string">'me/photos'</span>, data, <span class="hljs-string">'POST'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{..);
</code></pre></li>
<li><p>Great, but if I want publish a single post without images (only text), fails if I use this sentence:</p>
</li>
</ul>
<pre><code class="hljs">facebook.requestWithGraphPath(<span class="hljs-string">'me/feed'</span>, data, <span class="hljs-string">'POST'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{..);
</code></pre><ul>
<li>BUT, if I use feed dialog, works!</li>
</ul>
<pre><code class="hljs"><span class="hljs-tag">facebook</span><span class="hljs-class">.dialog</span>(<span class="hljs-string">'feed'</span>, {}, <span class="hljs-function">function</span>(e) {..);
</code></pre><p>About feed dialog, I have seen this message on <a href="https:&#x2F;&#x2F;developers.facebook.com&#x2F;docs&#x2F;reference&#x2F;api&#x2F;publishing&#x2F;">Facebook API reference</a> </p>
<p><em>You can not use the feed API to post to post to another person&#39;s timeline&#x2F;wall. To do that you must use the must use the Feed Dialog.</em></p>
<p>Have anything to do? Why works well send text+photo without feed dialog and not works with just text?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2013, 2:04:30 pm">June 17th 2013</span>
											by <span class='authorname'>Carlos Luis Seva</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Some news about this kind of error ? Solution to recover &quot;give rights&quot; to app popup ? Thank you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2013, 6:40:10 am">June 20th 2013</span>
											by <span class='authorname'>Jeffrey Muller</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-264785">
				
						<section>
							<p>Unfortunately the Facebook module doesn&#39;t do enough error handling to handle these types of issues. Try changing the user&#39;s password on the Facebook website and you will see similar behavior. See this issue and comments: https:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-2472</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 25th 2013, 2:00:04 am">June 25th 2013</span>
								by <span class='authorname'>Mark M</span><br>
								<a class="icon-bg icon-link" href="../../question/153427/facebook-ios6-built-in-module---login-fail.html#answer-264785" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
