<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Random crashes in iOS simulator » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Random crashes in iOS simulator</h1>
		</header>
		<section>
			<p>Since switching from Ti SDK 1.6.2 to 1.7.x I have been experiencing seemingly random application crashes with the following stack trace.</p>
<pre><code class="hljs">Thread <span class="hljs-number">4</span> Crashed:
<span class="hljs-number">0</span>   myapp               <span class="hljs-number">0x002633cb</span> TiObjectSetProperty + <span class="hljs-number">107</span> (APICast.h:<span class="hljs-number">75</span>)
<span class="hljs-number">1</span>   myapp               <span class="hljs-number">0x00040685</span> -[KrollObject noteObject:forTiString:context:] + <span class="hljs-number">357</span> (KrollObject.m:<span class="hljs-number">1304</span>)
<span class="hljs-number">2</span>   myapp               <span class="hljs-number">0x0003cbbf</span> KrollGetProperty + <span class="hljs-number">833</span> (KrollObject.m:<span class="hljs-number">481</span>)
<span class="hljs-number">3</span>   myapp               <span class="hljs-number">0x002663bf</span> TI::TiCallbackObject&lt;TI::TiObject&gt;::getOwnPropertySlot(TI::TiExcState*, TI::Identifier <span class="hljs-keyword">const</span>&amp;, TI::PropertySlot&amp;) + <span class="hljs-number">467</span> (TiCallbackObjectFunctions.h:<span class="hljs-number">139</span>)
<span class="hljs-number">4</span>   myapp               <span class="hljs-number">0x002444ba</span> TI::TiValue::get(TI::TiExcState*, TI::Identifier <span class="hljs-keyword">const</span>&amp;, TI::PropertySlot&amp;) <span class="hljs-keyword">const</span> + <span class="hljs-number">210</span> (TiObject.h:<span class="hljs-number">387</span>)
<span class="hljs-number">5</span>   myapp               <span class="hljs-number">0x00241ab6</span> cti_op_get_by_id_generic + <span class="hljs-number">86</span> (JITStubs.cpp:<span class="hljs-number">1094</span>)
<span class="hljs-number">6</span>   ???                 <span class="hljs-number">0x0b5ec410</span> <span class="hljs-number">0</span> + <span class="hljs-number">190759952</span>
<span class="hljs-number">7</span>   myapp               <span class="hljs-number">0x001ff4c2</span> TI::Interpreter::execute(TI::ProgramExecutable*, TI::TiExcState*, TI::ScopeChainNode*, TI::TiObject*, TI::TiValue*) + <span class="hljs-number">648</span> (JITCode.h:<span class="hljs-number">84</span>)
<span class="hljs-number">8</span>   myapp               <span class="hljs-number">0x001ceef4</span> TI::evaluate(TI::TiExcState*, TI::ScopeChain&amp;, TI::SourceCode <span class="hljs-keyword">const</span>&amp;, TI::TiValue) + <span class="hljs-number">388</span> (Completion.cpp:<span class="hljs-number">67</span>)
<span class="hljs-number">9</span>   myapp               <span class="hljs-number">0x00248cd9</span> TiEvalScript + <span class="hljs-number">297</span> (TiBase.cpp:<span class="hljs-number">61</span>)
<span class="hljs-number">10</span>  myapp               <span class="hljs-number">0x000324dc</span> -[KrollBridge evalFileOnThread:context:] + <span class="hljs-number">1470</span> (KrollBridge.mm:<span class="hljs-number">418</span>)
<span class="hljs-number">11</span>  myapp               <span class="hljs-number">0x000351a2</span> -[KrollInvocation invoke:] + <span class="hljs-number">118</span> (KrollContext.mm:<span class="hljs-number">97</span>)
<span class="hljs-number">12</span>  myapp               <span class="hljs-number">0x00034419</span> -[KrollContext invokeOnThread:method:withObject:callback:selector:] + <span class="hljs-number">187</span> (KrollContext.mm:<span class="hljs-number">896</span>)
<span class="hljs-number">13</span>  myapp               <span class="hljs-number">0x0002fb59</span> -[KrollBridge evalFile:callback:selector:] + <span class="hljs-number">97</span> (KrollBridge.mm:<span class="hljs-number">440</span>)
<span class="hljs-number">14</span>  myapp               <span class="hljs-number">0x00031df4</span> -[KrollBridge didStartNewContext:] + <span class="hljs-number">1902</span> (KrollBridge.mm:<span class="hljs-number">570</span>)
<span class="hljs-number">15</span>  myapp               <span class="hljs-number">0x00036a73</span> -[KrollContext main] + <span class="hljs-number">2445</span> (KrollContext.mm:<span class="hljs-number">1054</span>)
<span class="hljs-number">16</span>  Foundation          <span class="hljs-number">0x006aad4c</span> -[NSThread main] + <span class="hljs-number">81</span>
<span class="hljs-number">17</span>  Foundation          <span class="hljs-number">0x006aacd8</span> __NSThread__main__ + <span class="hljs-number">1387</span>
<span class="hljs-number">18</span>  libSystem.B.dylib   <span class="hljs-number">0x926c9259</span> _pthread_start + <span class="hljs-number">345</span>
<span class="hljs-number">19</span>  libSystem.B.dylib   <span class="hljs-number">0x926c90de</span> thread_start + <span class="hljs-number">34</span>
</code></pre><p>This is sometimes caused by something as trivial as adding a line of log code (Ti.API.log()). Commenting it out makes the app run again.</p>
<p>Any pointers as to what is causing this?</p>
<p>My environment (this also happened with Xcode 3.2.5 and iOS SDK 4.x:</p>
<ul>
<li>Xcode 4.2</li>
<li>iOS SDK 5</li>
<li>Ti SDK 1.7.3</li>
<li>OSX 1.6.8</li>
</ul>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 27th 2011, 7:20:56 pm">October 27th 2011</span>
				by <span class='authorname'>Henning Glatter-Gotz</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>sdk 1.7.x</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-222082">
				
						<section>
							<p>To give some sort of answer here …. There was another post on this yesterday, where nothing was resolved but the random code breaking occurred.</p>
<p>I have come across exactly the same and I think it is down to the javascript interpreter getting slightly confused. No evidence of this.</p>
<p>It is really random and sometimes just putting a blank line in resolves the issue.</p>
<p>What I think needs to happen is Appcelerator made aware, which I can do I will get the two Q&amp;A&#39;s and send them to the support team and see what they make of it.</p>
<p>If ou could post a little code which works and fails randomly that would be great.</p>
<p>T.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 27th 2011, 7:58:00 pm">October 27th 2011</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="question/127468/random-crashes-in-ios-simulator#answer-222082" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Email sent to appcelerator about this now, will see what they say</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 27th 2011, 8:06:25 pm">October 27th 2011</span>
											by <span class='authorname'>Trevor Ward</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>We encountered this major problem before when converting from 1.6.2 to 1.7.X.  We ended up having to rewrite about 50% of the coding for better stability and less random crashes. </p>
<p>You can always try one of the <a href="http:&#x2F;&#x2F;builds.appcelerator.com.s3.amazonaws.com&#x2F;index.html">continuous builds</a> to see if they help with the random crashes.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 27th 2011, 9:45:29 pm">October 27th 2011</span>
											by <span class='authorname'>Vinh Bui</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p><strong>@Trevor</strong>, thanks! The discussion you saw yesterday was probably one with a comment by me. I posted that <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;127359&#x2F;distribute---app-store-fails-since-xcode-42-installation">here</a> as well.</p>
<p><strong>@Vinh</strong>, could you please elaborate on <em>rewrite 50% of the code</em>. I am following the single context model presented in Twitanium. I thought that is the currently recommended approach.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 27th 2011, 10:22:07 pm">October 27th 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am starting to wonder if this this is a race condition of some sort. As I mentioned earlier, adding a single call to something like</p>
<pre><code class="hljs">Ti.API.<span class="hljs-built_in">log</span>(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>
</code></pre><p>will make the app work again. The only thing I can <em>guess</em> is that it is changing the timing of what executes in the underlying native code.</p>
<p>The following snippet is what I am dealing with at the moment.</p>
<ul>
<li>Read object from Ti.App.Properties (via wrapper)</li>
<li>Fetch data from a local database</li>
<li>Add properties to existing objects</li>
<li>Read boolean value from Ti.App.Properties</li>
<li>There is <strong>NO</strong> XHR in this code</li>
</ul>
<p>Having the code in exactly this form results in an application crash in the simulator.</p>
<pre><code class="hljs">
// Ti.API.log(<span class="hljs-string">'1'</span>);
            prefs = clg.preferences.read(clg.appVersion, <span class="hljs-string">'main'</span>);
            searchFilters = {};
// Ti.API.log(<span class="hljs-string">'2'</span>);

            <span class="hljs-keyword">if</span> (!prefs.basicSearch.showMan) {
                searchFilters.includeRecordType = [clg.db.recType.X, clg.db.recType.Y];
            }
// Ti.API.log(<span class="hljs-string">'3'</span>);

            data = clg.db.getSearchResults(searchFilters);
            tableRows = {
                rows:[],
                index:[]
            };
// Ti.API.log(<span class="hljs-string">'4'</span>);

            <span class="hljs-keyword">if</span> (prefs.basicSearch.showSlots) {
                lensLayout = {
                    slots:{
                        slot1:{label:<span class="hljs-string">'AA:'</span>, key:<span class="hljs-string">'aa'</span>},
                        slot2:{label:<span class="hljs-string">'BB:'</span>, key:<span class="hljs-string">'bb'</span>},
                        slot3:{label:<span class="hljs-string">'CC:'</span>, key:<span class="hljs-string">'cc'</span>}
                    }
                };
            } <span class="hljs-keyword">else</span> {
                lensLayout = {slots:false};
            }
// Ti.API.log(<span class="hljs-string">'5'</span>);

            manufacturerLayout = {slots:false};
            useGradient = Ti.App.Properties.getBool(clg.props.useSearchRowGradient);
// Ti.API.log(<span class="hljs-string">'6'</span>);
</code></pre><p>Uncommenting ANY ONE of the</p>
<pre><code class="hljs">Ti.API.<span class="hljs-command">log</span>('<span class="hljs-comment">#');</span>
</code></pre><p>lines causes the app to run fine.</p>
<p><strong>[Insert Profanity of your choice here]!?!?!??!</strong></p>
</p>
										<div class="author">
											&mdash; commented <span title="October 27th 2011, 11:31:06 pm">October 27th 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-222214">
				
						<section>
							<p>This is a really critical bug that I also have very often and randomly.</p>
<p>Simulator seems to crash more frequently with this stack error than real device.</p>
<p>Uncommting Ti.API.log(&#39;xxx&#39;) and Ti.API.info(&#39;xxx&#39;) seems to help a little bit, but this can&#39;t be the solution.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 29th 2011, 5:57:38 pm">October 29th 2011</span>
								by <span class='authorname'>Danny Pham</span><br>
								<a class="icon-bg icon-link" href="question/127468/random-crashes-in-ios-simulator#answer-222214" rel="permalink">permalink</a>
							</div>

							<h5>13 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Danny,</p>
<p>The commenting and uncommenting of log code is definitely not a solution. I simply mentioned this as an illustration of what I think is some sort of timing issue with the underlying native app that gets built by Ti.</p>
<p>The fact that I can never reproduce this in the debugger, adding seemingly irrelevant code stops&#x2F;causes the crashes and Appcelerator staff cannot reproduce things like this even with code that is provided, for me points to a problem that can be observed with multi-threaded apps that have some kind of bug (race condition, resource starvation, deadlock). These are unfortunately very hard to find.</p>
<p>Adding a line of logging code, changes the timing of when certain things get executed. The same goes for the debugger. Running something in the debugger changes the timing and is probably the reason that it cannot be reproduced.</p>
<p>Now, why others don&#39;t see the same behavior even when they run the same code in the &quot;same&quot; development environment is a bit tricky to answer.</p>
<p>Anyway, I have spent too much time trying to debug this when it happens (several times over the last few months) and every time it leads nowhere.</p>
<p>From past experience with multi threaded systems, this looks like a timing issue to me.</p>
<p>Just my two cents.</p>
<p>Since I did not see any of this in 1.6.2 I am about to through out 1.7.x.<br>I did try a 1.7.4 nightly build as well as a 1.8 build and have not seen the problem yet.</p>
<p>Would be nice to get a comment from the Appcelerator folks on this. I opened <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-342">this (TC-342)</a> issue on the 27th, but have not seen any action on it yet.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 2:58:35 pm">October 31st 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So 1.7.4 beta works for you with less crahs?</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 4:19:43 pm">October 31st 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>At the moment yes. But I do not read too much into this at this point. Switching from 1.7.2 to 1.7.3 also &quot;fixed&quot; the problem at hand only to have it show up later in some other place.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 6:28:37 pm">October 31st 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am currently switching to a single context tabbed application. Hope that this approach will run more stable. Do you use multiple contexts?</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 6:32:55 pm">October 31st 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I am following the Tweetanium single context model, which solved a lot of problems (but not this one). I can also recommend taking a look at the <a href="https:&#x2F;&#x2F;github.com&#x2F;jaraen&#x2F;TitanTricks">TitanTricks</a> app. There are some really good things in there as well.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 6:36:41 pm">October 31st 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for this link.</p>
<p>In my multi context app I am using in app.js:</p>
<pre><code class="hljs">Ti.<span class="hljs-keyword">App</span>.appData = {
    dbName: 'myApp',
    dbVersion: 'v0_38',
    dbInitFile: 'myApp.<span class="hljs-keyword">db</span>'
};

Ti.<span class="hljs-keyword">App</span>.dbConn = Ti.Database.install(Ti.<span class="hljs-keyword">App</span>.appData.dbInitFile, Ti.<span class="hljs-keyword">App</span>.appData.dbName + '_' + Ti.<span class="hljs-keyword">App</span>.appData.dbVersion);
</code></pre><p>Now I have read that is a no-go to set global stuff using Ti.App.*</p>
<p>I leave the database open and execute sql statement in other windows with Ti.App.dbConn.execute(&#39;…&#39;).</p>
<p>Maybe this is the main problem with random crashes?</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 11:38:17 pm">October 31st 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I initially tried the <code>Ti.App.mystuff</code> route too, but the model in Tweetanium is better.</p>
<p>For database access take a look at this <a href="https:&#x2F;&#x2F;github.com&#x2F;xavierlacot&#x2F;joli.js&#x2F;tree&#x2F;">ORM</a>. Xavier also gave a talk at Code Strong. The video is available <a href="http:&#x2F;&#x2F;www.appcelerator.com&#x2F;showcase&#x2F;videos&#x2F;codestrong2011">here</a>.</p>
<p>Saw your comment on the 1.7.4 announcement … bummer!! Seems like there need to be a few more bug fix iterations without adding new features. Would be nice to finally get something stable.</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 31st 2011, 11:53:04 pm">October 31st 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Tweetainium doesn&#39;t seem to avoid memory leaks as it loads everything in memory on startup right? The Commonjs approach seems better, above all I still want to use tabgroups.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 1st 2011, 12:21:28 am">November 1st 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>SDK 1.7.5 doesn&#39;t seem to solve this problem :-(</p>
<p>@Henning: dou you found any workaround yet?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2011, 2:12:30 pm">November 3rd 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Danny,</p>
<p>Unfortunately not. I have been working on the backend of my app and am hoping that there will be some sort of response from Appcelerator. But the <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-342">ticket</a> I opened has had no movement in a week now.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2011, 3:33:20 pm">November 3rd 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Seems like I have to downgrade to SDK 1.6.2 until this bug is resolved. With this SDK everything works fine in your app? So what are the major disadvantages of SDK 1.6.2?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2011, 6:34:29 pm">November 3rd 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>@Danny, I never experienced this problem with 1.6.2. If I recall 1.6.2 had XHR issues. Something really nice in 1.7 is also the ability to catch database exceptions.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 5th 2011, 8:10:02 pm">November 5th 2011</span>
											by <span class='authorname'>Henning Glatter-Gotz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>How do you catch database exceptions? With try and catch?</p>
<p>I think I have found a workaround to solve this bug. I have noticed that in a for-loop while processing arrays or objects that inherits TI proxy elements, the used memory seems to freeze &#x2F; block other processes and so the app crash with bus signal error 10. </p>
<p>What I have done is a looping with delayed sequences (each setTimeout 10ms) and thus seems to allow other memory processes to get released or unblocked. Not an ideal solution, but it works for me. My app doesn&#39;t crash anymore (as far as I have noticed) and the delay is only slightly.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 6th 2011, 7:38:44 pm">November 6th 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-222678">
				
						<section>
							<p>1.6.x has also serious memory problems. Seems like 1.8.0 solves the crashes, but unfortunately it is not stable enough to publish a public app with this SDK.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 5th 2011, 8:43:38 pm">November 5th 2011</span>
								by <span class='authorname'>Danny Pham</span><br>
								<a class="icon-bg icon-link" href="question/127468/random-crashes-in-ios-simulator#answer-222678" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>sorry, should be a follow-up to a comment and not a new answer. I can&#39;t delete posts here?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 5th 2011, 8:44:32 pm">November 5th 2011</span>
											by <span class='authorname'>Danny Pham</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
