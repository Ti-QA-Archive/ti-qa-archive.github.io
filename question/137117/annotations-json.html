<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Annotations JSON Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Annotations JSON</h1>
		</header>
		<section>
			<p>Guys, my request is work, is getting the right latitude and longitude but unfortunately is creating the annotation before getting the right values, so it comes as null.</p>
<p>What can I do to make the annotation wait?</p>
<p>thanks</p>
<pre><code class="hljs">var xhr = Ti.Network.createHTTPClient({

    <span class="hljs-string">onload :</span> function() {
        <span class="hljs-comment">// Ti.API.debug(this.responseText);</span>
        alert(<span class="hljs-string">'entrou no loading'</span>);
        json = JSON.parse(<span class="hljs-keyword">this</span>.responseText);
        pista = json.florianopolis[<span class="hljs-number">0</span>];

        latitude = bar.latitude;
        longitude = bar.longitude;
        nome = bar.nome;
        foto = bar.foto;



},
    <span class="hljs-string">onerror :</span> function(e) {
        Ti.API.debug(<span class="hljs-string">"STATUS: "</span> + <span class="hljs-keyword">this</span>.status);
        Ti.API.debug(<span class="hljs-string">"TEXT:   "</span> + <span class="hljs-keyword">this</span>.responseText);
        Ti.API.debug(<span class="hljs-string">"ERROR:  "</span> + e.error);
        alert(<span class="hljs-string">'There was an error retrieving the remote data. Try again.'</span>);
    },
    <span class="hljs-string">timeout :</span> <span class="hljs-number">5000</span>

});
xhr.open(<span class="hljs-string">"GET"</span>, url);
xhr.send();



barFloripa = Titanium.Map.createAnnotation({
    <span class="hljs-string">latitude :</span> latitude,
    <span class="hljs-string">longitude :</span> longitude,
    <span class="hljs-string">title :</span> nome,
    <span class="hljs-string">subtitle :</span> <span class="hljs-string">'Florianopolis'</span>,
    <span class="hljs-string">pincolor :</span> Titanium.Map.ANNOTATION_GREEN,
    <span class="hljs-string">rightButton :</span> foto,
    <span class="hljs-string">animate :</span> <span class="hljs-literal">true</span>,
    <span class="hljs-string">myid :</span> <span class="hljs-number">3</span> <span class="hljs-comment">// CUSTOM ATTRIBUTE THAT IS PASSED INTO EVENT OBJECTS</span>
});
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 17th 2012, 6:57:27 pm">May 17th 2012</span>
				by <span class='authorname'>Eduardo varela</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>maps</span></li>
					
						<li><span class='tagname'>null</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-238906">
				
						<section>
							<p>The createHTTPClient call is asychronous, so the code for creating the annotation should be executed or at least called from the HTTPClient&#39;s <code>onload</code> callback function. See <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;128486&#x2F;store-gps-location-in-a-variable">here</a> and <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;2.0&#x2F;index.html#!&#x2F;guide&#x2F;Callbacks_and_Events_for_Loose_Coupling">here</a> for more info.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 17th 2012, 7:53:49 pm">May 17th 2012</span>
								by <span class='authorname'>Adam Paxton</span><br>
								<a class="icon-bg icon-link" href="../../question/137117/annotations-json.html#answer-238906" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-238963">
				
						<section>
							<p>Thanks, What about the image, it is not showing up with my path request. It is weird</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 18th 2012, 11:37:31 am">May 18th 2012</span>
								by <span class='authorname'>Eduardo varela</span><br>
								<a class="icon-bg icon-link" href="../../question/137117/annotations-json.html#answer-238963" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Verify that the url (path) is correct for the button.  Also, please use the comment functionality to comment on other answers, and the answer functionality only to provide an answer to the original question.  Helps keep the Q&amp;A easy to read for future visitors.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 18th 2012, 12:11:19 pm">May 18th 2012</span>
											by <span class='authorname'>Adam Paxton</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
