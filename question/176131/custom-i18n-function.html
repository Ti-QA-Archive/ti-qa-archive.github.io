<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Custom i18n function » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Custom i18n function</h1>
		</header>
		<section>
			<p>Hello everyone,</p>
<p>Do you think if it is possible to overload the i18n functions : Ti.Locale.getString() and L()?<br>I would need to change the strings without recompiling them.</p>
<p>Thank you all!</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 15th 2014, 6:22:42 am">July 15th 2014</span>
				by <span class='authorname'>Guislain Duthieuw</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>i18n</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>In the last time Malcom H. has answered this question.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 15th 2014, 6:32:32 am">July 15th 2014</span>
								by <span class='authorname'>Rainer Schleevoigt</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Oh thank you, this is the most teasing answer I&#39;ve ever read :-)<br>To postpone your remarks I&#39;ll say &quot;Yes, I&#39;ve already search the Q&amp;A and can find something in the 40 first items I&#39;ve found ; I may have wrong keywords…&quot;<br>Can you please give me more clue to find the answer? Thank you ! :-)</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 15th 2014, 6:38:17 am">July 15th 2014</span>
								by <span class='authorname'>Guislain Duthieuw</span>
							</div>
						</li>
					
						<li class="comment">
							<div><ul>
<li>(&quot;and can&#39;t find something&quot; I meant)</li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="July 15th 2014, 6:40:31 am">July 15th 2014</span>
								by <span class='authorname'>Guislain Duthieuw</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Finaly found it : http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;153321&#x2F;internationalization-methods Thank you!<br>It answers me : I can&#39;t overload it (I wanted it to be used with builtin textid titleid properties…)</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 15th 2014, 7:30:54 am">July 15th 2014</span>
								by <span class='authorname'>Guislain Duthieuw</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-280715">
				
						<section>
							<p>We had an app that required the ability to change language on the fly, and not tied to the user device settings.</p>
<p>languages.js</p>
<pre><code class="hljs"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@projectDescription</span>
 * <span class="hljs-doctag">@author</span> Stephen Feather
 * <span class="hljs-doctag">@copyright</span> 2012 Feather Direct, LLC. All Rights Reserved.
 */</span>

<span class="hljs-keyword">var</span> Languages = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = {};
    <span class="hljs-keyword">self</span>.contentFolder = Titanium.Filesystem.resourcesDirectory+<span class="hljs-string">'library/'</span>;
    <span class="hljs-keyword">self</span>.languageList = [
        {id:<span class="hljs-string">'en'</span>,title:<span class="hljs-string">'English'</span>},
        {id:<span class="hljs-string">'es'</span>,title:<span class="hljs-string">'Español'</span>},
        {id:<span class="hljs-string">'pt'</span>,title:<span class="hljs-string">'Português'</span>}
    ];


    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-keyword">self</span>.languageList.length;j++){

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.languageList[j].id === Ti.Locale.currentLanguage){

        <span class="hljs-keyword">self</span>.defaultLanguage = <span class="hljs-keyword">self</span>.languageList[j].id;
        j = <span class="hljs-keyword">self</span>.languageList.length;
    } <span class="hljs-keyword">else</span> {

        <span class="hljs-keyword">self</span>.defaultLanguage = <span class="hljs-string">'en'</span>;
    }
}

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
};

module.exports = Languages;
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 15th 2014, 11:35:26 am">July 15th 2014</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="question/176131/custom-i18n-function.html#answer-280715" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>In this case, it returned content from a specific directory (swapping the language of the files being loaded.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 15th 2014, 11:37:25 am">July 15th 2014</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That was the v1.  In the second version, we wanted to swap the titles and text on the fly as well, not just the contents. Notice that we now have our own L() method in the library.</p>
<p>languages.js</p>
<pre><code class="hljs"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@projectDescription</span>
 * <span class="hljs-doctag">@author</span> Stephen Feather
 * <span class="hljs-doctag">@copyright</span> 2012 Feather Direct LLC. All Rights Reserved.
 */</span>


<span class="hljs-keyword">var</span> Languages = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = {};

    <span class="hljs-keyword">self</span>.contentFolder = Titanium.Filesystem.resourcesDirectory+<span class="hljs-string">'library/'</span>;
    <span class="hljs-keyword">self</span>.languageSupport = <span class="hljs-string">'en es pt'</span>;
    <span class="hljs-keyword">self</span>.languageList = [
        {id: <span class="hljs-number">0</span>, code:<span class="hljs-string">'en'</span>, title:<span class="hljs-string">'English'</span>, strings: <span class="hljs-keyword">require</span>(<span class="hljs-string">'strings/en'</span>)},
        {id: <span class="hljs-number">1</span>, code:<span class="hljs-string">'es'</span>, title:<span class="hljs-string">'Español'</span>, strings: <span class="hljs-keyword">require</span>(<span class="hljs-string">'strings/es'</span>)},
        {id: <span class="hljs-number">2</span>, code:<span class="hljs-string">'pt'</span>, title:<span class="hljs-string">'Português'</span>, strings: <span class="hljs-keyword">require</span>(<span class="hljs-string">'strings/pt'</span>)}
    ];

    <span class="hljs-keyword">self</span>.init = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-comment">//console.log('language.init');</span>
        <span class="hljs-keyword">if</span> (!Ti.App.Properties.hasProperty(<span class="hljs-string">'defaultLanguageCode'</span>)){

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-keyword">self</span>.languageList.length;j++){

                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.languageList[j].id === Ti.Locale.currentLanguage){
                    Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageCode'</span>, <span class="hljs-keyword">self</span>.languageList[j].code);
                    Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageTitle'</span>, <span class="hljs-keyword">self</span>.languageList[j].code);
                    Ti.App.Properties.setInt(<span class="hljs-string">'defaultLanguageId'</span>, <span class="hljs-keyword">self</span>.languageList[j].code);

                    <span class="hljs-keyword">self</span>.defaultLanguageCode = <span class="hljs-keyword">self</span>.languageList[j].code;
                    <span class="hljs-keyword">self</span>.defaultLanguageTitle = <span class="hljs-keyword">self</span>.languageList[j].title;
                    <span class="hljs-keyword">self</span>.defaultLanguageId = <span class="hljs-keyword">self</span>.languageList[j].id;


                    j = <span class="hljs-keyword">self</span>.languageList.length;
                } <span class="hljs-keyword">else</span> {
                    Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageCode'</span>, <span class="hljs-string">'en'</span>);
                    Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageTitle'</span>, <span class="hljs-string">'English'</span>);
                    Ti.App.Properties.setInt(<span class="hljs-string">'defaultLanguageId'</span>, <span class="hljs-number">0</span>);
                    <span class="hljs-keyword">self</span>.defaultLanguageCode = <span class="hljs-string">'en'</span>;
                    <span class="hljs-keyword">self</span>.defaultLanguageTitle = <span class="hljs-string">'English'</span>;
                    <span class="hljs-keyword">self</span>.defaultLanguageId = <span class="hljs-number">0</span>


                }
            }



        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">self</span>.defaultLanguageCode = Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageCode'</span>);
            <span class="hljs-keyword">self</span>.defaultLanguageTitle = Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageTitle'</span>);
            <span class="hljs-keyword">self</span>.defaultLanguageId = Ti.App.Properties.getInt(<span class="hljs-string">'defaultLanguageId'</span>);
        }
    };

    <span class="hljs-keyword">self</span>.setLanguage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(args)</span></span>{
        <span class="hljs-comment">//console.log('language.setLanguage: '+args);</span>
        <span class="hljs-keyword">if</span> (args &gt;= <span class="hljs-number">0</span>){
            console.log(<span class="hljs-string">'args greater or = 0'</span>);
            Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageCode'</span>, <span class="hljs-keyword">self</span>.languageList[args].code);
            Ti.App.Properties.setString(<span class="hljs-string">'defaultLanguageTitle'</span>, <span class="hljs-keyword">self</span>.languageList[args].title);
            Ti.App.Properties.setInt(<span class="hljs-string">'defaultLanguageId'</span>, <span class="hljs-keyword">self</span>.languageList[args].id);
            <span class="hljs-keyword">self</span>.defaultLanguageCode = Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageCode'</span>);
            <span class="hljs-keyword">self</span>.defaultLanguageTitle = Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageTitle'</span>);
            <span class="hljs-keyword">self</span>.defaultLanguageId = Ti.App.Properties.getInt(<span class="hljs-string">'defaultLanguageId'</span>);

        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.languageList[args];
    };

    <span class="hljs-keyword">self</span>.getLanguageCode = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageCode'</span>);
    }

    <span class="hljs-keyword">self</span>.getLanguageTitle = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageTitle'</span>);
    }

    <span class="hljs-keyword">self</span>.getLanguage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.languageList[<span class="hljs-keyword">self</span>.defaultLanguageId];
    }

    <span class="hljs-keyword">self</span>.L = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, fallBack)</span></span>{
        <span class="hljs-comment">//console.log('languages.L');</span>
        <span class="hljs-comment">//console.log(self.languageList[Ti.App.Properties.getString('defaultLanguageId')].strings[key]);</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span>.languageList[Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageId'</span>)].strings[key]){
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>.languageList[Ti.App.Properties.getString(<span class="hljs-string">'defaultLanguageId'</span>)].strings[key];
        }
        <span class="hljs-keyword">if</span> (fallBack){
            <span class="hljs-keyword">return</span> fallBack;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> key;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
};

module.exports = Languages;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 15th 2014, 11:39:59 am">July 15th 2014</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>the <code>strings</code> file pulled into the library is simple a js file that exports an object, whose properties match the name&#x2F;key of the conversion we want to make:</p>
<p>en.js</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> strings = {
    <span class="hljs-string">"appname"</span> : <span class="hljs-string">"My app"</span>,
    <span class="hljs-string">"share_the_app"</span>:<span class="hljs-string">"Share the App"</span>,
    <span class="hljs-string">"select_language"</span>:<span class="hljs-string">"Select Language"</span>

}

<span class="hljs-keyword">module</span>.exports = strings;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="July 15th 2014, 11:42:28 am">July 15th 2014</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you Stephen Feather! It seems quite complete! Can your own &quot;L()&quot; function be used automatically with textid and titleid from XML Alloy views? I was thinking to create my own Ti.UI namespace that catches textid and titleid values and call my own L() function, but it needs to put &lt;Label ns=&quot;require(&#39;myOwnNS&#39;)&quot; &#x2F;&gt; in every view</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 15th 2014, 11:49:06 am">July 15th 2014</span>
											by <span class='authorname'>Guislain Duthieuw</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>We do all that manipulation in the controller.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 15th 2014, 12:13:29 pm">July 15th 2014</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
