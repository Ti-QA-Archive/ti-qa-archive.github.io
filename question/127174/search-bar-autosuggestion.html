<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Search bar autosuggestion Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Search bar autosuggestion</h1>
		</header>
		<section>
			<p>HI </p>
<p>Here is my code it makes infinite calls in the background when we hit on the api on change event of searchbar.<br>I am doing something wrong Please suggest</p>
<p>var search = Titanium.UI.createSearchBar({<br>   barColor:&#39;#77B121&#39;,<br>   height:43,<br>   hintText:&#39;What\&#39;s It Worth?&#39;,<br>   top:0<br>});</p>
<p>&#x2F;&#x2F;AUTOCOMPLETE TABLE<br>var table_data = [];</p>
<p>var autocomplete_table = Titanium.UI.createTableView({<br>   search: search,<br>   filterAttribute : &#39;filter&#39;,<br>   scrollable: true,<br>   top:0<br>});<br>win.add(autocomplete_table);</p>
<p>&#x2F;&#x2F;<br>&#x2F;&#x2F; SEARCH BAR EVENTS<br>&#x2F;&#x2F;</p>
<p>search.addEventListener(&#39;change&#39;, function(e)<br>{</p>
<pre><code class="hljs">autonew()<span class="hljs-comment">;</span>
</code></pre><p>});</p>
<p>function autonew()</p>
<p>{</p>
<p>var xhr = Titanium.Network.createHTTPClient();<br>xhr.onload = function()<br>{</p>
<p>   var jsonObject = JSON.parse(this.responseText);</p>
<pre><code class="hljs">       table_data = <span class="hljs-keyword">[</span>];

        for<span class="hljs-function"> (</span>var i = 0; i &lt; jsonObject.results.length; i++<span class="hljs-function">)</span>
        {
          <span class="hljs-function"> Ti.API.info(</span>'row data - ' + jsonObject.results<span class="hljs-keyword">[</span>i].formatted_address<span class="hljs-function">)</span>;
           var row =<span class="hljs-function"> Ti.UI.createTableViewRow(</span>
           {
              height: 40,
              title: jsonObject.results<span class="hljs-keyword">[</span>i].formatted_address,
              hasDetail:true
           }<span class="hljs-function">)</span>;

           // apply rows to data<span class="hljs-instruction"> array
</span>
          <span class="hljs-function"> table_data.push(</span>row<span class="hljs-function">)</span>;
           // search.value = search.value;

        };

         search.value = search.value;   
       <span class="hljs-function"> autocomplete_table.setData(</span>table_data<span class="hljs-function">)</span>;
</code></pre><p>};<br>xhr.onerror = function()<br>{</p>
<p>};</p>
<p>if(search.value.length&gt;2)<br>{</p>
<p>xhr.open(&quot;GET&quot;,&#39;http:&#x2F;&#x2F;maps.googleapis.com&#x2F;maps&#x2F;api&#x2F;geocode&#x2F;json?address=&#39;+search.value+&#39;&amp;sensor=false&#39;);<br>xhr.send();<br>}</p>
<p>}</p>
<p>Thanks,</p>
<p>PANKAJ</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 21st 2011, 4:49:30 am">October 21st 2011</span>
				by <span class='authorname'>PANKAJ KUMAR</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>searchbar</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-221508">
				
						<section>
							<p>see <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;126119&#x2F;auto-complete-searchbar">http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;126119&#x2F;auto-complete-searchbar</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 21st 2011, 11:24:05 am">October 21st 2011</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/127174/search-bar-autosuggestion.html#answer-221508" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-269665">
				
						<section>
							<p>cool i can give some example for you with android auto address suggestion bar </p>
<pre><code class="hljs">var search = Titanium.UI.createTextField({

        <span class="hljs-string">height :</span> <span class="hljs-string">'40sp'</span>,
        <span class="hljs-string">hintText :</span> <span class="hljs-string">'Search'</span>,
        <span class="hljs-string">top :</span> <span class="hljs-string">'3sp'</span>,
        <span class="hljs-string">right :</span> <span class="hljs-string">'0%'</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'73%'</span>,
        <span class="hljs-string">textAlign :</span> <span class="hljs-string">'left'</span>,
        <span class="hljs-string">font :</span> {

            <span class="hljs-string">fontFamily :</span> <span class="hljs-string">'Verdana'</span>,
            <span class="hljs-string">fontSize :</span> <span class="hljs-string">'13sp'</span>,

        },
    });
</code></pre><p>your result dispaly as table row</p>
<pre><code class="hljs">    var resulttable = Ti.UI.createTableView({
        <span class="hljs-string">top :</span> <span class="hljs-string">'0%'</span>,
        <span class="hljs-string">left :</span> <span class="hljs-string">'0%'</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">height :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">separatorColor :</span> <span class="hljs-string">'#000000'</span>,

    });
</code></pre><p>and add event listner as change and any change call function with your value and if value is empty remove table from your view </p>
<pre><code class="hljs">    <span class="hljs-built_in">search</span>.addEventListener(<span class="hljs-string">"change"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, type)</span> {</span>
        Titanium.API.info(<span class="hljs-string">"in change event listener"</span>);
        <span class="hljs-keyword">if</span> ('' <span class="hljs-built_in">!</span>= <span class="hljs-built_in">search</span>.value) {
            tabgroupContentView.add(resulttable);
            <span class="hljs-keyword">if</span> (resulttable.data.length &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">for</span> (var i = resulttable.data[<span class="hljs-number">0</span>].rows.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
                    resulttable.deleteRow(i);
                }
            }
            auto_complete(<span class="hljs-built_in">search</span>.value);
        } <span class="hljs-keyword">else</span> {
            tabgroupContentView.remove(resulttable);
        }
    });
</code></pre><p>call following function to auto complte  </p>
<pre><code class="hljs">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">auto_complete</span>(<span class="hljs-params">search_term</span>) </span>{

        loader.open(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"https://maps.googleapis.com/maps/api/place/autocomplete/json?input="</span> + search_term + <span class="hljs-string">"&amp;types=geocode&amp;language=en&amp;sensor=true&amp;key=bar blar blar this is my key use ur one"</span>);

        loader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> histryresult = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span> + <span class="hljs-keyword">this</span>.responseText + <span class="hljs-string">')'</span>);
            jsonArry = histryresult.predictions;
            jsonArryterms = histryresult.terms;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; jsonArry.length; i++) {

                <span class="hljs-keyword">var</span> service_row = Ti.UI.createTableViewRow({
                    height : <span class="hljs-string">'70sp'</span>,
                    width : <span class="hljs-string">'100%'</span>,
                    backgroundColor : <span class="hljs-string">'#ffffff'</span>,
                    backgroundFocusedColor : <span class="hljs-string">'#FF8F2F'</span>,
                    backgroundSelectedColor : <span class="hljs-string">'#FF8F2F'</span>,
                    hasChild : <span class="hljs-literal">false</span>
                });

                <span class="hljs-keyword">var</span> lbl_oderid = Ti.UI.createLabel({
                    left : <span class="hljs-string">'3%'</span>,
                    top : <span class="hljs-string">'10%'</span>,
                    text : jsonArry[i].terms[<span class="hljs-number">1</span>].value,
                    color : <span class="hljs-string">'#A70CAF'</span>,
                    font : {
                        fontSize : <span class="hljs-string">'17sp'</span>,
                        fontWeight : <span class="hljs-string">'bold'</span>
                    },
                    height : <span class="hljs-string">'auto'</span>,
                    width : <span class="hljs-string">'auto'</span>
                });

                <span class="hljs-keyword">var</span> descriptiontext;
                <span class="hljs-keyword">if</span> (jsonArry[i].description == <span class="hljs-literal">undefined</span>) {
                    descriptiontext = <span class="hljs-string">'Not Valable'</span>;
                } <span class="hljs-keyword">else</span> {
                    descriptiontext = jsonArry[i].description;
                }

                <span class="hljs-keyword">var</span> lbl_description = Ti.UI.createLabel({
                    left : <span class="hljs-string">'5%'</span>,
                    top : <span class="hljs-string">'50%'</span>,
                    text : descriptiontext,
                    color : <span class="hljs-string">'#000000'</span>,
                    font : {
                        fontSize : <span class="hljs-string">'12sp'</span>,

                    },
                    height : <span class="hljs-string">'auto'</span>,
                    width : <span class="hljs-string">'auto'</span>
                });

                service_row.add(lbl_oderid);
                service_row.add(lbl_description);
                service_row.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{

                    <span class="hljs-keyword">var</span> locaName = jsonArry[e.index].description;

                    <span class="hljs-keyword">if</span> (jsonArry[e.index].description == <span class="hljs-literal">undefined</span>) {

                    } <span class="hljs-keyword">else</span> {
                        reversGeoloader.open(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"http://maps.googleapis.com/maps/api/geocode/json?address="</span> + locaName + <span class="hljs-string">"&amp;sensor=false"</span>);

                        reversGeoloader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

                            <span class="hljs-keyword">var</span> geoResult = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span> + <span class="hljs-keyword">this</span>.responseText + <span class="hljs-string">')'</span>);
                            jsonArry = geoResult.results;

                            <span class="hljs-keyword">var</span> newlat = jsonArry[<span class="hljs-number">0</span>].geometry.location.lat;
                            <span class="hljs-keyword">var</span> newlng = jsonArry[<span class="hljs-number">0</span>].geometry.location.lng;

                            curentlatitude = newlat;
                            curentlongitude = newlng;

                            getReversGeo(curentlatitude, curentlongitude, <span class="hljs-string">'str'</span>);
                            usercurentlocation.setText(<span class="hljs-string">'Set by serch'</span>);
                            tabTestWindow.close();

                        };
                        reversGeoloader.send();
                    }

                });

                resulttable.appendRow(service_row);

            }

        };
        loader.send();

    }
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 6th 2013, 12:27:37 pm">October 6th 2013</span>
								by <span class='authorname'>harsha kuruwita</span><br>
								<a class="icon-bg icon-link" href="question/127174/search-bar-autosuggestion.html#answer-269665" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
