<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>How to dynamically null an element children ? Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>How to dynamically null an element children ?</h1>
		</header>
		<section>
			<p>I&#39;ve a view and i&#39;ve removed all its children and also all their grandchildren recursively and dynamically  but now i need to null them all (as it&#39;s prescribed on the memory management best practices).<br>Doing that with a loop like for nulling a scrollView children in example i have : </p>
<pre><code class="hljs"><span class="hljs-keyword">for</span>(var <span class="hljs-built_in">i</span>=<span class="hljs-number">0</span>;<span class="hljs-built_in">i</span>&lt;Ti.App.accueilscreenCtrl.scrollView.getChildren().<span class="hljs-built_in">length</span>;<span class="hljs-built_in">i</span>++)<span class="hljs-cell">{
Ti.App.accueilscreenCtrl.scrollView.getChildren()[i]=null;
}</span>
</code></pre><p>I don&#39;t think this will really null the elements but just the children array cells. i coudn&#39;t even test this as for &#39;ScrollVview0&#39;,  &#39;ScrollVview1&#39; and  &#39;ScrollVview2&#39; children of &#39;scrollView&#39; (which i&#39;m clearing its children in the previous loop code) when i try to access any of these elements by :</p>
<pre><code class="hljs">Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview0   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.ScrollVview0);
Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview1   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.ScrollVview1);
Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview2   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.ScrollVview2);
</code></pre><p>or even : </p>
<pre><code class="hljs">Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview0   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.scrollView.ScrollVview0);
Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview1   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.scrollView.ScrollVview1);
Ti.API.info(<span class="hljs-string">"/&lt;/&gt;/&gt;  ScrollVview2   :"</span>+Ti.<span class="hljs-keyword">App</span>.accueilscreenCtrl.scrollView.ScrollVview2);
</code></pre><p>i always got undefined for these elements :</p>
<pre><code class="hljs">[INFO] :   <span class="hljs-regexp">/&lt;/</span>&gt;/&gt;  ScrollVview0   :<span class="hljs-literal">undefined</span>
[INFO] :   <span class="hljs-regexp">/&lt;/</span>&gt;/&gt;  ScrollVview1   :<span class="hljs-literal">undefined</span>
[INFO] :   <span class="hljs-regexp">/&lt;/</span>&gt;/&gt;  ScrollVview2   :<span class="hljs-literal">undefined</span>
</code></pre><p>the number of these ScrollVview&quot;i&quot; elements isn&#39;t always the same so i need a dynamic way to null them.<br>I&#39;ve asked about a similar javascript issue here :http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;20889077&#x2F;how-to-null-an-object-which-is-an-arrays-element-in-javascript&#x2F;20889125#comment31350418_20889125<br>but it seems there is no javascript solution.</p>
<p>Does someone has a clue ?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 3rd 2014, 12:23:40 pm">January 3rd 2014</span>
				by <span class='authorname'>mobile webdev2014</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>javascript</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-273419">
				
						<section>
							<p>Lets try and understand this.</p>
<p>You have a scrollview that has an unknown amount of child views.</p>
<p>You are adding these views dynamically to the scrollview.</p>
<p>You are then removing them dynamically from the scrollview, you are using the child elements to do this.</p>
<p>That is all you can do. Once you have removed them they no longer exist. </p>
<p>The nulling out is more to do with a view contained in a variable, then a child view. Mainly a window where you would null out any elements which exist in a variable.</p>
<p>i.e.</p>
<pre><code class="hljs">var subView = Ti.UI.createView()<span class="hljs-comment">;</span>

win.add(subView)<span class="hljs-comment">;</span>
</code></pre><p>you would then null out the win variable. So the parent. you could also null the subView variable, which would clean up your javaScript and memory.</p>
<p>Hopefully this explains it a bit more. But to clarify, adding a view to a parent view, by removing it cleans up the memory unless you have created it into a variable, where you can null that variable out.</p>
<p>T.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 3rd 2014, 4:41:54 pm">January 3rd 2014</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="../../question/161146/how-to-dynamically-null-an-element-children-.html#answer-273419" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thanks for your answer. In order not to loose memory, i will try to make loops and add an xml fragement(by creating a controller for each one) for each row so i can access any sub-controller&#39;s element and null it.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2014, 12:20:25 pm">January 8th 2014</span>
											by <span class='authorname'>mobile webdev2014</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-273427">
				
						<section>
							<p>Hello Crystaleez, </p>
<p>Working in this problem, I got a code sample that will allow you to clean the memory.</p>
<h3 id="code-sample">Code Sample</h3>
<h4 id="app-js">app.js</h4>
<pre><code class="hljs"><span class="hljs-comment">// INcluding memory management utils.</span>
Ti.include(<span class="hljs-string">'utils.js'</span>);

<span class="hljs-comment">// root window.</span>
var win = Ti.UI.createWindow({
    <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'white'</span>,
    <span class="hljs-string">exitOnclose :</span> <span class="hljs-literal">true</span>,
});

<span class="hljs-keyword">if</span> (Ti.UI.Android) {
    win.windowSoftInputMode = Ti.UI.Android.SOFT_INPUT_ADJUST_PAN;
}

function createRow(i) {
    var row = Ti.UI.createView({
        <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'white'</span>,
        <span class="hljs-string">borderColor :</span> <span class="hljs-string">'#bbb'</span>,
        <span class="hljs-string">borderWidth :</span> <span class="hljs-number">1</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">height :</span> <span class="hljs-number">70</span>,
        <span class="hljs-string">top :</span> <span class="hljs-number">0</span>,
        <span class="hljs-string">left :</span> <span class="hljs-number">0</span>
    });
    var inputTextField = Ti.UI.createTextField({
        <span class="hljs-string">hintText :</span> <span class="hljs-string">'Enter value '</span> + i,
        <span class="hljs-string">keyboardType :</span> Ti.UI.KEYBOARD_NUMBERS_PUNCTUATION,
        <span class="hljs-string">top :</span> <span class="hljs-number">10</span>,
        <span class="hljs-string">left :</span> <span class="hljs-string">'10%'</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'80%'</span>,
        <span class="hljs-string">height :</span> <span class="hljs-number">60</span>
    });
    row.add(inputTextField);
    <span class="hljs-keyword">return</span> row;
}

var label = Ti.UI.createLabel({
    <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'darkgray'</span>,
    <span class="hljs-string">text :</span> <span class="hljs-string">'remove'</span>,
    <span class="hljs-string">textAlign :</span> <span class="hljs-string">'center'</span>,
    <span class="hljs-string">bottom :</span> <span class="hljs-number">0</span>,
<span class="hljs-label">    left:</span><span class="hljs-number">0</span>,
    <span class="hljs-string">width :</span> Titanium.UI.FILL / <span class="hljs-number">2</span>,
    <span class="hljs-string">height :</span> <span class="hljs-number">100</span>
});

var label2 = Ti.UI.createLabel({
    <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'darkgray'</span>,
    <span class="hljs-string">text :</span> <span class="hljs-string">'create'</span>,
    <span class="hljs-string">textAlign :</span> <span class="hljs-string">'center'</span>,
    <span class="hljs-string">bottom :</span> <span class="hljs-number">0</span>,
    <span class="hljs-string">left :</span> Titanium.UI.FILL / <span class="hljs-number">2</span> + <span class="hljs-number">1</span>,
    <span class="hljs-string">width :</span> Titanium.UI.FILL / <span class="hljs-number">2</span>,
    <span class="hljs-string">height :</span> <span class="hljs-number">100</span>
});

win.add(label);
win.add(label2);

var scrollView;

label.addEventListener(<span class="hljs-string">"click"</span>, function() {
    win.remove(scrollView);
    Ti.API.info(scrollView.getChildren().length);
    alert(scrollView.getChildren().length);
    clean(scrollView);
    scrollView = <span class="hljs-literal">null</span>;
});

label2.addEventListener(<span class="hljs-string">'click'</span>, function() {

    scrollView = Ti.UI.createScrollView({
        <span class="hljs-string">bottom :</span> <span class="hljs-number">120</span>,
        <span class="hljs-string">contentHeight :</span> <span class="hljs-string">'auto'</span>,
        <span class="hljs-string">layout :</span> <span class="hljs-string">'vertical'</span>
    });
    Ti.API.info(scrollView.getChildren().length);
    alert(scrollView.getChildren().length);
    <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">20</span>; i++) {
        var row = createRow(i);
        scrollView.add(row);
    }
    win.add(scrollView);

});

win.open();
</code></pre><p>This sample includes two buttons, one to remove a scrollview and one to create a scrollview. </p>
<p>You will need to util.js file as well:</p>
<h4 id="utils-js">utils.js</h4>
<pre><code class="hljs"><span class="hljs-comment">/// Recursive Clean of Memory</span>
<span class="hljs-comment">// by Mauro Parra</span>
<span class="hljs-comment">// https://gist.github.com/mauropm/2655813</span>
<span class="hljs-comment">// Begin recursive clean of memory</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">do_clean</span>(<span class="hljs-params">e, c</span>) </span>{
    clean(c);
    e.remove(c);
    c = <span class="hljs-literal">null</span>;
    Ti.API.info(<span class="hljs-string">'Deleted child at do_clean'</span>);
    <span class="hljs-keyword">return</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clean</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (e.children) {
            Ti.API.info(<span class="hljs-string">'Number of children: '</span> + e.children.length);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; e.children.length; i++) {
                do_clean(e, e.children[<span class="hljs-number">0</span>]);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span>;
        }
    }
}

<span class="hljs-comment">// End recursive clean of memory</span>

<span class="hljs-comment">/// &lt;&lt;&lt; Register &amp; UnRegister Event Listeners</span>
<span class="hljs-comment">// Original from: https://gist.github.com/minhnc/2333095</span>
<span class="hljs-comment">// Thanks minhnc!</span>

<span class="hljs-comment">/**
 * params: {event: 'event', callback: eventCallback}
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerEventListener</span>(<span class="hljs-params">obj, params</span>) </span>{
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> obj._eventListeners == <span class="hljs-string">'undefined'</span>) {
        obj._eventListeners = [];
    }

    obj.addEventListener(params.event, params.callback);

    <span class="hljs-keyword">var</span> eventListeners = obj._eventListeners;
    eventListeners.push(params);
    obj._eventListeners = eventListeners;

    Ti.API.info(<span class="hljs-built_in">JSON</span>.stringify(obj._eventListeners));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unRegisterAllEventListeners</span>(<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> obj._eventListeners == <span class="hljs-string">'undefined'</span> || obj._eventListeners.length == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = obj._eventListeners.length; i &lt; len; i++) {
        <span class="hljs-keyword">var</span> e = obj._eventListeners[i];
        obj.removeEventListener(e.event, e.callback);
    }

    obj._eventListeners = [];
}

<span class="hljs-comment">/// Register &amp; UnRegister Event Listeners &gt;&gt;&gt;</span>

<span class="hljs-comment">// Begin win2 clean (all secondary windows are named win2)</span>

<span class="hljs-comment">// Function to clean the win2 (i.e., remove all the attached listeners, close it, null it)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">win2Clean</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (win2 != <span class="hljs-literal">null</span>) {
        win2.close();
        clean(win2);
        unRegisterAllEventListeners(win2);
        win2 = <span class="hljs-literal">null</span>;
    }
    Ti.App.removeEventListener(<span class="hljs-string">'win2:close'</span>, win2Clean);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">win2Close</span>(<span class="hljs-params"></span>) </span>{
    Ti.App.fireEvent(<span class="hljs-string">'win2:close'</span>);
}
</code></pre><h3 id="execution">Execution</h3>
<p>In order to check the memory, you have to follow this instructions:</p>
<ul>
<li>Create a new mobile project (classic titanium)</li>
<li>Paste app.js into app.js and copy utils.js  into Resources Directory</li>
<li>Build for simulator</li>
<li>Close the simulator</li>
<li>Go to the Finder and find the directory of your project, usually in Documents&#x2F;Titanium_Studio_Workspace&#x2F;yourprojectname</li>
<li>Go to the build directory</li>
<li>Click in the xcode project file</li>
<li>This will open Xcode</li>
<li>Go to Product -&gt; Profile</li>
<li>This will open instruments</li>
<li>Select iOS simulator, Memory, Allocations</li>
<li>Click Profile</li>
<li>Now this will open the simulator, and maybe will require special permissions to check the process. </li>
<li>Provide the necessary permissions and go to the simulator.</li>
<li>Click create and remove and see in the instruments </li>
<li>You will see that when you create the scrollview it will go to 6M of live bytes</li>
<li>When you click remove it will decrease to 3M+ of live bytes</li>
<li>Repeat</li>
</ul>
<p>You will see that it keeps showing you the same memory when the scrollview appears and will show you about the same amount of memory released when the scrollview is destroyed. Therefore, we don&#39;t have a leak on the cleaning.</p>
<p>Please take a look into this and let us know your experience. </p>
<p>I hope this helps to clarify how to clean the scrollview and it&#39;s contents. </p>
<p>Best,</p>
<p>Mauro</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 4th 2014, 12:17:15 am">January 4th 2014</span>
								by <span class='authorname'>Mauro Parra</span><br>
								<a class="icon-bg icon-link" href="../../question/161146/how-to-dynamically-null-an-element-children-.html#answer-273427" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for your answer Mauro,  especially for steps to see the memory profiling in the XCODE instruments(i still never tried that myself and this will help me to do it as soon as possible).<br>In the other hand still think that writting <code>inline code</code>c = null;<code>inline code</code> inside the <code>do_clean()</code> won&#39;t resolve the problem because what wil be nulled in only the &#39;c&#39; variable and that&#39;s maybe what could make the memory decrease.</p>
<p><a href="http:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;8318357&#x2F;javascript-pointer-reference-craziness-can-someone-explain-this&#x2F;8318405#8318405">this answer</a> explains the process of affecting a value to a variable in javascript(in your example &#39;c&#39; got its value when passing it thru the function parameters and what is inside the &#39;c&#39; variable isn&#39;t  <code>e.children[0]</code> itself but the object which it&#39;s referencing to.</p>
<p>I think i will stop to worry to much about nulling elements like what said T. Ward for now.(in the other hand i still wait for a solution to find a getElementbyId() like function as asked for in <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;151659&#x2F;using-getelementbyid-and-getelementbyname#comment-199324">this question</a></p>
<p>I also realized that i can free up more memory if i use xml fragments even for elements which are added with a loop (which is commonly used in Alloy examples) instead of creating everything dynamically as a controller can be created for each row added by the loop and then sub-elements of each controller can be accessed</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2014, 12:15:24 pm">January 8th 2014</span>
											by <span class='authorname'>mobile webdev2014</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>i think nulling <code>e.children[0]</code> iself also will null the cell indexed &#39;0&#39; in the &#39;children&#39; array and not really the object children of e.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 8th 2014, 1:14:49 pm">January 8th 2014</span>
											by <span class='authorname'>mobile webdev2014</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
