<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>TableView not refresh properly for the first row Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>TableView not refresh properly for the first row</h1>
		</header>
		<section>
			<p>I am writing an app using Alloy 1.1.2 for Android 4.x Tablet (Galaxy Note 10.0). There is a TableView which will be refreshed periodically using $.table.setData(data). It seems ok except the first row is not refreshed as expected. Do you have any solution of that?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 3rd 2013, 5:33:08 am">May 3rd 2013</span>
				by <span class='authorname'>Wilton Kwok</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>tableview</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Example of the data you are trying to set ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 11:27:43 am">May 3rd 2013</span>
								by <span class='authorname'>Nick Milner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Yeah, we definitely need a test case to have any idea what&#39;s going on.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 11:32:41 am">May 3rd 2013</span>
								by <span class='authorname'>Tony Lukasavage</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-262163">
				
						<section>
							<p><strong>orderBook.xml</strong></p>
<pre><code class="hljs">&lt;Alloy&gt;
    &lt;Collection src='orderBook'/&gt;

    &lt;<span class="hljs-keyword">View</span> id='orderBook' <span class="hljs-keyword">class</span>=<span class="hljs-string">"container"</span>&gt;

    &lt;<span class="hljs-keyword">View</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeader"</span>&gt;
        &lt;<span class="hljs-keyword">View</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH0"</span>/&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH1"</span> textid=<span class="hljs-string">"id"</span>&gt;ID&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH2"</span> textid=<span class="hljs-string">"order_time"</span>&gt;<span class="hljs-keyword">Order</span> Time&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH14"</span> textid=<span class="hljs-string">"exchange"</span>&gt;Exchange&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH3"</span> textid=<span class="hljs-string">"contract"</span>&gt;<span class="hljs-keyword">Contract</span>&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH4"</span> textid=<span class="hljs-string">"buy_sell"</span>&gt;Buy/Sell&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH5"</span> textid=<span class="hljs-string">"action"</span>&gt;Action&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH6"</span> textid=<span class="hljs-string">"type"</span>&gt;<span class="hljs-keyword">Type</span>&lt;/<span class="hljs-keyword">Label</span>&gt; 
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH7"</span> textid=<span class="hljs-string">"t_1"</span>&gt;T+1&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH8"</span> textid=<span class="hljs-string">"status"</span>&gt;Status&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH9"</span> textid=<span class="hljs-string">"filled_price"</span>&gt;Price&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH10"</span> textid=<span class="hljs-string">"filled_qty"</span>&gt;Qty&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH11"</span> textid=<span class="hljs-string">"os_qty"</span>&gt;O/S Qty&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH13"</span> textid=<span class="hljs-string">"account_no"</span>&gt;Account <span class="hljs-keyword">No</span>.&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowHeaderText orderBookH12"</span> textid=<span class="hljs-string">"system_remarks"</span>&gt;System Remarks&lt;/<span class="hljs-keyword">Label</span>&gt;
    &lt;/<span class="hljs-keyword">View</span>&gt;

        &lt;TableView id='<span class="hljs-keyword">table</span>'&gt;

        &lt;/TableView&gt;

    &lt;/<span class="hljs-keyword">View</span>&gt;
&lt;/Alloy&gt;
</code></pre><p><strong>orderBookRow.xml</strong></p>
<pre><code class="hljs">&lt;Alloy&gt;
    &lt;TableViewRow id='row' <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBody"</span>&gt;
        &lt;<span class="hljs-keyword">View</span> id='detailButton' <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook0"</span>&gt;
            &lt;ImageView image='/images/row_detail.png'/&gt;
        &lt;/<span class="hljs-keyword">View</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"id"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook1"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"orderTime"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook2"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"exchange"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook14"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"contract"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook3"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"buyOrSell"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook4"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"action"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook5"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"type"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook6"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"t1"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook7"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">View</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook8"</span>&gt;
            &lt;ImageView id=<span class="hljs-string">"statusImage"</span> width=<span class="hljs-string">"22"</span> height=<span class="hljs-string">"22"</span>/&gt;
        &lt;/<span class="hljs-keyword">View</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"price"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook9"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"qty"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook10"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"osQty"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook11"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"account"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook13"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
        &lt;<span class="hljs-keyword">Label</span> id=<span class="hljs-string">"remarks"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"tableRowBodyText orderBook12"</span>&gt;&lt;/<span class="hljs-keyword">Label</span>&gt;
    &lt;/TableViewRow&gt;
&lt;/Alloy&gt;
</code></pre><p><strong>orderBook.js</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> orders = Alloy.Collections.orderBook;
orders.on(<span class="hljs-string">'add'</span>, refreshTable);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refreshTable</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> user_id = Alloy.Globals.auth_info.user_id;
    <span class="hljs-keyword">var</span> list = orders.where({account_no: user_id})
    <span class="hljs-keyword">var</span> row = {};
    <span class="hljs-keyword">var</span> data = [];
    <span class="hljs-keyword">var</span> order_response = {};
    <span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>;
    _.each(list, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">item</span>)</span>{
        order_response = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(item));

        row = Alloy.createController(<span class="hljs-string">'orderBookRow'</span>, {

                order_group_id: order_response.order_group_id,
                product_code: order_response.product_code,
                order_side: order_response.order_side,
                order_action: order_response.order_action,
                order_type: order_response.order_type,
                t_plus_one_trading: order_response.t_plus_one_trading,
                system_order_status: order_response.system_order_status,
                exchange_order_status: order_response.exchange_order_status,
                exchange_code: order_response.exchange_code,
                order_price: order_response.order_price,
                order_quantity: order_response.order_quantity,
                average_price: order_response.average_price,
                outstanding_quantity: order_response.outstanding_quantity,
                total_filled_quantity: order_response.total_filled_quantity,
                order_date: order_response.order_date,
                order_time: order_response.order_time,
                order_input_user: order_response.order_input_user,
                account_no: order_response.account_no,
                time_in_force: order_response.time_in_force,
                client_side_reference_id: order_response.client_side_reference_id,
                correlated_action_code: order_response.correlated_action_code,
                system_remark: order_response.system_remark,
                error_code: order_response.error_code,
                index: index++

        }).getView();

        data.push(row);
    });

    $.table.setData(data);
}
</code></pre><p>There is another function listen to the server and get the list of order. When there is any update, the app will update the Model orderBook and then refresh the table. All the rows can be refreshed except the first row. The first row can be updated when the user scroll the the first row out of the tableview and scroll back. The first row is refreshed.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 5th 2013, 7:31:45 am">May 5th 2013</span>
								by <span class='authorname'>Wilton Kwok</span><br>
								<a class="icon-bg icon-link" href="../../question/151912/tableview-not-refresh-properly-for-the-first-row.html#answer-262163" rel="permalink">permalink</a>
							</div>

							<h5>8 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I put the tableRowHeader from orderBook.xml and assign to the headerView property of #.table. The first row can be refresh. But the reason that I put the tableRowHeader out of $.table because I want the header keep visible when the list is scrolled.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 5th 2013, 7:34:47 am">May 5th 2013</span>
											by <span class='authorname'>Wilton Kwok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So i your problem solved then? And you can add a header pretty easily like this:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">TableView</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">HeaderView</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- the view(s) you want to use as the header for this tabel --&gt;</span> 
    <span class="hljs-tag">&lt;/<span class="hljs-title">HeaderView</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 6th 2013, 10:54:56 am">May 6th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not really.  The first row still not refreshing again even I put the HeaderView.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 6th 2013, 12:36:53 pm">May 6th 2013</span>
											by <span class='authorname'>Wilton Kwok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m not following then. You mentioned in your comment above that you got the first row to refresh. What it still not working?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 6th 2013, 12:38:48 pm">May 6th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>When I demo to user today, the first row cannot be refreshed again. It&#39;s strange.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 6th 2013, 1:21:37 pm">May 6th 2013</span>
											by <span class='authorname'>Wilton Kwok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK, well since you are kind of all over the place with reproducing, we&#39;ll need a small test case that consistently reproduces the issue in order to test on our end. Don&#39;t post the whole app, just the smallest possible test case that reproduces the issue.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 6th 2013, 1:47:21 pm">May 6th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The above is the test case I am using. One more thing is that orderBook.js will listen to <strong>change</strong> event as follow.</p>
<pre><code class="hljs"><span class="hljs-keyword">order</span><span class="hljs-built_in">.</span><span class="hljs-keyword">on</span>(<span class="hljs-string">'change'</span>, refreshTable);
</code></pre><p>Once the refreshTable is called via <strong>change</strong> event. If the record of the first row is change, it will not refresh. But others are ok.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 8:57:11 am">May 7th 2013</span>
											by <span class='authorname'>Wilton Kwok</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Wilton, the above code is not a test case for a couple reasons:</p>
<ul>
<li>It cannot be run. You&#39;ve given pieces, but what you&#39;ve provided will not run on its own and therefore cannot be tested to reproduce your issue.</li>
<li>It is too complicated. You need to significantly reduce it down to the absolute minimum that causes your issue. Don&#39;t just post whole files from your app. No extra files, no extra UI components or models, just the bare minimum. Often in creating this bare minimum you&#39;ll discover the root problem yourself.</li>
</ul>
</p>
										<div class="author">
											&mdash; commented <span title="May 7th 2013, 11:31:44 am">May 7th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
