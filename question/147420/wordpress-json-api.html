<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Wordpress JSON API Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Wordpress JSON API</h1>
		</header>
		<section>
			<p>I have been modifying the twitter app that was created with a tutorial from MobileTuts+.(http:&#x2F;&#x2F;mobile.tutsplus.com&#x2F;tutorials&#x2F;appcelerator&#x2F;appcelerator-using-json-to-build-a-twitter-client&#x2F;)</p>
<p>I am able to launch the app in the emulator without any errors but I am not getting any data from it.</p>
<p>here is my code for this(modified)</p>
<pre><code class="hljs"><span class="hljs-comment">//</span>
<span class="hljs-comment">// Function loadNews()</span>
<span class="hljs-comment">//</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadNews</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-comment">// Empty array "rowData" for our tableview</span>
    <span class="hljs-keyword">var</span> rowData = [];
    <span class="hljs-comment">// Create our HTTP Client and name it "loader"</span>
    <span class="hljs-keyword">var</span> loader = Titanium.Network.createHTTPClient();
    <span class="hljs-comment">// Sets the HTTP request method, and the URL to get data from</span>
    loader.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"http://papillonstudios.ca/vghs/vghs_json/get_recent_posts/"</span>);
    <span class="hljs-comment">// Runs the function when the data is ready for us to process</span>
    loader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">var</span> news = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span>+<span class="hljs-keyword">this</span>.responseText+<span class="hljs-string">')'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tweets.length; i++)
        {
            <span class="hljs-keyword">var</span> post = news[i].posts.title_plain;
            <span class="hljs-keyword">var</span> post_content = news[i].posts.content;


            <span class="hljs-comment">//var tweet = tweets[i].text; // The tweet message</span>
            <span class="hljs-comment">//var user = tweets[i].user.screen_name; // The screen name of the user</span>
            <span class="hljs-comment">//var avatar = tweets[i].user.profile_image_url; // The profile image</span>
            <span class="hljs-comment">// Create a row and set its height to auto</span>
            <span class="hljs-keyword">var</span> row = Titanium.UI.createTableViewRow({height:<span class="hljs-string">'auto'</span>});

            <span class="hljs-comment">// Create the view that will contain the text and avatar</span>
            <span class="hljs-keyword">var</span> post_view = Titanium.UI.createView({
                height:<span class="hljs-string">'auto'</span>, 
                layout:<span class="hljs-string">'vertical'</span>,
                top:<span class="hljs-number">5</span>,
                right:<span class="hljs-number">5</span>,
                bottom:<span class="hljs-number">5</span>,
                left:<span class="hljs-number">5</span>
            });
            <span class="hljs-comment">// Create image view to hold profile pic</span>
            <span class="hljs-keyword">var</span> av_image = Titanium.UI.createImageView({
                url: <span class="hljs-string">'KS_nav_ui.png'</span>, <span class="hljs-comment">// the image for the image view</span>
                top:<span class="hljs-number">0</span>,
                left:<span class="hljs-number">0</span>,
                height:<span class="hljs-number">48</span>,
                width:<span class="hljs-number">48</span>
            });
            post_view.add(av_image);

            <span class="hljs-comment">// Create the label to hold the tweet message</span>
            <span class="hljs-keyword">var</span> post_lbl = Titanium.UI.createLabel({
                text:tweet,
                left:<span class="hljs-number">54</span>,
                top:<span class="hljs-number">0</span>,
                bottom:<span class="hljs-number">2</span>,
                height:<span class="hljs-string">'auto'</span>,
                width:<span class="hljs-number">236</span>,
                textAlign:<span class="hljs-string">'left'</span>,
                font:{fontSize:<span class="hljs-number">14</span>}
            });
            post_view.add(post_lbl);
            <span class="hljs-comment">// Add the post view to the row</span>
            row.add(post_view);
            <span class="hljs-comment">// Give each row a class name</span>
            row.className = <span class="hljs-string">"item"</span>+i;
            <span class="hljs-comment">// Add row to the rowData array</span>
            rowData[i] = row;
        }
        <span class="hljs-comment">// Create the table view and set its data source to "rowData" array</span>
        <span class="hljs-keyword">var</span> tableView = Titanium.UI.createTableView({data:rowData});
        <span class="hljs-comment">//Add the table view to the window</span>
        win1.add(tableView);
    };
    <span class="hljs-comment">// Send the HTTP request</span>
    loader.send();
}
loadNews();
</code></pre><p>from another post I found the response that I should be getting from the JSON API for wordpress. here it is as follows</p>
<pre><code class="hljs">{
  "<span class="hljs-attribute">status</span>": <span class="hljs-value"><span class="hljs-string">"ok"</span></span>,
  "<span class="hljs-attribute">count</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
  "<span class="hljs-attribute">count_total</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
  "<span class="hljs-attribute">pages</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
  "<span class="hljs-attribute">posts</span>": <span class="hljs-value">[
    {
      "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
      "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"post"</span></span>,
      "<span class="hljs-attribute">slug</span>": <span class="hljs-value"><span class="hljs-string">"hello-world"</span></span>,
      "<span class="hljs-attribute">url</span>": <span class="hljs-value"><span class="hljs-string">"http:\/\/localhost\/wordpress\/?p=1"</span></span>,
      "<span class="hljs-attribute">title</span>": <span class="hljs-value"><span class="hljs-string">"Hello world!"</span></span>,
      "<span class="hljs-attribute">title_plain</span>": <span class="hljs-value"><span class="hljs-string">"Hello world!"</span></span>,
      "<span class="hljs-attribute">content</span>": <span class="hljs-value"><span class="hljs-string">"&lt;p&gt;Welcome to WordPress. This is your first post. Edit or delete it, then start blogging!&lt;\/p&gt;\n"</span></span>,
      "<span class="hljs-attribute">excerpt</span>": <span class="hljs-value"><span class="hljs-string">"Welcome to WordPress. This is your first post. Edit or delete it, then start blogging!\n"</span></span>,
      "<span class="hljs-attribute">date</span>": <span class="hljs-value"><span class="hljs-string">"2009-11-11 12:50:19"</span></span>,
      "<span class="hljs-attribute">modified</span>": <span class="hljs-value"><span class="hljs-string">"2009-11-11 12:50:19"</span></span>,
      "<span class="hljs-attribute">categories</span>": <span class="hljs-value">[]</span>,
      "<span class="hljs-attribute">tags</span>": <span class="hljs-value">[]</span>,
      "<span class="hljs-attribute">author</span>": <span class="hljs-value">{
        "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
        "<span class="hljs-attribute">slug</span>": <span class="hljs-value"><span class="hljs-string">"admin"</span></span>,
        "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"admin"</span></span>,
        "<span class="hljs-attribute">first_name</span>": <span class="hljs-value"><span class="hljs-string">""</span></span>,
        "<span class="hljs-attribute">last_name</span>": <span class="hljs-value"><span class="hljs-string">""</span></span>,
        "<span class="hljs-attribute">nickname</span>": <span class="hljs-value"><span class="hljs-string">""</span></span>,
        "<span class="hljs-attribute">url</span>": <span class="hljs-value"><span class="hljs-string">""</span></span>,
        "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">""</span>
      </span>}</span>,
      "<span class="hljs-attribute">comments</span>": <span class="hljs-value">[
        {
          "<span class="hljs-attribute">id</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
          "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"Mr WordPress"</span></span>,
          "<span class="hljs-attribute">url</span>": <span class="hljs-value"><span class="hljs-string">"http:\/\/wordpress.org\/"</span></span>,
          "<span class="hljs-attribute">date</span>": <span class="hljs-value"><span class="hljs-string">"2009-11-11 12:50:19"</span></span>,
          "<span class="hljs-attribute">content</span>": <span class="hljs-value"><span class="hljs-string">"&lt;p&gt;Hi, this is a comment.&lt;br \/&gt;To delete a comment, just log in and view the post's comments. There you will have the option to edit or delete them.&lt;\/p&gt;\n"</span></span>,
          "<span class="hljs-attribute">parent</span>": <span class="hljs-value"><span class="hljs-number">0</span>
        </span>}
      ]</span>,
      "<span class="hljs-attribute">comment_count</span>": <span class="hljs-value"><span class="hljs-number">1</span></span>,
      "<span class="hljs-attribute">comment_status</span>": <span class="hljs-value"><span class="hljs-string">"open"</span>
    </span>}
  ]
</span>}
</code></pre><p>What am I doing wrong?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 25th 2013, 10:36:48 pm">January 25th 2013</span>
				by <span class='authorname'>Chad Gregory</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>twitter</span></li>
					
						<li><span class='tagname'>wordpress</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-255544">
				
						<section>
							<p>here is a blog post on integrating wordpress with Alloy </p>
<p><a href="http:&#x2F;&#x2F;bit.ly&#x2F;14odPu9">http:&#x2F;&#x2F;www.clearlyinnovative.com&#x2F;blog&#x2F;post&#x2F;34758524010&#x2F;titanium-quickie-a-simple-integration-of-alloy-and-wordpress-json-plugin</a></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 28th 2013, 2:43:25 pm">January 28th 2013</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="../../question/147420/wordpress-json-api.html#answer-255544" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-255397">
				
						<section>
							<p>The URL that you are passing to your HTTPClient is giving a 404 error, so check that you have the correct path.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 25th 2013, 10:49:35 pm">January 25th 2013</span>
								by <span class='authorname'>Adam Paxton</span><br>
								<a class="icon-bg icon-link" href="../../question/147420/wordpress-json-api.html#answer-255397" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Try <code>http:&amp;#x2F;&amp;#x2F;papillonstudios.ca&amp;#x2F;vghs&amp;#x2F;api&amp;#x2F;get_recent_posts&amp;#x2F;</code></p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2013, 10:50:21 pm">January 25th 2013</span>
											by <span class='authorname'>Adam Paxton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>yea I have been doing more tinkering and changed it back to the default but even with that and just changing a few values with the original tweets.js code I get the table view but no data. Here is the updated code.<br>I have just commented out what I didn&#39;t want displays. I didn&#39;t changed variable or function names either.</p>
<pre><code class="hljs"><span class="hljs-comment">// Function loadTweets()</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadTweets</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-comment">// Empty array "rowData" for our tableview</span>
    <span class="hljs-keyword">var</span> rowData = [];
    <span class="hljs-comment">// Create our HTTP Client and name it "loader"</span>
    <span class="hljs-keyword">var</span> loader = Titanium.Network.createHTTPClient();
    <span class="hljs-comment">// Sets the HTTP request method, and the URL to get data from</span>
    loader.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"http://papillonstudios.ca/vghs/api/get_recent_posts/"</span>);
    <span class="hljs-comment">// Runs the function when the data is ready for us to process</span>
    loader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">var</span> tweets = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span>+<span class="hljs-keyword">this</span>.responseText+<span class="hljs-string">')'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tweets.length; i++)
        {
            <span class="hljs-keyword">var</span> tweet = tweets[i].posts.title; <span class="hljs-comment">// The tweet message</span>
            <span class="hljs-comment">//var user = tweets[i].user.screen_name; // The screen name of the user</span>
            <span class="hljs-comment">//var avatar = tweets[i].user.profile_image_url; // The profile image</span>
            <span class="hljs-comment">// Create a row and set its height to auto</span>
            <span class="hljs-keyword">var</span> row = Titanium.UI.createTableViewRow({height:<span class="hljs-string">'auto'</span>});

            <span class="hljs-comment">// Create the view that will contain the text and avatar</span>
            <span class="hljs-keyword">var</span> post_view = Titanium.UI.createView({
                height:<span class="hljs-string">'auto'</span>, 
                layout:<span class="hljs-string">'vertical'</span>,
                top:<span class="hljs-number">5</span>,
                right:<span class="hljs-number">5</span>,
                bottom:<span class="hljs-number">5</span>,
                left:<span class="hljs-number">5</span>
            });
            <span class="hljs-comment">// Create image view to hold profile pic</span>
            <span class="hljs-comment">/*var av_image = Titanium.UI.createImageView({
                url:avatar, // the image for the image view
                top:0,
                left:0,
                height:48,
                width:48
            });
            post_view.add(av_image);*/</span>
            <span class="hljs-comment">// Create the label to hold the screen name</span>
            <span class="hljs-comment">/*var user_lbl = Titanium.UI.createLabel({
                text:user,
                left:54,
                width:120,
                top:-48,
                bottom:2,
                height:16,
                textAlign:'left',
                color:'#000',
                font:{fontFamily:'Trebuchet MS',fontSize:14,fontWeight:'bold'}
            });
            post_view.add(user_lbl);*/</span>
            <span class="hljs-comment">// Create the label to hold the tweet message</span>
            <span class="hljs-keyword">var</span> tweet_lbl = Titanium.UI.createLabel({
                text:tweet,
                left:<span class="hljs-number">54</span>,
                top:<span class="hljs-number">0</span>,
                bottom:<span class="hljs-number">2</span>,
                height:<span class="hljs-string">'auto'</span>,
                width:<span class="hljs-number">236</span>,
                textAlign:<span class="hljs-string">'left'</span>,
                font:{fontSize:<span class="hljs-number">14</span>}
            });
            post_view.add(tweet_lbl);
            <span class="hljs-comment">// Add the post view to the row</span>
            row.add(post_view);
            <span class="hljs-comment">// Give each row a class name</span>
            row.className = <span class="hljs-string">"item"</span>+i;
            <span class="hljs-comment">// Add row to the rowData array</span>
            rowData[i] = row;
        }
        <span class="hljs-comment">// Create the table view and set its data source to "rowData" array</span>
        <span class="hljs-keyword">var</span> tableView = Titanium.UI.createTableView({data:rowData});
        <span class="hljs-comment">//Add the table view to the window</span>
        win.add(tableView);
    };
    <span class="hljs-comment">// Send the HTTP request</span>
    loader.send();
}
loadTweets();
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 25th 2013, 11:14:46 pm">January 25th 2013</span>
											by <span class='authorname'>Chad Gregory</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-255398">
				
						<section>
							<p>yea I have been doing more tinkering and changed it back to the default but even with that and just changing a few values with the original tweets.js code I get the table view but no data. Here is the updated code.</p>
<p>I have just commented out what I didn&#39;t want displays. I didn&#39;t changed variable or function names either.</p>
<pre><code class="hljs"><span class="hljs-comment">// Function loadTweets()</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadTweets</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-comment">// Empty array "rowData" for our tableview</span>
    <span class="hljs-keyword">var</span> rowData = [];
    <span class="hljs-comment">// Create our HTTP Client and name it "loader"</span>
    <span class="hljs-keyword">var</span> loader = Titanium.Network.createHTTPClient();
    <span class="hljs-comment">// Sets the HTTP request method, and the URL to get data from</span>
    loader.open(<span class="hljs-string">"GET"</span>,<span class="hljs-string">"http://papillonstudios.ca/vghs/api/get_recent_posts/"</span>);
    <span class="hljs-comment">// Runs the function when the data is ready for us to process</span>
    loader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) 
    </span>{
        <span class="hljs-keyword">var</span> tweets = <span class="hljs-built_in">eval</span>(<span class="hljs-string">'('</span>+<span class="hljs-keyword">this</span>.responseText+<span class="hljs-string">')'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; tweets.length; i++)
        {
            <span class="hljs-keyword">var</span> tweet = tweets[i].posts.title; <span class="hljs-comment">// The tweet message</span>
            <span class="hljs-comment">//var user = tweets[i].user.screen_name; // The screen name of the user</span>
            <span class="hljs-comment">//var avatar = tweets[i].user.profile_image_url; // The profile image</span>
            <span class="hljs-comment">// Create a row and set its height to auto</span>
            <span class="hljs-keyword">var</span> row = Titanium.UI.createTableViewRow({height:<span class="hljs-string">'auto'</span>});

            <span class="hljs-comment">// Create the view that will contain the text and avatar</span>
            <span class="hljs-keyword">var</span> post_view = Titanium.UI.createView({
                height:<span class="hljs-string">'auto'</span>, 
                layout:<span class="hljs-string">'vertical'</span>,
                top:<span class="hljs-number">5</span>,
                right:<span class="hljs-number">5</span>,
                bottom:<span class="hljs-number">5</span>,
                left:<span class="hljs-number">5</span>
            });
            <span class="hljs-comment">// Create image view to hold profile pic</span>
            <span class="hljs-comment">/*var av_image = Titanium.UI.createImageView({
                url:avatar, // the image for the image view
                top:0,
                left:0,
                height:48,
                width:48
            });
            post_view.add(av_image);*/</span>
            <span class="hljs-comment">// Create the label to hold the screen name</span>
            <span class="hljs-comment">/*var user_lbl = Titanium.UI.createLabel({
                text:user,
                left:54,
                width:120,
                top:-48,
                bottom:2,
                height:16,
                textAlign:'left',
                color:'#000',
                font:{fontFamily:'Trebuchet MS',fontSize:14,fontWeight:'bold'}
            });
            post_view.add(user_lbl);*/</span>
            <span class="hljs-comment">// Create the label to hold the tweet message</span>
            <span class="hljs-keyword">var</span> tweet_lbl = Titanium.UI.createLabel({
                text:tweet,
                left:<span class="hljs-number">54</span>,
                top:<span class="hljs-number">0</span>,
                bottom:<span class="hljs-number">2</span>,
                height:<span class="hljs-string">'auto'</span>,
                width:<span class="hljs-number">236</span>,
                textAlign:<span class="hljs-string">'left'</span>,
                font:{fontSize:<span class="hljs-number">14</span>}
            });
            post_view.add(tweet_lbl);
            <span class="hljs-comment">// Add the post view to the row</span>
            row.add(post_view);
            <span class="hljs-comment">// Give each row a class name</span>
            row.className = <span class="hljs-string">"item"</span>+i;
            <span class="hljs-comment">// Add row to the rowData array</span>
            rowData[i] = row;
        }
        <span class="hljs-comment">// Create the table view and set its data source to "rowData" array</span>
        <span class="hljs-keyword">var</span> tableView = Titanium.UI.createTableView({data:rowData});
        <span class="hljs-comment">//Add the table view to the window</span>
        win.add(tableView);
    };
    <span class="hljs-comment">// Send the HTTP request</span>
    loader.send();
}
loadTweets();
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 25th 2013, 10:56:07 pm">January 25th 2013</span>
								by <span class='authorname'>Chad Gregory</span><br>
								<a class="icon-bg icon-link" href="../../question/147420/wordpress-json-api.html#answer-255398" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-255399">
				
						<section>
							<p>Won&#39;t explain it all, but this is a model we use for talking to wordpress json.</p>
<pre><code class="hljs">
<span class="hljs-comment">/* Sample clientconfig.js entry
        publications:{
                    title:L('publications', 'Publications'),
                    icon:'/images/tabBlog.png',
                    refresh_event: 'refresh_publications',
                    type: 'wordpress',
                    format: 'json',
                    url: 'http://mysite.com/'
                }
 */</span>
<span class="hljs-keyword">var</span> moment = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/moment'</span>);
<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/clientconfig'</span>);
<span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/utils'</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PostEntry</span>(<span class="hljs-params">entry</span>)</span>{
    <span class="hljs-keyword">this</span>.id = entry.id;
    <span class="hljs-keyword">this</span>.title = entry.title.replace(<span class="hljs-regexp">/&amp;#([^\s]*);/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(y)});
    <span class="hljs-keyword">this</span>.date = moment(entry.date,<span class="hljs-string">'YYYY-MM-DD HH:mm:ss'</span>);
    <span class="hljs-keyword">this</span>.content = entry.content;
    <span class="hljs-keyword">this</span>.url = entry.url;
}
exports.PostEntry = PostEntry;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BlogFeed</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">this</span>.uri = config.structure.tabs.publications.url;
    <span class="hljs-keyword">this</span>.count = <span class="hljs-number">30</span>;

    <span class="hljs-keyword">this</span>.buildURL = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> str = <span class="hljs-keyword">this</span>.uri+<span class="hljs-string">'?json=1'</span>;
        str += <span class="hljs-string">'&amp;count='</span>+<span class="hljs-keyword">this</span>.count;
        <span class="hljs-keyword">return</span> str;
    };

    <span class="hljs-keyword">this</span>.loadFeed = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>)</span>{
        <span class="hljs-keyword">var</span> xhrfeed = Ti.Network.createHTTPClient();
        xhrfeed.open(<span class="hljs-string">"GET"</span>, <span class="hljs-keyword">this</span>.buildURL());
        xhrfeed.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            <span class="hljs-keyword">try</span>
            {
                <span class="hljs-keyword">var</span> strContent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/caching'</span>).CacheFeedContent(<span class="hljs-keyword">this</span>, <span class="hljs-string">'publications.'</span>+config.structure.tabs.publications.format,<span class="hljs-string">'publications'</span>);
                callback(strContent);
                utils.hideActivityIndicator();


            }
            <span class="hljs-keyword">catch</span>(E)
            {
                Ti.API.error(E);
            }
        };

        xhrfeed.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            Ti.API.error(<span class="hljs-built_in">JSON</span>.stringify(e));
            alert(L(<span class="hljs-string">'errornetwork'</span>));
        };
        xhrfeed.send();


    };

    <span class="hljs-keyword">this</span>.parseFeed = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">json</span>)</span>{
        <span class="hljs-keyword">var</span> posts = [];
        <span class="hljs-keyword">var</span> data = <span class="hljs-built_in">JSON</span>.parse(json);
        <span class="hljs-keyword">var</span> postEntries = data.posts;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i &lt; postEntries.length; i++){
            <span class="hljs-keyword">var</span> post = {};
            post = <span class="hljs-keyword">new</span> exports.PostEntry(postEntries[i]);

            posts.push(post);
        }

        posts.sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{
            <span class="hljs-keyword">var</span> A = a.id;
            <span class="hljs-keyword">var</span> B = b.id;

            <span class="hljs-keyword">if</span> (A &gt; B)
                {<span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;}
            <span class="hljs-keyword">if</span> (A &lt; B)
                {<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

        });


        <span class="hljs-keyword">return</span> posts;



    };
}
exports.BlogFeed = BlogFeed;
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 25th 2013, 11:30:25 pm">January 25th 2013</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="../../question/147420/wordpress-json-api.html#answer-255399" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>there is some config and caching stuff you can probably figure out on your own. but the gist of it:</p>
<p>have a couple of different &#39;types&#39; or sources, json&#x2F;xml&#x2F;csv. what you see above is just one &#39;type&#39;</p>
<p>parser is dynamically created based upon a control file, packaged with the app, or downloaded later, allowing source changes without changing the display code.</p>
<pre><code class="hljs"><span class="hljs-built_in">var</span> parser = <span class="hljs-keyword">require</span>(<span class="hljs-string">'/lib/types/'</span>+config<span class="hljs-built_in">.</span>structure<span class="hljs-built_in">.</span>tabs<span class="hljs-built_in">.</span>publications<span class="hljs-built_in">.</span><span class="hljs-keyword">type</span>+<span class="hljs-string">'-'</span>+config<span class="hljs-built_in">.</span>structure<span class="hljs-built_in">.</span>tabs<span class="hljs-built_in">.</span>publications<span class="hljs-built_in">.</span>format);
<span class="hljs-built_in">var</span> blog = <span class="hljs-literal">new</span> parser<span class="hljs-built_in">.</span>BlogFeed();
</code></pre><p>the PostEntry plays middle man and returns the same data structure back to the app, regardless of the type. So the PostEntry from wordpress-xml.js would return the same thing as worpdress-json.xml would.</p>
<pre><code class="hljs"><span class="hljs-tag">blog</span><span class="hljs-class">.loadFeed</span>(<span class="hljs-tag">mycallbackFunction</span>);
</code></pre><p>This returns the raw unprocessed data to the callback function.<br>Then in the callback:</p>
<pre><code class="hljs">var Posts = blog.parseFeed<span class="hljs-comment">(doc)</span>;
for <span class="hljs-comment">(var i=0;i&lt;Posts.length;i++)</span>{
    <span class="hljs-comment">//do whatever with your individual posts Posts[i]</span>
}
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 25th 2013, 11:41:12 pm">January 25th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>here is a sibling for it (wordpress-rss.js)</p>
<pre><code class="hljs"><span class="hljs-comment">/* Sample clientconfig.js entry
 *            publications:{
 *                    title:L('publications', 'Publications'),
 *                    icon:'/images/tabBlog.png',
 *                    refresh_event: 'refresh_publications',
 *                    type: 'wordpress',
 *                    format: 'rss',
 *                    url: 'http://mysite.com/feed/rss2/'
 *                }
 */</span>
<span class="hljs-keyword">var</span> moment = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/moment'</span>);
<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/clientconfig'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PostEntry</span>(<span class="hljs-params">entry</span>)</span>{
    <span class="hljs-keyword">this</span>.title = entry.title;
    <span class="hljs-keyword">this</span>.date = moment(entry.date);
    <span class="hljs-keyword">this</span>.content = entry.content;
    <span class="hljs-keyword">this</span>.url = entry.url;
}
exports.PostEntry = PostEntry;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BlogFeed</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">this</span>.uri=config.structure.tabs.publications.url;

    <span class="hljs-keyword">this</span>.buildURL = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> str = <span class="hljs-keyword">this</span>.uri;
        <span class="hljs-keyword">return</span> str;
    };

    <span class="hljs-keyword">this</span>.loadFeed = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>)</span>{
        <span class="hljs-keyword">var</span> xhrfeed = Ti.Network.createHTTPClient();
        xhrfeed.open(<span class="hljs-string">"GET"</span>, <span class="hljs-keyword">this</span>.buildURL());
        xhrfeed.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            <span class="hljs-keyword">try</span>{
                <span class="hljs-keyword">var</span> strContent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/caching'</span>).CacheFeedContent(<span class="hljs-keyword">this</span>, <span class="hljs-string">'publications.'</span>+config.structure.tabs.publications.format,<span class="hljs-string">'publications'</span>);
                callback(strContent);
                utils.hideActivityIndicator();
            } <span class="hljs-keyword">catch</span>(E){
                Ti.API.error(E);
            }

        };

        xhrfeed.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
            Ti.API.error(<span class="hljs-built_in">JSON</span>.stringify(e));
            alert(L(<span class="hljs-string">'errornetwork'</span>));
        };
        xhrfeed.send();

    };

    <span class="hljs-keyword">this</span>.parseFeed = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">xml</span>)</span>{
        <span class="hljs-keyword">var</span> posts = [];
        <span class="hljs-keyword">var</span> dom_doc = Ti.XML.parseString(xml);
        <span class="hljs-keyword">var</span> items = dom_doc.getElementsByTagName(<span class="hljs-string">"item"</span>);
        <span class="hljs-keyword">var</span> doctitle = dom_doc.evaluate(<span class="hljs-string">"//channel/title/text()"</span>).item(<span class="hljs-number">0</span>).nodeValue;

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c=<span class="hljs-number">0</span>;c&lt;items.length;c++){
            <span class="hljs-keyword">var</span> tempPost = {};
            <span class="hljs-keyword">var</span> post = {};
            <span class="hljs-keyword">var</span> item = items.item(c);
            tempPost.title = item.getElementsByTagName(<span class="hljs-string">"title"</span>).item(<span class="hljs-number">0</span>).textContent;
            tempPost.date = item.getElementsByTagName(<span class="hljs-string">"pubDate"</span>).item(<span class="hljs-number">0</span>).textContent;
            tempPost.content = item.getElementsByTagName(<span class="hljs-string">"content:encoded"</span>).item(<span class="hljs-number">0</span>).textContent;
            tempPost.url = item.getElementsByTagName(<span class="hljs-string">"link"</span>).item(<span class="hljs-number">0</span>).textContent;
            post = <span class="hljs-keyword">new</span> exports.PostEntry(tempPost);
            posts.push(post);
        }

        <span class="hljs-keyword">return</span> posts;
    };
}
exports.BlogFeed = BlogFeed;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="January 25th 2013, 11:43:18 pm">January 25th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok but theres one thing Im having trouble with, with what you gave me, I have been at this all day so I might just not be thinking clearly but its this</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> moment = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/moment'</span>);
<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/clientconfig'</span>);
<span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">'/lib/utils'</span>);
</code></pre><p>where do they come from&#x2F; are the modules I have to download?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 25th 2013, 11:51:23 pm">January 25th 2013</span>
											by <span class='authorname'>Chad Gregory</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>and your clientconfig has errors &quot;unexpected &quot;:&quot;&quot; on title, icon, refresh_event, type,  format and url properties</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2013, 12:06:44 am">January 26th 2013</span>
											by <span class='authorname'>Chad Gregory</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Would this work? publications:({title:(&#39;publications&#39;, &#39;Publications&#39;),<br>            icon:&#39;&#x2F;images&#x2F;tabBlog.png&#39;,<br>                    refresh_event: &#39;refresh_publications&#39;,<br>                    type: &#39;wordpress&#39;,<br>                    format: &#39;json&#39;,<br>                    url: &#39;http:&#x2F;&#x2F;mysite.com&#x2F;&#39;<br>                });</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2013, 12:12:41 am">January 26th 2013</span>
											by <span class='authorname'>Chad Gregory</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p><em>sigh</em></p>
<pre><code class="hljs"><span class="hljs-built_in">and</span> your clientconfig <span class="hljs-built_in">has</span> errors <span class="hljs-string">"unexpected "</span>
</code></pre><p>I knew I shouldn&#39;t have shared tonight.  I come back from a nice dinner to have you tell my my FREE code doesn&#39;t work for you. I&#39;m starting to realize why Aaron left.</p>
<ul>
<li>i shared some code.</li>
<li>it, with the rest of its friends (other js files) work for me.</li>
<li>I&#39;m not writing an app for you, I get paid well to do that for clients.</li>
<li>momentJS is free, use google.  </li>
<li>clientconfig is another js file containing CONFIG information about the particular project. I would have hoped the properties would give a clue to what they are so you could replace them.</li>
<li>utils is just that, a library of utility functions. no, I&#39;m not going to share it.</li>
</ul>
<p>clientconfig.js</p>
<pre><code class="hljs">exports.structure ={
    tabs: {
        publications:{
            title:L(<span class="hljs-string">'publications'</span>, <span class="hljs-string">'Publications'</span>),
            icon:<span class="hljs-string">'/images/tabBlog.png'</span>,
            refresh_event: <span class="hljs-string">'refresh_publications'</span>,
            type: <span class="hljs-string">'wordpress'</span>,
            format: <span class="hljs-string">'rss'</span>,
            url: <span class="hljs-string">'http://mysite.com/feed/rss2/'</span>
        }
    }
}
</code></pre><p>we generate our tabs dynamically as well.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2013, 12:39:43 am">January 26th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>this is making me laughâ¦ but you are right<br><strong>I&#39;m not writing an app for you, I get paid well to do that for clients</strong></p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2013, 5:40:35 pm">January 26th 2013</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
