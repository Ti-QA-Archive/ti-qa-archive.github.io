<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Random App Crash with Storekit » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Random App Crash with Storekit</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>I´m trying to implement in App Purchases within my app. Here is a brief description of my situation and the issue I am experiencing:</p>
<p>I have created a page with displays purchasable items. I Ti.include the “storekit.js” file in this page to call the functions from it when making a purchase.  When the user hits the purchase button, I use:</p>
<pre><code class="hljs">requestProduct<span class="hljs-list">( <span class="hljs-keyword">ID</span> , function <span class="hljs-list">(<span class="hljs-keyword">product</span>)</span> {
purchaseProduct<span class="hljs-list">(<span class="hljs-keyword">product</span>)</span><span class="hljs-comment">;</span></span>
</code></pre><p>where id is the identifier of the purchase.</p>
<p>Basically, I can make purchases in sandbox and also restore purchases. So the basics seem to work in my opinion. </p>
<p>However, I do get a random issue which also occurs when I  do not hit any purchase button, just browsing the page a couple of times. So I assume it is somewhere within the included storekit.js. </p>
<p>I receive the following issue:</p>
<pre><code class="hljs">malloc: *** <span class="hljs-keyword">error</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">object</span> <span class="hljs-number">0x136d09f0</span>: <span class="hljs-built_in">double</span> free
*** <span class="hljs-keyword">set</span> a breakpoint <span class="hljs-keyword">in</span> malloc_error_break <span class="hljs-keyword">to</span> debug
</code></pre><p>I did set the Breakpoint in XCode and did receive further information, which indicates towards “setReceiptVerificationSharedSecret”. </p>
<p>I made two screenshots of the XCode Output and the Part in my App where I have a reference to the setReceiptVerificationSharedSecret</p>
<p>http:&#x2F;&#x2F;img839.imageshack.us&#x2F;img839&#x2F;5153&#x2F;46205478.png</p>
<p>http:&#x2F;&#x2F;img17.imageshack.us&#x2F;img17&#x2F;4232&#x2F;24121476.png</p>
<p>I´m a bit lost with the debugging in XCode.Anyone with some idea on this one?</p>
<p>I am also unsure rreg. when the purchases are made against the sandbox or the live environment. the doc. in the storekit module states that if i run the app on a device, it allways goes against the live environment. however, even using a distribution profile on my iphone, i still get the Environment:Sandbox displayed on the phone. Does it only go against the live environment when the app is in the app store?</p>
<p>reg</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 10th 2013, 7:40:46 pm">March 10th 2013</span>
				by <span class='authorname'>Nicolas Pütz</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>in app purchase</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>storekit</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-258470">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Thank you for reporting this issue. The screenshots were very helpful in identifying the issue with the &#39;double free&#39; in the module cleanup code. Look for an updated storekit module (v1.6.4) with the fix shortly.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 12th 2013, 12:29:30 pm">March 12th 2013</span>
								by <span class='authorname'>Jeff English</span><br>
								<a class="icon-bg icon-link" href="question/149384/random-app-crash-with-storekit.html#answer-258470" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>thank you very much. is there any more info i can provide you with? any extracs from xcode etc.? the bug is reproducable more or less, so if you let me know what kind of logging you would need let me know.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 12th 2013, 12:41:15 pm">March 12th 2013</span>
											by <span class='authorname'>Nicolas Pütz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Update ti.storekit (v1.6.4) should now be available on the MarketPlace</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 12th 2013, 2:41:32 pm">March 12th 2013</span>
											by <span class='authorname'>Jeff English</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>wow, that was fast. looking good, the crash does not occure any more as far as i can see. really briliant, thanks a lot. </p>
<p>One last thing, could you enligten me on the last part of my posting reg. when purchases are made towards sandbox and when towards live?</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 12th 2013, 5:22:48 pm">March 12th 2013</span>
											by <span class='authorname'>Nicolas Pütz</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The sandbox will be used if you are running your application from XCode.<br>&quot;Deploy to Device&quot; will connect to the &#39;live&#39; environment.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 13th 2013, 11:31:08 am">March 13th 2013</span>
											by <span class='authorname'>Jeff English</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>how is it then when I run the app on my test devices (with distriibution profile and ad hoc distribution) I still get the &quot;Environment:Sandbox&quot; displayed running it on the device (See Screenshot form my IPhone)<br>http:&#x2F;&#x2F;img254.imageshack.us&#x2F;img254&#x2F;3229&#x2F;fotolt.png</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2013, 8:54:41 am">March 14th 2013</span>
											by <span class='authorname'>Nicolas Pütz</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-258646">
				
						<section>
							<p>One of our developers says: &quot;StoreKit connects to a sandbox when it isn&#39;t distributed through the App Store&quot;. We will need to update our documentation accordingly.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 14th 2013, 9:43:29 pm">March 14th 2013</span>
								by <span class='authorname'>Jeff English</span><br>
								<a class="icon-bg icon-link" href="question/149384/random-app-crash-with-storekit.html#answer-258646" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-258868">
				
						<section>
							<p>This should be a separate post, but I&#39;ve been pulling my hair out for two days trying to get storekit to test.  I still keep getting invalid product errors after going through the documentation at least a half dozen times. Any help would be greatly appreciated.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 18th 2013, 8:38:47 pm">March 18th 2013</span>
								by <span class='authorname'>Joe Diviak</span><br>
								<a class="icon-bg icon-link" href="question/149384/random-app-crash-with-storekit.html#answer-258868" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
