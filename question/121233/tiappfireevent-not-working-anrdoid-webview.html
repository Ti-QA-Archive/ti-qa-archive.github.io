<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Ti.App.fireEvent not working Anrdoid webview! » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Ti.App.fireEvent not working Anrdoid webview!</h1>
		</header>
		<section>
			<p>Here is my pastie: http:&#x2F;&#x2F;pastie.org&#x2F;2083479</p>
<p>newchart.htm is the file I&#39;m calling into the webview in results.js.</p>
<p>Now, this works 100% in the iphone simulator. In Android emulator it just crashes (don&#39;t know why, but read something about the emulator and webviews or something). There&#39;s no output on the titanium console (that hasn&#39;t worked for a while!).</p>
<p>So I put it on my android phone (motorola milestone, gingerbread, 2.3.3).</p>
<p>The result is absolutely nothing. If I put in alerts then in results.js it will alert all the way down the page but NOT in the eventListener function (whereas it will in iPhone). In the newchart.htm code I&#39;ve got a <code>try{}catch(e){}</code> which doesn&#39;t get fired, so I&#39;m assuming there&#39;s no javascript errors. But the titanium event won&#39;t fire.</p>
<p>I&#39;ve gone through so many different permutations of this application all day. I&#39;ve been shifting code around, up down, trying different layouts and all sorts, and it just won&#39;t work at all.</p>
<p>Can anyone tell me either a) this is a bug, and will never work, quit your trying and use something better than titanium or b) you&#39;re doing it all wrong… heres the solution.</p>
<p>Thanks</p>
<p>Tom</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 17th 2011, 2:58:02 pm">June 17th 2011</span>
				by <span class='authorname'>Thomas Clayson</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>events</span></li>
					
						<li><span class='tagname'>webview</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-210680">
				
						<section>
							<p>Hi Thomas,</p>
<p>I don&#39;t want to be the voice of doom, but I wouldn&#39;t hold your breath for fixes to Android&#39;s webview behaviour: it&#39;s pretty broken.  I think it&#39;s fair to say it&#39;s beta-quality, at best.</p>
<p>There are multiple evalJS and webview-related tickets on JIRA.  One of mine, regarding inconsistent Ti-injection of the necessary JS to a webview in order for it to talk back to Ti.App, was imported from Lighthouse in April (I think I filed it on Lighthouse in…March?)  It&#39;s currently been downgraded to &quot;Trivial&quot;, with no further action taken.</p>
<p>So there you go.  &quot;Trivial&quot;.</p>
<p>(Now, I&#39;m not saying that&#39;s the exact problem you&#39;re seeing, but that&#39;s maybe even the more troubling thing: Android&#39;s webview doesn&#39;t seem to be what you&#39;d call <em>robust</em>.  Meaning you might run into further problems with it.  We certainly have.)</p>
<p>As I&#39;m sure you&#39;ve seen, there are related issues without any posted resolution going back a good year.  And it looks like another ticket was raised on JIRA about evaljS() <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TC-61">last week</a>.</p>
<p>I don&#39;t want to be the one to advise you to use something else, but I can say that, on our own project, we&#39;re kicking ourselves for not having bitten the bullet at the start and maintained two separate codebases – Objective-C for iOS and Java for Android – instead of falling for the promise of a not-yet-working cross-platform solution and fighting with Android bugs months after we should have been done.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 18th 2011, 5:53:42 pm">June 18th 2011</span>
								by <span class='authorname'>K T</span><br>
								<a class="icon-bg icon-link" href="question/121233/tiappfireevent-not-working-anrdoid-webview.html#answer-210680" rel="permalink">permalink</a>
							</div>

							<h5>7 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Yeah, I hear what you&#39;re saying. Should have really tested it on something a little less important, and now I don&#39;t want to just have wasted 3&#x2F;4 weeks of development. I will wait and see if paul and I can&#39;t get to the bottom of it before giving up completely, but thanks for putting everything in perspective. At least maintaining two codebases means you have complete control over everything, without relying on titanium to support it properly.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2011, 7:27:31 am">June 19th 2011</span>
											by <span class='authorname'>Thomas Clayson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>KT</p>
<p>I intend to get to the bottom of what does and what does not work in  the latest version of Titanium with webviews and evalJS. For instance, your ticket <a href="http:&#x2F;&#x2F;jira.appcelerator.org&#x2F;browse&#x2F;TIMOB-3539">TIMOB-3539</a>, that was brought over from Lighthouse, has indeed been fixed.</p>
<p>It is expected that the scenario in the Jira ticket you have referenced does not work as the user expects, for the reasons explained in <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;116950&#x2F;tiappfireevent--webview--api-16-issue.html#answer-208695">this post</a>.</p>
<p>Cheers</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2011, 7:42:09 am">June 19th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thomas - I like your attitude! :)  Yes, let&#39;s try to work through this together.</p>
<p>Paul</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2011, 7:43:12 am">June 19th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks, Paul – I got the notice that ticket was updated, er, yesterday. :)  Whether or not it addresses what we&#39;ve been seeing I&#39;ll now have to test, as we&#39;ve had to put into place our own workaround on this end, and I was waiting for some official comment about the original ticket before looking further into it.  As for the recent submitter&#39;s issue, it should&#39;ve clicked that he was trying to access a remote page.</p>
<p>The thanks is genuine, Paul: you&#39;re a great help for poor, beleaguered Ti developers. :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2011, 6:39:25 pm">June 19th 2011</span>
											by <span class='authorname'>K T</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>And actually Paul, to follow up, our problem with Android webviews and evalJS() still exists.  Based on our workaround, it seems to have something to do with the JS not being injected if there&#39;s a space in the local URL.  But right now it&#39;s pretty far down on the list of Android bugs we&#39;re fighting with (since we do actually have a workaround for that one), so maybe someday I&#39;ll be able to look at it in some more detail.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 22nd 2011, 3:15:31 am">June 22nd 2011</span>
											by <span class='authorname'>K T</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>KT</p>
<p>If there is a bug that you can demonstrate with code, then let&#39;s raise a ticket! ;) It&#39;s crucial that we record <em>all</em> bugs, so that the core team has a true view of the software.</p>
<p>Cheers</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 22nd 2011, 5:29:40 am">June 22nd 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Any Luck on this. Even i am having the same issue.<br>Any help is highly appreciated<br>Geervani</p>
</p>
										<div class="author">
											&mdash; commented <span title="September 13th 2012, 4:08:16 pm">September 13th 2012</span>
											by <span class='authorname'>Geervani BS</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210638">
				
						<section>
							<p>Thomas</p>
<p>Would you read my response in <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;116950&#x2F;tiappfireevent--webview--api-16-issue.html#answer-208695">this post</a>? Once you have taken that information into account, update us with your resulting situation and I will help you from there.</p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 17th 2011, 6:01:10 pm">June 17th 2011</span>
								by <span class='authorname'>Paul Dowsett</span><br>
								<a class="icon-bg icon-link" href="question/121233/tiappfireevent-not-working-anrdoid-webview.html#answer-210638" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hi Paul</p>
<p>Before posting I did do a LOT of searching for the solution, and did come across your post there.</p>
<p>I&#39;m sorry if it wasn&#39;t very clear, but nothing&#39;s being downloaded from the internet. The .htm file is local in the resources folder.</p>
<p>Also, as I said in my OP, I did read &quot;somewhere&quot; (actually in reference to the post you directed me to) that this doesn&#39;t work in the emulator, so I put it on my device, and it still doesn&#39;t work there.</p>
<p>Again, to reiterate it works fine in the iphone emulator, so I know that all the javascript works, I&#39;ve seen it working, and putting the alerts in as I said seem to suggest its a problem with the event firing.</p>
<p>Thanks for having a look anyway, let me know if you know any other reasons why it wouldn&#39;t work.</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 17th 2011, 6:52:27 pm">June 17th 2011</span>
											by <span class='authorname'>Thomas Clayson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thomas</p>
<p>Unfortunately, your code doesn&#39;t run in my environment, and I am unable to replicate your issue. Would you mind stripping it back to <a href="http:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Contributing+to+Titanium#ContributingtoTitanium-CreatingGoodUsecases">a usecase</a>, so that we can both verify whether it is a bug?</p>
<p>Thanks</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 18th 2011, 8:39:56 pm">June 18th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hmm, yeah, you&#39;ll need my sqlite db and the relevant js includes for the html webview. Ill try stripping it down, like your link says, its gonna be easier with less code. Code is at work, and I&#39;m a good 100 miles away atm, but ill get right on it first thing Monday morning. Once again, thank you for having a look and trying to help.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2011, 7:34:06 am">June 19th 2011</span>
											by <span class='authorname'>Thomas Clayson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Paul</p>
<p>Here is my usecase: http:&#x2F;&#x2F;pastie.org&#x2F;2094995</p>
<p>Its stripped to its least possible iteration.</p>
<p>In the iPhone simulator it works perfectly. First it alerts <code>running results.js</code> (tracker&#x2F;results.js line 6) then it alerts <code>webview</code> (jqplot&#x2F;newchart.htm line 10) and then it alerts <code>called getRows</code> (tracker&#x2F;results.js line 9).</p>
<p>In android it alerts <code>running results.js</code> and then <code>webview</code> and the view goes blue (background color of the webview) but event <code>getRows</code> is never called and the alert <code>called getRows</code> NEVER displays.</p>
<p>Thanks for your help.</p>
<p>PS: accidentally posted as an answer the first time. No delete button unfortunately.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 6:57:08 am">June 20th 2011</span>
											by <span class='authorname'>Thomas Clayson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thomas</p>
<p>I have tried your code and, although admittedly I have modified it slightly to make it run on my system (removed unnecessary references to image files, moved all files to the root folder, etc), it seems to be ok on my system. Try the following on yours:</p>
<p><strong>app.js</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> tabGroup = Ti.UI.createTabGroup({
  barColor:<span class="hljs-string">'#333'</span>
});

<span class="hljs-keyword">var</span> win1 = Ti.UI.createWindow({
  title:<span class="hljs-string">'Questions'</span>
});
<span class="hljs-keyword">var</span> tab1 = Ti.UI.createTab({
  title:<span class="hljs-string">'Questions'</span>,
  <span class="hljs-built_in">window</span>:win1
});

<span class="hljs-keyword">var</span> win2 = Ti.UI.createWindow({
  title:<span class="hljs-string">'View Results'</span>,
  url:<span class="hljs-string">'results.js'</span>
});
<span class="hljs-keyword">var</span> tab2 = Ti.UI.createTab({
  title:<span class="hljs-string">'Results'</span>,
  <span class="hljs-built_in">window</span>:win2
});

tabGroup.addTab(tab1);
tabGroup.addTab(tab2);

tabGroup.open();
</code></pre><p><strong>results.js</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win = Ti.UI.currentWindow;

Ti.API.info(<span class="hljs-string">'running results.js'</span>);

<span class="hljs-keyword">var</span> webview = Ti.UI.createWebView({
  url: <span class="hljs-string">'newchart.htm'</span>,
  backgroundColor:<span class="hljs-string">'blue'</span>
});
win.add(webview);

Ti.App.addEventListener(<span class="hljs-string">'getRows'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
  Ti.API.info(<span class="hljs-string">'called getRows'</span>);
});

Ti.App.addEventListener(<span class="hljs-string">'updateQuestions'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
  webview.url = <span class="hljs-string">'newchart.htm?rand='</span>+<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*<span class="hljs-number">10001</span>);
});

Ti.App.addEventListener(<span class="hljs-string">'submittedQuestion'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
  webview.url = <span class="hljs-string">'newchart.htm?rand='</span>+<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*<span class="hljs-number">10001</span>);
});
</code></pre><p><strong>newchart.htm</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>

    New Chart
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"texthere"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

      Ti.App.fireEvent('getRows');

  <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre><p>This <a href="http:&#x2F;&#x2F;dl.dropbox.com&#x2F;u&#x2F;14392713&#x2F;appcelerator-videos&#x2F;local-webview-fireevents.ogv">this video</a> of it.</p>
<p>Let me know if you have any issues with this.</p>
<p>Cheers</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 1:45:30 pm">June 20th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hmm, it looks like the code styler has lost some of the html code. Please refer to the full copy <a href="http:&#x2F;&#x2F;pastebin.com&#x2F;raw.php?i=7h0zmTfh">here</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 1:47:31 pm">June 20th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-210751">
				
						<section>
							<p>Hi Paul</p>
<p>Here is my usecase: http:&#x2F;&#x2F;pastie.org&#x2F;2094995</p>
<p>Its stripped to its least possible iteration.</p>
<p>In the iPhone simulator it works perfectly. First it alerts <code>running results.js</code> (tracker&#x2F;results.js line 6) then it alerts <code>webview</code> (jqplot&#x2F;newchart.htm line 10) and then it alerts <code>called getRows</code> (tracker&#x2F;results.js line 9).</p>
<p>In android it alerts <code>running results.js</code> and then <code>webview</code> and the view goes blue (background color of the webview) but event <code>getRows</code> is never called and the alert <code>called getRows</code> NEVER displays.</p>
<p>Thanks for your help.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 20th 2011, 6:55:46 am">June 20th 2011</span>
								by <span class='authorname'>Thomas Clayson</span><br>
								<a class="icon-bg icon-link" href="question/121233/tiappfireevent-not-working-anrdoid-webview.html#answer-210751" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>OK, Thomas, I will take a look. Btw, please don&#39;t answer your own questions. ;)  Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 12:07:15 pm">June 20th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeah, I did post in a comment and say I didn&#39;t mean to post as an answer! Haha, just wrote in the wrong box the first time. Plus there&#39;s no delete button on posts. I would have deleted the answer and copied it into the comment bit, but I&#39;m not allowed.</p>
<p>Anyway, thanks for having a look.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 12:08:55 pm">June 20th 2011</span>
											by <span class='authorname'>Thomas Clayson</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not to worry - we&#39;ve all done it! ;)</p>
<p>Take a look at my comment above, and the code, and let me know how it goes.</p>
<p>Cheers</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2011, 2:44:15 pm">June 20th 2011</span>
											by <span class='authorname'>Paul Dowsett</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
