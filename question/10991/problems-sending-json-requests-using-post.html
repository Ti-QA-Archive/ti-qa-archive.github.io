<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Problems sending JSON requests using POST » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Problems sending JSON requests using POST</h1>
		</header>
		<section>
			<p>It appears as though the setRequestHeader gets ignored for a HTTPClient which is being used to POST.</p>
<p>I have a REST service which consumes and produces application&#x2F;json. however it doesn&#39;t like the requests from Titanium because requests are always sent with content-type:x-www-form-urlencoded regardless of what you specify using setRequestHeader().</p>
<p>Is this a bug? Is there a possible workaround?</p>
<pre><code class="hljs">var xhr = Titanium.Network.createHTTPClient();

xhr.onreadystatechange = function() {

    try {
      if (this.readyState == <span class="hljs-number">4</span>) {
           var results = JSON.parse(this.responseText);

        }
    } catch(e) {
        Ti.API.debug(e.error);
    }
};
xhr.open(<span class="hljs-string">"<span class="hljs-keyword">POST</span>"</span>,<span class="hljs-string">"http://myrestserviceurl"</span>);
xhr.setTimeout(<span class="hljs-number">10</span>);
xhr.setRequestHeader(<span class="hljs-string">"Content-Type"</span>,<span class="hljs-string">"application/json"</span>);
xhr.send('{<span class="hljs-string">"value1"</span>:<span class="hljs-string">"x"</span>,<span class="hljs-string">"value2"</span>:<span class="hljs-string">"y"</span>}');
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="April 2nd 2010, 2:13:43 pm">April 2nd 2010</span>
				by <span class='authorname'>nobody anonymous</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>setrequestheader</span></li>
					
						<li><span class='tagname'>x-www-form-urlencoded</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>7</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>7 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-25301">
				
						<section>
							<p>I recently tested and fixed this bug (or so I thought..), which version of the mobile sdk is your project using? (you can check in the &quot;Edit&quot; tab of developer)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 2nd 2010, 3:53:10 pm">April 2nd 2010</span>
								by <span class='authorname'>Marshall Culpepper</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-25301" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-25321">
				
						<section>
							<p>Thanks Marshall,</p>
<p>I&#39;m using Titanium 1.1.2 on Windows. With Android 1.6 sdk.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 2nd 2010, 4:00:03 pm">April 2nd 2010</span>
								by <span class='authorname'>nobody anonymous</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-25321" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-25511">
				
						<section>
							<p>Hmm.. Try sending the JSON inline instead of as a raw string (this is how our current test works)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 2nd 2010, 6:53:33 pm">April 2nd 2010</span>
								by <span class='authorname'>Marshall Culpepper</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-25511" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-25761">
				
						<section>
							<p>I&#39;m sending my request as follows and it is now sending the POST as application&#x2F;json (perhaps it was before and i was getting confused).<br>However the message gets sent all garbled. Are you able to show me a working example of how to send json data?</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();

xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readyState == <span class="hljs-number">4</span>) {
           <span class="hljs-keyword">var</span> results = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);

        }
    } <span class="hljs-keyword">catch</span>(e) {
        Ti.API.debug(e.error);
    }
};
xhr.open(<span class="hljs-string">"POST"</span>,<span class="hljs-string">"http://myrestserviceurl"</span>);
xhr.setTimeout(<span class="hljs-number">10</span>);
xhr.setRequestHeader(<span class="hljs-string">"Content-Type"</span>,<span class="hljs-string">"application/json; charset=utf-8"</span>);
xhr.send({<span class="hljs-string">"value1"</span>:<span class="hljs-string">"x"</span>, <span class="hljs-string">"value2"</span>:<span class="hljs-string">"y"</span>});
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="April 3rd 2010, 6:56:00 am">April 3rd 2010</span>
								by <span class='authorname'>nobody anonymous</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-25761" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-54501">
				
						<section>
							<p>We are having the same problem as identified above, but when we did as one of the answers above suggested it still did not work, our server still sees the request as a form and not a json post.  It seems the content type is not getting set during a post.  Any ideas?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 13th 2010, 6:59:07 pm">May 13th 2010</span>
								by <span class='authorname'>Tom Wilson</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-54501" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-153011">
				
						<section>
							<p>We had a bug like this in our app.  The problem was we were sending an object instead of a string.  The error message about incorrect content-type seems to be wrong.  After changing our code to send a string instead of an obejct it worked fine.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 30th 2010, 5:38:04 pm">November 30th 2010</span>
								by <span class='authorname'>David Smith</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-153011" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-220229">
				
						<section>
							<p>you should give URL with local host or the server IP address followed by port number….I think it works</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 5th 2011, 7:35:07 am">October 5th 2011</span>
								by <span class='authorname'>LOKESH KV</span><br>
								<a class="icon-bg icon-link" href="../../question/10991/problems-sending-json-requests-using-post.html#answer-220229" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
