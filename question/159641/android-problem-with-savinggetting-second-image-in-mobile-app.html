<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android problem with saving/getting second image in mobile app » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android problem with saving/getting second image in mobile app</h1>
		</header>
		<section>
			<p>Android 4.3, Mobile, TI 3.1.2, Win7</p>
<p>I have an app that is receiving information including a couple of images from json. I receive the info, place in an array and then extract the information into variables. The problem I am having is that when I accomplish a check on the two images that belong at the top of a trouble ticket the left one come in but the right one does not. While it says its there it does not save and I receive an error &#39;file not found&#39;. You will notice in the code that the filename is part of several pieces that if it is not found on the mobile device (the image) then it will build the command string to go retrieve the image. That said the first one works but not the second check on the right side image. Additionally, it occurs on every other ticket that comes in.</p>
<p>I could use a bit of help on this. Been banging my head for a week now.</p>
<p>Thanks,<br>Ron</p>
<p>[Code]</p>
<p>var backbtn = Ti.UI.createButton ({<br>    top : &quot;1%&quot;,<br>    left: &quot;1%&quot;,<br>    title: &quot;Back&quot;<br>});<br>$.gettick.add(backbtn);</p>
<p>backbtn.addEventListener(&quot;click&quot;, backfunc);<br>function backfunc() {</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> bkbtn = Alloy.createController(<span class="hljs-string">'retrievetic'</span>).getView(<span class="hljs-string">'rettic'</span>);
$.gettick.add(bkbtn);
</code></pre><p>};</p>
<p>var gtickets = Ti.UI.createLabel ({<br>    top: &quot;10%&quot;,<br>    color: &quot;red&quot;,<br>    text: &quot; Getting Ticket&quot;<br>});<br>$.gettick.add(gtickets);</p>
<p>var gototicketlist = Ti.UI.createButton ({<br>    top:&quot;40%&quot;,<br>    title: &quot;Go To Ticket List&quot;,<br>    visible: &quot;false&quot;<br>});<br>$.gettick.add(gototicketlist);</p>
<p>gototicketlist.addEventListener(&#39;click&#39;, list);</p>
<p>function list() {<br>    var viewlist = Alloy.createController(&#39;loadtic&#39;).getView(&#39;loadtic&#39;);<br>    $.gettick.add(viewlist);</p>
<p>};</p>
<p>var homeurl=&quot;http:&#x2F;&#x2F;.com:&quot;; &#x2F;&#x2F; REDACTED FOR SECURITY REASONS<br>var productlink= &quot;&#x2F;nt4&#x2F;tix.php?confirmationcode=12345&amp;edit=register&quot;;</p>
<p>var xhr = Titanium.Network.createHTTPClient();<br>xhr.onload = function() {<br>Ti.API.info (&#39;response text = &#39; + this.responseText);</p>
<p>var data1 = JSON.parse(this.responseText);</p>
<p>for (var x=0; x&lt;data1.length; x++){</p>
<p>var confirmcode = data1[x].confirmationcode;<br>var section = data1[x].section;<br>var retrieved = data1[x].retrieved;<br>var sku = data1[x].sku;<br>var lhome = data1[x].teamhome;<br>var lhomeimg = data1[x].teamhomeimg;<br>var ropp = data1[x].teamopp;<br>var roppimg = data1[x].teamoppimg;<br>var datetime = data1[x].datetime;</p>
<p>var file_url = &quot;http:&#x2F;&#x2F;&#x2F;ticket4&#x2F;&#x2F;&quot;;REDACTED FOR SECURITY REASONS</p>
<p>var dirlist =Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory);<br>var dirlisting = dirlist.getDirectoryListing();<br>Ti.API.info(&#39;AT END OF DIRECTORY LISTING&#39;);<br>Ti.API.info(&#39;array length = &#39; + dirlisting.length);<br>for(i = 0; i &lt; dirlisting.length; i++)<br>{<br>    Ti.API.info(&#39;directory files = &#39; + dirlisting[i]); &#x2F;&#x2F;displays &lt;null&gt; for each element.<br>};</p>
<p>var thimgcheck = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, lhomeimg);</p>
<p>if (lhimgcheck.exists())</p>
<pre><code class="hljs">{Ti.API.info(<span class="hljs-string">'thic '</span> + lhomeimg + <span class="hljs-string">' exists'</span>); }
<span class="hljs-keyword">else</span> 
{Ti.API.info(<span class="hljs-string">'this '</span> + lhomeimg + <span class="hljs-string">' does not exist'</span>);

<span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
xhr.setTimeout(<span class="hljs-number">10000</span>);
xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
</span>{

thimgcheck.write(<span class="hljs-keyword">this</span>.responseData);
Ti.API.info(<span class="hljs-string">'file home '</span>+lhomeimg+<span class="hljs-string">' saved'</span>);
Ti.API.info(<span class="hljs-string">'HOME IMG '</span> + lhimgcheck);
</code></pre><p>};</p>
<p>xhr.open(&quot;GET&quot;,file_url+lhomeimg);<br>Ti.API.info(file_url+lhomeimg + &#39; = lhomeurl&#39;);<br>xhr.file = lhimgcheck;<br>xhr.send();<br>Ti.API.info(&#39;Home team img&#39; + thimgcheck);<br>};</p>
<p>var ropimgcheck = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, roppimg);</p>
<p>if (ropimgcheck.exists())</p>
<pre><code class="hljs">{Ti.API.info(<span class="hljs-string">'thic1 '</span> + roppimg + <span class="hljs-string">' exists'</span>); }
<span class="hljs-keyword">else</span> 
{Ti.API.info(<span class="hljs-string">'this1 '</span> + roppimg + <span class="hljs-string">' does not exist'</span>);

<span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
xhr.setTimeout(<span class="hljs-number">10000</span>);
xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
</span>{

topimgcheck.write(<span class="hljs-keyword">this</span>.responseData);
Ti.API.info(<span class="hljs-string">'file teamopp '</span>+teamoppimg+<span class="hljs-string">' saved'</span>);
Ti.API.info(<span class="hljs-string">'GETTING R IMG '</span> + ropimgcheck);
</code></pre><p>};</p>
<p>xhr.open(&quot;GET&quot;,file_url+roppimg);<br>Ti.API.info(file_url+roppimg + &#39; = roppurl&#39;);<br>xhr.file = ropimgcheck;<br>xhr.send();<br>Ti.API.info(&#39;opp img&#39; + ropimgcheck);<br>};</p>
<p>var ticket = &quot;test1&quot;;</p>
<p>var dataset = Ti.Database.open(&#39;test1&#39;);<br>dataset.execute(&#39;create table if not exists tickets(entryID integer primary key autoincrement, confirmcode text, retrieved text, sku text, lhome text, lhomeimg text, ropp text, roppimg, datetime text);&#39;);<br>dataset.close();</p>
<p>var tickdata = Ti.Database.open(ticket);</p>
<p>var tickdentry = tickdata.execute(&#39;insert into ticket(confirmcode, retrieved, sku, lhome, lhomeimg, ropp, roppimg, datetime)values(?,?,?,?,?,?,?,?)&#39;, confirmcode, retrieved, sku, lhome, lhomeimg, ropp, roppimg, datetime);<br>var lastidset = tickdata.lastInsertRowId;<br>Ti.API.info(&#39;last row entered = &#39; + lastidset);</p>
<p>tickdata.close();</p>
<p>};<br>if (data1.length &gt; &quot;0&quot;){<br>var retrieved = &quot;1&quot;;} else<br>{ var retrieved = &quot;0&quot;;};</p>
<p>if (retrieved == 1) {<br>    gototicketlist.visible = &quot;true&quot;;<br>    Ti.App.Properties.setString(&#39;dbpresent&#39;,&#39;1&#39;);<br>    var gotthem = Ti.UI.createLabel ({<br>        top: &quot;20%&quot;,<br>        color: &quot;red&quot;,<br>        text: &quot;Tickets are Loaded \n Please click on Go To Tickets List to View&quot;,<br>        textAlign: &quot;center&quot;<br>    });<br>    $.gettick.add(gotthem);</p>
<p>} else {</p>
<pre><code class="hljs">var errorlabel = Ti.UI.createLabel ({
    top:<span class="hljs-string">"40%"</span>,
    <span class="hljs-keyword">text</span>: <span class="hljs-string">"Tickets not loaded \n Please Check your internet connection"</span>,
    <span class="hljs-keyword">color</span>: <span class="hljs-string">"red"</span>
});
<span class="hljs-variable">$.</span>gettick.add(errorlabel);
</code></pre><p>};<br>};<br>xhr.open(&quot;GET&quot;, homeurl+productlink);<br>xhr.send();</p>
<p>[End Code]</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 19th 2013, 2:57:18 pm">November 19th 2013</span>
				by <span class='authorname'>Ron Arnold</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android mobile json</span></li>
					
						<li><span class='tagname'>image</span></li>
					
						<li><span class='tagname'>save</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Wow, your code is hard to read since you didn&#39;t format it. Would you try again. Add three <code>~</code> (tilde) characters before and after so that it shows up as a formatted code block</p>
<pre><code class="hljs"><span class="hljs-comment">// like this</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="November 19th 2013, 7:06:55 pm">November 19th 2013</span>
								by <span class='authorname'>Tim Poulsen</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-271520">
				
						<section>
							<p>I think I got this right. Thx R</p>
<pre><code class="hljs">

<span class="javascript">
<span class="hljs-keyword">var</span> backbtn = Ti.UI.createButton ({
    top : <span class="hljs-string">"1%"</span>,
    left: <span class="hljs-string">"1%"</span>,
    title: <span class="hljs-string">"Back"</span>
});
$.gettick.add(backbtn);

backbtn.addEventListener(<span class="hljs-string">"click"</span>, backfunc);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">backfunc</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> bkbtn = Alloy.createController(<span class="hljs-string">'retrievetic'</span>).getView(<span class="hljs-string">'rettic'</span>);
    $.gettick.add(bkbtn);

};



<span class="hljs-keyword">var</span> gtickets = Ti.UI.createLabel ({
    top: <span class="hljs-string">"10%"</span>,
    color: <span class="hljs-string">"red"</span>,
    text: <span class="hljs-string">" Getting Ticket"</span>
});
$.gettick.add(gtickets);


<span class="hljs-keyword">var</span> gototicketlist = Ti.UI.createButton ({
    top:<span class="hljs-string">"40%"</span>,
    title: <span class="hljs-string">"Go To Ticket List"</span>,
    visible: <span class="hljs-string">"false"</span>
});
$.gettick.add(gototicketlist);

gototicketlist.addEventListener(<span class="hljs-string">'click'</span>, list);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">list</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> viewlist = Alloy.createController(<span class="hljs-string">'loadtic'</span>).getView(<span class="hljs-string">'loadtic'</span>);
    $.gettick.add(viewlist);

};


<span class="hljs-keyword">var</span> homeurl=<span class="hljs-string">"http://.com:"</span>; <span class="hljs-comment">// REDACTED FOR SECURITY REASONS</span>
<span class="hljs-keyword">var</span> productlink= <span class="hljs-string">"/nt4/tix.php?confirmationcode=12345&amp;edit=register"</span>;

<span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
Ti.API.info (<span class="hljs-string">'response text = '</span> + <span class="hljs-keyword">this</span>.responseText);

<span class="hljs-keyword">var</span> data1 = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.responseText);






<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x=<span class="hljs-number">0</span>; x&lt;data1.length; x++){


<span class="hljs-keyword">var</span> confirmcode = data1[x].confirmationcode;
<span class="hljs-keyword">var</span> section = data1[x].section;
<span class="hljs-keyword">var</span> retrieved = data1[x].retrieved;
<span class="hljs-keyword">var</span> sku = data1[x].sku;
<span class="hljs-keyword">var</span> lhome = data1[x].teamhome;
<span class="hljs-keyword">var</span> lhomeimg = data1[x].teamhomeimg;
<span class="hljs-keyword">var</span> ropp = data1[x].teamopp;
<span class="hljs-keyword">var</span> roppimg = data1[x].teamoppimg;
<span class="hljs-keyword">var</span> datetime = data1[x].datetime;

<span class="hljs-keyword">var</span> file_url = <span class="hljs-string">"http:///ticket4//"</span>;REDACTED FOR SECURITY REASONS

<span class="hljs-keyword">var</span> dirlist =Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory);
<span class="hljs-keyword">var</span> dirlisting = dirlist.getDirectoryListing();
Ti.API.info(<span class="hljs-string">'AT END OF DIRECTORY LISTING'</span>);
Ti.API.info(<span class="hljs-string">'array length = '</span> + dirlisting.length);
<span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; dirlisting.length; i++)
{
    Ti.API.info(<span class="hljs-string">'directory files = '</span> + dirlisting[i]); <span class="hljs-comment">//displays &lt;null&gt; for each element.</span>
};

<span class="hljs-keyword">var</span> thimgcheck = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, lhomeimg);
<span class="hljs-comment">//var contents = thimgcheck.read();</span>

<span class="hljs-keyword">if</span> (lhimgcheck.exists())

    {Ti.API.info(<span class="hljs-string">'thic '</span> + lhomeimg + <span class="hljs-string">' exists'</span>); }
    <span class="hljs-keyword">else</span> 
    {Ti.API.info(<span class="hljs-string">'this '</span> + lhomeimg + <span class="hljs-string">' does not exist'</span>);

    <span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
    xhr.setTimeout(<span class="hljs-number">10000</span>);
    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{

    thimgcheck.write(<span class="hljs-keyword">this</span>.responseData);
    Ti.API.info(<span class="hljs-string">'file home '</span>+lhomeimg+<span class="hljs-string">' saved'</span>);
    Ti.API.info(<span class="hljs-string">'HOME IMG '</span> + lhimgcheck);
};

xhr.open(<span class="hljs-string">"GET"</span>,file_url+lhomeimg);
Ti.API.info(file_url+lhomeimg + <span class="hljs-string">' = lhomeurl'</span>);
xhr.file = lhimgcheck;
xhr.send();
Ti.API.info(<span class="hljs-string">'Home team img'</span> + thimgcheck);
};


<span class="hljs-keyword">var</span> ropimgcheck = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, roppimg);


<span class="hljs-keyword">if</span> (ropimgcheck.exists())

    {Ti.API.info(<span class="hljs-string">'thic1 '</span> + roppimg + <span class="hljs-string">' exists'</span>); }
    <span class="hljs-keyword">else</span> 
    {Ti.API.info(<span class="hljs-string">'this1 '</span> + roppimg + <span class="hljs-string">' does not exist'</span>);

    <span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();
    xhr.setTimeout(<span class="hljs-number">10000</span>);
    xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
    </span>{

    topimgcheck.write(<span class="hljs-keyword">this</span>.responseData);
    Ti.API.info(<span class="hljs-string">'file teamopp '</span>+teamoppimg+<span class="hljs-string">' saved'</span>);
    Ti.API.info(<span class="hljs-string">'GETTING R IMG '</span> + ropimgcheck);
};

xhr.open(<span class="hljs-string">"GET"</span>,file_url+roppimg);
Ti.API.info(file_url+roppimg + <span class="hljs-string">' = roppurl'</span>);
xhr.file = ropimgcheck;
xhr.send();
Ti.API.info(<span class="hljs-string">'opp img'</span> + ropimgcheck);
};



<span class="hljs-keyword">var</span> ticket = <span class="hljs-string">"test1"</span>;

<span class="hljs-keyword">var</span> dataset = Ti.Database.open(<span class="hljs-string">'test1'</span>);
dataset.execute(<span class="hljs-string">'create table if not exists tickets(entryID integer primary key autoincrement, confirmcode text, retrieved text, sku text, lhome text, lhomeimg text, ropp text, roppimg, datetime text);'</span>);
dataset.close();



<span class="hljs-keyword">var</span> tickdata = Ti.Database.open(ticket);

<span class="hljs-keyword">var</span> tickdentry = tickdata.execute(<span class="hljs-string">'insert into ticket(confirmcode, retrieved, sku, lhome, lhomeimg, ropp, roppimg, datetime)values(?,?,?,?,?,?,?,?)'</span>, confirmcode, retrieved, sku, lhome, lhomeimg, ropp, roppimg, datetime);
<span class="hljs-keyword">var</span> lastidset = tickdata.lastInsertRowId;
Ti.API.info(<span class="hljs-string">'last row entered = '</span> + lastidset);

tickdata.close();





};
<span class="hljs-keyword">if</span> (data1.length &gt; <span class="hljs-string">"0"</span>){
<span class="hljs-keyword">var</span> retrieved = <span class="hljs-string">"1"</span>;} <span class="hljs-keyword">else</span> 
{ <span class="hljs-keyword">var</span> retrieved = <span class="hljs-string">"0"</span>;};



<span class="hljs-keyword">if</span> (retrieved == <span class="hljs-number">1</span>) {
    gototicketlist.visible = <span class="hljs-string">"true"</span>;
    Ti.App.Properties.setString(<span class="hljs-string">'dbpresent'</span>,<span class="hljs-string">'1'</span>);
    <span class="hljs-keyword">var</span> gotthem = Ti.UI.createLabel ({
        top: <span class="hljs-string">"20%"</span>,
        color: <span class="hljs-string">"red"</span>,
        text: <span class="hljs-string">"Tickets are Loaded \n Please click on Go To Tickets List to View"</span>,
        textAlign: <span class="hljs-string">"center"</span>
    });
    $.gettick.add(gotthem);


} <span class="hljs-keyword">else</span> {


    <span class="hljs-keyword">var</span> errorlabel = Ti.UI.createLabel ({
        top:<span class="hljs-string">"40%"</span>,
        text: <span class="hljs-string">"Tickets not loaded \n Please Check your internet connection"</span>,
        color: <span class="hljs-string">"red"</span>
    });
    $.gettick.add(errorlabel);

};
};
xhr.open(<span class="hljs-string">"GET"</span>, homeurl+productlink);
xhr.send();</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 19th 2013, 8:42:56 pm">November 19th 2013</span>
								by <span class='authorname'>Ron Arnold</span><br>
								<a class="icon-bg icon-link" href="question/159641/android-problem-with-savinggetting-second-image-in-mobile-app#answer-271520" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Anyone with suggestions?<br> Thanks In Advance,<br>R</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 21st 2013, 2:31:14 am">November 21st 2013</span>
											by <span class='authorname'>Ron Arnold</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
