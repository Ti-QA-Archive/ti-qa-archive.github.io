<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android Looping EventListener Problem » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android Looping EventListener Problem</h1>
		</header>
		<section>
			<p>Hi,<br>I&#39;d like to create views dynamically and attach an eventlistener for each of them. However I am failing to do so. Only last one get the listener. Here is my code. Thank you.</p>
<p>— My specs —<br>Android emulator &#x2F; Mac OS 10.8.2 &#x2F; Mobile SDK 3.0.2GA &#x2F; Titanium Studio, build: 3.1.1.201303271814</p>
<p><strong>index.xml</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p><strong>index.js</strong></p>
<pre><code class="hljs">$.<span class="hljs-keyword">index</span>.open();
<span class="hljs-keyword">var</span> totalView = <span class="hljs-number">12</span>;
<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> views = [];
<span class="hljs-keyword">var</span> colors = [<span class="hljs-string">'aqua'</span>, <span class="hljs-string">'black'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'brown'</span>, <span class="hljs-string">'cyan'</span>, <span class="hljs-string">'darkgray'</span>, <span class="hljs-string">'fuchsia'</span>, <span class="hljs-string">'gray'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'lightgray'</span>, <span class="hljs-string">'lime'</span>, <span class="hljs-string">'magenta'</span>, <span class="hljs-string">'maroon'</span>, <span class="hljs-string">'navy'</span>, <span class="hljs-string">'olive'</span>, <span class="hljs-string">'orange'</span>, <span class="hljs-string">'pink'</span>, <span class="hljs-string">'purple'</span>, <span class="hljs-string">'red'</span>, <span class="hljs-string">'silver'</span>, <span class="hljs-string">'teal'</span>, <span class="hljs-string">'white'</span>, <span class="hljs-string">'yellow'</span>];

<span class="hljs-keyword">while</span> (i &lt; totalView) <span class="hljs-comment">{
    views[i] = Ti.UI.createButton({
        width: 123,
        height: 49,
        // top: (i * 50),
        backgroundColor: colors[i]
    }</span>);
    views[i].id = i;

    <span class="hljs-keyword">var</span> testEvent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> <span class="hljs-comment">{
        alert(e.source.id);
    }</span>;</span>

    views[i].addEventListener(<span class="hljs-string">'click'</span>, testEvent);

    t = Ti.UI.create2DMatrix();
    t = t.rotate(((<span class="hljs-number">360</span>/totalView) * i));
    views[i].animate(<span class="hljs-comment">{
            anchorPoint: {
                x: 0,
                y: 0.5
            }</span>,
            transform: t,
            duration: <span class="hljs-number">500</span>
        });
    $.<span class="hljs-keyword">index</span>.<span class="hljs-keyword">add</span>(views[i]);
    i++;
};
</code></pre><p><strong>index.tss</strong></p>
<pre><code class="hljs">"<span class="hljs-tag">Window</span>": <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">backgroundColor</span>:<span class="hljs-value"><span class="hljs-string">"white"</span>
</span></span></span>}
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="March 30th 2013, 6:21:58 am">March 30th 2013</span>
				by <span class='authorname'>Can Soysal</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>eventlistener</span></li>
					
						<li><span class='tagname'>loop</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>@Can Soysal : </p>
<p>i think that there are some issue in this 5 lines. Please check it first your click event is correct but some problem is here. </p>
<pre><code class="hljs">t = Ti.UI.create2DMatrix();
    t = t.rotate(((<span class="hljs-number">360</span>/totalView) * i));
    views[i].animate({
            <span class="hljs-built_in">anchor</span>Point: {
                x: <span class="hljs-number">0</span>,
                y: <span class="hljs-number">0.5</span>
            },
            transform: t,
            duration: <span class="hljs-number">500</span>
        });
</code></pre><p>Thanx.</p>
</div>
							<div class="author">
								&mdash; commented <span title="March 30th 2013, 7:48:16 am">March 30th 2013</span>
								by <span class='authorname'>Dharmik Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>@Dharmik Patel<br>Hi, I checked and made some change in this function. I figured out there is nothing wrong. In fact if views are not animated-rotated with anchor point it is working as it should be. Here is the working code below. But I should definitely set anchor point to make it look like a wheel. Thank you</p>
<p><strong>index.js</strong></p>
<pre><code class="hljs">$.<span class="hljs-keyword">index</span>.open();
<span class="hljs-keyword">var</span> totalView = <span class="hljs-number">12</span>;
<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> views = [];
<span class="hljs-keyword">var</span> colors = [<span class="hljs-string">'aqua'</span>, <span class="hljs-string">'black'</span>, <span class="hljs-string">'blue'</span>, <span class="hljs-string">'brown'</span>, <span class="hljs-string">'cyan'</span>, <span class="hljs-string">'darkgray'</span>, <span class="hljs-string">'fuchsia'</span>, <span class="hljs-string">'gray'</span>, <span class="hljs-string">'green'</span>, <span class="hljs-string">'lightgray'</span>, <span class="hljs-string">'lime'</span>, <span class="hljs-string">'magenta'</span>, <span class="hljs-string">'maroon'</span>, <span class="hljs-string">'navy'</span>, <span class="hljs-string">'olive'</span>, <span class="hljs-string">'orange'</span>, <span class="hljs-string">'pink'</span>, <span class="hljs-string">'purple'</span>, <span class="hljs-string">'red'</span>, <span class="hljs-string">'silver'</span>, <span class="hljs-string">'teal'</span>, <span class="hljs-string">'white'</span>, <span class="hljs-string">'yellow'</span>];

<span class="hljs-keyword">while</span> (i &lt; totalView) <span class="hljs-comment">{
    var t = Ti.UI.create2DMatrix();
    t = t.rotate(((360/totalView) * i));

    views[i] = Ti.UI.createButton({
        width: 123,
        height: 49,
        top: (i * 30),
        transform: t,
        backgroundColor: colors[i]
    }</span>);

    views[i].id = i;

    <span class="hljs-keyword">var</span> testEvent = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> <span class="hljs-comment">{
        alert(e.source.id);
    }</span>;</span>

    views[i].addEventListener(<span class="hljs-string">'click'</span>, testEvent);

    $.<span class="hljs-keyword">index</span>.<span class="hljs-keyword">add</span>(views[i]);
    i++;
};
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="March 30th 2013, 9:50:32 am">March 30th 2013</span>
								by <span class='authorname'>Can Soysal</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-259657">
				
						<section>
							<p>Hi Can</p>
<p>The issue is that your applying the event listener within the while loop. it actually applies the event listener to the views but it only has the last view properties applied to all.</p>
<p>the solution is to put the event listner adding into a seperate function, passing the view object.</p>
<p>so I.e</p>
<pre><code class="hljs">
funtion <span class="hljs-built_in">set</span>Listener(<span class="hljs-keyword">in</span>Object) {
     <span class="hljs-keyword">in</span>Object.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-built_in">test</span>Event);
}

<span class="hljs-keyword">while</span> ...

// <span class="hljs-keyword">do</span> code create view

    <span class="hljs-built_in">set</span>Listener(views[i]);

....
</code></pre><p>Hope this makes sense</p>
<p>T.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 30th 2013, 9:46:02 am">March 30th 2013</span>
								by <span class='authorname'>Trevor Ward</span><br>
								<a class="icon-bg icon-link" href="question/150225/android-looping-eventlistener-problem#answer-259657" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>@Trevor, Unfortunately I tried everything: putting eventlisteners outside, inside, putting in an array. nothing worked as expected :(</p>
</p>
										<div class="author">
											&mdash; commented <span title="April 1st 2013, 8:30:21 pm">April 1st 2013</span>
											by <span class='authorname'>Can Soysal</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-259658">
				
						<section>
							<p>@Trevor,<br>Unfortunately I tried everything: putting eventlisteners outside, inside, putting in an array. nothing worked as expected :(</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 30th 2013, 9:53:31 am">March 30th 2013</span>
								by <span class='authorname'>Can Soysal</span><br>
								<a class="icon-bg icon-link" href="question/150225/android-looping-eventlistener-problem#answer-259658" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-259659">
				
						<section>
							<p>@Trevor Ward<br>Unfortunately I tried everything: putting eventlisteners outside, inside, putting in an array. nothing worked as expected :(</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 30th 2013, 9:55:01 am">March 30th 2013</span>
								by <span class='authorname'>Can Soysal</span><br>
								<a class="icon-bg icon-link" href="question/150225/android-looping-eventlistener-problem#answer-259659" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Soysal, I would like to suggest you to please use the comment facility for the discussion purpose to maintain community standard…Thanks !</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 30th 2013, 12:26:55 pm">March 30th 2013</span>
											by <span class='authorname'>Sarafaraz Babi</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
