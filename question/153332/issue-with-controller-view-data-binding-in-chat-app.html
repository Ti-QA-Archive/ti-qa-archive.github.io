<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Issue with controller view data binding in chat app. Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Issue with controller view data binding in chat app.</h1>
		</header>
		<section>
			<p>Hi..<br>I&#39;d created a chat app. It works somewhat properly.. But I&#39;ve some issues with it. Please some one help me. The issues are..</p>
<ol>
<li>I&#39;d displayed the chat messages as a table row and  added the chat messages to row using a model. here is the code.</li>
</ol>
<p>controller.js</p>
<pre><code class="hljs">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformFunction</span><span class="hljs-params">(model)</span> </span>{

    <span class="hljs-keyword">var</span> transform = model.toJSON();
    transform.title =  transform.message;
    transform.title =  transform.message;        
    <span class="hljs-keyword">return</span> transform;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestServer</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> chat = Alloy.createModel(<span class="hljs-string">'chatModel'</span>);
    chat.save({params });
    <span class="hljs-keyword">var</span> details = chat.fetch({
        success: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(collection, response, options)</span> </span>{
            <span class="hljs-keyword">var</span> chats = response.data.chats;
            <span class="hljs-keyword">var</span> library= Alloy.Collections.test;
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i =<span class="hljs-number">0</span>; i&lt;chats.length;i++){
                user = chats[i].first_name;
                <span class="hljs-keyword">var</span> payload ={
                    <span class="hljs-string">"message"</span> : chats[i].message,
                };
                            library.add(Alloy.createModel(<span class="hljs-string">"test"</span>,payload));
            }    
               },
           error: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(collection, Req, options)</span> </span>{
               alert(<span class="hljs-string">"error"</span>);
       });
       <span class="hljs-keyword">var</span> library= Alloy.Collections.test;
    library.reset();             
}
setInterval(requestServer,<span class="hljs-number">20000</span>);
</code></pre><p>Now the issue is that since I&#39;d used &quot;.add&quot; function to add chat messages to tableview whenever the setInterval function is called new chats are added along with the same old chats repeatedly. I&#39;d tried to solve this issue by resetting the collection. It seems to work. but the issue is that the view reloads at the Interval time. How to solve this issue?</p>
<p>here is my view code</p>
<p>view.xml</p>
<pre><code class="hljs">
<span class="hljs-tag">&lt;<span class="hljs-title">Collection</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"test"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"container"</span> &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">TableView</span> <span class="hljs-attribute">dataCollection</span>=<span class="hljs-value">"test"</span> <span class="hljs-attribute">dataTransform</span>=<span class="hljs-value">"transformFunction"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"chats"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">TableViewRow</span> <span class="hljs-attribute">title</span> = "{<span class="hljs-attribute">title</span>}"/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">TableView</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
</code></pre><ol>
<li>Now the second issue is that how to display the latest events first in the tableview?</li>
</ol>
<p>Please help me.</p>
<p>Thanks</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 7th 2013, 2:16:39 am">June 7th 2013</span>
				by <span class='authorname'>Kishore K</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>chat</span></li>
					
						<li><span class='tagname'>data binding</span></li>
					
						<li><span class='tagname'>tableview</span></li>
					
						<li><span class='tagname'>view</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-263960">
				
						<section>
							<ol>
<li><p>Try <a href="http:&#x2F;&#x2F;backbonejs.org&#x2F;#Collection-unshift">Collection.unshift</a> to put your row at the beginning of the collection.</p>
</li>
<li><p>Same as #1, or you can use <a href="http:&#x2F;&#x2F;backbonejs.org&#x2F;#Collection-comparator">Collection.comparator</a> to set a specific order for the collection.</p>
</li>
</ol>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 7th 2013, 10:33:21 am">June 7th 2013</span>
								by <span class='authorname'>Tony Lukasavage</span><br>
								<a class="icon-bg icon-link" href="../../question/153332/issue-with-controller-view-data-binding-in-chat-app.html#answer-263960" rel="permalink">permalink</a>
							</div>

							<h5>5 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks  Tony Lukasavage for your answer. It worked, but thats not actually i want. I need to display the recent chats in the screen and not the older messages. Now the situation is that when a new message comes or we send a new message it lies in the bottom and we have to scroll down to search it. I&#39;m searching for a solution to overcome this.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 3:59:41 am">June 10th 2013</span>
											by <span class='authorname'>Kishore K</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I don&#39;t understand your problem. You can sort the incoming entries any way you want by using the comparator.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 11:10:19 am">June 10th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry for the inconvenience. Just like whatsapp or messageme applications i need to get the recent events of chats in the display. I hope something like &quot;scrollToIndex&quot; may help. but no idea how to implement it. nor the comparator too. Could you please explain the syntax?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 11:16:31 am">June 10th 2013</span>
											by <span class='authorname'>Kishore K</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You just want the most recent events at the top right? You should either query them in that order from your API (which would be faster) or use the comparator to order them once they are in your collection:</p>
<pre><code class="hljs"><span class="hljs-comment">// this code is using the names of collection and model you used in the original question</span>

<span class="hljs-keyword">var</span> events = Alloy.Globals.test;
events.comparator = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
  <span class="hljs-comment">// assuming timestamp is the date of your event</span>
  <span class="hljs-keyword">return</span> event.<span class="hljs-keyword">get</span>(<span class="hljs-string">"timestamp"</span>);
};
</code></pre><p><a href="http:&#x2F;&#x2F;backbonejs.org&#x2F;#Collection-comparator">http:&#x2F;&#x2F;backbonejs.org&#x2F;#Collection-comparator</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="June 10th 2013, 11:51:58 am">June 10th 2013</span>
											by <span class='authorname'>Tony Lukasavage</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>ok thanks ..</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 14th 2013, 2:05:00 am">June 14th 2013</span>
											by <span class='authorname'>Kishore K</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
