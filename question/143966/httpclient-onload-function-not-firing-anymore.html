<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>HTTPClient onload function not firing anymore » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>HTTPClient onload function not firing anymore</h1>
		</header>
		<section>
			<p>Hey guys,<br>I&#39;m trying to code a moblie application (iOS, Android) which reads a RSS&#39; xml and lists all the RSS links in a table.<br>It was working, and suddenly, I couldn&#39;t get anything with the same code.<br>I searched again and again with alerts and I found that it&#39;s the onload function which doesn&#39;t launch.<br>I was working on MountainLion and Windows 7, same effect at the same time.<br>Here are my logs after trying to load : </p>
<pre><code class="hljs">[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">InputManagerService(   61)</span>] Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@4511fce8
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>] (TiHttpClient-1) [19036,26826] HTTP Error (java.net.UnknownHostException): rss.lefigaro.fr
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>] java.net.UnknownHostException: rss.lefigaro.fr
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at java.net.InetAddress.lookupHostByName(InetAddress.java:513)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:278)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at java.net.InetAddress.getAllByName(InetAddress.java:242)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:136)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:653)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:637)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at ti.modules.titanium.network.TiHTTPClient$ClientRunnable.run(TiHTTPClient.java:1186)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>]     at java.lang.Thread.run(Thread.java:1096)
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>] (TiHttpClient-1) [17,26843] Sending error rss.lefigaro.fr
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">TiHttpClient(  514)</span>] (TiHttpClient-1) [3,26846] No onerror callback specified; it would be called if it were.
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>] (Thread-14) [1312,28158] Analytics Service Started
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>] (Thread-14) [200,28358] Sending 10 analytics events.
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>] (Thread-14) [20194,48552] Error posting events: api.appcelerator.net
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>] java.net.UnknownHostException: api.appcelerator.net
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at java.net.InetAddress.lookupHostByName(InetAddress.java:513)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:278)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at java.net.InetAddress.getAllByName(InetAddress.java:242)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:136)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:653)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:627)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:616)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at org.appcelerator.titanium.analytics.TiAnalyticsService$1.run(TiAnalyticsService.java:133)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>]     at java.lang.Thread.run(Thread.java:1096)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">TiAnalyticsSvc(  514)</span>] (Thread-14) [4,48556] Stopping Analytics Service
</code></pre><p>And here is my code :</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> data = [];

<span class="hljs-keyword">var</span>    tableView = Titanium.UI.createTableView({
    data: data,
    height: <span class="hljs-string">'90%'</span>,
    top: <span class="hljs-number">0</span>
});

<span class="hljs-keyword">var</span>    refresh = Titanium.UI.createButton({
    height: <span class="hljs-string">'10%'</span>,
    bottom: <span class="hljs-number">0</span>,
    width: <span class="hljs-string">'100%'</span>,
    title: <span class="hljs-string">"Rafraîchir"</span>
});

<span class="hljs-keyword">var</span> xhr = Titanium.Network.createHTTPClient();

<span class="hljs-keyword">var</span> wView = Titanium.UI.createWebView({
    top: <span class="hljs-number">0</span>,
    height: <span class="hljs-string">'90%'</span>,
    left: <span class="hljs-number">0</span>,
    width: <span class="hljs-string">'100%'</span>
});

<span class="hljs-keyword">var</span> cancel = Titanium.UI.createButton({
    bottom: <span class="hljs-number">0</span>,
    height: <span class="hljs-string">'10%'</span>,
    width: <span class="hljs-string">'100%'</span>,
    title: <span class="hljs-string">"Retour"</span>
});


xhr.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-keyword">try</span>
    {
        tableView.data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        tableView.data = data;
        <span class="hljs-keyword">var</span>    doc = <span class="hljs-keyword">this</span>.responseXML.documentElement;
        <span class="hljs-keyword">var</span>    items = doc.getElementsByTagName(<span class="hljs-string">'item'</span>);
        <span class="hljs-keyword">var</span>    doctitle = doc.evaluate(<span class="hljs-string">"//channel/title/text()"</span>).item(<span class="hljs-number">0</span>).nodeValue;
        <span class="hljs-keyword">var</span>    urls = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>;c &lt; items.length;c++)
        {
            urls[c] = items.item(c).getElementsByTagName(<span class="hljs-string">'link'</span>).item(<span class="hljs-number">0</span>).text;
            postName = items.item(c).getElementsByTagName(<span class="hljs-string">'title'</span>).item(<span class="hljs-number">0</span>).text;
            postUrl = items.item(c).getElementsByTagName(<span class="hljs-string">'link'</span>).item(<span class="hljs-number">0</span>).text;
            row = Titanium.UI.createTableViewRow({ 
                title: postName,
                backgroundColor: <span class="hljs-string">'#555'</span>,
                backgroundSelectedColor: <span class="hljs-string">'#ccf'</span>,
                color: <span class="hljs-string">'#999'</span>
            });
            row.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>)</span>{
                wView.setUrl(urls[e.index]);
                Titanium.UI.currentWindow.add(wView);
                Titanium.UI.currentWindow.add(cancel); 
            });
            tableView.add(row); <span class="hljs-comment">// Ajout de la case au tableau</span>
        }
    }
    <span class="hljs-keyword">catch</span>(E)
    {
        alert(E.message);
    }
};

refresh.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    <span class="hljs-keyword">try</span>
    {
    xhr.abort();
    xhr.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://rss.lefigaro.fr/lefigaro/laune'</span>);
    xhr.send();
    }
    <span class="hljs-keyword">catch</span>(E)
    {}
});

cancel.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
    <span class="hljs-keyword">try</span>
    {
        Titanium.UI.currentWindow.remove(wView);
    }
    <span class="hljs-keyword">catch</span>(E)
    {
    }
    <span class="hljs-keyword">try</span>
    {
        Titanium.UI.currentWindow.remove(cancel);
    }
    <span class="hljs-keyword">catch</span>(E)
    {}
});

xhr.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://rss.lefigaro.fr/lefigaro/laune'</span>);
xhr.send();

Titanium.UI.currentWindow.add(tableView);
Titanium.UI.currentWindow.add(refresh);
</code></pre><p>For some explanations about my code :<br>It creates 2 tables, a hidden URL table and a visible &quot;titles&quot; URL, with a refresh button.<br>When we click a row, it opens a webview of the URL in the hidden table corresponding to the selected row, and a cancel button, replacing the refreshing one.</p>
<p>If the error is obvious, I&#39;m sorry, I&#39;m new to JS and Titanium (~3months), made a year of C.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 25th 2012, 12:30:21 pm">October 25th 2012</span>
				by <span class='authorname'>Arthur Rucquois</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>onload</span></li>
					
				</ul>
			

			<section>
				<h5>4 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>The error you are getting in Java here is an unknown host exception, which indicates that an IP address could not be found for the host.  Is this on device or emulator?  Android emulators (for me) will often drop network connectivity without me immediately noticing.  Have you confirmed your emulator has a network connection and is able to resolve your RSS feed URL?</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 25th 2012, 12:44:54 pm">October 25th 2012</span>
								by <span class='authorname'>Kevin Whinnery</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>It is on emulator. I haven&#39;t changed any settings after many total reinstallations, thanks for answering that fast.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 25th 2012, 1:30:59 pm">October 25th 2012</span>
								by <span class='authorname'>Arthur Rucquois</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ok, so I checked it, I have no internet connection on the emulator. Any suggestions ?</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 29th 2012, 7:55:33 am">October 29th 2012</span>
								by <span class='authorname'>Arthur Rucquois</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I solved this internet error, it was an error from Win7 bad connection parameters. I created a new connection, I have Internet on the emulator. Now it crashes, but this is a local error. Ah dev life is rough nowadays :D Have a good day.</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 29th 2012, 11:39:16 am">October 29th 2012</span>
								by <span class='authorname'>Arthur Rucquois</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
