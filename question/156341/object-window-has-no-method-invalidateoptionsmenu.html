<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Object #&lt;Window&gt; has no method &#39;invalidateOptionsMenu&#39; » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Object #&lt;Window&gt; has no method &#39;invalidateOptionsMenu&#39;</h1>
		</header>
		<section>
			<p>Hi all!<br>For what I read here, () to be able to display the menu using alloy, I have to call invalidateOptionsMenu.<br>The problem is that I&#39;m getting this error: Object #&lt;Window&gt; has no method &#39;invalidateOptionsMenu&#39;</p>
<p>Here is the relevant code:<br>VIEW:</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Wallets"</span> <span class="hljs-attribute">backgroundColor</span>=<span class="hljs-value">"White"</span> <span class="hljs-attribute">onOpen</span>=<span class="hljs-value">"doOpen"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- Android Menu --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Menu</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"android"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"mnuNewWalletAndroid"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"newWallet"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Menu</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p>CONTROLLER:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doOpen</span>(<span class="hljs-params"></span>)
</span>{
    <span class="hljs-keyword">if</span> (OS_ANDROID)
    {
        $.index.invalidateOptionsMenu();
    }
}

$.index.open();
</code></pre><p>Any clues?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 24th 2013, 1:52:03 pm">August 24th 2013</span>
				by <span class='authorname'>Juan Manuel Haedo</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>menu</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Forgot to add the link:<br>http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Android.Menu</p>
<p>And on the Alloy XML Markup it says:<br>&quot;Due to the way menus are created in Alloy, menus created using Alloy markup are not displayed until the options menu is invalidated. To force menus (or action items) to be displayed, call invalidateOptionsMenu from the open event listener of the window or tab group where the menu is defined.&quot;</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 24th 2013, 1:54:37 pm">August 24th 2013</span>
								by <span class='authorname'>Juan Manuel Haedo</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Are you just trying to create menus using alloy and you are not sure how?</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 24th 2013, 1:58:02 pm">August 24th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I don&#39;t understand your question…<br>I think I&#39;m doing it right, so that&#39;s why I&#39;m posting my problem. To see if someone else can see what I&#39;m doing wrong.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 24th 2013, 2:01:45 pm">August 24th 2013</span>
								by <span class='authorname'>Juan Manuel Haedo</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I am wondering if you have achieved adding menus to an Android app before?  I have not needed to use <strong>invalidateOptionsMenu</strong>.</p>
<p>So my question to you is really;</p>
<ul>
<li><em>Do you want to see a working example of Alloy Menus, including; tabs, overflow menus and ActionBar that works on Android 4.x but also works on Android 2.x automatically swapping out the ActionBar ways with the suitable UI?</em></li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="August 24th 2013, 2:07:14 pm">August 24th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ah! That would be GREAT!</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 24th 2013, 2:10:25 pm">August 24th 2013</span>
								by <span class='authorname'>Juan Manuel Haedo</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>3</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-276235">
				
						<section>
							<p>Hi Juan, I am having the same issue that you had. Although the menus render most times they occasionally don&#39;t show at all.</p>
<p>It seems that the documentation is incorrect here, invalidateOptionsMenu is actually a method of activity, rather than window, try this instead:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (<span class="hljs-constant">OS_ANDROID</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$.</span>win.activity) {
        <span class="hljs-variable">$.</span>win.activity.invalidateOptionsMenu();
    }
}
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="March 10th 2014, 8:51:16 am">March 10th 2014</span>
								by <span class='authorname'>Martyn Joyce</span><br>
								<a class="icon-bg icon-link" href="question/156341/object-window-has-no-method-invalidateoptionsmenu.html#answer-276235" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>4</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-267627">
				
						<section>
							<p>Hi</p>
<p>Here you go, I have been playing around with this all morning as a test piece of code, so you caught me a great time - it is easy to share right now.</p>
<p>To use this test code I would recommend that you create a test default Alloy project and replace the code as you see it below;</p>
<p><strong>index.xml</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">TabGroup</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"win"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Menu</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu"</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"android"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu1"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu2"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu3"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu4"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu5"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">MenuItem</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"menu6"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"doClickMenu"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Menu</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Tab</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Apple"</span> <span class="hljs-attribute">icon</span>=<span class="hljs-value">"KS_nav_ui.png"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tab 1"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Label</span>&gt;</span>I am Window 1<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Tab</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Tab</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Banana"</span> <span class="hljs-attribute">icon</span>=<span class="hljs-value">"KS_nav_views.png"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tab 2"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Label</span>&gt;</span>I am Window 2<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Tab</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Tab</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Cherry"</span> <span class="hljs-attribute">icon</span>=<span class="hljs-value">"KS_nav_views.png"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">Window</span> <span class="hljs-attribute">title</span>=<span class="hljs-value">"Tab 3"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">Label</span>&gt;</span>I am Window 3<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">Tab</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">TabGroup</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p><strong>index.tss</strong></p>
<pre><code class="hljs"><span class="hljs-string">"Window"</span>: {
    backgroundColor: <span class="hljs-string">"#fff"</span>
},
<span class="hljs-string">"Label"</span>: {
    width: Ti.UI.SIZE,
    height: Ti.UI.SIZE,
    color: <span class="hljs-string">"#000"</span>,
    font: {
        fontSize: <span class="hljs-number">20</span>,
        fontFamily: <span class="hljs-string">'Helvetica Neue'</span>
    },
    textAlign: <span class="hljs-string">'center'</span>
},
<span class="hljs-string">"MenuItem"</span>: {
    showAsAction: Ti.Android.SHOW_AS_ACTION_IF_ROOM,
},
<span class="hljs-string">'#menu1'</span>: {
    icon: <span class="hljs-string">'images/action_about.png'</span>,
    title: <span class="hljs-string">'Menu 1'</span>
},
<span class="hljs-string">'#menu2'</span>: {
    icon: <span class="hljs-string">'images/action_settings.png'</span>,
    title: <span class="hljs-string">'Menu 2'</span>
},
<span class="hljs-string">'#menu3'</span>: {
    icon: <span class="hljs-string">'images/action_about.png'</span>,
    title: <span class="hljs-string">'Menu 3'</span>
},
<span class="hljs-string">'#menu4'</span>: {
    icon: <span class="hljs-string">'images/action_settings.png'</span>,
    title: <span class="hljs-string">'Menu 4'</span>
},
<span class="hljs-string">'#menu5'</span>: {
    icon: <span class="hljs-string">'images/action_about.png'</span>,
    title: <span class="hljs-string">'Menu 5'</span>
},
<span class="hljs-string">'#menu6'</span>: {
    icon: <span class="hljs-string">'images/action_settings.png'</span>,
    title: <span class="hljs-string">'Menu 6'</span>
}
</code></pre><p><strong>index.js</strong></p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doClickMenu</span>(<span class="hljs-params">evt</span>)</span>{
    alert(evt.source.title);
} 
<span class="hljs-comment">// we need to do some things to the Window once it is properly instantiated, so we add an event listener to its OPEN event</span>
$.win.addEventListener(<span class="hljs-string">'open'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    Ti.API.info(<span class="hljs-string">'version:'</span> + Ti.Platform.version);
    <span class="hljs-keyword">if</span> (Ti.Platform.version &gt;= <span class="hljs-number">4</span>) {
        <span class="hljs-keyword">var</span> actionBar = $.win.activity.actionBar; <span class="hljs-comment">// get a handle to the action bar</span>
        actionBar.title = <span class="hljs-string">'My App'</span>; <span class="hljs-comment">// change the App Title</span>
        actionBar.displayHomeAsUp = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Show the "angle" pointing back</span>
        actionBar.onHomeIconItemSelected = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// what to do when the "home" icon is pressed</span>
            Ti.API.info(<span class="hljs-string">"Home icon clicked!"</span>);
        };    
    }
});
$.win.open();
</code></pre><p>Amend your tiapp.xml and make sure the following values are included</p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">android</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">tool-api-level</span>&gt;</span>14<span class="hljs-tag">&lt;/<span class="hljs-title">tool-api-level</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">manifest</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">application</span> <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@android:style/Theme.Holo.Light"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">supports-screens</span> <span class="hljs-attribute">android:anyDensity</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">android:largeScreens</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">android:normalScreens</span>=<span class="hljs-value">"true"</span> <span class="hljs-attribute">android:smallScreens</span>=<span class="hljs-value">"false"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">uses-sdk</span> <span class="hljs-attribute">android:minSdkVersion</span>=<span class="hljs-value">"10"</span> <span class="hljs-attribute">android:targetSdkVersion</span>=<span class="hljs-value">"14"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">manifest</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">android</span>&gt;</span>
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 24th 2013, 2:14:51 pm">August 24th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/156341/object-window-has-no-method-invalidateoptionsmenu.html#answer-267627" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>This is great! Although i haven&#39;t tested it yet, but, I would be requiring a simpler answer telling the actual cause of the problem and how to solve it, without the entire code, just the important bits regarding the issue.</p>
<p>Thanks!</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 29th 2013, 3:11:28 pm">August 29th 2013</span>
											by <span class='authorname'>Juan Manuel Haedo</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You asked why <strong>invalidateOptionsMenu</strong> was not working, I would guess that as it requires a heavyweight window and you have not provided the TSS I cannot confirm if that has been triggered though.</p>
<p>However <strong>invalidateOptionsMenu</strong> is not required to achieve the menus in the code I provided above.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 29th 2013, 4:52:21 pm">August 29th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
