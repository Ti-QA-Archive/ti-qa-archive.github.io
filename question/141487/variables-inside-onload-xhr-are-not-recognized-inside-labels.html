<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Variables inside onload xhr are not recognized inside labels Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Variables inside onload xhr are not recognized inside labels</h1>
		</header>
		<section>
			<p>My variables that are assigned inside my xhr.onload function aren&#39;t being recognized by my labels..<br>Can you guys help me fix this?  Thanks</p>
<pre><code class="hljs">var userProfile = Titanium.UI.currentWindow;

    var xhr = Ti.Network.createHTTPClient();

    userkey = userProfile.userkey;
    broadcast_id = userProfile.broadcast_id;    
    <span class="hljs-comment">//alert (userkey);</span>
    <span class="hljs-comment">//alert (broadcast_id);</span>

        xhr.<span class="hljs-built_in">open</span>(<span class="hljs-string">'POST'</span>, <span class="hljs-string">"http://localhost:8888/get_profile.php"</span>);    
        var params = {
                user_key:userkey,
                broadcast_id:broadcast_id
                };

        <span class="hljs-comment">//alert(params2);</span>


    xhr.onload = function()
        {
        var json = <span class="hljs-keyword">this</span>.responseText;
        var response = JSON.parse(json);
        alert (response);

        username = response.username;
        sex = response.sex;
        geaardheid = response.geaardheid;
        bday = response.bday;
        country = response.country;
        city = response.city;
        }

    xhr.send(params);



    var profilePic =  Titanium.UI.createImageView({
        <span class="hljs-built_in">image</span>:<span class="hljs-string">'../profilepic/profilepic.png'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-number">110</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-number">130</span>,
        left:<span class="hljs-number">10</span>,
        top:<span class="hljs-number">10</span>
        });


    var lblUsername =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:username,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">15</span>,
        left:<span class="hljs-number">130</span>
        });

    var lblSex =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:sex,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">35</span>,
        left:<span class="hljs-number">130</span>
        });


    var lblGeaardheid =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:geaardheid,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">55</span>,
        left:<span class="hljs-number">130</span>
        });    

    var lblBday =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:bday,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">75</span>,
        left:<span class="hljs-number">130</span>
        });

    var lblCountry =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:country,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">95</span>,
        left:<span class="hljs-number">130</span>
        });

    var lblCity =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:city,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#999'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">115</span>,
        left:<span class="hljs-number">130</span>
        });

    var msgButton = Ti.UI.createButton({
        backgroundImage:<span class="hljs-string">'/images/buttons/pill_green.png'</span>,
        <span class="hljs-built_in">color</span>: <span class="hljs-string">'#FFFFFFF'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-number">40</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-number">300</span>,
        top: <span class="hljs-number">150</span>,
        title:<span class="hljs-string">'Send a Message to '</span>+ username,
        font:{fontFamily:<span class="hljs-string">'Helvetica Neue'</span>,fontWeight:<span class="hljs-string">'regular'</span>,fontSize:<span class="hljs-number">16</span>}
        });

    var lblSelfsummary =  Titanium.UI.createLabel({
        <span class="hljs-built_in">text</span>:<span class="hljs-string">'My Self Summary :'</span>,
        <span class="hljs-built_in">color</span>:<span class="hljs-string">'#f6a433'</span>,
        <span class="hljs-built_in">textAlign</span>:<span class="hljs-string">'left'</span>,
        <span class="hljs-variable">width</span>:<span class="hljs-string">'auto'</span>,
        <span class="hljs-variable">height</span>:<span class="hljs-string">'auto'</span>,
        font:{fontWeight:<span class="hljs-string">'bold'</span>,fontSize:<span class="hljs-number">14</span>},
        top:<span class="hljs-number">200</span>,
        left:<span class="hljs-number">10</span>
        });

    userProfile.<span class="hljs-built_in">add</span>(profilePic)
    userProfile.<span class="hljs-built_in">add</span>(lblUsername);
    userProfile.<span class="hljs-built_in">add</span>(lblSex);
    userProfile.<span class="hljs-built_in">add</span>(lblGeaardheid);
    userProfile.<span class="hljs-built_in">add</span>(lblBday);
    userProfile.<span class="hljs-built_in">add</span>(lblCountry);
    userProfile.<span class="hljs-built_in">add</span>(lblCity);
    userProfile.<span class="hljs-built_in">add</span>(msgButton);
    userProfile.<span class="hljs-built_in">add</span>(lblSelfsummary);
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 26th 2012, 11:42:20 am">August 26th 2012</span>
				by <span class='authorname'>Mitch Ceulemans</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>label</span></li>
					
						<li><span class='tagname'>variables</span></li>
					
						<li><span class='tagname'>xhr</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Missing from your question are a number of important pieces of information. I suggest you take a look at the <a href="https:&#x2F;&#x2F;wiki.appcelerator.org&#x2F;display&#x2F;guides&#x2F;Using+Questions+and+Answers">Using Questions and Answers</a> article, specifically the Q&amp;A Question Checklist.  The missing information is critical to reproducing problems in a test environment and often indicates other factors that cause the undesirable outcome you are experiencing.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 26th 2012, 2:07:16 pm">August 26th 2012</span>
								by <span class='authorname'>Stephen Feather</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-246065">
				
						<section>
							<p>Since you have failed to show code regarding the declaration of your variables, it is impossible for us to give an accurate answer.</p>
<p>So, short answer: Sounds like a scope problem. fix it.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 26th 2012, 2:08:11 pm">August 26th 2012</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="../../question/141487/variables-inside-onload-xhr-are-not-recognized-inside-labels.html#answer-246065" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>If this is your entire code, then you </p>
<p>1 haven&#39;t properly declared your variables </p>
<p>2 Variables declared inside a function are not visible outside the scope of the function.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 26th 2012, 2:11:21 pm">August 26th 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246066">
				
						<section>
							<p>It looks to me as though you are creating the labels before your xhr response has come back, therefore, the variables in your labels are undefined. XHR calls happen asynchronously, so you need to either wait until the response comes back to create the labels, or update the label values once you have a response.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 26th 2012, 2:13:32 pm">August 26th 2012</span>
								by <span class='authorname'>Anthony Decena</span><br>
								<a class="icon-bg icon-link" href="../../question/141487/variables-inside-onload-xhr-are-not-recognized-inside-labels.html#answer-246066" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Apart from the issue I&#39;ve stated here, you also need to fix the scoping issue that Stephen mentions above. Nowhere do you declare the variables that you are trying to use and anything that you do declare inside the onload handler will not be accessible outside of the function scope.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 26th 2012, 2:17:40 pm">August 26th 2012</span>
											by <span class='authorname'>Anthony Decena</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-246083">
				
						<section>
							<p>@Mitch this is a scope issue.</p>
<p>Put</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> username</span> = sex = geaardheid = bday = country = city = <span class="hljs-string">""</span>
</code></pre><p>before </p>
<pre><code class="hljs">xhr.<span class="hljs-keyword">open</span>(<span class="hljs-string">'POST'</span>, <span class="hljs-string">"http://localhost:8888/get_profile.php"</span>);
</code></pre><p>and everything should work for you perfectly fine.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 27th 2012, 3:47:17 am">August 27th 2012</span>
								by <span class='authorname'>Sahil Grover</span><br>
								<a class="icon-bg icon-link" href="../../question/141487/variables-inside-onload-xhr-are-not-recognized-inside-labels.html#answer-246083" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>-1 because I&#39;d fire any of my devs that put that:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> username</span> = sex = geaardheid = bday = country = city = <span class="hljs-string">""</span>
</code></pre><p>in a project. </p>
<p>Does it declare all those variables and set their value to nothing? yes.</p>
<p>During code review or a hit-by-a-bus scenario, is it easily and quickly understood by another dev going through 1000s of lines of code? no.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 27th 2012, 9:58:16 am">August 27th 2012</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>This will also NOT make everything ok as he is still trying to use the variables BEFORE they have been returned in the onload handler.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 27th 2012, 12:47:58 pm">August 27th 2012</span>
											by <span class='authorname'>Anthony Decena</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>-2</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
