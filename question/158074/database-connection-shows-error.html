<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>database connection shows error » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>database connection shows error</h1>
		</header>
		<section>
			<pre><code class="hljs"><span class="hljs-built_in">var</span> value1 = username<span class="hljs-built_in">.</span>getValue();
    <span class="hljs-built_in">var</span> value2 = password<span class="hljs-built_in">.</span>getValue();
    <span class="hljs-keyword">if</span> (value1 != <span class="hljs-string">''</span> <span class="hljs-subst">&amp;&amp;</span> value2 != <span class="hljs-string">''</span>) {

    <span class="hljs-built_in">var</span> db = Ti<span class="hljs-built_in">.</span>Database<span class="hljs-built_in">.</span>open(<span class="hljs-string">'kusumadb'</span>);
        Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">"for retriving the data"</span>);

        <span class="hljs-built_in">var</span> <span class="hljs-keyword">rows</span> = db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'SELECT username,password FROM userdetails'</span>);

        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>isValidRow()) {
            Ti<span class="hljs-built_in">.</span>API<span class="hljs-built_in">.</span>info(<span class="hljs-string">'username: '</span> + <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>fieldByName(<span class="hljs-string">'username'</span>) + <span class="hljs-string">', password:'</span> + <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>fieldByName(<span class="hljs-string">'password'</span>));
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>fieldByName(<span class="hljs-string">'username'</span>) === value1) {
                <span class="hljs-built_in">var</span> win1 = Ti<span class="hljs-built_in">.</span>UI<span class="hljs-built_in">.</span>createWindow({
                    backgroundCol<span class="hljs-subst">or</span> : <span class="hljs-string">"yellow"</span>
                });
                win1<span class="hljs-built_in">.</span>open();

            } <span class="hljs-keyword">else</span> {
                <span class="hljs-built_in">var</span> db = Ti<span class="hljs-built_in">.</span>Database<span class="hljs-built_in">.</span>open(<span class="hljs-string">'kusumadb'</span>);
                db<span class="hljs-built_in">.</span>execute(<span class="hljs-string">'INSERT INTO userdetails (username, password) VALUES(?,?)'</span>, value1, value2);
                <span class="hljs-built_in">var</span> win2 = Ti<span class="hljs-built_in">.</span>UI<span class="hljs-built_in">.</span>createWindow({
                    backgroundCol<span class="hljs-subst">or</span> : <span class="hljs-string">"pink"</span>
                });
                win2<span class="hljs-built_in">.</span>open();
            }
            <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>next();
        }
        <span class="hljs-keyword">rows</span><span class="hljs-built_in">.</span>close();
        db<span class="hljs-built_in">.</span>close();
    }
</code></pre><p>what i am trying to do is am comparing the username with the database username but i.m ending up with the following error</p>
<pre><code class="hljs">[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiExceptionHandler( 1025)</span>] (main) [26483,28466] ----- Titanium Javascript Runtime Error -----
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiExceptionHandler( 1025)</span>] (main) [0,28466] - In alloy/controllers/index.js:41,27
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiExceptionHandler( 1025)</span>] (main) [1,28467] - Message: Uncaught TypeError: Cannot call method 'execute' of undefined
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiExceptionHandler( 1025)</span>] (main) [0,28467] - Source:             var rows = db.execute("SELECT username,password FROM userdetails")
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">V8Exception( 1025)</span>] Exception occurred at alloy/controllers/index.js:41: Uncaught TypeError: Cannot call method 'execute' of undefined
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">TiAnalyticsSvc( 1025)</span>] (Thread-99) [1782,30249] Analytics Service Started
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>] close() was never explicitly called on database '/data/data/com.scriptbees.pract/databases/kusumadb' 
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>] android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">init</span>&gt;</span></span>(SQLiteDatabase.java:1943)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1007)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:986)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:962)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1043)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1036)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:761)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:215)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at ti.modules.titanium.database.DatabaseModule.open(DatabaseModule.java:70)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at org.appcelerator.kroll.runtime.v8.V8Runtime.nativeRunModule(Native Method)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at org.appcelerator.kroll.runtime.v8.V8Runtime.doRunModule(V8Runtime.java:159)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at org.appcelerator.kroll.KrollRuntime.handleMessage(KrollRuntime.java:289)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at org.appcelerator.kroll.runtime.v8.V8Runtime.handleMessage(V8Runtime.java:185)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.os.Handler.dispatchMessage(Handler.java:95)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at android.os.Looper.loop(Looper.java:137)
[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">SQLiteDatabase( 1025)</span>]     at org.appcelerator.kroll.KrollRuntime$KrollRuntimeThread.run(KrollRuntime.java:112)
</code></pre><p>kindly help me am using titanium version 3.1.3 and running in android platform</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 5th 2013, 3:10:51 am">October 5th 2013</span>
				by <span class='authorname'>kusuma jammula</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>database</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-269636">
				
						<section>
							<p>Hi</p>
<p>First thing to check, has the database reference <strong>kusumadb</strong> been created by previously using the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Database-method-install">install</a> method?  If not then you MUST install the database or create the database first.</p>
<p>You have used the following line of code twice;</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Ti.Database.<span class="hljs-keyword">open</span>('kusumadb');
</code></pre><p>You should not do this because it is already open and accessible by the first use of the line of code.  Reopening the database especially using the same variable will cause unforeseen circumstances.</p>
<p>First thing to do is check the database exists and make sure it is capable of being accessed as a database.  You can work out where the file is stored when used in the simulator or emulator by reading the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Database-method-open">open</a> method.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 5th 2013, 9:25:30 am">October 5th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/158074/database-connection-shows-error#answer-269636" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>but i had followed this examples from the link http:&#x2F;&#x2F;pedrobraz.com&#x2F;hello-world&#x2F;  and after that i had tried to implement the code and its giving me Window already focused, ignoring focus gain in titanium error im really stuck with this from past 3 days pls help me</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 5th 2013, 10:21:03 am">October 5th 2013</span>
											by <span class='authorname'>kusuma jammula</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>pls give me an example i&#39;m very new to mobile apps and titanium i was reading the docs has read  about result set same process they have done what is my requirement is need to compare the username with the existing name in database its not working out its screwing me…………………….!</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 5th 2013, 10:23:48 am">October 5th 2013</span>
											by <span class='authorname'>kusuma jammula</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The error message suggests the problem is with the return of the database open command;</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> db</span> = Ti.Database.<span class="hljs-keyword">open</span>('kusumadb');
<span class="hljs-variable"><span class="hljs-keyword">var</span> rows</span> = db.execute('SELECT username,password FROM userdetails');
</code></pre><p>As the error suggests the problem is with line 2 above, it says that method &quot;execute&quot; cannot be called from undefined - this implies that <strong>db</strong> is undefined.  If <strong>db</strong> is undefined then the line above must have a problem as it was the line defining the db.  That line appears to be correctly written though.</p>
<p>So at this point the problem looks to be related possibly to failed db install performed previously, a missing file or corrupt file.</p>
<ul>
<li>Have you tried looking for the file manually as suggested?</li>
<li>Do you use the method <strong>install</strong>?</li>
<li>Do you use the execute statement with a <strong>create</strong> sql command?</li>
</ul>
</p>
										<div class="author">
											&mdash; commented <span title="October 5th 2013, 10:46:54 am">October 5th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>yes malcolm had followed the docs i&#39;m getting below error</p>
<pre><code class="hljs">E/V8Exception(  <span class="hljs-number">682</span>): Exception occurred at alloy/controllers/index.js:<span class="hljs-number">6</span>: Uncaug
ht Error: database /data/data/com.scriptbees.vmhybird/databases/kusumadb (conn<span class="hljs-preprocessor">#</span>
<span class="hljs-number">0</span>) already closed
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="October 8th 2013, 4:57:54 am">October 8th 2013</span>
											by <span class='authorname'>kusuma jammula</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
