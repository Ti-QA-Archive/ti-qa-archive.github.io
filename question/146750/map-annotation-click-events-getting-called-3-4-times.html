<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Map Annotation click events getting called 3-4 times » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Map Annotation click events getting called 3-4 times</h1>
		</header>
		<section>
			<p>Hi ,<br>       I am using MapView in my project with in that using Annotation CLICK EVENT is getting called 3-4 times.any one can tell me why it is happening.</p>
<p>Thanks</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 11th 2013, 7:54:26 am">January 11th 2013</span>
				by <span class='authorname'>PRASHANT SHUKLA</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>annotation</span></li>
					
						<li><span class='tagname'>mapview</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Missing from you question are several pieces of information that will help you obtain a speedy and accurate answer;</p>
<ul>
<li>Titanium SDK Version?</li>
<li>Primary Target Platform; Android, iOS or both?</li>
<li>A code snippet that can be used to determine what you have achieved so far</li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="January 11th 2013, 8:03:52 am">January 11th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Malcolm ,<br>                    Thanks for reply.simply I am using annotation click event ,whenever I click any annotation   on map,click event got fired 3-4 times.nothing special in code.I made different file for annotation there I am using this click event.<br><em>SDK - 3.0
</em>Platform - iOS</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 11th 2013, 8:22:39 am">January 11th 2013</span>
								by <span class='authorname'>PRASHANT SHUKLA</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-254317">
				
						<section>
							<p>Hi</p>
<p>Almost certainly (based on not seeing any code yet) this is because your code is ADDING the event each time it shows the map, so the first time you go to the map - you will see one event fire, the next time two - so on and so forth.</p>
<p>I will need to see some code to be sure though.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 11th 2013, 8:07:01 am">January 11th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/146750/map-annotation-click-events-getting-called-3-4-times#answer-254317" rel="permalink">permalink</a>
							</div>

							<h5>6 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>here is code:</p>
<p>function Marker(parameters)<br>{<br>    var self = Ti.Map.createAnnotation({<br>        latitude : location.lat,<br>        longitude : location.lng,<br>        title : name,<br>        subtitle : area,<br>        animate : true,<br>        metadata1 : &#39;M&#39; + name,<br>        rightButton : Titanium.UI.iPhone.SystemButton.DISCLOSURE,<br>        markerType : type,<br>        image:Image,<br>        bubbleParent:false,</p>
<pre><code class="hljs">})<span class="hljs-comment">;</span>
</code></pre><p>&#x2F;&#x2F;check annotation click<br>    self.addEventListener(&#39;click&#39;, function(e)<br>    {<br>        if(e.clicksource == &quot;pin&quot;)<br>        {</p>
<pre><code class="hljs">             }
    <span class="hljs-keyword">else</span>
    {


    }
</code></pre><p>}</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 8:26:28 am">January 11th 2013</span>
											by <span class='authorname'>PRASHANT SHUKLA</span>
										</div>
									</li>
								
									<li class="comment">
										<p><pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Marker</span><span class="hljs-params">(parameters)</span> </span>{ 
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = Ti.Map.createAnnotation({ 
        latitude : location.lat,
        longitude : location.lng, 
        title : name, 
        subtitle : area, 
        animate : <span class="hljs-keyword">true</span>, 
        metadata1 : <span class="hljs-string">'M'</span> + name,
        rightButton : Titanium.UI.iPhone.SystemButton.DISCLOSURE, 
        markerType : type, 
        image:Image, 
        bubbleParent:<span class="hljs-keyword">false</span>,
    });

    <span class="hljs-comment">//check annotation click </span>
    <span class="hljs-keyword">self</span>.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{ 
        <span class="hljs-keyword">if</span>(e.clicksource == <span class="hljs-string">"pin"</span>) {
                 } <span class="hljs-keyword">else</span> {
        }
}
</code></pre><p>In this code we cannot see how often you call it. ;-))<br>On the other hand is it best practice to connect the map with a listener.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 8:45:00 am">January 11th 2013</span>
											by <span class='authorname'>Rainer Schleevoigt</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi  Rainer,<br>                 Thanks for reply.<br>I have a seperate file for map ,where I am calling this function for creating annotations ,this is simple code where annotations are linked with map and they have their own click event ,based on your selection it provides information about annotation ,my question is simple whenever I click it gets call 3-4 times.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 9:23:19 am">January 11th 2013</span>
											by <span class='authorname'>PRASHANT SHUKLA</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks for the annotation code but by itself it is insufficient to know how you are adding them to the map.</p>
<p>However the problem might lie with how you are attaching the event to the marker rather than the map itself.</p>
<p>It is more common to add a single event handler to the <strong>map</strong> and NOT the <strong>annotation</strong> - I know you can do it your way but it often leads to problems such as you are seeing.</p>
<p>If you remove this section;</p>
<pre><code class="hljs"><span class="hljs-keyword">self</span>.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{ 
<span class="hljs-keyword">if</span> (e.clicksource == <span class="hljs-string">"pin"</span>) {
} <span class="hljs-keyword">else</span> {
}
</code></pre><p>And instead add a generic handler, such as;</p>
<pre><code class="hljs"><span class="hljs-comment">// map being the variable you used to create the map</span>
map.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    <span class="hljs-keyword">if</span> (e.clicksource == <span class="hljs-string">'pin'</span>) {
        alert(e.annotation.metadata1);
    }
});
<span class="hljs-comment">// place this code UNDER the map create method</span>
</code></pre><p>Then you can handle all your events in one place - with a single event handler.  Should make things much easier.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 9:49:37 am">January 11th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Malcolm ,I tried with map event also ,same problem there..</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 9:57:39 am">January 11th 2013</span>
											by <span class='authorname'>PRASHANT SHUKLA</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So we are going to need more code to review what is going wrong - not everything in your app just the related parts.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 11th 2013, 9:59:44 am">January 11th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
