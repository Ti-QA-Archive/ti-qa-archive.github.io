<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>MAP geolocation coordinates: &#34;&#39;undefined&#39; is not an object (evaluating &#39;e.coords.longitude&#39;)&#34; » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>MAP geolocation coordinates: &#34;&#39;undefined&#39; is not an object (evaluating &#39;e.coords.longitude&#39;)&#34;</h1>
		</header>
		<section>
			<p><em><br>iOS (and hopefully Android) Application<br>iOS &amp; Android &#x2F; latest SDKs<br>Tested on iOS simulator and iphone 4s device<br>Host Operating System: OSX<br>Titanium Studio, build: 3.2.1.201402041146
</em></p>
<p>Greetings,<br>I am trying to build an app which uses geolocation to construct a route and show it in mapview using an array of lat&#x2F;long points.</p>
<p>The idea is to use this to map out hiking trails in the woods so there is no Geocoding required only lat&#x2F;long position.</p>
<p>However, it seems I am having trouble passing the coord outside of the Geolocation.getCurrentPosition function.  When I run the app I get this: </p>
<p><strong>undefined&#39; is not an object (evaluating &#39;e.coords.longitude&#39;)</strong></p>
<p>I can&#39;t help but think I have a syntax problem somewhere.<br>Apologies for my lack of Javascript Proficiency.<br>Thanks in advance!</p>
<pre><code class="hljs"><span class="hljs-comment">//WELCOME TO TrailDOTS!</span>
<span class="hljs-comment">//The purpose of this App is to create a trail (route) on the device</span>
<span class="hljs-comment">//native mapping program by tracking the users position.</span>
<span class="hljs-comment">//METHODOLOGY:</span>
<span class="hljs-comment">//Device Geolocation Services will begin to plot Lat/Long position every 10s when</span>
<span class="hljs-comment">//user presses the "Start" Button.  </span>
<span class="hljs-comment">//These positions will be stored in an array called "points".</span>
<span class="hljs-comment">//A "route" will be shown on the map showing where the user's current trail</span>

<span class="hljs-comment">//Post Final Project Scope:</span>
<span class="hljs-comment">//The routes can be saved locally on the device and even exported to be drawn in other </span>
<span class="hljs-comment">//programs.</span>
<span class="hljs-comment">//Add a compass to use when walking in the woods</span>
</code></pre><pre><code class="hljs"><span class="hljs-comment">/////////////THIS IS THE MAPPING MODULE 'CREATE.JS'\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
<span class="hljs-comment">////////////LETS GET STARTED BUILDING TrailDOTS!\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params"></span>)</span>{

<span class="hljs-keyword">var</span> self = Ti.UI.createWindow({
    backgroundcolor:<span class="hljs-string">'green'</span>,
    backgroundImage: <span class="hljs-string">'/images/trail.png'</span>,
    title: <span class="hljs-string">'TrailDOTS....Create Trail'</span>,
    barColor: <span class="hljs-string">'#495E49'</span>
});


<span class="hljs-keyword">var</span> <span class="hljs-built_in">Map</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.map'</span>);

<span class="hljs-comment">//This timer will help us determine when to take a lat/long reading latter on.</span>
<span class="hljs-keyword">var</span> timerStarted = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">var</span> intTimer;

<span class="hljs-comment">//create array will to hold all the latitude and longitude points in our route</span>
<span class="hljs-keyword">var</span> points = [];

<span class="hljs-comment">//create route object</span>
<span class="hljs-keyword">var</span> route = 
        <span class="hljs-comment">//Map.createRoute({</span>
       {
        name : <span class="hljs-string">'My Trail'</span>,
        points : points,
        color : <span class="hljs-string">"red"</span>,
        width : <span class="hljs-number">4</span>
       };
    <span class="hljs-comment">//});</span>
 <span class="hljs-comment">//may need to add this below later</span>
<span class="hljs-comment">// mapview.addRoute(route);</span>
</code></pre><pre><code class="hljs"><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">///\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
//</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span>START NAVBAR<span class="hljs-string">\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
<span class="hljs-pi">//Create Control Buttons at Top of Page

 var navbar = Titanium.UI.createView({
    top: 0,
    left: 0,
    width: 320,
    height: 40,
    backgroundColor: '<span class="hljs-comment">#000'</span>
    //</span><span class="hljs-attribute">backgroundImage</span>: <span class="hljs-string">'images/navbox.png'</span>
});

<span class="hljs-keyword">var</span> button_start = Titanium.UI.createButton({
    <span class="hljs-attribute">top</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attribute">width</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attribute">height</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attribute">backgroundImage</span>: <span class="hljs-string">'images/button_start.png'</span>,
    <span class="hljs-attribute">borderRadius</span>: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> button_stop = Titanium.UI.createButton({
    <span class="hljs-attribute">top</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attribute">left</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attribute">width</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attribute">height</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attribute">backgroundImage</span>: <span class="hljs-string">'images/button_stop.png'</span>,
    <span class="hljs-attribute">borderRadius</span>: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> button_save = Titanium.UI.createButton({
    <span class="hljs-attribute">top</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attribute">left</span>: <span class="hljs-number">160</span>,
    <span class="hljs-attribute">width</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attribute">height</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attribute">backgroundImage</span>: <span class="hljs-string">'images/button_save.png'</span>,
    <span class="hljs-attribute">borderRadius</span>: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> button_compass = Titanium.UI.createButton({
    <span class="hljs-attribute">top</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attribute">left</span>: <span class="hljs-number">240</span>,
    <span class="hljs-attribute">width</span>: <span class="hljs-number">80</span>,
    <span class="hljs-attribute">height</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attribute">backgroundImage</span>: <span class="hljs-string">'images/button_compass.png'</span>,
    <span class="hljs-attribute">borderRadius</span>: <span class="hljs-number">3</span>
});

navbar.add(button_start);
navbar.add(button_stop);
<span class="hljs-pi">//funtionality for these buttons will come later
navbar.add(button_save);
navbar.add(button_compass);
//</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span>END NAVBAR<span class="hljs-string">\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
<span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">////</span><span class="hljs-pi">//</span>
</code></pre><pre><code class="hljs">//////////////////////////////////////////<span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\
</span>////////////////////CORE MAP CREATION START<span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\\</span><span class="hljs-command">\
</span>
//---------------------CREATE THE MAPVIEW-------------------------
var mapview = Map.createView(<span class="hljs-special">{</span>
    //create some space at top for control buttons
    top: 40,
    height: 460,
    mapType: Map.HYBRID_TYPE,
    //initiate with bogus coordinates as placeholders
    region:<span class="hljs-special">{</span>latitude: 50, longitude:-70, latitudeDelta:0.001, longitudeDelta:0.001<span class="hljs-special">}</span>,
    animate: true,
    regionFit: true,
    //!!THIS IS IMPORTANT!!
    userLocation: true

<span class="hljs-special">}</span>);
//---------------------END CREATE THE MAPVIEW------------------------
</code></pre><pre><code class="hljs"><span class="hljs-comment">//-----------------ENABLE THE START BUTTON TO BEGIN TRACKING POSITION-----</span>
button_start.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
    Ti.API.info(<span class="hljs-string">'Start Button Hath Been Clicked'</span>);

    <span class="hljs-keyword">if</span>(timerStarted == <span class="hljs-literal">false</span>)
    {
       Ti.API.info(<span class="hljs-string">'Timer will start...'</span>);
       points = []; 

      <span class="hljs-comment">//set our first point</span>
        Titanium.Geolocation.getCurrentPosition(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{        
        <span class="hljs-keyword">var</span> currLongitude = e.coords.longitude;
        <span class="hljs-keyword">var</span> currLatitude = e.coords.latitude;    
        points.push({latitude: e.currLatitude, longitude: e.currLongitude});

        <span class="hljs-comment">//add new point to route</span>
        route.points = points;  

           <span class="hljs-comment">//add route to our mapview object</span>
           mapview.createRoute(route);

           timerStarted = <span class="hljs-literal">true</span>;

           <span class="hljs-comment">//start timer and refresh it every 10 seconds</span>
           <span class="hljs-comment">//10 seconds = 10,000 milliseconds</span>
           intTimer = setInterval(recordCurrentLocation, <span class="hljs-number">10000</span>);
       });       

    }
    <span class="hljs-keyword">else</span>
    {
       <span class="hljs-comment">//stop the running timer</span>
       <span class="hljs-keyword">if</span>(timerStarted == <span class="hljs-literal">true</span> <span class="hljs-comment">/* &amp;&amp; (e.clicksource == 'button_stop')*/</span>)
       {
         clearInterval(intTimer);
         timerStarted = <span class="hljs-literal">false</span>;
         alert(<span class="hljs-string">'Click Save Trail to Keep this Trail'</span>);
       }
    }
});
<span class="hljs-comment">//----------END ENABLE THE START BUTTON TO BEGIN TRACKING POSITION-----</span>
</code></pre><pre><code class="hljs"><span class="hljs-comment">//-----------------RECORD CURRENT LOCATION----------------------------------------------</span>
<span class="hljs-comment">//this function records the current location </span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recordCurrentLocation</span><span class="hljs-params">()</span>
</span>{
    Ti.API.info(<span class="hljs-string">'getting next position...'</span>);
    <span class="hljs-comment">//bogus points to initialize</span>
    points.push({latitude:<span class="hljs-number">50</span>,longitude:-<span class="hljs-number">70</span>});
    route.points = points;

    <span class="hljs-comment">//get the current position</span>
    Titanium.Geolocation.getCurrentPosition(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{        
        <span class="hljs-keyword">var</span> currLongitude = e.coords.longitude;
        <span class="hljs-keyword">var</span> currLatitude = e.coords.latitude;    
        points.push({latitude: e.currLatitude, longitude: e.currLongitude});

        <span class="hljs-comment">//add new point to route</span>
        route.points = points;

        <span class="hljs-comment">//remove the old route and add this new one</span>
        mapview.removeRoute(route); 
        mapview.createRoute(route);
    });
}
<span class="hljs-comment">//------------------END RECORD CURRENT LOCATION----------------------------</span>
</code></pre><pre><code class="hljs"><span class="hljs-comment">//-----------------GET CURRENT POSITION----------------------------</span>
<span class="hljs-comment">//set the distance filter</span>
Titanium.Geolocation.distanceFilter = 10; 

<span class="hljs-comment">//This is required.  </span>
Ti.Geolocation.purpose = <span class="hljs-string">"To Map a Trail with a Geolocation Enabled Device"</span>;

Titanium.Geolocation.getCurrentPosition(function(<span class="hljs-keyword">e</span>)
{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.<span class="hljs-keyword">error</span>)
    {
        <span class="hljs-comment">//if mapping non-functional return an alert</span>
        alert('GeoLocation May Not be Available or Enabled <span class="hljs-keyword">on</span> Your Device');

        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">//get the properties from Titanium.GeoLocation</span>
    <span class="hljs-comment">//most of these will not be used in this app.</span>
    <span class="hljs-keyword">var</span> longitude = <span class="hljs-keyword">e</span>.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = <span class="hljs-keyword">e</span>.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = <span class="hljs-keyword">e</span>.coords.altitude;
    <span class="hljs-keyword">var</span> heading = <span class="hljs-keyword">e</span>.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = <span class="hljs-keyword">e</span>.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = <span class="hljs-keyword">e</span>.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = <span class="hljs-keyword">e</span>.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = <span class="hljs-keyword">e</span>.coords.altitudeAccuracy;

    <span class="hljs-comment">//apply the lat and lon properties to our mapview</span>
    <span class="hljs-comment">//!!!USE THIS METHOD TO PASS the above properties</span>
    mapview.region = {latitude: latitude, longitude: longitude, latitudeDelta:0.5, longitudeDelta:0.5};
});
<span class="hljs-comment">//----------------------END GET CURRENT POSITION----------------------------</span>

<span class="hljs-comment">////////////////////CORE MAP CREATION END\\\\\\\\\\\\\\\\\\\\\\\</span>
</code></pre><pre><code class="hljs"><span class="hljs-comment">//add all window components here</span>
<span class="hljs-keyword">self</span>.<span class="hljs-keyword">add</span>(mapview);
<span class="hljs-keyword">self</span>.<span class="hljs-keyword">add</span>(navbar);

return <span class="hljs-keyword">self</span>;
}

<span class="hljs-keyword">module</span>.exports = <span class="hljs-keyword">create</span>;
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 25th 2014, 12:47:28 pm">May 25th 2014</span>
				by <span class='authorname'>Dana Bishop</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>e.coords</span></li>
					
						<li><span class='tagname'>geolocation</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>map</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-279039">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>I suspect your problem is not how you gain your information from the geo services but more that you do not have permission to ask for them or the services them selves are turned off.</p>
<p>On iOS we have two different things we need to check for;</p>
<ul>
<li>Have the geo location services been disabled by the user for this device?</li>
<li>Has the user chosen no to allowing geo services when the app first requested?</li>
</ul>
<p>As you are returning undefined when referencing <strong>e.coords.longitude</strong> then that shows you are not getting them back rather than getting useless pr out of date values.</p>
<p>This very quick and simple code block will explain how to find out in your app.</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (Ti.Geolocation.locationServicesEnabled === <span class="hljs-literal">false</span>) {
    <span class="hljs-comment">// the device has the location services disabled</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> authorization = Ti.Geolocation.locationServicesAuthorization;
    <span class="hljs-keyword">if</span> (authorization == Ti.Geolocation.AUTHORIZATION_DENIED) {
        <span class="hljs-comment">// the user chose to not allow this app access to the geolocation services</span>
        <span class="hljs-comment">// the user must go to settings and enable the access</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// the device has geo turned on and</span>
        <span class="hljs-comment">// the user said this app can use those services</span>
       alert(<span class="hljs-string">'success'</span>);
    }    
}
</code></pre><p>The code above in no way shows you how to retrieve the current location - it shows you the things you must do in order to check if you can gain access to them in the first place.</p>
<p>Once you have this in control you can move onto to solving the other problem in you code.  As Nick has pointed out getCurrentPosition has a limited benefit and especially in this case you will be far better off with an event listener that updates only when the location has changed.  You existing code has a <strong>setInterval</strong> method to update your code every 10 seconds.  This is wrong in two ways;</p>
<ul>
<li>If you are stood still for 10 seconds, no new information has been provided</li>
<li>Use of setInterval and setTimout must be done with care - these two methods are responsible for a large number of memory leaks.  They themselves do NOT cause memory leaks but developers who fail to clean up after them (required) will cause the inadvertent re-use of internal proxies.  This is not the right place for how to resolver those, but more a point of there are better ways.</li>
</ul>
<p>Your code appears to re-write your geo code at least three times, this is prone to error and unnecessary.  You are much better allowing CommonJS to handle this for you.  I answered a question some time ago that used this solution combined with the location event listener.</p>
<ul>
<li><p><a href="https:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;148423&#x2F;geolocation-coordinates-are-not-accurate">Geolocation coordinates are not accurate</a></p>
<p>This is a long and detailed question that helped walk the author through resolving their problem</p>
</li>
<li><p><a href="https:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;147768&#x2F;geolocation-inside-an-eventlistener-">GeoLocation inside an eventlistener ???</a> </p>
<p>I also provided a really quick and simple example of how to use the location services.</p>
</li>
</ul>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 25th 2014, 2:43:20 pm">May 25th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/174514/map-geolocation-coordinates-undefined-is-not-an-object-evaluating-ecoordslongitude#answer-279039" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>WOOT!  That worked!  Now I just need to figure out how to save all the Lat&#x2F;Long points in an array and feed them back to the route.  THANKS!!!!!!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 4:12:43 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>This is a job for CommonJS.  If you create a simple module that keeps the array values internally, allows you to add to them and then return the current set.  Sounds complicated?  Nope, see how it can be achieved;</p>
<p><strong>geohelper.js</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> points = [];
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addPoint</span><span class="hljs-params">(point)</span> </span>{
    points.push(point);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPoints</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> points;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reset</span><span class="hljs-params">()</span> </span>{
    points = [];
}
exports.addPoint = addPoint;
exports.getPoints = getPoints;
exports.reset = reset;
</code></pre><p>Then you use it later on as follows;</p>
<pre><code class="hljs"><span class="hljs-comment">// add a point</span>
<span class="hljs-comment">// do this inside the event</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">'geohelper'</span>).addPoint({
    latitude : e.coords.latitude,
    longitude: e.coords.longitude
});

<span class="hljs-comment">// get the points back when you need</span>
<span class="hljs-comment">// to add them to the map</span>
<span class="hljs-comment">// then loop this returned array</span>
<span class="hljs-keyword">var</span> points = <span class="hljs-built_in">require</span>(<span class="hljs-string">'geohelper'</span>).getPoints();
</code></pre><p>The points will stay in memory as long as the app has not been shut down and removed from memory - so if you need to clear them out before then;</p>
<pre><code class="hljs"><span class="hljs-keyword">require</span>(<span class="hljs-string">'geohelper'</span>).<span class="hljs-keyword">reset</span>();
</code></pre><p>That should get you started.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 4:28:11 pm">May 25th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So close I think! I added the require inside the event and get the &quot;undefined is not an object&quot; error for e.coords lattitude.  Perhaps I added it in the wrong place?</p>
<pre><code class="hljs"><span class="hljs-comment">//---------------------TRACK LOCATION----------------------------</span>

<span class="hljs-keyword">var</span> location = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/location'</span>);
btnStart.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.start({
        action: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            Ti.API.info(<span class="hljs-string">'Location Callback: '</span> + <span class="hljs-built_in">JSON</span>.stringify(e));
            alert(<span class="hljs-string">'info has been sent'</span> + <span class="hljs-built_in">JSON</span>.stringify(e));
            <span class="hljs-comment">//add a point to the array 'points' initiated in geohelper.js</span>
            <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/geohelper'</span>).addPoint({
                latitude : e.coords.latitude,
                longitude: e.coords.longitude
            });

        }
    });
});
btnStop.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.stop();
    alert(<span class="hljs-string">'Press SAVE to Save this Trail'</span>);
});
<span class="hljs-comment">//----------------------END TRACK LOCATION--------------------------</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 5:37:37 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The problem is a simpler one.  you have create a <strong>location.start</strong> method I have no knowledge of and it appears to return data I have no knowledge of.</p>
<p>I created a usage example based on returning data from the <strong>location</strong> event or the <strong>getCurrentPosition</strong> method - would work with either.</p>
<p>However I have no idea what your <strong>start method returns and in what manner.  So whilst my example and your code both share the callback variable of </strong>e** these two things are unlikely the same thing.</p>
<p>This section of your code;</p>
<pre><code class="hljs">location.start({
    action: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(e)</span> </span>{
...
</code></pre><p><strong>action</strong> returns back <strong>e</strong>, this likely contains the lat&#x2F;lon values - if not it has to.  Chances are they are not defined in the same way as the <strong>location</strong> event or the <strong>getCurrentPosition</strong> method returns them.</p>
<p>You do however have an easy way to find out, you have added a console line that provides the answers;</p>
<pre><code class="hljs">Ti.API.<span class="hljs-number">inf</span>o('<span class="hljs-keyword">Location</span> <span class="hljs-title">Callback</span>: ' + JSON.stringify(e));
</code></pre><p>Does this have any reference to <strong>latitude</strong> or <strong>longitude</strong>?  If so what dot notation path gives those tow values?</p>
<p>You can make your life a little easier to check this by adding two of the optional parameters to <strong>stringify</strong>;</p>
<pre><code class="hljs">Ti.API.<span class="hljs-number">inf</span>o('<span class="hljs-keyword">Location</span> <span class="hljs-title">Callback</span>: ' + JSON.stringify(e, null, <span class="hljs-number">4</span>));
</code></pre><p>This will display the results in a clearer version.</p>
<p>My example expected the following structure - (unrelated parts left out)</p>
<pre><code class="hljs"><span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">coords</span>:<span class="hljs-value"> {
        latitude: somevalue,
        longitude: somevalue
    </span></span></span>}
}
</code></pre><p>So the path would be <strong>e.coords.latitude</strong> and <strong>e.coords.longitude</strong>.</p>
<p>Amend to suit your own code.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 5:53:38 pm">May 25th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>So Sorry, the &quot;location&quot; method came from a link you provided me earlier:</p>
<p><a href="https:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;148423&#x2F;geolocation-coordinates-are-not-accurate">Link from Earlier</a></p>
<p>The stringified JSON looks like: {&quot;timestamp&quot;; ####, &quot;altitude&quot;: ####, &quot;speed&quot;: ####,&quot;latitude&quot;: ####,&quot;longitude&quot;: ####, &quot;accuracy&quot;: ####, &quot;altitudeAccuracy&quot;: ####, &quot;heading&quot;: ####}</p>
<p>I took the &#39;coords&#39; out of the require statement:</p>
<pre><code class="hljs"><span class="hljs-tag">require</span>(<span class="hljs-string">'mod/geohelper'</span>)<span class="hljs-class">.addPoint</span>({
            <span class="hljs-attribute">latitude </span>: e.latitude,
            <span class="hljs-attribute">longitude</span>: e.longitude
            });
</code></pre><p>It appears to be ok now.  However I am &#39;missing points data&#39; when I run the app.</p>
<p>Thanks again!  I&#39;ve attached everything below in case anyone is interested…</p>
<p>geohelper.js is from the post above.</p>
<p>location.js is from the link at the top of this post.</p>
<pre><code class="hljs"><span class="hljs-comment">//Get Location</span>

Ti.Geolocation.setPurpose(<span class="hljs-string">'Create a Trail with Location Services'</span>); 
<span class="hljs-keyword">var</span> <span class="hljs-keyword">callback</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">locationHandler</span><span class="hljs-params">(e)</span> </span>{
    <span class="hljs-keyword">if</span> (e.success === undefined || e.success) {
        <span class="hljs-keyword">if</span> (typeof (<span class="hljs-keyword">callback</span>) === <span class="hljs-string">'function'</span>) {
            <span class="hljs-keyword">callback</span>(e.coords);
        }
    }
} 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span><span class="hljs-params">(obj)</span> </span>{
    <span class="hljs-keyword">callback</span> = obj.action;
    Ti.Geolocation.addEventListener(<span class="hljs-string">"location"</span>, locationHandler);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">callback</span> = undefined;
    Ti.Geolocation.removeEventListener(<span class="hljs-string">"location"</span>, locationHandler);
}
exports.start = start;
exports.stop = stop;
</code></pre><p>Here is all the code for full disclosure:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params"></span>)</span>{

<span class="hljs-keyword">var</span> self = Ti.UI.createWindow({
    backgroundcolor:<span class="hljs-string">'green'</span>,
    backgroundImage: <span class="hljs-string">'/images/trail.png'</span>,
    title: <span class="hljs-string">'TrailDOTS....Create Trail'</span>,
    barColor: <span class="hljs-string">'#495E49'</span>
});


<span class="hljs-keyword">var</span> <span class="hljs-built_in">Map</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.map'</span>);


<span class="hljs-comment">//var points = [];</span>


<span class="hljs-comment">///////////////////////////////////////////////////////////////</span>
<span class="hljs-comment">//////////////////////////START NAVBAR\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
<span class="hljs-comment">//Create Control Buttons at Top of Page</span>

 <span class="hljs-keyword">var</span> navbar = Titanium.UI.createView({
    top: <span class="hljs-number">0</span>,
    left: <span class="hljs-number">0</span>,
    width: <span class="hljs-number">320</span>,
    height: <span class="hljs-number">40</span>,
    backgroundColor: <span class="hljs-string">'#000'</span>
    <span class="hljs-comment">//backgroundImage: 'images/navbox.png'</span>
});

<span class="hljs-keyword">var</span> btnStart = Titanium.UI.createButton({
    top: <span class="hljs-number">5</span>,
    left: <span class="hljs-number">0</span>,
    width: <span class="hljs-number">80</span>,
    height: <span class="hljs-number">30</span>,
    backgroundImage: <span class="hljs-string">'images/button_start.png'</span>,
    borderRadius: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> btnStop = Titanium.UI.createButton({
    top: <span class="hljs-number">5</span>,
    left: <span class="hljs-number">80</span>,
    width: <span class="hljs-number">80</span>,
    height: <span class="hljs-number">30</span>,
    backgroundImage: <span class="hljs-string">'images/button_stop.png'</span>,
    borderRadius: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> btnSave = Titanium.UI.createButton({
    top: <span class="hljs-number">5</span>,
    left: <span class="hljs-number">160</span>,
    width: <span class="hljs-number">80</span>,
    height: <span class="hljs-number">30</span>,
    backgroundImage: <span class="hljs-string">'images/button_save.png'</span>,
    borderRadius: <span class="hljs-number">3</span>
});

<span class="hljs-keyword">var</span> btnCompass = Titanium.UI.createButton({
    top: <span class="hljs-number">5</span>,
    left: <span class="hljs-number">240</span>,
    width: <span class="hljs-number">80</span>,
    height: <span class="hljs-number">30</span>,
    backgroundImage: <span class="hljs-string">'images/button_compass.png'</span>,
    borderRadius: <span class="hljs-number">3</span>
});

navbar.add(btnStart);
navbar.add(btnStop);
navbar.add(btnSave);
navbar.add(btnCompass);
<span class="hljs-comment">//////////////////////////END NAVBAR\\\\\\\\\\\\\\\\\\\\\\\\\\\</span>
<span class="hljs-comment">///////////////////////////////////////////////////////////////</span>


<span class="hljs-comment">////////////////////CORE MAP CREATION\\\\\\\\\\\\\\\\\\\\\\\</span>

<span class="hljs-comment">//---------------------CREATE THE MAPVIEW-------------------------</span>
<span class="hljs-keyword">var</span> mapview = <span class="hljs-built_in">Map</span>.createView({
    <span class="hljs-comment">//create some space at top for control buttons</span>
    top: <span class="hljs-number">40</span>,
    height: <span class="hljs-number">460</span>,
    mapType: <span class="hljs-built_in">Map</span>.HYBRID_TYPE,
    <span class="hljs-comment">//initiate with bogus coordinates as placeholders</span>
    region:{latitude: <span class="hljs-number">50</span>, longitude:-<span class="hljs-number">70</span>, latitudeDelta:<span class="hljs-number">0.001</span>, longitudeDelta:<span class="hljs-number">0.001</span>},
    animate: <span class="hljs-literal">true</span>,
    regionFit: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">//THIS IS IMPORTANT!!</span>
    userLocation: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">//route: route</span>

});
<span class="hljs-comment">//---------------------END CREATE THE MAPVIEW------------------------</span>


<span class="hljs-comment">//---------------------TRACK LOCATION----------------------------</span>
<span class="hljs-comment">//This uses a callback to receive the location information which is thrown to the console tab. </span>
<span class="hljs-comment">//Add it to a label or whatever you need when you are on the device.</span>
<span class="hljs-keyword">var</span> location = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/location'</span>);
btnStart.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.start({
        action: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            Ti.API.info(<span class="hljs-string">'Location Callback: '</span> + <span class="hljs-built_in">JSON</span>.stringify(e, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
            alert(<span class="hljs-string">'info has been sent'</span> + <span class="hljs-built_in">JSON</span>.stringify(e, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
            <span class="hljs-comment">//add a point to the array 'points' stored in geohelper.js</span>

               <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/geohelper'</span>).addPoint({
            latitude : e.latitude,
            longitude: e.longitude
            });

           }
    });
});

btnStop.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.stop();
    alert(<span class="hljs-string">'Press SAVE to Save this Trail'</span>);
});
<span class="hljs-comment">//----------------------END TRACK LOCATION--------------------------</span>


<span class="hljs-comment">//------------GET POINTS FROM ARRAY AND CREATE ROUTE-----------------</span>
<span class="hljs-comment">//create array will to hold all the latitude and longitude points in our route</span>
<span class="hljs-keyword">var</span> points = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/geohelper'</span>).getPoints();

<span class="hljs-comment">//create route object and add to mapview</span>

<span class="hljs-keyword">var</span> route = <span class="hljs-built_in">Map</span>.createRoute({
       name: <span class="hljs-string">'My Trail'</span>,
       points: points,
       color: <span class="hljs-string">"red"</span>,
       width: <span class="hljs-number">4</span>
    });

mapview.addRoute(route);

<span class="hljs-comment">//------------END GET POINTS FROM ARRAY AND CREATE ROUTE-----------------</span>


<span class="hljs-comment">//-----------------GET CURRENT POSITION----------------------------</span>
<span class="hljs-comment">//set the distance filter</span>
Titanium.Geolocation.distanceFilter = <span class="hljs-number">10</span>; 

<span class="hljs-comment">//This is required.  </span>
Ti.Geolocation.purpose = <span class="hljs-string">"To Map a Trail with a Geolocator Enabled Device"</span>;

Titanium.Geolocation.getCurrentPosition(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)
</span>{
    <span class="hljs-keyword">if</span> (e.error)
    {
        <span class="hljs-comment">//if mapping non-functional return an alert</span>
        alert(<span class="hljs-string">'GeoLocation May Not be Available or Enabled on Your Device'</span>);
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">//get the properties from Titanium.GeoLocation</span>
    <span class="hljs-comment">//most of these will not be used in this app.</span>
    <span class="hljs-keyword">var</span> longitude = e.coords.longitude;
    <span class="hljs-keyword">var</span> latitude = e.coords.latitude;
    <span class="hljs-keyword">var</span> altitude = e.coords.altitude;
    <span class="hljs-keyword">var</span> heading = e.coords.heading;
    <span class="hljs-keyword">var</span> accuracy = e.coords.accuracy;
    <span class="hljs-keyword">var</span> speed = e.coords.speed;
    <span class="hljs-keyword">var</span> timestamp = e.coords.timestamp;
    <span class="hljs-keyword">var</span> altitudeAccuracy = e.coords.altitudeAccuracy;

    <span class="hljs-comment">//apply the lat and lon properties to our mapview</span>
    <span class="hljs-comment">//!!!USE THIS METHOD TO PASS the above properties</span>
    mapview.region = {latitude: latitude, longitude: longitude, latitudeDelta:<span class="hljs-number">0.5</span>, longitudeDelta:<span class="hljs-number">0.5</span>};
});
<span class="hljs-comment">//----------------------END GET CURRENT POSITION----------------------------</span>

<span class="hljs-comment">////////////////////END CORE MAP CREATION\\\\\\\\\\\\\\\\\\\\\\\</span>





<span class="hljs-comment">//add all window components here</span>
self.add(mapview);
self.add(navbar);


<span class="hljs-keyword">return</span> self;
}

<span class="hljs-built_in">module</span>.exports = create;
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 6:33:49 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>No that was my fault.  I should have realised that you would have used code from one of my one links - my excuse is that I wrote them both over a year ago ;-)</p>
<p>You have not said when or where the error  &#39;missing points data&#39; appears.  From your code I assume that the problem would be here;</p>
<pre><code class="hljs">var points = require('mod/geohelper').getPoints();

//<span class="hljs-operator"><span class="hljs-keyword">create</span> route <span class="hljs-keyword">object</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">add</span> <span class="hljs-keyword">to</span> mapview

<span class="hljs-keyword">var</span> route = <span class="hljs-keyword">Map</span>.createRoute({
       <span class="hljs-keyword">name</span>: <span class="hljs-string">'My Trail'</span>,
       points: points,
       color: <span class="hljs-string">"red"</span>,
       width: <span class="hljs-number">4</span>
});</span>

mapview.addRoute(route);
</code></pre><p>If this is the case then I would expect it to fail as well.  It looks like you attempt to add the route to a map before any points have been added to the helper function - thus it returns an empty array.  This would match the error you are receiving.</p>
<p>The route should only be added to the map once you have at least to points returned - and certainly not attempted during the initial display of this window..</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 6:49:54 pm">May 25th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are correct!  I moved the above section to the TRACK LOCATION section and it works!!!!!!<br>Thank you Malcolm!!!!!!!</p>
<p>Here is the updated code for anyone who cares.  </p>
<pre><code class="hljs"><span class="hljs-comment">//---------------------TRACK LOCATION----------------------------</span>
<span class="hljs-comment">//This uses a callback to receive the location information which is thrown to the console tab. </span>
<span class="hljs-comment">//Add it to a label or whatever you need when you are on the device.</span>
<span class="hljs-keyword">var</span> location = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/location'</span>);
btnStart.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.start({
        action: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
            Ti.API.info(<span class="hljs-string">'Location Callback: '</span> + <span class="hljs-built_in">JSON</span>.stringify(e, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
            alert(<span class="hljs-string">'info has been sent'</span> + <span class="hljs-built_in">JSON</span>.stringify(e, <span class="hljs-literal">null</span>, <span class="hljs-number">4</span>));
            <span class="hljs-comment">//add a point to the array 'points' stored in geohelper.js</span>

               <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/geohelper'</span>).addPoint({
            latitude : e.latitude,
            longitude: e.longitude
            });

            <span class="hljs-keyword">var</span> points = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mod/geohelper'</span>).getPoints();

            <span class="hljs-comment">//create route object and add to mapview</span>

            <span class="hljs-keyword">var</span> route = <span class="hljs-built_in">Map</span>.createRoute({
               name: <span class="hljs-string">'My Trail'</span>,
               points: points,
               color: <span class="hljs-string">"red"</span>,
               width: <span class="hljs-number">4</span>
            });

            mapview.addRoute(route);

           }
    });
});

btnStop.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    location.stop();
    alert(<span class="hljs-string">'Press SAVE to Save this Trail'</span>);
});
<span class="hljs-comment">//----------------------END TRACK LOCATION--------------------------</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 8:36:01 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Excellent - is this question answered now?</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 8:37:56 pm">May 25th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yes it is!  Great Job.  I appreciate the guidance.  You guys are the best.  If there is anything I can do in payment let me know!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 9:33:21 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You are welcome and you just just did.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 9:43:53 pm">May 25th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-279029">
				
						<section>
							<p>I would suggest you dont use <code>getCurrentPosition</code> as the docs state</p>
<pre><code class="hljs"><span class="hljs-keyword">On</span> Android, the radios are <span class="hljs-keyword">not</span> turned <span class="hljs-keyword">on</span> <span class="hljs-keyword">to</span> update the location, <span class="hljs-keyword">and</span> a cached location <span class="hljs-keyword">is</span> used.

<span class="hljs-keyword">On</span> iOS the radios may be used <span class="hljs-keyword">if</span> the location <span class="hljs-keyword">is</span> too <span class="hljs-string">"old"</span>.
</code></pre><p>So you can get cached and out of date data.  If you insist on doing so you ought to perform this check</p>
<pre><code class="hljs">
Titanium.Geolocation.getCurrentPosition(function(<span class="hljs-keyword">e</span>) {      
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">e</span>.success) {
            <span class="hljs-keyword">var</span> currLongitude = <span class="hljs-keyword">e</span>.coords.longitude;
            <span class="hljs-keyword">var</span> currLatitude = <span class="hljs-keyword">e</span>.coords.latitude;   
            points.push({latitude: <span class="hljs-keyword">e</span>.currLatitude, longitude: <span class="hljs-keyword">e</span>.currLongitude});
}
</code></pre><p>A better idea is to subscribe to the <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Geolocation-event-location">location</a> event instead - but only for enough time to retrieve coordinates as it is battery intensive</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 25th 2014, 12:54:25 pm">May 25th 2014</span>
								by <span class='authorname'>Nick Milner</span><br>
								<a class="icon-bg icon-link" href="question/174514/map-geolocation-coordinates-undefined-is-not-an-object-evaluating-ecoordslongitude#answer-279029" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>I switched to the location event.  Works and it was much easier.  Thanks!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2014, 4:38:43 pm">May 25th 2014</span>
											by <span class='authorname'>Dana Bishop</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hej Dana , it sounds good solution… I am doing exactly the same to my school, will it be possible for you the last update and full version of this code…with regards Abli…</p>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2014, 10:01:59 am">December 2nd 2014</span>
											by <span class='authorname'>Abraham bobosha</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The event example code is in the answer I gave here in green;</p>
<ul>
<li><a href="https:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;147768&#x2F;geolocation-inside-an-eventlistener-">GeoLocation inside an eventlistener ???</a></li>
</ul>
</p>
										<div class="author">
											&mdash; commented <span title="December 2nd 2014, 10:46:45 am">December 2nd 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
