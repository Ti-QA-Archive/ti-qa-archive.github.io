<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Connecting to mysql database » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Connecting to mysql database</h1>
		</header>
		<section>
			<p>This is for a titanium mobile app (itunes&#x2F;android).   </p>
<p>I inherited this project and the original developers are not available.  </p>
<p>I am brand new to Titanium and have been able to make changes to layout.  I will need some help with a few functions, but that is after I get it re-connected to a database.  </p>
<p>Rebuilt db from php files, ran some test on the php (all good) and changed the url in the settings.js file.  Unable to login or register a new user.  </p>
<ol>
<li><p>If the database changed would the google api used in the php need to change? </p>
</li>
<li><p>What else would prevent the app from connecting to db?    </p>
</li>
</ol>
<p>Thank you - Darrell</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 20th 2014, 7:07:59 pm">January 20th 2014</span>
				by <span class='authorname'>Darrell Ritchie</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>api</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>javascript</span></li>
					
						<li><span class='tagname'>php</span></li>
					
				</ul>
			

			<section>
				<h5>9 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I was able to get a return and I believe you are right.  When i tried to register after finding a couple of missing db login fields in the code.  I got an ALERT message that begins with…</p>
<p>Registration Failed.  Please Try Again.<br>&lt;!DOCTYPE HTML PUBLIC &quot; -&#x2F;&#x2F;W3C&#x2F;DTS HTML 4.0 Transitonal EN&quot;</p>
<p>and then a bunch of css code.</p>
<p>Is there anywhere I can get someone to do this for me or a tutorial on how to set one up with json?<br>Can I do this with any hosting company? (server)</p>
<p>Thank you,<br>Darrell</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 8:19:02 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Here is the srv.php code.  Does it look right?</p>
<p>&lt;?php<br>include &#39;srv.php&#39;;    &#x2F;&#x2F;Contains the conneciton info</p>
<p>&#x2F;&#x2F; ——————<br>    $pass = $_POST[&#39;password&#39;];<br>    $email      = $_POST[&#39;email&#39;];<br>    &#x2F;&#x2F;Let&#39;s make it all lowercase<br>    $email      = strtolower($email);</p>
<p>&#x2F;&#x2F; Select eveything from the users table where username field == the username we posted and password field == the password we posted<br>$sql = &quot;SELECT * FROM users&quot;;<br>$query = mysql_query($sql);</p>
<p>&#x2F;&#x2F; If we find a match, create an array of data, json_encode it and echo it out<br>if (mysql_num_rows($query) &gt; 0)<br>{<br>    $row = mysql_fetch_array($query);<br>    $response = array(<br>        &#x2F;&#x2F;Returned elements<br>        &#39;logged&#39; =&gt; true,<br>        &#39;name&#39; =&gt; $row[&#39;name&#39;],<br>        &#39;email&#39; =&gt; $row[&#39;email&#39;],<br>        &#39;info&#39; =&gt; $row[&#39;info&#39;]<br>    );<br>    echo json_encode($response);<br>}<br>else<br>{<br>    &#x2F;&#x2F; Else the username and&#x2F;or password was invalid! Create an array, json_encode it and echo it out<br>    $response = array(<br>        &#39;logged&#39; =&gt; false,<br>        &#39;message&#39; =&gt; &#39;No good&#39;<br>    );<br>    echo json_encode($response);</p>
<p>}<br>?&gt;</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 8:22:02 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Whoops! That was the test.php.</p>
<p>Here is the srv.php</p>
<p>&lt;?php<br>&#x2F;&#x2F; Connect to the database(host, username, password)<br>$con = mysql_connect(&#39;76.162.254.157&#39;,&#39;transil_tony&#39;,&#39;Tony2014&#39;));<br>if (!$con)<br>{<br>    echo &quot;Failed to make connection.&quot;;<br>    exit;<br>}</p>
<p>&#x2F;&#x2F; Select the database. Enter the name of your database (not the same as the table name)<br>$db = mysql_select_db(&#39;transil_dogplay&#39;);  </p>
<p>if (!$db)<br>{<br>    echo &quot;Failed to select db.&quot;;<br>    exit;<br>}  ;</p>
<p>?&gt;</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 8:24:09 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Change your db password NOW you just published it to a publicly accessible URL.  So right now the entire internet can find it and many are unforgiving pond scum that will take advantage.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:25:11 pm">January 20th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Please repost the test.php again using the code syntax as right now it is hard to work out what is a comment and what is code.</p>
<p>Use 3 <strong>~</strong> on a separate line above the code and again below the line! you code should be in a block like this;</p>
<pre><code class="hljs"><span class="hljs-comment">// comment</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"something"</span>;
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:30:21 pm">January 20th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Malcolm,  Thank you I did notice that and deleted the user.  Much appreciated.  Quick question as I was reviewing code - the settings.js file has a bunch of oracle.file (ie, oracle.friends = [];).</p>
<p>Is the oracle a standard code or is this hosting dependent?</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:31:11 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
						<li class="comment">
							<div><pre><code class="hljs"><span class="php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-keyword">include</span> <span class="hljs-string">'srv.php'</span>;    <span class="hljs-comment">//Contains the conneciton info</span>

<span class="hljs-comment">// ------------------</span>
    <span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'password'</span>];
    <span class="hljs-variable">$email</span>      = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">'email'</span>]; 
    <span class="hljs-comment">//Let's make it all lowercase</span>
    <span class="hljs-variable">$email</span>      = strtolower(<span class="hljs-variable">$email</span>);

<span class="hljs-comment">// Select eveything from the users table where username field == the username we posted and password field == the password we posted</span>
<span class="hljs-variable">$sql</span> = <span class="hljs-string">"SELECT * FROM users"</span>;
<span class="hljs-variable">$query</span> = mysql_query(<span class="hljs-variable">$sql</span>);

<span class="hljs-comment">// If we find a match, create an array of data, json_encode it and echo it out</span>
<span class="hljs-keyword">if</span> (mysql_num_rows(<span class="hljs-variable">$query</span>) &gt; <span class="hljs-number">0</span>)
{
    <span class="hljs-variable">$row</span> = mysql_fetch_array(<span class="hljs-variable">$query</span>);
    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-comment">//Returned elements</span>
        <span class="hljs-string">'logged'</span> =&gt; <span class="hljs-keyword">true</span>,
        <span class="hljs-string">'name'</span> =&gt; <span class="hljs-variable">$row</span>[<span class="hljs-string">'name'</span>],
        <span class="hljs-string">'email'</span> =&gt; <span class="hljs-variable">$row</span>[<span class="hljs-string">'email'</span>],
        <span class="hljs-string">'info'</span> =&gt; <span class="hljs-variable">$row</span>[<span class="hljs-string">'info'</span>]
    );
    <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-comment">// Else the username and/or password was invalid! Create an array, json_encode it and echo it out</span>
    <span class="hljs-variable">$response</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'logged'</span> =&gt; <span class="hljs-keyword">false</span>,
        <span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'No good'</span>
    );
    <span class="hljs-keyword">echo</span> json_encode(<span class="hljs-variable">$response</span>);

}
<span class="hljs-preprocessor">?&gt;</span></span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:34:41 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Re oracle, unknown.  Whilst oracle is a database it is typically used in much larger solutions and less likely in the js file.  I would need more context to understand this more.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:37:46 pm">January 20th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Malcolm,</p>
<p>The app has a settings.js file that has many lines that begin with oracle.</p>
<p>I would be happy to share the entire code with you privately.</p>
<p>What is the most frustrating is the app appeared to work when the original developers were demoing it.  And, now since they didn&#39;t backup&#x2F;export the db and I had to build a new one. I can&#39;t get it to function.</p>
<p>Thank you,<br>Darrell</p>
<p>What I feel I need is someone who is an expert who can mentor me through the project or take it over.  The end client is getting anxious.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 20th 2014, 9:44:01 pm">January 20th 2014</span>
								by <span class='authorname'>Darrell Ritchie</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-274167">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>First off it is a perception thing - your app is NOT connecting to the mysql database on the remote server - it will be connecting via apis that were either grabbed from a pre-rolled service or made specifically for the app.  Whilst the later is more common your use of the phrase &quot;google api&quot; makes me wonder.</p>
<p>The problem with login&#x2F;register can only be in two places;</p>
<ul>
<li>The server side php code has a problem - you can and SHOULD test this from a web browser even if you have to create a web form to post the values to the respective APIs.  Once this has been found to be working you move on the the other potential issue.</li>
<li>The app is not sending the correct parameters to the API - these should be the same ones you tested and confirmed as working in the first point.</li>
</ul>
<p>Remember that APIs are simply server side scripts that take parameters (optional), perform and action on the database (or other generic action) and return some sort of data; success or failure of action or the data requested.</p>
<p>Your app NEVER actually connects to the database as constant connections via network devices - particularly mobile devices cannot guarantee stable connections and nor should they be expected to.</p>
<p>So all you are ever doing is calling a web page and returning data - just not HTML data.  Ideally you return json or if you like spending time pointlessly - xml.</p>
<p>You have a login&#x2F;register routine - if this is a simple in-house db lookup then this should be quick to resolve and easy to test.  If however the google api you are referring to relates to some google service to handle the authentication - then you are best looking up a web site orientated Q&amp;A&#x2F;forum as the problem will be on the server side and not the app side.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 20th 2014, 7:24:23 pm">January 20th 2014</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/161739/connecting-to-mysql-database#answer-274167" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>You test.php file suggests that the db select statement requests the row that matches the email and password - but the following line simply returns every single row in the table and perform zero checking;</p>
<pre><code class="hljs"><span class="hljs-variable">$sql</span> = <span class="hljs-string">"SELECT * FROM users"</span>;
</code></pre><p>This should have both the email and password columns in the select statement and the returned JSON should not be an array as the matching result should be zero or one - never more - at least as long as you database has some sensible integrity.</p>
<pre><code class="hljs">// something like this
$sql = "<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">where</span> <span class="hljs-string">`email`</span>=$email <span class="hljs-keyword">and</span> <span class="hljs-string">`pass`</span>=$pass;</span>";
</code></pre><p>Having reread the php I notice the array is a single element which should work, but the lack of where clauses mean the JSON returned data will almost certainly be more than one record - so the JSON returned will not successfully get parsed as valid.</p>
<p>Make the tweak and it &quot;should&quot; work as long as you test the column names etc,</p>
<p>Test in a web browser and then use <a href="http:&#x2F;&#x2F;jsonlint.com&#x2F;">jsonlint.com</a> to validate the entire response if it validates your app should also work as long as the httpClient request posts two params.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 20th 2014, 9:49:30 pm">January 20th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Send me  a <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;devlink&#x2F;profile&#x2F;427941&#x2F;malcolm-hollingsworth">DevLink</a> email with the settings file you spoke about and I will take a quick look.</p>
<p>I will take a look first thing tomorrow - gone midnight here in the UK.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 20th 2014, 10:20:10 pm">January 20th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>It looks like the settings file reference to <em>oracle</em> is no more than a parent object name and could have been called <em>settings*</em> just as easily.</p>
<p>The references to APNS and GCM UID refer to push notification id values with the first being Apple and the second being Android.</p>
<p>Whilst I am known as <a href="http:&#x2F;&#x2F;twitter.com&#x2F;MalcTheOracle">MalcTheOracle</a> this oracle is not as cool!</p>
<p>BTW please follow up in the answer (here) now rather than the question (above).</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 21st 2014, 8:33:20 am">January 21st 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Final got most of it running.</p>
<p>Here is what it was…</p>
<p>The settings file needed to have the appropriate web server url and folder added.  Which required adding a web server for to hold the php folder.  </p>
<p>First go around with something new always is  challenging.  Then you find the answers and it seems so easy.</p>
<p>Malcolm, thank you once again.  I learned a lot along the way.</p>
<p>Darrell</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 22nd 2014, 11:30:46 pm">January 22nd 2014</span>
											by <span class='authorname'>Darrell Ritchie</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I did not notice your &quot;answer&quot; from yesterday as it was not a comment to this answer or attached to your original question.</p>
<p>So is this question now answered? If so excellent news, and do not forget to mark it as such.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 23rd 2014, 5:01:59 am">January 23rd 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You forgot to mark the question as having been answered - you simply closed it instead.</p>
<p>This information is helpful to the community and when it is shown as a green answered question it shows that the provided information helped solve the problem.</p>
<p>If you are not sure how let me know I will help you.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 24th 2014, 8:29:14 am">January 24th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>How do I mark it as answered?</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2014, 4:07:41 pm">January 26th 2014</span>
											by <span class='authorname'>Darrell Ritchie</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Go to this question in <strong>My Q&amp;A</strong>, then look down to find this answer and see a blue button with &quot;<strong>mark as best answer</strong>&quot; click that one.</p>
<p>That should do it ;-)</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2014, 4:38:20 pm">January 26th 2014</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Ok - thanks.   I just posted a question about &quot;Compare Alloy compare to Titanium Classic &quot;and would love your input.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2014, 4:41:48 pm">January 26th 2014</span>
											by <span class='authorname'>Darrell Ritchie</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>&quot;Compare Alloy to Titanium Classic&quot;  is the question title.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 26th 2014, 4:43:06 pm">January 26th 2014</span>
											by <span class='authorname'>Darrell Ritchie</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-274217">
				
						<section>
							<p>Malcolm,  Thank you.</p>
<p>Here  is what I have found out so far…</p>
<p>The login_ctrl.js file is set to trigger function to get php to call db and return results -  however it isn&#39;t working?<br>Here is some code snippets showing of the login function.</p>
<p>login_ctrl.js</p>
<pre><code class="hljs">login_page.fn_login = function(){
    login_ctrl.loginReq.open (<span class="hljs-string">'POST'</span>, oracle.server_usr_auth);
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">params</span> = {
        email : login_page.tf_login_email.<span class="hljs-keyword">value</span>,
        password : login_page.tf_login_pw.<span class="hljs-keyword">value</span>
    };
    login_ctrl.loginReq.send(<span class="hljs-keyword">params</span>);
    anim.show_activity(login_page.win);
    <span class="hljs-comment">//And now we wait.</span>
</code></pre><p>settings.js</p>
<pre><code class="hljs">oracle.server_ppl_here     = 'http://<span class="hljs-number">76.162.254.151</span>/scripts/map/ppl_here.php'<span class="hljs-comment">;</span>
oracle.server_usr_reg     = 'http://<span class="hljs-number">76.162.254.151</span>/scripts/post_reg.php'<span class="hljs-comment">;</span>
oracle.server_usr_auth     = 'http://<span class="hljs-number">76.162.254.151</span>/scripts/post_auth.php'<span class="hljs-comment">;</span>
</code></pre><p>Where is the hangup?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 21st 2014, 7:18:57 pm">January 21st 2014</span>
								by <span class='authorname'>Darrell Ritchie</span><br>
								<a class="icon-bg icon-link" href="question/161739/connecting-to-mysql-database#answer-274217" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
