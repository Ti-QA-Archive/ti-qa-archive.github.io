<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>JSON.stringify is not working in android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>JSON.stringify is not working in android</h1>
		</header>
		<section>
			<p>JSON.stringify is not working in android and for iphone its work fine . i am converting an array to  json string using JSON.stringify to convert the array to string .so i can send this json string data to service were the the data has been manipulated .on iphone the data is properly received by the service but in android the service is not able to receive the data.</p>
<pre><code class="hljs">
<span class="hljs-comment">// 'mainSurveyAnsArray' this is an multidimensional array which i am converting it to string </span>

JSONArray[<span class="hljs-string">'survey_status'</span>] = <span class="hljs-number">0</span>;
JSONArray[<span class="hljs-string">'data'</span>] = mainSurveyAnsArray;
<span class="hljs-keyword">var</span> xmlhttp_ans = Ti.Network.createHTTPClient();
<span class="hljs-keyword">var</span> surveyPost = <span class="hljs-built_in">JSON</span>.stringify(JSONArray);
<span class="hljs-keyword">var</span> surveyPostTest = <span class="hljs-built_in">JSON</span>.parse(surveyPost);

xmlhttp_ans.open(<span class="hljs-string">'POST'</span>, Ti.App.Properties.getString(<span class="hljs-string">'appURL'</span>)+<span class="hljs-string">'sync-answer-service.php'</span>,<span class="hljs-literal">true</span>);
xmlhttp_ans.setRequestHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);
xmlhttp_ans.setRequestHeader(<span class="hljs-string">'charset'</span>,<span class="hljs-string">'utf-8'</span>);

xmlhttp_ans.send({surveyData:<span class="hljs-built_in">JSON</span>.stringify(JSONArray)});
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="December 23rd 2013, 9:52:35 am">December 23rd 2013</span>
				by <span class='authorname'>Zahir Wallani</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>json.stringify</span></li>
					
						<li><span class='tagname'>stringify</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>what you are getting… i mean which error are you getting?</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 23rd 2013, 11:41:01 am">December 23rd 2013</span>
								by <span class='authorname'>Mitul Bhalia</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>its not giving any error. i am not able to send json data. a blank post has been send</p>
</div>
							<div class="author">
								&mdash; commented <span title="December 24th 2013, 7:03:44 am">December 24th 2013</span>
								by <span class='authorname'>Zahir Wallani</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-272930">
				
						<section>
							<p>You may want to post a sample of your data and the error you are getting.  I just ran the following app.js with random junk in an array, and it runs as expected on both android and iOS.</p>
<pre><code class="hljs"><span class="hljs-atom">var</span> <span class="hljs-atom">obj</span> = [
    [<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>,<span class="hljs-string">"c"</span>],
    [<span class="hljs-string">"d"</span>,<span class="hljs-string">"e"</span>,<span class="hljs-string">"f"</span>],
    {<span class="hljs-string">"hello"</span>:<span class="hljs-string">"world"</span>},
    <span class="hljs-number">200</span>,
    <span class="hljs-string">"test"</span>
];
<span class="hljs-atom">alert</span>(<span class="hljs-name">JSON</span>.<span class="hljs-atom">stringify</span>(<span class="hljs-atom">obj</span>));
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 23rd 2013, 11:58:37 am">December 23rd 2013</span>
								by <span class='authorname'>Mahlon Gumbs</span><br>
								<a class="icon-bg icon-link" href="question/160758/jsonstringify-is-not-working-in-android.html#answer-272930" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>i am using the above code creating an JSONArray = {} with  stdClass Object then parsing it with  JSON.stringify(JSONArray); and sending it to service in json format .but its work fine in ios but breaking on android.<br>So after JSON.stringify(JSONArray)  i got different data in ios and android.in android json data breaks . the data is not send completly</p>
<pre><code class="hljs">
<span class="hljs-keyword">var</span> JSONArray = {};
<span class="hljs-keyword">var</span> mainSurveyAnsArray = {};
<span class="hljs-keyword">var</span> rows_open_dropdown_sync = db_sync.execute(<span class="hljs-string">"SELECT * FROM open_dropdown_ans where a_s_id = "</span>+sur_ans_id);
<span class="hljs-keyword">var</span> sur_open_dropdown_ans_count = rows_open_dropdown_sync.rowCount;
<span class="hljs-keyword">var</span> surveyOpendropdownArray = {};
<span class="hljs-keyword">var</span> open_dropdown_i=<span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (rows_open_dropdown_sync.isValidRow()){

<span class="hljs-keyword">var</span> surveyOpendropdownAnsArray = {};
surveyOpendropdownAnsArray[<span class="hljs-string">'a_od_id'</span>] = rows_open_dropdown_sync.fieldByName(<span class="hljs-string">'a_od_id'</span>);
surveyOpendropdownAnsArray[<span class="hljs-string">'a_s_id'</span>] = rows_open_dropdown_sync.fieldByName(<span class="hljs-string">'a_s_id'</span>);
surveyOpendropdownAnsArray[<span class="hljs-string">'s_id'</span>] = rows_open_dropdown_sync.fieldByName(<span class="hljs-string">'s_id'</span>);
surveyOpendropdownAnsArray[<span class="hljs-string">'od_id'</span>] = rows_open_dropdown_sync.fieldByName(<span class="hljs-string">'od_id'</span>);
surveyOpendropdownAnsArray[<span class="hljs-string">'odo_id'</span>] = rows_open_dropdown_sync.fieldByName(<span class="hljs-string">'odo_id'</span>);
surveyOpendropdownArray[open_dropdown_i]=surveyOpendropdownAnsArray;
surveyOpendropdownAnsArray =<span class="hljs-literal">null</span>;

open_dropdown_i++;
rows_open_dropdown_sync.next();
}

surveyAnsTypeArray[<span class="hljs-string">'open_dropdown'</span>] = surveyOpendropdownArray;
surveyOpendropdownArray = <span class="hljs-literal">null</span>;


surveyAnsDataArray[<span class="hljs-string">'survey_data'</span>] = surveyAnsArray;
surveyAnsDataArray[<span class="hljs-string">'survey_ans_data'</span>] = surveyAnsTypeArray;
mainSurveyAnsArray[sur_i]=surveyAnsDataArray;

JSONArray[<span class="hljs-string">'survey_status'</span>] = <span class="hljs-number">0</span>;
JSONArray[<span class="hljs-string">'data'</span>] = mainSurveyAnsArray;

<span class="hljs-keyword">var</span> xmlhttp_ans = Ti.Network.createHTTPClient();
<span class="hljs-keyword">var</span> surveyPost = <span class="hljs-built_in">JSON</span>.stringify(JSONArray);
<span class="hljs-keyword">var</span> surveyPostTest = <span class="hljs-built_in">JSON</span>.parse(surveyPost);

xmlhttp_ans.open(<span class="hljs-string">'POST'</span>, Ti.App.Properties.getString(<span class="hljs-string">'appURL'</span>)+<span class="hljs-string">'sync-answer-service.php'</span>,<span class="hljs-literal">true</span>);


<span class="hljs-keyword">if</span>(isAndroid){

<span class="hljs-keyword">var</span> androidUserAgent = <span class="hljs-string">'Mozilla/5.0 (Linux; U; '</span> + Ti.Platform.name + <span class="hljs-string">' '</span> + Ti.Platform.version + <span class="hljs-string">'; '</span> + Ti.Locale.currentLocale + <span class="hljs-string">'; '</span> + Ti.Platform.model + <span class="hljs-string">' AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'</span>;
    xmlhttp_ans.setRequestHeader(<span class="hljs-string">'User-Agent'</span>, androidUserAgent);

}<span class="hljs-keyword">else</span>{
    xmlhttp_ans.setRequestHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);
    xmlhttp_ans.setRequestHeader(<span class="hljs-string">'charset'</span>,<span class="hljs-string">'utf-8'</span>);
}
<span class="hljs-comment">//xmlhttp_ans.send({surveyData:'good'});</span>
xmlhttp_ans.send({surveyData:<span class="hljs-built_in">JSON</span>.stringify(JSONArray)});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 24th 2013, 5:41:10 am">December 24th 2013</span>
											by <span class='authorname'>Zahir Wallani</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Your post suggest you believe JSON.stringify is not working. Can we eliminate that by confirming the content of JSONArray via <code>Ti.API.info(JSON.stringify(JSONArray));</code>?  Lets just make sure you have the data you believe you have.</p>
<p>Second, did you really mean to only set the content-type to application&#x2F;json if <strong>NOT</strong> running on android? If not, perhaps what you meant to have is the following:</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span> (isAndroid) {
    <span class="hljs-keyword">var</span> androidUserAgent = <span class="hljs-string">'Mozilla/5.0 (Linux; U; '</span> + Ti.Platform.name + <span class="hljs-string">' '</span> + Ti.Platform.version + <span class="hljs-string">'; '</span> + Ti.Locale.currentLocale + <span class="hljs-string">'; '</span> + Ti.Platform.model + <span class="hljs-string">' AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'</span>;
    xmlhttp_ans.setRequestHeader(<span class="hljs-string">'User-Agent'</span>, androidUserAgent);

}
xmlhttp_ans.setRequestHeader(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);
xmlhttp_ans.setRequestHeader(<span class="hljs-string">'charset'</span>, <span class="hljs-string">'utf-8'</span>);
xmlhttp_ans.send({surveyData:<span class="hljs-built_in">JSON</span>.stringify(JSONArray)});
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="December 24th 2013, 10:37:59 am">December 24th 2013</span>
											by <span class='authorname'>Mahlon Gumbs</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
