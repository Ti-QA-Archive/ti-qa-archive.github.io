<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Paypal module with Alloy framework Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Paypal module with Alloy framework</h1>
		</header>
		<section>
			<p>Hi All,</p>
<p>Are there any examples of using the Paypal module with the Alloy framework? I know that an example is provided with the paypal module that has the .js component but it would be great to get the whole end-to-end MVC view (i.e. .js, .tss and .xml)</p>
<p>Thanks in advance.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 3rd 2013, 9:08:48 am">November 3rd 2013</span>
				by <span class='authorname'>Nick Savas</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>module</span></li>
					
						<li><span class='tagname'>mvc</span></li>
					
						<li><span class='tagname'>paypal</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-270800">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>As you will note from the example code for the PayPal module, there are no standard UI views or buttons.  Due to this; the code to invoke the PayPal UI is done entirely in the controller - so the code will be identical.</p>
<p>Whilst some of the more detailed examples include status buttons - they are nothing more complicated than standard buttons - these you can achieve using standard Alloy Views and TSS as needed - but again very standard things.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 3rd 2013, 9:34:33 am">November 3rd 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/159064/paypal-module-with-alloy-framework#answer-270800" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>You must remember that Alloy is an MVC model and not a new language so you can use the PayPal code almost exactly as it is.</p>
<ul>
<li><a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules&#x2F;blob&#x2F;master&#x2F;paypal&#x2F;mobile&#x2F;ios&#x2F;example&#x2F;simple.js">Simple Example</a></li>
</ul>
<p>However if you wanted to go to a little trouble then this is a quick way to swap things over - I have not tested this code but is should be fine.</p>
<p><strong>index.js</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"status"</span>&gt;</span>Loading, please wait...<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonhole"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre><p><strong>index.tss</strong></p>
<pre><code class="hljs">"<span class="hljs-tag">Window</span>": <span class="hljs-rules">{
}</span>,
"<span class="hljs-tag">Label</span>": <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">color</span>:<span class="hljs-value"> <span class="hljs-string">'#333'</span>,
    height: <span class="hljs-number">45</span>,
    top: <span class="hljs-number">50</span>
</span></span></span>},
"<span class="hljs-id">#buttonhole</span>": <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">50</span>,
    top: <span class="hljs-number">100</span>
</span></span></span>}
</code></pre><p><strong>index.js</strong></p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> Paypal = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.paypal'</span>);

<span class="hljs-keyword">var</span> button;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addButtonToWindow</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (button) {
        $.buttonhole.remove(button);
        button = <span class="hljs-literal">null</span>;
    }
    button = Paypal.createPaypalButton({
        <span class="hljs-comment">// <span class="hljs-doctag">NOTE:</span> height/width only determine the size of the view that the button is embedded in - the actual button size</span>
        <span class="hljs-comment">// is determined by the buttonStyle property!</span>
        width: <span class="hljs-number">194</span>,
        height: <span class="hljs-number">37</span>,
        buttonStyle: Paypal.BUTTON_194x37, <span class="hljs-comment">// The style &amp; size of the button</span>
        bottom: <span class="hljs-number">50</span>,
        language: <span class="hljs-string">'en_US'</span>,
        textStyle: Paypal.PAYPAL_TEXT_DONATE, <span class="hljs-comment">// Causes the button's text to change from "Pay" to "Donate"</span>
        appID: <span class="hljs-string">'&lt;&lt;&lt;YOUR APP ID HERE&gt;&gt;&gt;'</span>, <span class="hljs-comment">// The appID issued by Paypal for your application; for testing, feel free to delete this property entirely.</span>
        paypalEnvironment: Paypal.PAYPAL_ENV_SANDBOX, <span class="hljs-comment">// Sandbox, None or Live</span>
        feePaidByReceiver: <span class="hljs-literal">false</span>,
        enableShipping: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Whether or not to select/send shipping information</span>
        payment: { <span class="hljs-comment">// The payment itself</span>
            paymentType: Paypal.PAYMENT_TYPE_SERVICE, <span class="hljs-comment">// The type of payment</span>
            subtotal: <span class="hljs-number">10</span>, <span class="hljs-comment">// The total cost of the order, excluding tax and shipping</span>
            tax: <span class="hljs-number">0</span>,
            shipping: <span class="hljs-number">0</span>,
            currency: <span class="hljs-string">'USD'</span>,
            recipient: <span class="hljs-string">'&lt;&lt;&lt;YOUR RECIPIENT HERE&gt;&gt;&gt;'</span>,
            customID: <span class="hljs-string">'anythingYouWant'</span>,
            invoiceItems: [
                { name: <span class="hljs-string">'Shoes'</span>, totalPrice: <span class="hljs-number">8</span>, itemPrice: <span class="hljs-number">2</span>, itemCount: <span class="hljs-number">4</span> },
                { name: <span class="hljs-string">'Hats'</span>, totalPrice: <span class="hljs-number">2</span>, itemPrice: <span class="hljs-number">0.5</span>, itemCount: <span class="hljs-number">4</span> }
            ],
            ipnUrl: <span class="hljs-string">'http://www.appcelerator.com/'</span>,
            merchantName: <span class="hljs-string">'Dev Tools'</span>,
            memo: <span class="hljs-string">'For the orphans and widows in the world!'</span>
        }
    });

    <span class="hljs-comment">// Events available</span>
    button.addEventListener(<span class="hljs-string">'paymentCancelled'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        $.status.text = <span class="hljs-string">'Payment Cancelled.'</span>;
        <span class="hljs-comment">// The button should only be used once; so after a payment is cancelled, succeeds, or errors, we must redisplay it.</span>
        addButtonToWindow();
    });
    button.addEventListener(<span class="hljs-string">'paymentSuccess'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        $.status.text = <span class="hljs-string">'Payment Success.  TransactionID: '</span> + e.transactionID + <span class="hljs-string">', Reloading...'</span>;
        <span class="hljs-comment">// The button should only be used once; so after a payment is cancelled, succeeds, or errors, we must redisplay it.</span>
        addButtonToWindow();
    });
    button.addEventListener(<span class="hljs-string">'paymentError'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        $.status.text = <span class="hljs-string">'Payment Error,  errorCode: '</span> + e.errorCode + <span class="hljs-string">', errorMessage: '</span> + e.errorMessage;
        <span class="hljs-comment">// The button should only be used once; so after a payment is cancelled, succeeds, or errors, we must redisplay it.</span>
        addButtonToWindow();
    });

    button.addEventListener(<span class="hljs-string">'buttonDisplayed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        $.status.text = <span class="hljs-string">'The button was displayed!'</span>;
    });
    button.addEventListener(<span class="hljs-string">'buttonError'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        $.status.text = <span class="hljs-string">'The button failed to display!'</span>;
    });
    $.buttonhole.add(button);
}
addButtonToWindow();
$.index.open();
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2013, 3:26:28 pm">November 3rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I incorrectly entered the file name for the xml as <strong>index.js</strong> this should have been <strong>index.xml</strong>.</p>
<p>For clarity the revised block is as follows;</p>
<p><strong>index.xml</strong></p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Alloy</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">Window</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">Label</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"status"</span>&gt;</span>Loading, please wait...<span class="hljs-tag">&lt;/<span class="hljs-title">Label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">View</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonhole"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">Window</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">Alloy</span>&gt;</span>
</code></pre></p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2013, 3:27:40 pm">November 3rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you Malcolm - will give it a go</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2013, 7:03:06 pm">November 3rd 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That was great - thank you Malcolm. One other question I did have that confuses me is the content of my index.js.</p>
<p>I currently have other code in my index.js and I have &#39;$.index.open();&#39;, when I added the above paypaypal block there was another $.index.open();. I would have thought having multiple occurrences of these would fail.</p>
<p>Could you explain how multiple $.index.open(); work in index.js? They are outside any function so I don&#39;t get when $.index.open(); gets invoked during the execution of the app.</p>
<p>Hope I am making sense here - thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 4th 2013, 8:25:51 am">November 4th 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You only need one <strong>$.index.open()</strong>, the code above was designed to be stand-alone - so take what you need and leave anything else.</p>
<p>Also there is no need to place this in the index file, you can put it anywhere - I just used the <strong>index.js&#x2F;xml&#x2F;tss</strong> names for examples.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 4th 2013, 8:28:41 am">November 4th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Right I see. I don&#39;t fully understand how that works.</p>
<p>Can I reference this <code>View id=buttonhole</code> in index.xml but have the paypal block code in a file called paypal.js? I just tried it and it didn&#39;t seem to work. Do I need to keep the naming convention as paypal.js&#x2F;xml&#x2F;tss?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 4th 2013, 8:51:23 am">November 4th 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The only reason that I created an empty view with the id <strong>buttonhole</strong> is you need to add the <strong>PayPal</strong> button to the window you use it one somewhere.  How you choose to do this and where is entirely up to you.  I did it so it appeared in a specific place and that place was defined inside the xml &amp; tss files.</p>
<p>If you have a controller named <strong>paypal.js</strong> then you should use either the example I gave of <strong>buttonhole</strong> or something you prefer in THIS controller.  Remember this is only used to give the custom PayPal button somewhere easy to be placed.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 4th 2013, 9:01:26 am">November 4th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Malcolm,<br>Thank you. I understand this now and have modified my code to the following: </p>
<pre><code class="hljs"><span class="hljs-tag">&lt;<span class="hljs-title">Button</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonhole"</span> <span class="hljs-attribute">onClick</span>=<span class="hljs-value">"xxx"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">Button</span>&gt;</span>`
</code></pre><p>I have just realised that the code provided is simply code to display the paypal button in the app, once i click on this button I would then like to actually trigger the paypal transaction wizard, thus I suspect that I would need to add the appropriate function in the xxx section above?</p>
<p>Am I on the right track here or not?</p>
<p>I have assumed that this paypal module once added to your app will provide a wizard process of executing a transaction with a paypal log in screen and then confirmation of address and then submit of transaction - Is this a fair assumption?</p>
<p>Thanks,<br>Nick</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 6th 2013, 7:42:20 am">November 6th 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Please do not use <strong>button</strong> to contain the custom button.  As the custom button is added to something (so you can determine its location it need to be placed inside a container.  A container is a view that is designed to accept child views.  A button is not one of these.</p>
<p>Basically do not add a button to another button as a button is not a container.  Whilst this will work on iOS you will get different results on other platforms - and better you start as you mean to go on rather than suffer one of those annoying bugs that just will not make sense in the future.</p>
<p>The example I gave you is the simple one - as stated in the link.  There are more detailed examples in the same location.</p>
<ul>
<li><a href="https:&#x2F;&#x2F;github.com&#x2F;appcelerator&#x2F;titanium_modules&#x2F;tree&#x2F;master&#x2F;paypal&#x2F;mobile&#x2F;ios&#x2F;example">All Examples</a></li>
</ul>
<p>The are not written specifically for Alloy, but if you check out the simple example and how I changed it with only a handful of tweaks you will easily understand how to do the same with other examples.</p>
<p>Plus it will give you a great opportunity to learn the subtle differences and better understand what the code actually does.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 9th 2013, 4:33:39 pm">November 9th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Hi Malcolm,</p>
<p>Ok - so the button is displaying correctly however, when I click it the application crashes after around 5-10 seconds with this error:</p>
<pre><code class="hljs">[<span class="hljs-keyword">ERROR</span>] :  An <span class="hljs-keyword">error</span> occurred running the iOS Simulator
[<span class="hljs-keyword">ERROR</span>] :  [DEBUG] <span class="hljs-keyword">using</span> retina iphone retina ios <span class="hljs-number">7</span>
[<span class="hljs-keyword">ERROR</span>] :  
[<span class="hljs-keyword">ERROR</span>] :  Project failed <span class="hljs-keyword">to</span> build after <span class="hljs-number">51</span>s <span class="hljs-number">861</span>ms
</code></pre><p>Do you think this is because my parameter settings are incorrect? I do not have a developer paypal account or anything like that, I have simply retained the majority of the parameter settings from the simple.js example.</p>
<p>Thanks,<br>Nick</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 15th 2013, 9:41:39 pm">November 15th 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-270814">
				
						<section>
							<p>I am new to alloy and have only done a few sample Apps, could you show how to integrate this code into an alloy app?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 3rd 2013, 3:11:59 pm">November 3rd 2013</span>
								by <span class='authorname'>Nick Savas</span><br>
								<a class="icon-bg icon-link" href="question/159064/paypal-module-with-alloy-framework#answer-270814" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Quick tip; next time - please do not create a new answer when your contribution is actually a comment - it confuses things in the future when trying to work out relevance.  You are NOT being told off.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2013, 3:28:12 pm">November 3rd 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Oops - sorry about that!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2013, 7:02:17 pm">November 3rd 2013</span>
											by <span class='authorname'>Nick Savas</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
