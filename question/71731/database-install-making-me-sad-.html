<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Database Install Making Me Sad :( » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Database Install Making Me Sad :(</h1>
		</header>
		<section>
			<p>Hi all, first let me start by saying any help is GREATLY appreciated!  I have been struggling for a good while trying to get a demo database connection made in my test app…  The app will load with no problems but the minute I try to query the database or write out the variable contents it kills the app and goes back to the home screen.  When I run the following code the console will render the code with no problems or errors and the app will load and immediately exit…</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win = Titanium.UI.currentWindow;

<span class="hljs-keyword">var</span> db = Titanium.Database.install(<span class="hljs-string">'../testdb.db'</span>,<span class="hljs-string">'testdb'</span>);

<span class="hljs-keyword">var</span> rows = db.execute(<span class="hljs-string">'SELECT tip FROM TIPS WHERE rowid=1'</span>);

<span class="hljs-comment">// close database</span>
rows.close();

win.<span class="hljs-keyword">add</span>(rows);

Ti.UI.currentWindow.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span><span class="hljs-comment">{Titanium.UI.currentWindow.close();}</span>);</span>
</code></pre><p>Also, the console debug code looks like the following note the lines towards the end with &quot;session did end with error (null)&quot;, I read a few others having issues with a similar comment but all efforts have failed…</p>
<pre><code class="hljs">[INFO] Compiling JavaScript...one moment
[INFO] No JavaScript errors detected.
[INFO] One moment, building ...
[INFO] Titanium SDK <span class="hljs-string">version:</span> <span class="hljs-number">1.4</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>
[INFO] iPhone Device <span class="hljs-string">family:</span> iphone
[INFO] iPhone SDK <span class="hljs-string">version:</span> <span class="hljs-number">4.1</span>
[DEBUG] executing <span class="hljs-string">command:</span> <span class="hljs-regexp">/usr/</span>bin/killall iPhone Simulator
[DEBUG] No matching processes belonging to you were found
[DEBUG] finding old log files
[DEBUG] executing <span class="hljs-string">command:</span> mdfind -onlyin <span class="hljs-regexp">/Users/</span>chris<span class="hljs-regexp">/Library/</span>Application Support<span class="hljs-regexp">/iPhone Simulator/</span><span class="hljs-number">4.1</span> -name a937089a-d853-<span class="hljs-number">49</span>ac-be16-<span class="hljs-number">5</span>be374402318.log
[DEBUG] <span class="hljs-regexp">/Users/</span>chris<span class="hljs-regexp">/Library/</span>Application Support<span class="hljs-regexp">/iPhone Simulator/</span><span class="hljs-number">4.1</span><span class="hljs-regexp">/Applications/</span><span class="hljs-number">400617</span>D5-<span class="hljs-number">861</span>A-<span class="hljs-number">4651</span>-<span class="hljs-number">9454</span>-DDA345421E87<span class="hljs-regexp">/Documents/</span>a937089a-d853-<span class="hljs-number">49</span>ac-be16-<span class="hljs-number">5</span>be374402318.log
[DEBUG] removing old log <span class="hljs-string">file:</span> <span class="hljs-regexp">/Users/</span>chris<span class="hljs-regexp">/Library/</span>Application Support<span class="hljs-regexp">/iPhone Simulator/</span><span class="hljs-number">4.1</span><span class="hljs-regexp">/Applications/</span><span class="hljs-number">400617</span>D5-<span class="hljs-number">861</span>A-<span class="hljs-number">4651</span>-<span class="hljs-number">9454</span>-DDA345421E87<span class="hljs-regexp">/Documents/</span>a937089a-d853-<span class="hljs-number">49</span>ac-be16-<span class="hljs-number">5</span>be374402318.log
[INFO] Launching application <span class="hljs-keyword">in</span> Simulator
[DEBUG] App <span class="hljs-string">Spec:</span> &lt;DTiPhoneSimulatorApplicationSpecifier <span class="hljs-number">0x1003024d0</span>&gt; specified by path <span class="hljs-regexp">/Users/</span>chris<span class="hljs-regexp">/Documents/</span>Appcelerator<span class="hljs-regexp">/testdb/</span>build<span class="hljs-regexp">/iphone/</span>build<span class="hljs-regexp">/Debug-iphonesimulator/</span>testdb.app
[DEBUG] SDK <span class="hljs-string">Root:</span> &lt;DTiPhoneSimulatorSystemRoot <span class="hljs-number">0x100301870</span>&gt; path=<span class="hljs-regexp">/Developer/</span>Platforms<span class="hljs-regexp">/iPhoneSimulator.platform/</span>Developer<span class="hljs-regexp">/SDKs/</span>iPhoneSimulator4<span class="hljs-number">.1</span>.sdk version=<span class="hljs-number">4.1</span> name=Simulator - iOS <span class="hljs-number">4.1</span>
[DEBUG] using device family iphone
[INFO] Launched application <span class="hljs-keyword">in</span> Simulator (<span class="hljs-number">1.49</span> seconds)
[DEBUG] Session started
[DEBUG] executing <span class="hljs-string">command:</span> xcodebuild -version
[DEBUG] Session did end with error (<span class="hljs-literal">null</span>)
[INFO] Application has exited from Simulator
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="October 20th 2010, 1:49:38 am">October 20th 2010</span>
				by <span class='authorname'>Chris Givens</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>4</span></li>
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>database</span></li>
					
						<li><span class='tagname'>error</span></li>
					
						<li><span class='tagname'>immediately</span></li>
					
						<li><span class='tagname'>install</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
						<li><span class='tagname'>issue</span></li>
					
						<li><span class='tagname'>mobile</span></li>
					
						<li><span class='tagname'>null</span></li>
					
						<li><span class='tagname'>problem</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-130111">
				
						<section>
							<p>Give this a shot…</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> data = (function() {
    // <span class="hljs-type">Maintain</span> a database connection we can use
    <span class="hljs-keyword">var</span> conn = <span class="hljs-type">Ti</span>.<span class="hljs-type">Database</span>.install('../testdb.db','testdb');

    // <span class="hljs-type">Accepts</span> a variable number <span class="hljs-keyword">of</span> arguments.
    // <span class="hljs-type">The</span> first argument should always be <span class="hljs-type">SQL</span>. <span class="hljs-type">Every</span> subsequent argument <span class="hljs-keyword">is</span> a
    // param to be replaced within the sql.
    function getResults(){
        <span class="hljs-keyword">var</span> <span class="hljs-literal">result</span> = null;
        <span class="hljs-keyword">var</span> results = [];
        <span class="hljs-keyword">var</span> resultSet = <span class="hljs-type">Function</span>.apply.call(conn.execute, conn, arguments);
        <span class="hljs-keyword">while</span> (resultSet.isValidRow()) {
            <span class="hljs-literal">result</span> = {};
            <span class="hljs-keyword">var</span> fieldCount = resultSet.fieldCount();
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;fieldCount; i++){
                <span class="hljs-literal">result</span>[resultSet.fieldName(i)] = resultSet.field(i);
            }
            results.push(<span class="hljs-literal">result</span>);
            resultSet.next();
        }
        resultSet.close();

        <span class="hljs-keyword">return</span> results;
    }

    <span class="hljs-keyword">var</span> api = {};

    // <span class="hljs-type">Get</span> all items <span class="hljs-keyword">from</span> a specific table.
    api.getTip = function(rowId) {
        <span class="hljs-keyword">return</span> getResults('<span class="hljs-type">SELECT</span> tip <span class="hljs-type">FROM</span> tips <span class="hljs-type">WHERE</span> rowid=?', rowId);
    };

    <span class="hljs-keyword">return</span> api;
}());


<span class="hljs-keyword">var</span> tip = data.getTip(<span class="hljs-number">1</span>);

// <span class="hljs-type">Print</span> to console <span class="hljs-keyword">for</span> debug
<span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.info(tip);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 20th 2010, 2:58:38 am">October 20th 2010</span>
								by <span class='authorname'>Bart Lewis</span><br>
								<a class="icon-bg icon-link" href="question/71731/database-install-making-me-sad-#answer-130111" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Bart, thanks for the response I really appreciate the help with this.  I can confirm that your code did allow me to connect to the database without it immediately closing and returning the simulator home-screen.  It accessed the database and logged the appropriate value from the table in the console window.  What I don&#39;t really get is why it was crashing out in the first place.  Was I not properly connecting to the database or doing an improper call to access the data through the SQL statement.  I am just trying to understand for future reference what the real cause of my issue was here…  My ultimate goal with the database is to store pointer file locations for some sound files in the resource directory and have the program read that database and access those file pointers to populate a scrollable table…  So I will need some way to iterate through the database values in that table and present them…  This was my first stab at trying to get a solid understanding of how to work with the database in Titanium…  Again any help you can provide is absolutely appreciated…and I really thank you for providing the code above it has helped me to at least verify that everything can work and that the real issue was apparently within something I was doing as I suspected… :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 21st 2010, 1:27:00 am">October 21st 2010</span>
											by <span class='authorname'>Chris Givens</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sweet.</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 25th 2011, 2:05:16 pm">May 25th 2011</span>
											by <span class='authorname'>Stan Silver</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>2</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-130061">
				
						<section>
							<p>Did you look at this:</p>
<p>http:&#x2F;&#x2F;assets.appcelerator.com.s3.amazonaws.com&#x2F;docs&#x2F;API_DatabaseClass.pdf</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 20th 2010, 1:54:56 am">October 20th 2010</span>
								by <span class='authorname'>Jeffrey Messick</span><br>
								<a class="icon-bg icon-link" href="question/71731/database-install-making-me-sad-#answer-130061" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks for the reply, I did go through that document.  I tried to focus on page 18 and 19 as they were the closest to what I was attempting to accomplish but still the console fails with the same results.  It should be noted that I am using a pre-existing database that is made up of the testdb.db database that is used in the kitchen sink example.  So I am not trying to create a DB on the fly and insert data into it I am just simply trying to install the existing database and read data from it into a variable and utilize that stored value…</p>
</p>
										<div class="author">
											&mdash; commented <span title="October 20th 2010, 2:09:09 am">October 20th 2010</span>
											by <span class='authorname'>Chris Givens</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
