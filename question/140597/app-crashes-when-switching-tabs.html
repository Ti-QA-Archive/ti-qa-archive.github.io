<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>App crashes when switching tabs Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>App crashes when switching tabs</h1>
		</header>
		<section>
			<p>Hi,<br>I have an Android app which has a custom tabbar implemented. When launching it in emulator, switching tabs works fine. There are no errormessages in the log. However, after installing it on my device, switching tabs makes the app crash.</p>
<p>Does anyone have had a similar error or has any ideas where it could come from?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="August 6th 2012, 6:23:20 am">August 6th 2012</span>
				by <span class='authorname'>Martin Golpashin</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>crash</span></li>
					
						<li><span class='tagname'>custom</span></li>
					
						<li><span class='tagname'>tab</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hi Martin Golpashin,</p>
<p>Post your code so we may help you better you may use <a href="http:&#x2F;&#x2F;pastie.org&#x2F;">http:&#x2F;&#x2F;pastie.org&#x2F;</a> for post your code.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 6th 2012, 6:42:49 am">August 6th 2012</span>
								by <span class='authorname'>Nitin Chavda</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I can&#39;t paste my code because there are too many lines of code within a lot of files and I don&#39;t know what could cause the error.<br>Maybe there is a problem in terms of memory</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 6th 2012, 6:59:37 am">August 6th 2012</span>
								by <span class='authorname'>Martin Golpashin</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hi Martin Golpashin,</p>
<p>Don&#39;t post all code just post your tab creation code and in which tab your app crash that file code.</p>
</div>
							<div class="author">
								&mdash; commented <span title="August 6th 2012, 7:01:26 am">August 6th 2012</span>
								by <span class='authorname'>Nitin Chavda</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-244555">
				
						<section>
							<p>So here is the Code that creates the tabbar. my windowobject is a module that implements the singleton-pattern to make it availible in the global scope without using ti.app</p>
<p>I inserted a few alerts to &quot;log&quot; on my device (since the application works fine in the debugger). When switching tabs, I can see that the gradient switches and the app crashes when trying to add the new view. So I thought I could see the alerts until win1.add(activeTab.view); But Somehow, I don&#39;t get any alerts at all</p>
<p>Here is my code</p>
<pre><code class="hljs">var win = require(<span class="hljs-string">'win'</span>)

function tabBar(settings, win1) {
    var win1 = win.getWindow();

    var tabs = <span class="hljs-keyword">new</span> Object();
    var activeTab = <span class="hljs-literal">null</span>;

    function resetActiveTab() {
        <span class="hljs-keyword">if</span> (activeTab != <span class="hljs-literal">null</span>) {
            activeTab.setBackgroundGradient({
                <span class="hljs-string">colors :</span> [<span class="hljs-string">'transparent'</span>, <span class="hljs-string">'transparent'</span>]
            });

            win1.remove(activeTab.view);
        }

    }

    function setActiveTab(tab) {
        <span class="hljs-comment">//remove previous active Tab</span>
        alert(<span class="hljs-string">'reset active tab'</span>)
        resetActiveTab(win1)

        tab.setBackgroundGradient({
            <span class="hljs-string">type :</span> <span class="hljs-string">'linear'</span>,
            <span class="hljs-string">colors :</span> [<span class="hljs-string">'#00b7f0'</span>, <span class="hljs-string">'#1c61bc'</span>],
            <span class="hljs-string">startPoint :</span> {
                <span class="hljs-string">x :</span> <span class="hljs-number">0</span>,
                <span class="hljs-string">y :</span> <span class="hljs-number">0</span>
            },
            <span class="hljs-string">endPoint :</span> {
                <span class="hljs-string">x :</span> <span class="hljs-number">2</span>,
                <span class="hljs-string">y :</span> <span class="hljs-number">50</span>
            },
            <span class="hljs-string">backFillStart :</span> <span class="hljs-literal">false</span>
        });

        activeTab = tab;
        <span class="hljs-comment">//set view of tab on the window</span>
        alert(<span class="hljs-string">'set active tab'</span>)
        win1.add(activeTab.view);

    }

    function addClickEventListener(tabItem) {
        tabItem.addEventListener(<span class="hljs-string">'click'</span>, function(e) {
            alert(<span class="hljs-string">'click'</span>)
            var item = e.source;

            <span class="hljs-comment">//assert that the event doesnt get fired by the label</span>
            <span class="hljs-keyword">if</span> (item.text != <span class="hljs-literal">null</span>) {
                item = item.parent;
            }
            <span class="hljs-keyword">if</span> (item != activeTab) {
                setActiveTab(item);
            }

        });
    };

    <span class="hljs-comment">// Create the container for the tab items</span>
    var tabBar = Ti.UI.createView({
        <span class="hljs-string">height :</span> settings.height,
        <span class="hljs-string">top :</span> <span class="hljs-number">0</span>,
        <span class="hljs-string">width :</span> <span class="hljs-string">'100%'</span>,
        <span class="hljs-string">backgroundGradient :</span> {
            <span class="hljs-string">type :</span> <span class="hljs-string">'linear'</span>,
            <span class="hljs-string">colors :</span> [<span class="hljs-string">'#000001'</span>, <span class="hljs-string">'#666666'</span>],
            <span class="hljs-string">startPoint :</span> {
                <span class="hljs-string">x :</span> <span class="hljs-number">0</span>,
                <span class="hljs-string">y :</span> <span class="hljs-number">0</span>
            },
            <span class="hljs-string">endPoint :</span> {
                <span class="hljs-string">x :</span> <span class="hljs-number">2</span>,
                <span class="hljs-string">y :</span> <span class="hljs-number">50</span>
            },
            <span class="hljs-string">backFillStart :</span> <span class="hljs-literal">false</span>
        },
    });

    <span class="hljs-comment">//calculate width of each item</span>
    var width = <span class="hljs-number">100</span> / settings.items.length;
    <span class="hljs-keyword">for</span> (var i = <span class="hljs-number">0</span>; i &lt; settings.items.length; i++) {
        <span class="hljs-comment">// Go through each item and create an imageView</span>

        <span class="hljs-comment">//calculate distance to left</span>
        var left = width * i

        tabs[i] = Titanium.UI.createView({
            <span class="hljs-string">width :</span> width + <span class="hljs-string">'%'</span>,
            <span class="hljs-string">height :</span> settings.height,
            <span class="hljs-string">left :</span> left + <span class="hljs-string">'%'</span>
        });

        tabs[i].view = settings.items[i].view;
        tabs[i].view.top = settings.height;

        var tmpLabel = Ti.UI.createLabel({
            <span class="hljs-string">text :</span> settings.items[i].title,
            <span class="hljs-string">color :</span> <span class="hljs-string">'white'</span>,
            <span class="hljs-string">visible :</span> <span class="hljs-literal">true</span>,
            <span class="hljs-string">textAlign :</span> Ti.UI.TEXT_ALIGNMENT_CENTER
        })
        tabs[i].add(tmpLabel);

        addClickEventListener(tabs[i]);
        <span class="hljs-comment">// Add to the container window</span>
        tabBar.add(tabs[i]);
    }

    setActiveTab(tabs[<span class="hljs-number">0</span>]);

    <span class="hljs-keyword">return</span> tabBar;
}

module.exports = tabBar
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 6th 2012, 7:10:01 am">August 6th 2012</span>
								by <span class='authorname'>Martin Golpashin</span><br>
								<a class="icon-bg icon-link" href="../../question/140597/app-crashes-when-switching-tabs.html#answer-244555" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>In the function &quot;setActiveTab&quot;, I just replaced resetActiveTab(win1) by alert(&#39;reset active tab&#39;) and win1.add(activeTab.view); by alert(&#39;add active tab&#39;).<br>When running it on my device, I get &quot;add active tab&quot; first, and then &quot;reset active tab&quot;â¦.how could that be??</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 6th 2012, 7:30:58 am">August 6th 2012</span>
											by <span class='authorname'>Martin Golpashin</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>okay this is because both alerts are fired at the same time, so so second one is overlaying the first one</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 6th 2012, 7:51:32 am">August 6th 2012</span>
											by <span class='authorname'>Martin Golpashin</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
