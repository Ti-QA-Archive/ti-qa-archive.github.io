<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Activity Indicator: View Not Attached Crash Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Activity Indicator: View Not Attached Crash</h1>
		</header>
		<section>
			<p>Hi,</p>
<p>While I can&#39;t reproduce it locally, I see some crashes in my Android dev console log with the following trace:</p>
<pre><code class="hljs">java<span class="hljs-class">.lang</span><span class="hljs-class">.IllegalArgumentException</span>: View not attached to window manager
at android<span class="hljs-class">.view</span><span class="hljs-class">.WindowManagerImpl</span><span class="hljs-class">.findViewLocked</span>(WindowManagerImpl<span class="hljs-class">.java</span>:<span class="hljs-number">395</span>)
at android<span class="hljs-class">.view</span><span class="hljs-class">.WindowManagerImpl</span><span class="hljs-class">.removeView</span>(WindowManagerImpl<span class="hljs-class">.java</span>:<span class="hljs-number">239</span>)
at android<span class="hljs-class">.view</span><span class="hljs-class">.Window</span><span class="hljs-variable">$LocalWindowManager</span>.<span class="hljs-function"><span class="hljs-title">removeView</span><span class="hljs-params">(Window.java:<span class="hljs-number">441</span>)</span></span>
at android<span class="hljs-class">.app</span><span class="hljs-class">.Dialog</span><span class="hljs-class">.dismissDialog</span>(Dialog<span class="hljs-class">.java</span>:<span class="hljs-number">306</span>)
at android<span class="hljs-class">.app</span><span class="hljs-class">.Dialog</span><span class="hljs-class">.access</span>$<span class="hljs-number">000</span>(Dialog<span class="hljs-class">.java</span>:<span class="hljs-number">89</span>)
at android<span class="hljs-class">.app</span><span class="hljs-class">.Dialog</span>$<span class="hljs-number">1</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(Dialog.java:<span class="hljs-number">132</span>)</span></span>
at android<span class="hljs-class">.app</span><span class="hljs-class">.Dialog</span><span class="hljs-class">.dismiss</span>(Dialog<span class="hljs-class">.java</span>:<span class="hljs-number">296</span>)
at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.ui</span><span class="hljs-class">.widget</span><span class="hljs-class">.TiUIActivityIndicator</span><span class="hljs-class">.handleHide</span>(TiUIActivityIndicator<span class="hljs-class">.java</span>:<span class="hljs-number">217</span>)
at ti<span class="hljs-class">.modules</span><span class="hljs-class">.titanium</span><span class="hljs-class">.ui</span><span class="hljs-class">.widget</span><span class="hljs-class">.TiUIActivityIndicator</span><span class="hljs-class">.handleMessage</span>(TiUIActivityIndicator<span class="hljs-class">.java</span>:<span class="hljs-number">77</span>)
at android<span class="hljs-class">.os</span><span class="hljs-class">.Handler</span><span class="hljs-class">.dispatchMessage</span>(Handler<span class="hljs-class">.java</span>:<span class="hljs-number">95</span>)
at android<span class="hljs-class">.os</span><span class="hljs-class">.Looper</span><span class="hljs-class">.loop</span>(Looper<span class="hljs-class">.java</span>:<span class="hljs-number">150</span>)
at android<span class="hljs-class">.app</span><span class="hljs-class">.ActivityThread</span><span class="hljs-class">.main</span>(ActivityThread<span class="hljs-class">.java</span>:<span class="hljs-number">4385</span>)
at java<span class="hljs-class">.lang</span><span class="hljs-class">.reflect</span><span class="hljs-class">.Method</span><span class="hljs-class">.invokeNative</span>(Native Method)
at java<span class="hljs-class">.lang</span><span class="hljs-class">.reflect</span><span class="hljs-class">.Method</span><span class="hljs-class">.invoke</span>(Method<span class="hljs-class">.java</span>:<span class="hljs-number">507</span>)
at com<span class="hljs-class">.android</span><span class="hljs-class">.internal</span><span class="hljs-class">.os</span><span class="hljs-class">.ZygoteInit</span><span class="hljs-variable">$MethodAndArgsCaller</span>.<span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">(ZygoteInit.java:<span class="hljs-number">849</span>)</span></span>
at com<span class="hljs-class">.android</span><span class="hljs-class">.internal</span><span class="hljs-class">.os</span><span class="hljs-class">.ZygoteInit</span><span class="hljs-class">.main</span>(ZygoteInit<span class="hljs-class">.java</span>:<span class="hljs-number">607</span>)
at dalvik<span class="hljs-class">.system</span><span class="hljs-class">.NativeStart</span><span class="hljs-class">.main</span>(Native Method)
</code></pre><p>I&#39;m assuming some sequence of events leads to my code trying to close the indicator when it already has been cleaned up or something to that effect.  I know the proper fix would be to figure out the sequence and prevent it, but I&#39;ve had no luck with that.  Is there something I could check before doing the hide on the activityindicatory itself?</p>
<p>Below is the code I use to hide and show the windows:</p>
<pre><code class="hljs">    var actInd = Titanium.UI.createActivityIndicator({
        bottom:<span class="hljs-number">60</span>, 
        height:<span class="hljs-number">50</span>,
        width:<span class="hljs-number">200</span>,
        font : {fontFamily:<span class="hljs-string">'Helvetica Neue'</span>, fontSize:<span class="hljs-number">15</span>,fontWeight:<span class="hljs-string">'bold'</span>},
        color : <span class="hljs-string">'white'</span>,
        style:Titanium.UI.iPhone.ActivityIndicatorStyle.BIG
    });

    utils.showInd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(message)</span></span>{
        <span class="hljs-keyword">if</span> (showingInd == <span class="hljs-keyword">true</span>) {
            utils.hideInd();
        }
        Titanium.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"Calling Show Indicator "</span> + message);
        actInd.message = message;
        actInd.show();
        showingInd = <span class="hljs-keyword">true</span>;
    };

    utils.hideInd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> {
        Titanium.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"Calling Hide Indicator"</span>);
        <span class="hljs-keyword">if</span> (showingInd == <span class="hljs-keyword">true</span>) {
            Titanium.API.<span class="hljs-built_in">debug</span>(<span class="hljs-string">"Doing Hide"</span>);
            actInd.hide();
            actInd.message = null;

        }
        showingInd = <span class="hljs-keyword">false</span>;
    };
</code></pre><p>The show and hide are called in numerous places across the application.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 16th 2012, 11:17:04 am">February 16th 2012</span>
				by <span class='authorname'>Frank A</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>activityinidicator</span></li>
					
						<li><span class='tagname'>android</span></li>
					
				</ul>
			

			<section>
				<h5>2 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>where is <code>showingInd</code> being initialized and stored? Is this in a commonJS module or an includes file</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 16th 2012, 11:51:41 am">February 16th 2012</span>
								by <span class='authorname'>Aaron Saunders</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>showingInd is just initialized above var actInd - this is an includes file, built a while ago.  This app needs a good makeover, but for now I was hoping for a tactical fix.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 16th 2012, 11:59:04 am">February 16th 2012</span>
								by <span class='authorname'>Frank A</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-230527">
				
						<section>
							<p>I would create a commonJS module to contain the whole thing and allow it to track the state of the activity indicator. Not certain if that is what you did here because all of the code is not included, but it would address the project you are seeing.</p>
<p>Something like this</p>
<pre><code class="hljs">Activity = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
   <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">false</span>;
   <span class="hljs-keyword">this</span>.proxy = Titanium.UI.createActivityIndicator({});
}
Activity.prototype.hide = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
   <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.visible  === <span class="hljs-literal">true</span> ) {
      <span class="hljs-keyword">this</span>.proxy.hide();
   }
   <span class="hljs-keyword">this</span>.visible = <span class="hljs-literal">false</span>;
}
Activity.prototype.show = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
   <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>.visible === <span class="hljs-literal">false</span> ) {
      <span class="hljs-keyword">this</span>.proxy.hide();
   }
   <span class="hljs-keyword">this</span>.visible = show;
}
exports.Activity = Activity
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 16th 2012, 12:01:32 pm">February 16th 2012</span>
								by <span class='authorname'>Aaron Saunders</span><br>
								<a class="icon-bg icon-link" href="question/132255/activity-indicator-view-not-attached-crash#answer-230527" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Thanks I&#39;ll give it a try.  A more general commonJS follow-up; if my app is using multiple contexts (new windows with  url) do I need to do the require in each?</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 12:13:54 pm">February 16th 2012</span>
											by <span class='authorname'>Frank A</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I believe the short answer is yes. I would have to see your code and have a better understanding of overall architecture to be 100% certain of my answer</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 12:27:45 pm">February 16th 2012</span>
											by <span class='authorname'>Aaron Saunders</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I dont think you want to see this code :-)  I&#39;ll play around, although I think the multiple contexts are at the heart of the issue.  Back when I wrote it there was a lot about Titanium I didn&#39;t get.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2012, 12:31:31 pm">February 16th 2012</span>
											by <span class='authorname'>Frank A</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
