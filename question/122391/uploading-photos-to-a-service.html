<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Uploading Photos to a Service Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Uploading Photos to a Service</h1>
		</header>
		<section>
			<p>Hi, the current project I&#39;m working on requires me to upload photos from the camera to an internet service. I got an example using Twitpic up and running quickly using the Kitchen Sink for reference but I&#39;d prefer to use Photobucket or Flickr (for greater flexibility and since Twitpic takes all your photo rights). </p>
<p>I&#39;ve been messing around with Photobucket trying to do POST and GET calls using HTTPClient to no avail though I just found out that this might be due to a lack of a commercial key if not just my utter confusion over their API. Can someone recommend a good photo service that works nicely with Titanium or otherwise point me towards an HTTPClient tutorial? Sample code in either regard would be much appreciated. I&#39;m very confused about some of this stuff since I&#39;ve only ever done API use for the web. Thanks.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 11th 2011, 3:44:28 pm">July 11th 2011</span>
				by <span class='authorname'>dave fletcher</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>api</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>photos</span></li>
					
						<li><span class='tagname'>xhr</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-212808">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>I like <a href="http:&#x2F;&#x2F;www.flickr.com&#x2F;services&#x2F;api&#x2F;response.json.html">flickr</a>, particularly if you use a rails app to interface. What are you trying to accomplish? Will you be the only user? If not, will your users need to have an account with the photo service? If you want to <strong><em>be</em></strong> the photo service, <a href="http:&#x2F;&#x2F;aws.amazon.com&#x2F;s3&#x2F;">Amazon S3</a> would be the standard solution.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 11th 2011, 4:52:53 pm">July 11th 2011</span>
								by <span class='authorname'>Micah Alcorn</span><br>
								<a class="icon-bg icon-link" href="question/122391/uploading-photos-to-a-service.html#answer-212808" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>There will be multiple users but I do want all the photos to go to one place under one account and be aggregated there for later display back on the app. I was thinking I&#39;d just create an account on flickr or photobucket and have the logins hardcoded into the program.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 11th 2011, 6:52:22 pm">July 11th 2011</span>
											by <span class='authorname'>dave fletcher</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That is surely against their TOS, but they proabably would only notice if the storage requirement was significant. I would probably still use a Rails app to interface so that you can handle the authentication on a remote server.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 11th 2011, 7:05:07 pm">July 11th 2011</span>
											by <span class='authorname'>Micah Alcorn</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-213012">
				
						<section>
							<p>Flickr took me awhile to get working but I managed it. I look forward to posting some example code in the near future.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 13th 2011, 12:09:55 pm">July 13th 2011</span>
								by <span class='authorname'>dave fletcher</span><br>
								<a class="icon-bg icon-link" href="question/122391/uploading-photos-to-a-service.html#answer-213012" rel="permalink">permalink</a>
							</div>

							<h5>4 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Would you be able to provide a code sample with flickr? Have been searching the docs and struggling to find answers. A code snippet would be greatly appreciated. Thanks.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 22nd 2011, 11:14:09 pm">August 22nd 2011</span>
											by <span class='authorname'>David Lowe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>K well just so you know this is very specifically to upload photos to a single given account. However, you could feasibly grab the login credentials from the user but then you&#39;d have to go through getting all the appropriate tokens which I&#39;ve simply hardcoded in since its for a single account. Also note I used an md5.js class I found online for free I believe <a href="http:&#x2F;&#x2F;pajhome.org.uk&#x2F;crypt&#x2F;md5&#x2F;">here</a>.</p>
<p>Here&#39;s how you get the full token (probably a better way to do this, however this is a simplified version for mobile devices):</p>
<pre><code class="hljs">        <span class="hljs-keyword">var</span> <span class="hljs-keyword">method</span> = <span class="hljs-string">"flickr.auth.getFullToken"</span>;
            <span class="hljs-keyword">var</span> api_key = <span class="hljs-string">"your_API_key_here"</span>;
            <span class="hljs-keyword">var</span> mini_token = <span class="hljs-string">"your_mini_token_here"</span>;
            <span class="hljs-keyword">var</span> shared_secret = <span class="hljs-string">"your_shared_secret"</span>;
            <span class="hljs-keyword">var</span> format = 'json';

            <span class="hljs-type">Titanium</span>.<span class="hljs-keyword">include</span>(<span class="hljs-string">"md5.js"</span>);
            <span class="hljs-keyword">var</span> signature_string = shared_secret + <span class="hljs-string">"api_key"</span> + api_key + <span class="hljs-string">"format"</span> + format + <span class="hljs-string">"method"</span> + <span class="hljs-keyword">method</span> + <span class="hljs-string">"mini_token"</span> + mini_token + <span class="hljs-string">"permswrite"</span>;
            <span class="hljs-keyword">var</span> api_sig = hex_md5(signature_string);
            <span class="hljs-type">Ti</span>.<span class="hljs-type">API</span>.info(<span class="hljs-string">"Sig "</span> + api_sig);

            xhr = <span class="hljs-type">Titanium</span>.<span class="hljs-type">Network</span>.createHTTPClient();
            xhr.timeout = <span class="hljs-number">60000</span>;
            xhr.onload = function() {
                textfield.value = this.responseText;
            };

            <span class="hljs-keyword">var</span> url = 'http://api.flickr.com/services/rest/?format=json&amp;<span class="hljs-keyword">method</span>='+<span class="hljs-keyword">method</span>+'&amp;api_key='+api_key+'&amp;mini_token='+mini_token+'&amp;perms=write&amp;api_sig='+api_sig;

            xhr.open('<span class="hljs-type">GET</span>', url);
            xhr.send();
</code></pre><p>And here&#39;s how you then upload a photo with the tokens you get from the above (in my case I printed it out to a text field to read it but, again, you could nest these to get your full tokens first and then upload).</p>
<pre><code class="hljs">            <span class="hljs-variable"><span class="hljs-keyword">var</span> api_key</span> = <span class="hljs-string">"your_API_key_here"</span>;
            <span class="hljs-variable"><span class="hljs-keyword">var</span> token</span> = <span class="hljs-string">"your_full_token"</span>;
            <span class="hljs-variable"><span class="hljs-keyword">var</span> shared_secret</span> = <span class="hljs-string">"your_shared_secret"</span>;
            <span class="hljs-variable"><span class="hljs-keyword">var</span> title</span> = <span class="hljs-string">"testPhoto"</span>;

            Titanium.include(<span class="hljs-string">"jacketCam/md5.js"</span>);
            <span class="hljs-variable"><span class="hljs-keyword">var</span> signature_string</span> = shared_secret + <span class="hljs-string">"api_key"</span> + api_key + <span class="hljs-string">"auth_token"</span> + token + <span class="hljs-string">"title"</span> + title;
            <span class="hljs-variable"><span class="hljs-keyword">var</span> api_sig</span> = hex_md5(signature_string);

            <span class="hljs-comment">// write and then read image for uploading, not sure if this is required</span>
            <span class="hljs-variable"><span class="hljs-keyword">var</span> image</span> = event.media;
            <span class="hljs-variable"><span class="hljs-keyword">var</span> f</span> = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,'camera_photo.png');
            f.write(image);
            <span class="hljs-variable"><span class="hljs-keyword">var</span> i</span> = f.read();

            xhr = Titanium.Network.createHTTPClient();
            xhr.timeout = <span class="hljs-number">60000</span>;
            xhr.setRequestHeader('enctype', 'multipart/form-data');
            xhr.onload = function() {
                <span class="hljs-comment">// close window once uploaded</span>
                myWin.close();
            };

            <span class="hljs-variable"><span class="hljs-keyword">var</span> url</span> = 'http:<span class="hljs-comment">//api.flickr.com/services/upload/';</span>

            xhr.<span class="hljs-keyword">open</span>('POST', url);
            xhr.send({
                photo:i,
                title:title,
                api_key:api_key,
                auth_token:token,
                api_sig:api_sig
            });
</code></pre><p>Note this all happens in a within a Titanium.Media function so event.media is my picture (either from the camera or gallery in this case). Hope that helps. I used this site for <a href="http:&#x2F;&#x2F;www.flickr.com&#x2F;services&#x2F;api&#x2F;auth.howto.mobile.html">flickr mobile reference</a> which will walk you through the first steps more clearly. Hope that helps.</p>
</p>
										<div class="author">
											&mdash; commented <span title="August 23rd 2011, 7:05:20 pm">August 23rd 2011</span>
											by <span class='authorname'>dave fletcher</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thanks Dave! This worked pretty well for a quick proof of concept I had to put together. I used Ti.Utils.md5HexDigest(signature_string); instead of md5.js and it worked just as well. For a real app, I also not sure I&#39;d waste time applying for flickr&#39;s business api (that they charge for, last i heard) instead of doing a quick db&#x2F;middleware thing myself.</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 6:37:31 pm">March 14th 2012</span>
											by <span class='authorname'>Tim Shayakhmetov</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>lso just noticed that there seems to be a time lag of at least an hour between the flickr RSS &#x2F; JSON feed (http:&#x2F;&#x2F;api.flickr.com&#x2F;services&#x2F;feeds&#x2F;photos_public.gne?id=your_ID_here&amp;lang=en-us&amp;format=json) and the photostream on http:&#x2F;&#x2F;www.flickr.com&#x2F;photos&#x2F;yourphotospage. This is with the free flickr api key, I&#39;m sure the business version would not take this long (I hope).</p>
</p>
										<div class="author">
											&mdash; commented <span title="March 14th 2012, 7:24:53 pm">March 14th 2012</span>
											by <span class='authorname'>Tim Shayakhmetov</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-212831">
				
						<section>
							<p>I think to avoid the entire hassle, just storing using a php script on my own server will be best and simplest (not to mention legalist). I have no rails experience so I doubt that would be a great idea.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 11th 2011, 7:28:45 pm">July 11th 2011</span>
								by <span class='authorname'>dave fletcher</span><br>
								<a class="icon-bg icon-link" href="question/122391/uploading-photos-to-a-service.html#answer-212831" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
