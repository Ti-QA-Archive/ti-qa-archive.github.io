<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Android - How to open email attachment with Titanium 2.1.3? Â» Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Android - How to open email attachment with Titanium 2.1.3?</h1>
		</header>
		<section>
			<p>I&#39;m working on Titanium SDK 2.1.3 and deploying for Android, I followed this article to include my app in the list of applications that can open mime types like application&#x2F;*, image&#x2F;* and audio&#x2F;*. It made my Android Manifest to look like this:</p>
<pre><code class="hljs"><span class="hljs-pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">manifest</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">package</span>=<span class="hljs-value">"nenvo.com.desktop"</span> <span class="hljs-attribute">android:versionCode</span>=<span class="hljs-value">"1"</span>
    <span class="hljs-attribute">android:versionName</span>=<span class="hljs-value">"1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-sdk</span> <span class="hljs-attribute">android:minSdkVersion</span>=<span class="hljs-value">"8"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- TI_MANIFEST --&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">application</span> <span class="hljs-attribute">android:icon</span>=<span class="hljs-value">"@drawable/appicon"</span>
        <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"Desktop Lite"</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"DesktopLiteApplication"</span>
        <span class="hljs-attribute">android:debuggable</span>=<span class="hljs-value">"false"</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- TI_APPLICATION --&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">".DesktopLiteActivity"</span>
            <span class="hljs-attribute">android:label</span>=<span class="hljs-value">"Desktop Lite"</span> <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@style/Theme.Titanium"</span>
            <span class="hljs-attribute">android:configChanges</span>=<span class="hljs-value">"keyboardHidden|orientation"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.MAIN"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.LAUNCHER"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:scheme</span>=<span class="hljs-value">"content"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">action</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.action.VIEW"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.DEFAULT"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">category</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.intent.category.BROWSABLE"</span> /&gt;</span>
                <span class="hljs-comment">&lt;!-- open any mime type file --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:mimeType</span>=<span class="hljs-value">"application/*"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:mimeType</span>=<span class="hljs-value">"audio/*"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:mimeType</span>=<span class="hljs-value">"image/*"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:mimeType</span>=<span class="hljs-value">"text/*"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:mimeType</span>=<span class="hljs-value">"video/*"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">data</span> <span class="hljs-attribute">android:pathPattern</span>=<span class="hljs-value">".*\\.asd"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">activity</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"org.appcelerator.titanium.TiActivity"</span>
            <span class="hljs-attribute">android:configChanges</span>=<span class="hljs-value">"keyboardHidden|orientation"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"org.appcelerator.titanium.TiTranslucentActivity"</span>
            <span class="hljs-attribute">android:configChanges</span>=<span class="hljs-value">"keyboardHidden|orientation"</span>
            <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@android:style/Theme.Translucent"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"org.appcelerator.titanium.TiModalActivity"</span>
            <span class="hljs-attribute">android:configChanges</span>=<span class="hljs-value">"keyboardHidden|orientation"</span>
            <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@android:style/Theme.Translucent"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"ti.modules.titanium.ui.TiTabActivity"</span>
            <span class="hljs-attribute">android:configChanges</span>=<span class="hljs-value">"keyboardHidden|orientation"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">activity</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"ti.modules.titanium.ui.android.TiPreferencesActivity"</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">service</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"org.appcelerator.titanium.analytics.TiAnalyticsService"</span>
            <span class="hljs-attribute">android:exported</span>=<span class="hljs-value">"false"</span> /&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-title">application</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_NETWORK_STATE"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_MOCK_LOCATION"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.VIBRATE"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_WIFI_STATE"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_COARSE_LOCATION"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.INTERNET"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_FINE_LOCATION"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">manifest</span>&gt;</span>
</code></pre><p>Now my app is launched when an email attachment is trying to be opened, the problem is that I don&#39;t know how to retrieve the file I&#39;m trying to open, I tried the following on my start and resume events for my Android application:</p>
<pre><code class="hljs">activity.addEventListener(<span class="hljs-string">'start'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    Ti.API.<span class="hljs-built_in">log</span>(<span class="hljs-string">'*** Start Event Called ***'</span>);
    var <span class="hljs-keyword">args</span> = activity.getIntent().getData(); // this <span class="hljs-keyword">is</span> null
    functions.handleFunction(<span class="hljs-keyword">args</span>); 
});

activity.addEventListener(<span class="hljs-string">'resume'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    Ti.API.<span class="hljs-built_in">log</span>(<span class="hljs-string">'*** Resume Event Called ***'</span>);
    var <span class="hljs-keyword">args</span> = activity.getIntent().getData(); //this <span class="hljs-keyword">is</span> also null
    functions.handleFunction(<span class="hljs-keyword">args</span>);
});
</code></pre><p>When I tried to retrieve the data for the intent, I got null as a result. When I display the Intent object, I get the following:</p>
<p><code>{&amp;quot;flags&amp;quot;:0,&amp;quot;type&amp;quot;:null,&amp;quot;data&amp;quot;:null,&amp;quot;action&amp;quot;:null}</code></p>
<p>Why am I not receiving any data on the Intent? Am I doing something wrong?</p>
<p>Any help will be appreciated.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 1st 2013, 7:10:48 pm">July 1st 2013</span>
				by <span class='authorname'>Nenvo Software</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>android-intent</span></li>
					
						<li><span class='tagname'>data</span></li>
					
						<li><span class='tagname'>intent</span></li>
					
						<li><span class='tagname'>titanium studio</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I noticed that when I opened my app from the list of apps that could open an specific file, my app would start as if it was closed before (even if it had been opened previously). I tried to get the Intent during this loading on my app.js file and to my surprise I got the data of the intent, which is the following:</p>
<p><code>content:&amp;#x2F;&amp;#x2F;com.android.email.attachmentprovider&amp;#x2F;1&amp;#x2F;2&amp;#x2F;RAW</code></p>
<p>How do I open that? How do I retrieve the file from that address?</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 1st 2013, 7:22:21 pm">July 1st 2013</span>
								by <span class='authorname'>Nenvo Software</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I tried to get the file from that address like this:</p>
<p><code>var tmpFile = Ti.Filesystem.getFile(String(currentActivity.getIntent().getData()));</code></p>
<p>But what I got was an File object that looked like this:</p>
<pre><code class="hljs">{
    "<span class="hljs-attribute">writable</span>": <span class="hljs-value"><span class="hljs-literal">false</span></span>,
    "<span class="hljs-attribute">symbolicLink</span>": <span class="hljs-value"><span class="hljs-literal">false</span></span>,
    "<span class="hljs-attribute">parent</span>": <span class="hljs-value"><span class="hljs-literal">null</span></span>,
    "<span class="hljs-attribute">readonly</span>": <span class="hljs-value"><span class="hljs-literal">true</span></span>,
    "<span class="hljs-attribute">nativePath</span>": <span class="hljs-value"><span class="hljs-string">"content://com.android.email.attachmentprovider/1/2/RAW"</span></span>,
    "<span class="hljs-attribute">executable</span>": <span class="hljs-value"><span class="hljs-literal">false</span></span>,
    "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"api-eventos.txt"</span></span>,
    "<span class="hljs-attribute">directoryListing</span>": <span class="hljs-value"><span class="hljs-literal">null</span></span>,
    "<span class="hljs-attribute">hidden</span>": <span class="hljs-value"><span class="hljs-literal">false</span></span>,
    "<span class="hljs-attribute">size</span>": <span class="hljs-value"><span class="hljs-number">0</span>
</span>}
</code></pre><p>It does show the name of the original file, but the size is 0 and there doesn&#39;t seem like it contains any information of the original file, I tried to read it and got null as a result. How can I get the file from the attachment address?</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 1st 2013, 8:21:58 pm">July 1st 2013</span>
								by <span class='authorname'>Nenvo Software</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Get the intent of the activity, and print the arguments. Check <a href="http:&#x2F;&#x2F;docs.appcelerator.com&#x2F;titanium&#x2F;latest&#x2F;#!&#x2F;api&#x2F;Titanium.Android.Activity-property-intent">here</a>. </p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 1st 2013, 9:49:05 pm">July 1st 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Try this:</p>
<pre><code class="hljs">activity.addEventListener(<span class="hljs-string">'newIntent'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> {</span>
    Ti.API.<span class="hljs-built_in">log</span>(<span class="hljs-string">'*** onNewIntent Event Called ***'</span>);
    var <span class="hljs-keyword">args</span> = <span class="hljs-keyword">e</span>.intent.getData(); //this <span class="hljs-keyword">is</span> also null
    functions.handleFunction(<span class="hljs-keyword">args</span>);
});
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="July 2nd 2013, 5:27:31 am">July 2nd 2013</span>
								by <span class='authorname'>Manuel Lehner</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Mauro, this is what I get from the Intent</p>
<pre><code class="hljs">{
    "<span class="hljs-attribute">flags</span>":<span class="hljs-value"><span class="hljs-number">50855937</span></span>,
    "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"image/png"</span></span>,
    "<span class="hljs-attribute">data</span>":<span class="hljs-value"><span class="hljs-string">"content://com.android.email.attachmentprovider/1/4/RAW"</span></span>,
    "<span class="hljs-attribute">action</span>":<span class="hljs-value"><span class="hljs-string">"android.intent.action.VIEW"</span>
</span>}
</code></pre><p>The data is that weird address which I don&#39;t know how to handle, how do I get the file? If I try to use that address to open the file and then try to read it, I get a null.</p>
<p>As for Manuel&#39;s comment, I have reached the stage where getting the data from the Intent is no longer the problem, but to access to the file.</p>
</div>
							<div class="author">
								&mdash; commented <span title="July 2nd 2013, 2:05:36 pm">July 2nd 2013</span>
								by <span class='authorname'>Nenvo Software</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-265259">
				
						<section>
							<p>Finally found the way to solve this. The content returns an URI, I can use it to get the file but I can&#39;t read it, but I can copy it into another file. The new file can be then read and being used like any other File object. Here&#39;s my code:</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> currentActivity</span> = Ti.Android.currentActivity;
<span class="hljs-variable"><span class="hljs-keyword">var</span> passedData</span> = currentActivity.getIntent().getData();
<span class="hljs-keyword">if</span>(passedData !== <span class="hljs-literal">null</span>)
{
    <span class="hljs-variable"><span class="hljs-keyword">var</span> tmpFile</span> = Ti.Filesystem.getFile(String(passedData));
    <span class="hljs-variable"><span class="hljs-keyword">var</span> fileData</span> = Ti.Filesystem.getFile(Ti.Filesystem.getTempDirectory() + tmpFile.name);
    tmpFile.copy(fileData.nativePath); <span class="hljs-comment">//the copy can be handled like any other normal file</span>
    Ti.App.Properties.setString('passedData', JSON.stringify(fileData)); <span class="hljs-comment">// in my case I place it in a Ti.App.Property for later use</span>
}
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 2nd 2013, 6:02:20 pm">July 2nd 2013</span>
								by <span class='authorname'>Nenvo Software</span><br>
								<a class="icon-bg icon-link" href="question/154335/android---how-to-open-email-attachment-with-titanium-213.html#answer-265259" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
