<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Problems resizing camera image in Android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Problems resizing camera image in Android</h1>
		</header>
		<section>
			<p>There doesn&#39;t seem to be a sure fire way to resize camera images in Android.  I have an app what works perfectly in IOS, intermittently in Android.  When I get the image (x), I call x.media.imageAsThumbnail(88) and often get an exception that just says &quot;A javascript exception occured&quot;.  Same problem if I call resize.</p>
<p>I tried to create a simple test case, but the test case, with the same code and same image works fine. </p>
<p>This leads me to believe that it might be a memory issue.</p>
<p>I&#39;ve seen references to assigning images to other imageviews then calling toImage().. that just returns black, probably because the imageview is not being displayed.  </p>
<p>Any thoughts or pointers?  I know this is rather vague, but I&#39;m having a ton of image issue on Android that I don&#39;t have on IOS.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="May 3rd 2013, 1:52:42 pm">May 3rd 2013</span>
				by <span class='authorname'>Greg Pasquariello</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>image</span></li>
					
						<li><span class='tagname'>resize</span></li>
					
				</ul>
			

			<section>
				<h5>9 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Hello,</p>
<p>can you provide an example of image where it fails? Maybe is it related to the file size?  format? Depth? </p>
<p>Best,<br>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 4:08:38 pm">May 3rd 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I wish I could… it&#39;s not the image itself; the same image that fails in my app works in the example I made for this post.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 8:35:46 pm">May 3rd 2013</span>
								by <span class='authorname'>Greg Pasquariello</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello,</p>
<p>looks like there is something else happening in the code. Run ddms and see if you can see the reason for the crash. Or get the crashlog.</p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 9:13:39 pm">May 3rd 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Was trying to duplicate in the Emulator… boom, out of ram.  This is just a single, standard camera image.</p>
<p>W&#x2F;System.err(  406): java.lang.OutOfMemoryError: bitmap size exceeds VM budget<br>W&#x2F;System.err(  406):     at android.graphics.BitmapFactory.nativeDecodeStream(Native Method)<br>W&#x2F;System.err(  406):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:459)<br>W&#x2F;System.err(  406):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:515)<br>W&#x2F;System.err(  406):     at org.appcelerator.titanium.TiBlob.getImage(TiBlob.java:492)<br>W&#x2F;System.err(  406):     at org.appcelerator.titanium.TiBlob.imageAsThumbnail(TiBlob.java:540)<br>W&#x2F;System.err(  406):     at org.appcelerator.kroll.runtime.v8.V8Function.nativeInvoke(Native Method)<br>W&#x2F;System.err(  406):     at org.appcelerator.kroll.runtime.v8.V8Function.callSync(V8Function.java:57)<br>W&#x2F;System.err(  406):     at org.appcelerator.kroll.runtime.v8.V8Function.call(V8Function.java:43)<br>W&#x2F;System.err(  406):     at org.appcelerator.kroll.runtime.v8.V8Function$1.run(V8Function.java:70)<br>W&#x2F;System.err(  406):     at android.os.Handler.handleCallback(Handler.java:587)<br>W&#x2F;System.err(  406):     at android.os.Handler.dispatchMessage(Handler.java:92)<br>W&#x2F;System.err(  406):     at android.os.Looper.loop(Looper.java:123)<br>W&#x2F;System.err(  406):     at org.appcelerator.kroll.KrollRuntime$KrollRuntimeThread.run(KrollRuntime.java:112)</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 9:59:12 pm">May 3rd 2013</span>
								by <span class='authorname'>Greg Pasquariello</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello,</p>
<p>share an image and your test case I will try to replicate the issue. </p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 10:37:40 pm">May 3rd 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I&#39;m not sure you&#39;re understanding my comment above.  It does not happen with the image in my test case.  It only happens in the full app.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 10:41:44 pm">May 3rd 2013</span>
								by <span class='authorname'>Greg Pasquariello</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello,</p>
<p>what I have is a duty to give it a shot, and see how you are doing your thumbnail and suggest how to do it without breaking the app.</p>
<p>If you are able to provide that information, would be awesome. </p>
<p>Best,</p>
<p>Mauro</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 10:48:46 pm">May 3rd 2013</span>
								by <span class='authorname'>Mauro Parra</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Ok, well then this is the code that blows up:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageCaptureSuccessful</span><span class="hljs-params">(x)</span> </span>{
    <span class="hljs-keyword">if</span> (x.success == <span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">var</span> newImage = x.media.imageAsThumbnail(<span class="hljs-number">88</span>);   <span class="hljs-comment">// crashes here.</span>


        <span class="hljs-keyword">var</span> imageViewController = Alloy.createController(<span class="hljs-string">"ImageDisplay"</span>);
        imageViewController.init(x.media);
        Sparkd.app.navigator.pushController(imageViewController);    
    }
}

exports.launchGallery = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    Titanium.Media.openPhotoGallery({
        allowEditing : <span class="hljs-literal">false</span>,
        animated : <span class="hljs-literal">true</span>,
        mediaTypes : [Titanium.Media.MEDIA_TYPE_PHOTO],
        success : imageCaptureSuccessful
    });
}

exports.launchCamera = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    Titanium.Media.showCamera({
        allowEditing : <span class="hljs-literal">false</span>,
        animated : <span class="hljs-literal">true</span>,
        mediaTypes : [Titanium.Media.MEDIA_TYPE_PHOTO],
        success : imageCaptureSuccessful,
        saveToPhotoGallery: <span class="hljs-literal">false</span>,
        allowEditing: <span class="hljs-literal">false</span>,
        showControls: <span class="hljs-literal">true</span>
    });
}
</code></pre><p>It blows up on the <code>var newImage =</code> line when I take any photo from from the camera, or load a camera photo from the gallery.  But again, it doesn&#39;t happen in my test app, it only happens in my real app.</p>
<p>This is the image</p>
<p>[https:&#x2F;&#x2F;dl.dropboxusercontent.com&#x2F;u&#x2F;3237244&#x2F;PostedPics&#x2F;20130428_130652.jpg]</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 11:06:25 pm">May 3rd 2013</span>
								by <span class='authorname'>Greg Pasquariello</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>And please don&#39;t get me wrong… I appreciate the help.  It&#39;s just that I cannot duplicate the issue in a simple test app, so I&#39;m not sure how you&#39;ll be able to suggest a fix.</p>
<p>One thing that I did try is creating a small ImageView and calling toImage() on it.  However, that doesn&#39;t appear to return anything other than a black image, I presume because the ImageView isn&#39;t being shown on the window.</p>
</div>
							<div class="author">
								&mdash; commented <span title="May 3rd 2013, 11:09:34 pm">May 3rd 2013</span>
								by <span class='authorname'>Greg Pasquariello</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-262136">
				
						<section>
							<p>I&#39;ve got LOTS of troubles working with Android and images (more in 2.3).  You must think that in Android, there is an internal translation for every image. So, every pixel in image (no matter format), burns 4 bytes (3 for RGB and one for alpha).</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="May 3rd 2013, 8:59:22 pm">May 3rd 2013</span>
								by <span class='authorname'>Avelino Garcia</span><br>
								<a class="icon-bg icon-link" href="question/151938/problems-resizing-camera-image-in-android#answer-262136" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>The image support in Titanium is really bad, and it&#39;s only because it mostly works in IOS that it&#39;s even acceptable.   I don&#39;t see any way around this issue… the javascript exception is completely useless as far as any kind of information, and this kind of exception severely limits the kind of apps that I&#39;m willing to build with Titanium.  </p>
<p>If anyone has any suggestions, I&#39;m all ears.  Nothing worse than an issue that you cannot duplicate!</p>
</p>
										<div class="author">
											&mdash; commented <span title="May 3rd 2013, 9:06:46 pm">May 3rd 2013</span>
											by <span class='authorname'>Greg Pasquariello</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
