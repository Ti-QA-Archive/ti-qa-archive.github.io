<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>ti.map - regionChanged event not firing on Android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>ti.map - regionChanged event not firing on Android</h1>
		</header>
		<section>
			<p>I am writing an app that relies on the ti.map regionChanged event.  The app works fine on ios, but on Android the regionChanged  event is never fired.  I am sure that all the permissions and key are set up correctly as the map displays fine and all annotations and routes are working ok.</p>
<p>As the app was using a large number of annotations and routes I wrote a test app that simply displays a map and a label that should show the current region when the regionChanged event is fired and even that does not work.</p>
<p>I have tried the ti.map version 2.2.3 that ships with sdk 3.5.0.GA and also 1.2.4 (the oldest version installed on my mac) and 2.2.5 from github, all behave the same.</p>
<p>Any advice would be very gratefully accepted.</p>
<p>Set up as follows:</p>
<p>Mac OSX Yosemite 10.10.2<br>Titanium Studio 3.4.1<br>Mobile SDK 3.5.0.GA</p>
<p>Tested on Samsung Galaxy Tab 10.1 and Samsung Galaxy Note 3</p>
<p>Tiapp.xml</p>
<pre><code class="hljs"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">ti:app</span> <span class="hljs-attribute">xmlns:ti</span>=<span class="hljs-value">"http://ti.appcelerator.org"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">id</span>&gt;</span>com.phc.test2<span class="hljs-tag">&lt;/<span class="hljs-title">id</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">name</span>&gt;</span>Test2<span class="hljs-tag">&lt;/<span class="hljs-title">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">publisher</span>&gt;</span>Des<span class="hljs-tag">&lt;/<span class="hljs-title">publisher</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url</span>&gt;</span>http://<span class="hljs-tag">&lt;/<span class="hljs-title">url</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">description</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">copyright</span>&gt;</span>2015 by Des<span class="hljs-tag">&lt;/<span class="hljs-title">copyright</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">icon</span>&gt;</span>appicon.png<span class="hljs-tag">&lt;/<span class="hljs-title">icon</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">fullscreen</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">fullscreen</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">navbar-hidden</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">navbar-hidden</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">analytics</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">analytics</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">guid</span>&gt;</span>0f7699d8-23b5-4063-905d-ee2521f21f3b<span class="hljs-tag">&lt;/<span class="hljs-title">guid</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"ti.ui.defaultunit"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"string"</span>&gt;</span>dp<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">ios</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">plist</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UISupportedInterfaceOrientations~iphone<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIInterfaceOrientationPortrait<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UISupportedInterfaceOrientations~ipad<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIInterfaceOrientationPortrait<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIInterfaceOrientationPortraitUpsideDown<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIInterfaceOrientationLandscapeLeft<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIInterfaceOrientationLandscapeRight<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIRequiresPersistentWiFi<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">false</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIPrerenderedIcon<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">false</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIStatusBarHidden<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">false</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>UIStatusBarStyle<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>UIStatusBarStyleDefault<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">plist</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ios</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">android</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">manifest</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.INTERNET"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.WRITE_EXTERNAL_STORAGE"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_FINE_LOCATION"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_COARSE_LOCATION"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.providers.gsf.permission.READ_GSERVICES"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-feature</span> <span class="hljs-attribute">android:glEsVersion</span>=<span class="hljs-value">"0x00020000"</span> <span class="hljs-attribute">android:required</span>=<span class="hljs-value">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.phc.test2.permission.MAPS_RECEIVE"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">permission</span>
                <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.phc.test2.permission.MAPS_RECEIVE"</span> <span class="hljs-attribute">android:protectionLevel</span>=<span class="hljs-value">"signature"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">application</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-title">meta-data</span>
                    <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.google.android.maps.v2.API_KEY"</span> <span class="hljs-attribute">android:value</span>=<span class="hljs-value">"AIzaSyAc6Ap2SmzWB1ZJm7cbGdu_Kxb3ByaHvsM"</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">application</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">manifest</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">android</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">mobileweb</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">precache</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">splash</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">enabled</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">inline-css-images</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">inline-css-images</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">splash</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">theme</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-title">theme</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">mobileweb</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">modules</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">module</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"iphone"</span>&gt;</span>ti.map<span class="hljs-tag">&lt;/<span class="hljs-title">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">module</span> <span class="hljs-attribute">platform</span>=<span class="hljs-value">"android"</span>&gt;</span>ti.map<span class="hljs-tag">&lt;/<span class="hljs-title">module</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">modules</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">deployment-targets</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span> <span class="hljs-attribute">device</span>=<span class="hljs-value">"android"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span> <span class="hljs-attribute">device</span>=<span class="hljs-value">"blackberry"</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span> <span class="hljs-attribute">device</span>=<span class="hljs-value">"ipad"</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span> <span class="hljs-attribute">device</span>=<span class="hljs-value">"iphone"</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">target</span> <span class="hljs-attribute">device</span>=<span class="hljs-value">"mobileweb"</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-title">target</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">deployment-targets</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">sdk-version</span>&gt;</span>3.5.0.GA<span class="hljs-tag">&lt;/<span class="hljs-title">sdk-version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">ti:app</span>&gt;</span>
</code></pre><p>app.js</p>
<pre><code class="hljs">var win1 = <span class="hljs-type">Titanium</span>.<span class="hljs-type">UI</span>.createWindow({
    orientationModes:[<span class="hljs-type">Titanium</span>.<span class="hljs-type">UI</span>.<span class="hljs-type">PORTRAIT</span>, <span class="hljs-type">Titanium</span>.<span class="hljs-type">UI</span>.<span class="hljs-type">UPSIDE_PORTRAIT</span>],
    url:<span class="hljs-symbol">'home</span>.js',
    exitOnClose:<span class="hljs-literal">true</span>,
    navBarHidden:<span class="hljs-literal">true</span>,
    title:<span class="hljs-symbol">'Test2'</span>
});

win1.<span class="hljs-keyword">open</span><span class="hljs-literal">()</span>;
</code></pre><p>home.js</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> win = Titanium.UI.currentWindow;
<span class="hljs-keyword">var</span> MapModule = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ti.map'</span>);

<span class="hljs-keyword">if</span> (Ti.Platform.name == <span class="hljs-string">'android'</span>) {
    <span class="hljs-keyword">var</span> rc = MapModule.isGooglePlayServicesAvailable();
    <span class="hljs-keyword">switch</span> (rc) {
        <span class="hljs-keyword">case</span> MapModule.SUCCESS:
            Ti.API.info(<span class="hljs-string">'Google Play services is installed.'</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> MapModule.SERVICE_MISSING:
            alert(<span class="hljs-string">'Google Play services is missing. Please install Google Play services from the Google Play store.'</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> MapModule.SERVICE_VERSION_UPDATE_REQUIRED:
            alert(<span class="hljs-string">'Google Play services is out of date. Please update Google Play services.'</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> MapModule.SERVICE_DISABLED:
            alert(<span class="hljs-string">'Google Play services is disabled. Please enable Google Play services.'</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> MapModule.SERVICE_INVALID:
            alert(<span class="hljs-string">'Google Play services cannot be authenticated. Reinstall Google Play services.'</span>);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            alert(<span class="hljs-string">'Unknown error.'</span>);
            <span class="hljs-keyword">break</span>;
    }
}

<span class="hljs-keyword">var</span> mapView = MapModule.createView({
    mapType: MapModule.NORMAL_TYPE,
    region: {latitude:<span class="hljs-number">50.96</span>, longitude:<span class="hljs-number">0.28</span>, latitudeDelta:<span class="hljs-number">1.15</span>, longitudeDelta:<span class="hljs-number">1.15</span>},
    animate:<span class="hljs-literal">false</span>,
    userLocation:<span class="hljs-literal">true</span>
});

<span class="hljs-keyword">var</span> l1 = Ti.UI.createLabel({
    text: <span class="hljs-string">"It's Poo"</span>,
    color: <span class="hljs-string">'#000000'</span>,
    backgroundColor: <span class="hljs-string">'#ffffff'</span>,
    textAlign:<span class="hljs-string">'center'</span>,
    top:<span class="hljs-number">0</span>,
    left:<span class="hljs-number">0</span>,
    width:<span class="hljs-string">'100%'</span>,
    height:<span class="hljs-string">'20%'</span>,
    font:{fontSize:<span class="hljs-number">16</span>},
    opacity: <span class="hljs-number">0.75</span>
});

win.add(mapView);
win.add(l1);

mapView.addEventListener(<span class="hljs-string">'regionChanged'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    win.remove(l1);
    l1.text = <span class="hljs-built_in">JSON</span>.stringify(e);
    win.add(l1);
});
</code></pre>
		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 14th 2015, 9:10:21 pm">February 14th 2015</span>
				by <span class='authorname'>Derrick Huth</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>regionchanged</span></li>
					
						<li><span class='tagname'>ti.map</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>I did a bit more digging, effectively writing my own regionChanged event by running getRegion every 0.1s and checking if it had changed.</p>
<p>The reason the event is not fired is that Titanium does not think the map region has changed, whatever you do to the map, move it, zoom in and out, the returned region stays the same.</p>
</div>
							<div class="author">
								&mdash; commented <span title="February 15th 2015, 8:20:24 pm">February 15th 2015</span>
								by <span class='authorname'>Derrick Huth</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>1</span> Answer</div>
		</aside>
	</div>

	<hr>

	<h3>1 Answer</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-285878">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi Derrick,</p>
<p>i test it.. there is small mistake <code>regionChanged</code> is not correct event. actually in map view event <code>c</code> is small.</p>
<p>when i tried with <code>regionChanged</code> it not fire. but when i tried <code>regionchanged</code>  it&#39;s work fine… </p>
<p>Thanks</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 16th 2015, 11:44:43 am">February 16th 2015</span>
								by <span class='authorname'>Nilesh Patel</span><br>
								<a class="icon-bg icon-link" href="question/180857/timap---regionchanged-event-not-firing-on-android.html#answer-285878" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Many thanks Nilesh, you are a life saver.</p>
<p>I missed this as I was updating an old project and it definately used to work with the event spelt regionChanged.</p>
</p>
										<div class="author">
											&mdash; commented <span title="February 16th 2015, 2:18:00 pm">February 16th 2015</span>
											by <span class='authorname'>Derrick Huth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
