<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Local HTML Files / JS working on IOS not Android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Local HTML Files / JS working on IOS not Android</h1>
		</header>
		<section>
			<p>Ok guys this is weird,</p>
<p>This code works in IOS EXACTLY the way that I want it to:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> barcode =Ti.UI.createWebView({
    top:<span class="hljs-string">"30%"</span>,
    left:<span class="hljs-string">"33%"</span>,
    height:<span class="hljs-string">"25%"</span>,
    width:<span class="hljs-string">"37%"</span>,
    url: <span class="hljs-string">"/local/jscode39.html"</span>
})
barcode.addEventListener(<span class="hljs-string">'beforeload'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>
</span>{
    barcode.evalJS(<span class="hljs-string">"var sku='"</span>+barcodesku+<span class="hljs-string">"';"</span>);
});
</code></pre><p>when it runs it gives me the barcode that I want and like it should. It also works just fine on my IPod Touch (my poor mans IPhone :)</p>
<p>When I run it on the Android Emulator and the device it will go through all the steps BUT it wont give me the barcode like it does in IOS.<br>Instead I get this :</p>
<pre><code class="hljs">[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>] java.lang.Throwable: Warning: A WebView method was called on thread 'WebViewCoreThread'. All WebView methods must be called on the UI thread. Future versions of WebView may not support use on other threads.
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebView.checkThread(WebView.java:9355)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebView.getSettings(WebView.java:4053)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.ZoomManager.getReadingLevelScale(ZoomManager.java:317)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebView.getReadingLevelScale(WebView.java:2448)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore.setupViewport(WebViewCore.java:2487)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore.didFirstLayout(WebViewCore.java:2258)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore.nativeUpdateFrameCache(Native Method)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore.access$4900(WebViewCore.java:55)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore$EventHub$1.handleMessage(WebViewCore.java:1458)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.os.Handler.dispatchMessage(Handler.java:99)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.os.Looper.loop(Looper.java:137)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:722)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview ( 1051)</span>]     at java.lang.Thread.run(Thread.java:856)
</code></pre><p>I use webvies all the time in my apps but never locally and I need this code to work on the device rather than sending the information across the net and back. (it&#39;s to reduce loading and displaying times plus some other reasons). </p>
<p>How can I fix this?<br>this occurrs on both my MAC OSX and TI 3.1.2 and on my wind 7 with TI 3.!.3GA … I have the latest SDK &#x2F; NODE&#x2F; ACS releases on both machines..</p>
<p>Was there a change in the GOOGLE code that i am not aware of or what am I doing wrong?<br>the directory structure is<br>APP<br>resources<br>local<br>then the html and the JS files are in there. </p>
<p>Like I said works on IOS but not android at all</p>
<p>Thanks<br>&#x2F;john</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 30th 2013, 12:30:18 am">September 30th 2013</span>
				by <span class='authorname'>John Schimanski</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>ios</span></li>
					
						<li><span class='tagname'>local html</span></li>
					
						<li><span class='tagname'>local js</span></li>
					
						<li><span class='tagname'>webview</span></li>
					
				</ul>
			

			<section>
				<h5>5 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>Forgot to add… Android 4.0</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 30th 2013, 12:37:10 am">September 30th 2013</span>
								by <span class='authorname'>John Schimanski</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Hello, if you still have problem then please opens an issue in <a href="https:&#x2F;&#x2F;jira.appcelerator.org">JIRA</a>. Thanks</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 30th 2013, 9:10:03 am">September 30th 2013</span>
								by <span class='authorname'>Md. Mostafizur Rahman</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Still having the issue …. Opened the following ticket<br>TC-3059 - Local HTML &#x2F; JS working on IOS not Android</p>
<p>Anyone have any ideas why this is going on?</p>
<p>John</p>
</div>
							<div class="author">
								&mdash; commented <span title="September 30th 2013, 12:24:04 pm">September 30th 2013</span>
								by <span class='authorname'>John Schimanski</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Also got this last night without any changes to the code</p>
<pre><code class="hljs">DEBUG][Module  (  702)] Loading module: alloy/controllers/ticketview -&gt; Resources/alloy/controllers/ticketview.js
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">TiAssetHelper(  702)</span>] Fetching "alloy/controllers/ticketview.js" with Fastdev...
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">TiFastDev(  702)</span>] (KrollRuntimeThread) [1572,7939] sent tokens successfully
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">TiFastDev(  702)</span>] (KrollRuntimeThread) [6,7945] sent tokens successfully
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">dalvikvm(  702)</span>] GC_CONCURRENT freed 385K, 4% free 12813K/13319K, paused 4ms+7ms
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">dalvikvm(   77)</span>] GREF has increased to 401
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>] java.lang.Throwable: EventHub.removeMessages(int what = 107) is not supported before the WebViewCore is set up.
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.WebViewCore$EventHub.removeMessages(WebViewCore.java:1671)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.WebViewCore$EventHub.access$7800(WebViewCore.java:920)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.WebViewCore.removeMessages(WebViewCore.java:1783)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.WebView.sendOurVisibleRect(WebView.java:2858)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.ZoomManager.setZoomScale(ZoomManager.java:586)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.ZoomManager.access$1700(ZoomManager.java:49)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.webkit.ZoomManager$PostScale.run(ZoomManager.java:977)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.os.Handler.handleCallback(Handler.java:605)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.os.Handler.dispatchMessage(Handler.java:92)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.os.Looper.loop(Looper.java:137)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at android.app.ActivityThread.main(ActivityThread.java:4340)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at java.lang.reflect.Method.invokeNative(Native Method)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at java.lang.reflect.Method.invoke(Method.java:511)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webcore (  702)</span>]     at dalvik.system.NativeStart.main(Native Method)
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">TiAPI   (  702)</span>]  sku = 223456789
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>] java.lang.Throwable: Warning: A WebView method was called on thread 'WebViewCoreThread'. All WebView methods must be called on the UI thread. Future versions of WebView may not support use on other threads.
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebView.checkThread(WebView.java:9355)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebView.getSettings(WebView.java:4053)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.ZoomManager.getReadingLevelScale(ZoomManager.java:317)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebView.getReadingLevelScale(WebView.java:2448)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore.setupViewport(WebViewCore.java:2487)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore.didFirstLayout(WebViewCore.java:2258)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore.nativeUpdateFrameCache(Native Method)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore.access$4900(WebViewCore.java:55)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore$EventHub$1.handleMessage(WebViewCore.java:1458)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.os.Handler.dispatchMessage(Handler.java:99)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.os.Looper.loop(Looper.java:137)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:722)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">webview (  702)</span>]     at java.lang.Thread.run(Thread.java:856)
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">TiWebChromeClient.console(  702)</span>] (main) [2532,10477] Uncaught SyntaxError: Unexpected token var (1:file:///android_asset/Resources/local/jscode39.html)
[<span class="hljs-link_label">WARN</span>][<span class="hljs-link_reference">TiWebViewBinding(  702)</span>] (KrollRuntimeThread) [2293,12770] Timeout waiting to evaluate JS
[<span class="hljs-link_label">INFO</span>][<span class="hljs-link_reference">WindowManager(   77)</span>] createSurface Window{41603098 Panel:com.cstg.ticket1/com.cstg.ticket1.Ticket1aActivity paused=false}: DRAW NOW PENDING
[<span class="hljs-link_label">DEBUG</span>][<span class="hljs-link_reference">dalvikvm(  702)</span>] GC_CONCURRENT freed 394K, 4% free 13294K/13831K, paused 4ms+10ms
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="September 30th 2013, 12:24:47 pm">September 30th 2013</span>
								by <span class='authorname'>John Schimanski</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>TI = 3.1.3GA<br>android 4.2.2<br>mac OSX and windows 7 </p>
<p>This is driving me nuts</p>
<p>Ok I got it working in IOS perfectly</p>
<p>I can not get it to work in Android:</p>
<p>index.js </p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> weburl = <span class="hljs-string">"/local/jscode39.html"</span>;

<span class="hljs-keyword">var</span> barcode =Ti.UI.createWebView({
    top:<span class="hljs-string">"30%"</span>,
    left:<span class="hljs-string">"35%"</span>,
    height:<span class="hljs-string">"45%"</span>,
    width:<span class="hljs-string">"50%"</span>,
    url: weburl,
    backgroundColor: <span class="hljs-string">"white"</span>
})

Ti.API.info(<span class="hljs-string">"sku = "</span> +barcodesku);

barcode.addEventListener(<span class="hljs-string">'beforeload'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>
</span>{    


    barcode.evalJS(<span class="hljs-string">"var sku='"</span>+barcodesku+<span class="hljs-string">"';"</span>);
    Ti.API.info(<span class="hljs-string">'sku after evaljs = '</span> +barcodesku);

});
</code></pre><p>code39js.html</p>
<pre><code class="hljs"><span class="hljs-comment">&lt;!-- &lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt; --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">HTML</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">HEAD</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">TITLE</span>&gt;</span>JavaScript Code39<span class="hljs-tag">&lt;/<span class="hljs-title">TITLE</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">language</span>=<span class="hljs-value">"JavaScript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"code39.jslocal"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">HEAD</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">BODY</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"font-family:Verdana; font-size:11pt"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">language</span>=<span class="hljs-value">"JavaScript"</span>&gt;</span><span class="javascript">
<span class="hljs-built_in">document</span>.open();

<span class="hljs-built_in">document</span>.write(sku);

Code39(<span class="hljs-string">""</span>,<span class="hljs-string">""</span>,<span class="hljs-number">60</span>,<span class="hljs-number">10</span>,sku,<span class="hljs-number">0</span>);
<span class="hljs-built_in">document</span>.close();
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">BODY</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">HTML</span>&gt;</span>
</code></pre><p>the code works just the way that its supposed to in IOS … and the emulator loads the webpage … i can change different colors etc.) </p>
<p>but then I get the following errors</p>
<pre><code class="hljs">[<span class="hljs-constant">TiWebChromeClient.</span>console( <span class="hljs-number">1033</span>)] (main) [<span class="hljs-number">1442</span>,<span class="hljs-number">12869</span>] <span class="hljs-constant">Uncaught ReferenceError:</span> sku is <span class="hljs-keyword">not</span> <span class="hljs-keyword">defined</span> (<span class="hljs-number">18</span><span class="hljs-symbol">:file</span><span class="hljs-symbol">:///android_asset/Resources/local/jscode39</span>.html)
[<span class="hljs-constant">INFO]</span>[<span class="hljs-constant">TiWebChromeClient.</span>console( <span class="hljs-number">1033</span>)] (main) [<span class="hljs-number">573</span>,<span class="hljs-number">13442</span>] <span class="hljs-constant">Uncaught SyntaxError:</span> <span class="hljs-constant">Unexpected </span>token var (<span class="hljs-number">1</span><span class="hljs-symbol">:file</span><span class="hljs-symbol">:///android_asset/Resources/local/jscode39</span>.html)
[<span class="hljs-constant">WARN]</span>[<span class="hljs-constant">TiWebViewBinding(</span> <span class="hljs-number">1033</span>)] (<span class="hljs-constant">KrollRuntimeThread)</span> [<span class="hljs-number">2395</span>,<span class="hljs-number">15837</span>] <span class="hljs-constant">Timeout </span>waiting to evaluate <span class="hljs-constant">JS</span>
</code></pre><p>This is driving me nuts….</p>
<p>I can&#39;t figure out how to pass this variable across to the WEBVIEW in android</p>
<p>John</p>
</div>
							<div class="author">
								&mdash; commented <span title="October 24th 2013, 1:14:54 am">October 24th 2013</span>
								by <span class='authorname'>John Schimanski</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>0</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>0 Answers</h3>

	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
