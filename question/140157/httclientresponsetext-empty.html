<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>HTTClient.responseText empty » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>HTTClient.responseText empty</h1>
		</header>
		<section>
			<p>Hi, I&#39;m having a hard time while parsing a remote JSON file which I obtain using HTTPClient.<br>The &quot;onload&quot; event fires up, but the responseText property is empty, even when the JSON file is not.<br>The JSON file is 35Kb and I did test what could happend if I shorten it a bit. I&#39;ve seen that, if the JSON file is a small one I don&#39;t have this problem. Is there a limit about how much data can the responseText property can hold?</p>
<p>APP Type: Mobile<br>Ti SDK: Build: 2.1.0.201206251749 | jenkins-titanium-rcp-master-218 (origin&#x2F;master)<br>Platfrom: Android<br>Version: 2.2<br>Device: Emulator<br>Host: Debian x64</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> httpClient = Ti.Network.createHTTPClient({
            timeout: <span class="hljs-number">5000</span>,
            onload: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> </span>{
                alert( <span class="hljs-keyword">this</span>.getResponseText() );<span class="hljs-comment">//this.responseText is empty too</span>
            },
        });
httpClient.open( <span class="hljs-string">'GET'</span>, <span class="hljs-string">'url.bla.bla'</span> );<span class="hljs-comment">//url is valid, just a private one.</span>
httpClient.send();
</code></pre><p>JSON file contents: (Working)</p>
<pre><code class="hljs">{"<span class="hljs-attribute">canales</span>":<span class="hljs-value">[{"<span class="hljs-attribute">grupo</span>":<span class="hljs-value"><span class="hljs-string">"uchile.4.2005.0.ADI001.1"</span></span>,"<span class="hljs-attribute">autor</span>":<span class="hljs-value"><span class="hljs-string">"13047454"</span></span>,"<span class="hljs-attribute">fecha</span>":<span class="hljs-value"><span class="hljs-string">"2012-06-15 12:24:59"</span></span>,"<span class="hljs-attribute">serv_nombre</span>":<span class="hljs-value"><span class="hljs-string">"Material Docente"</span></span>,"<span class="hljs-attribute">serv_nombre_interno</span>":<span class="hljs-value"><span class="hljs-string">"material_docente"</span></span>,"<span class="hljs-attribute">serv_url</span>":<span class="hljs-value"><span class="hljs-string">"https://adi2.ing.uchile.cl/~andregon/ucursos/ucursos/uchile/2005/0/ADI001/1/material_docente/"</span></span>,"<span class="hljs-attribute">titulo</span>":<span class="hljs-value"><span class="hljs-string">"GUIA completo.txt"</span></span>,"<span class="hljs-attribute">mensaje</span>":<span class="hljs-value"><span class="hljs-string">"GUIA completo.txt"</span></span>,"<span class="hljs-attribute">url</span>":<span class="hljs-value"><span class="hljs-string">"https://adi2.ing.uchile.cl/~andregon/ucursos/ucursos/uchile/2005/0/ADI001/1/material_docente/objeto/375331"</span></span>}]</span>}
</code></pre><p>If the above entry (everything between []) is repeated 90 times (which is the times on the actual file) the responseText is empty.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="July 25th 2012, 2:50:29 pm">July 25th 2012</span>
				by <span class='authorname'>Andres Gonzalez</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>empty</span></li>
					
						<li><span class='tagname'>httpclient</span></li>
					
						<li><span class='tagname'>json</span></li>
					
						<li><span class='tagname'>responsetext</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>4</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>4 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-243777">
				
						<section>
							<p>Try</p>
<pre><code class="hljs"><span class="hljs-keyword">this</span>.responseText
</code></pre><p>instead of</p>
<pre><code class="hljs">this.<span class="hljs-function"><span class="hljs-title">getResponseText</span><span class="hljs-params">()</span></span>
</code></pre><p>I have run into a number of situations on android where the getter function doesn&#39;t work (on various different objects and properties throughout Titanium), but direct access to the property does work.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 25th 2012, 2:56:18 pm">July 25th 2012</span>
								by <span class='authorname'>Jason Priebe</span><br>
								<a class="icon-bg icon-link" href="question/140157/httclientresponsetext-empty#answer-243777" rel="permalink">permalink</a>
							</div>

							<h5>9 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>As I said (marked as a comment in the code)</p>
<pre><code class="hljs"><span class="hljs-keyword">this</span>.responseText
</code></pre><p>and </p>
<pre><code class="hljs">this.<span class="hljs-function"><span class="hljs-title">getResponseText</span><span class="hljs-params">()</span></span>
</code></pre><p>are both empty.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 2:59:53 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Sorry – I missed that.</p>
<p>Can you put a short file (that works) and a long file (that doesn&#39;t work) on a public web server somewhere and create a one-file app.js example that demonstrates the problem?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 3:01:42 pm">July 25th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;ll do so in a few minutes, but it&#39;s quite the same that it&#39;s already here.<br>A generic HTTPClient usage and either a small (455bytes, working, just like the one in the example) or a big (35Kbytes, repeating</p>
<pre><code class="hljs">{"<span class="hljs-attribute">grupo</span>":<span class="hljs-value"><span class="hljs-string">"uchile.4.2005.0.ADI001.1"</span></span>,"<span class="hljs-attribute">autor</span>":<span class="hljs-value"><span class="hljs-string">"13047454"</span></span>,"<span class="hljs-attribute">fecha</span>":<span class="hljs-value"><span class="hljs-string">"2012-06-15 12:24:59"</span></span>,"<span class="hljs-attribute">serv_nombre</span>":<span class="hljs-value"><span class="hljs-string">"Material Docente"</span></span>,"<span class="hljs-attribute">serv_nombre_interno</span>":<span class="hljs-value"><span class="hljs-string">"material_docente"</span></span>,"<span class="hljs-attribute">serv_url</span>":<span class="hljs-value"><span class="hljs-string">"https://adi2.ing.uchile.cl/~andregon/ucursos/ucursos/uchile/2005/0/ADI001/1/material_docente/"</span></span>,"<span class="hljs-attribute">titulo</span>":<span class="hljs-value"><span class="hljs-string">"GUIA completo.txt"</span></span>,"<span class="hljs-attribute">mensaje</span>":<span class="hljs-value"><span class="hljs-string">"GUIA completo.txt"</span></span>,"<span class="hljs-attribute">url</span>":<span class="hljs-value"><span class="hljs-string">"https://adi2.ing.uchile.cl/~andregon/ucursos/ucursos/uchile/2005/0/ADI001/1/material_docente/objeto/375331"</span></span>}
</code></pre><p>90 times will do).</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 3:06:48 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>&quot;Quite the same&quot; is not the same as &quot;exactly the same as&quot;.  :-)</p>
<p>I&#39;m pretty sure that I&#39;ve used HTTPClient to download documents larger than 35KB, so it&#39;s critical that we take a look at the exact document you&#39;re unable to load.  </p>
<p>There are lots of variables at play here – maybe your server is not playing nice with HTTPClient (maybe HTTP response headers are incompatible or something).</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 3:09:24 pm">July 25th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>The file can be viewed at pastebin.com&#x2F;3e7nBQcJ</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:28:50 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>That doesn&#39;t help much.  I need a fully repeatable example of code.  In other words, you post an app.js that contains a URL to a JSON file that fails.  Then we have something we can investigate.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:32:18 pm">July 25th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>JSON File URL: http:&#x2F;&#x2F;adi.ing.uchile.cl&#x2F;~test&#x2F;canales.json<br>The code in the app.js is quite more complex than what I can show here, but a simple window implementing the code of HTTPClient (which is the same as the example) will do. Since I did just try that in the callback function for onload. Just the alert, I mean.<br>In other words, the content in the json file (at the url or at pastebin) and the simple&#x2F;generic use of the Ti.Network.createHTTPClient() are all is needed to repeat the error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:41:16 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I don&#39;t think you understand.  I want you to come up with a minimal example that fails.  Then post the minimal example.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:45:07 pm">July 25th 2012</span>
											by <span class='authorname'>Jason Priebe</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think I did understood, and the example is what I had posted here. I don&#39;t know how much simplier than</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> httpClient = Ti.Network.createHTTPClient({
            onload: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( e )</span> </span>{
                alert( <span class="hljs-keyword">this</span>.getResponseText() );<span class="hljs-comment">//this.responseText is empty too</span>
            },
        });
httpClient.open( <span class="hljs-string">'GET'</span>, <span class="hljs-string">'http://adi.ing.uchile.cl/~test/canales.json'</span> );
httpClient.send();
}
</code></pre><p>can you get. :S (Ok, I&#39;ve removed the timeout parameter, just in case)<br>If you mean for me to add</p>
<pre><code class="hljs"><span class="hljs-keyword">if</span>( Ti.<span class="hljs-keyword">version</span> &lt; 1.8 ) {
    alert('Sorry - this application template requires Titanium Mobile SDK 1.8 or later');
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">window</span> = Ti.UI.createWindow();
    <span class="hljs-comment">//httpClient code</span>
    <span class="hljs-keyword">window</span>.<span class="hljs-keyword">open</span>();
}
</code></pre><p>is just all the same. Or so I think.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:52:45 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-243779">
				
						<section>
							<p>Can you try and increase the timeout? Or even remove it, to see if that has any effect?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 25th 2012, 3:45:56 pm">July 25th 2012</span>
								by <span class='authorname'>Pallavi Sivakumaran</span><br>
								<a class="icon-bg icon-link" href="question/140157/httclientresponsetext-empty#answer-243779" rel="permalink">permalink</a>
							</div>

							<h5>10 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Increasing the timeout, or not declaring it, has show no change in the behavior.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:25:00 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I don&#39;t know whether or not this would make any difference, but there&#39;s a Parse error on line 1022 in the JSON object (according to http:&#x2F;&#x2F;jsonlint.com):<br><em>&quot;titulo&quot;: &quot;Roberto Meza: &quot;LaLeySOPAeInternet&quot;&quot;,</em></p>
<p>Maybe correcting this would fix the issue?</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:41:27 pm">July 25th 2012</span>
											by <span class='authorname'>Pallavi Sivakumaran</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I think it would do if I parse the JSON file (which I was planning to do later), but instead of a parsing error I just get an empty responseText. I&#39;ll try fixing that and see what happens.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:43:34 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Nopes, I&#39;ve just added some slashes to it (…&quot;titulo&quot;:&quot;Roberto Meza: \&quot;La Ley SOPA e Internet\&quot;&quot;…, 2 times in the file) and still empty responseText</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:46:22 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I tried accessing the JSON and got the following error in the console:</p>
<pre><code class="hljs">[<span class="hljs-link_label">ERROR</span>][<span class="hljs-link_reference">TiHttpClient(  370)</span>] (KrollRuntimeThread) [2430,2430] Unable to decode using charset: UTF-8
</code></pre><p>Try changing the charset as mentioned in the following link:<br>http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;137869&#x2F;tihttpclient-unable-to-decode-using-charset-utf-8#answer-240128</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:53:12 pm">July 25th 2012</span>
											by <span class='authorname'>Pallavi Sivakumaran</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Checking that now, I didn&#39;t  see that error before. Sorry if this was the thing causing the problem.<br>Will be back with an update.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:56:22 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m not sure if I&#39;m testing this right, should I just</p>
<pre><code class="hljs">httpClient.<span class="hljs-keyword">open</span>(...);
httpClient.setRequestHeader( <span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/json'</span>, <span class="hljs-string">'charset=ISO-8859-1'</span> );
httpClient.<span class="hljs-keyword">send</span>();
</code></pre><p>?<br>If so, well, didn&#39;t work. I still have the UTF-8 error on the console and the empty responseText.<br>I&#39;ll see if I can change the encoding of the file and see what happens.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 5:08:20 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>There, it worked… I need to force the encoding of the file from the server.<br>I don&#39;t like the idea of fixing it like this, but that will work for testing purposes.</p>
<p>Thanks again.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 5:11:43 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>No probs. Glad it worked :)</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 5:12:56 pm">July 25th 2012</span>
											by <span class='authorname'>Pallavi Sivakumaran</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>To further clarify this problem (which was mine), AFAIKnew our server was forcing ISO-8859-1 encoding (the same as the json file) and seems like the httpClient connects using only UTF-8, which caused the problem decoding (noted in the console). After converting the json file to UTF-8 worked like a charm.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 5:26:58 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-243782">
				
						<section>
							<p>Just wondering if you can get it to work outside of the Titanium Environment? Have you tried just doing the same request in a browser to see if it works. I always seem to find my mistakes that way.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 25th 2012, 3:53:06 pm">July 25th 2012</span>
								by <span class='authorname'>Lee Bartelme</span><br>
								<a class="icon-bg icon-link" href="question/140157/httclientresponsetext-empty#answer-243782" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>If i just open the url of the JSON file in a browser, it works just fine, and our ajax functions get the file too.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 4:24:27 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-243799">
				
						<section>
							<p>In the end, was a matter of encodings between the server, the file and the httpClient.<br>I didn&#39;t notice the error line in the console, so I&#39;m the one to blame here.<br>:P</p>
<p>Anyway, moral of the story: double check ALL the encodings!</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="July 25th 2012, 5:30:16 pm">July 25th 2012</span>
								by <span class='authorname'>Andres Gonzalez</span><br>
								<a class="icon-bg icon-link" href="question/140157/httclientresponsetext-empty#answer-243799" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>An onerror method with an alert could have saved you some time also.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 9:11:38 pm">July 25th 2012</span>
											by <span class='authorname'>Darren Adams</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well onerror is not fired by this. I did had it implemented.</p>
</p>
										<div class="author">
											&mdash; commented <span title="July 25th 2012, 9:24:41 pm">July 25th 2012</span>
											by <span class='authorname'>Andres Gonzalez</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
