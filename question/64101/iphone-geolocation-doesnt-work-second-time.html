<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>iPhone Geolocation doesn&#39;t work second time » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>iPhone Geolocation doesn&#39;t work second time</h1>
		</header>
		<section>
			<p>I am writing an AR section for an iPhone app and the first time it runs it works great, but if I exit out of the screen (not the app) and then return to the AR screen the geolocation eventlistener that I add again does not ever get called.  </p>
<p>Titanium.Geolocation.addEventListener(&#39;heading&#39;,goHeading);</p>
<p>I notice the same happens in KitchenSink in the AR demo screen, so it&#39;s not just me…</p>
<p>Someone had this problem with Android (http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;43171&#x2F;android-titaniumgeolocation-wont-run-again-after-pressing-the-arrow-button) - is there a fix for the iPhone SKD as well? </p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="September 23rd 2010, 6:25:37 am">September 23rd 2010</span>
				by <span class='authorname'>Paul Burrowes</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>geolocation</span></li>
					
						<li><span class='tagname'>iphone</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>6</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>6 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-125201">
				
						<section>
							<p>I have the exact same problem with the location listener (among numerous other problems). </p>
<p>If I exit the page and go back again it never starts up. Leaving the app and going back in again, it starts up fine.</p>
<p>Did you ever sort this out?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 10th 2010, 8:07:15 am">October 10th 2010</span>
								by <span class='authorname'>Leigh Kayley</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-125201" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-125211">
				
						<section>
							<p>Have you tried doing a Titanium.Geolocation.removeEventListener(&#39;heading&#39;); when you &#39;close&#x2F;blur&#39; the window?  Then start it when you &#39;open&#x2F;focus&#39; it?</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="October 10th 2010, 9:16:58 am">October 10th 2010</span>
								by <span class='authorname'>Kosso</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-125211" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-139521">
				
						<section>
							<p>Same problem here (iPhone) : my app shows the email dialog, and once closed, hop, no more heading. Even removing and setting back the event listener does not bring it to life.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 8th 2010, 4:57:20 pm">November 8th 2010</span>
								by <span class='authorname'>Christophe Soudron</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-139521" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-217724">
				
						<section>
							<p>Removing and resetting the listener works for me (SDK 1.7.2):</p>
<pre><code class="hljs">Ti.Geolocation.distanceFilter = <span class="hljs-number">15</span>;

<span class="hljs-keyword">var</span> locationCallback = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    Ti.Geolocation.removeEventListener(<span class="hljs-string">'location'</span>, locationCallback);
    Ti.Geolocation.addEventListener(<span class="hljs-string">'location'</span>, locationCallback);

    hiApp.location = e.coords;
}

Ti.Geolocation.addEventListener(<span class="hljs-string">'location'</span>, locationCallback);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="August 30th 2011, 11:04:39 am">August 30th 2011</span>
								by <span class='authorname'>Kristof Gruber</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-217724" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-225028">
				
						<section>
							<p>The Problem still exists, anyone has found a workaround for that? Im&#39; on 1.7.5 and 1.7.6.20111206</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 7th 2011, 6:13:44 pm">December 7th 2011</span>
								by <span class='authorname'>Konstantin Filtschew</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-225028" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-225035">
				
						<section>
							<p>I&#39;ve fixed it. If you remove the eventListener and there is no event listener registered, the framework stops working and you will never be able to register an event listener for location again. The only chance is to restart the app or program it the right way as appcelerator expects it:</p>
<pre><code class="hljs"><span class="hljs-keyword">var</span> locationCallbackEnabled = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">var</span> locationCallback = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
    Ti.API.info(<span class="hljs-string">'coords: '</span>+e.coords);
}

<span class="hljs-comment">// If you register one, you have to remove one</span>
Ti.Geolocation.addEventListener(<span class="hljs-string">'location'</span>, locationCallback);
<span class="hljs-comment">// save the information, that an event listener is registered</span>
locationCallbackEnabled = <span class="hljs-literal">true</span>;


<span class="hljs-keyword">var</span> removelocationCallback = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

    <span class="hljs-comment">/* ATTENTION: This is the most important thing. 
      * Check if the listener is added or not. 
         * If you don't do this, you will not be able to 
         * add an event listener again!
     */</span>
    <span class="hljs-keyword">if</span> (locationCallbackEnabled) {
        Ti.Geolocation.removeEventListener(<span class="hljs-string">'location'</span>, locationCallback);
        <span class="hljs-comment">// save the information, that</span>
        locationCallbackEnabled = <span class="hljs-literal">false</span>;
    }
}

<span class="hljs-comment">// remove the event listener after 20 seconds</span>
setTimeout(removelocationCallback, <span class="hljs-number">1000</span>*<span class="hljs-number">20</span>);

<span class="hljs-comment">// if you do this again, it is now save because</span>
<span class="hljs-comment">// locationCallbackEnabled is set to false</span>
setTimeout(removelocationCallback, <span class="hljs-number">1000</span>*<span class="hljs-number">25</span>);
</code></pre>
						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="December 7th 2011, 7:18:51 pm">December 7th 2011</span>
								by <span class='authorname'>Konstantin Filtschew</span><br>
								<a class="icon-bg icon-link" href="question/64101/iphone-geolocation-doesnt-work-second-time.html#answer-225035" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
