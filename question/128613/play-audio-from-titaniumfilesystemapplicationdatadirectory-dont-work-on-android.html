<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Play audio from Titanium.Filesystem.applicationDataDirectory don&#39;t work on android » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Play audio from Titanium.Filesystem.applicationDataDirectory don&#39;t work on android</h1>
		</header>
		<section>
			<p>I download a file to <code>applicationDataDirectory</code> and try to play it using <code>Ti.Media.createSound</code>, on iphone it&#39;s work fine, but on android I get an error:</p>
<p><code>java.io.IOException: Prepare failed.: status=0x1.</code> I solved it by save the file to <code>externalStorageDirectory</code> but now all the files appears in music gallery. Here is my code:</p>
<pre><code class="hljs">Ti.App.dataDir = Titanium.Filesystem.applicationDataDirectory + Ti.Filesystem.<span class="hljs-keyword">separator</span> + <span class="hljs-string">'Phrasebook/'</span>;
var <span class="hljs-keyword">file</span> = Ti.Filesystem.getFile(Ti.App.dataDir, Ti.App.selectedLang + <span class="hljs-string">'/'</span> + mp3 + <span class="hljs-string">'.mp3'</span>);
var <span class="hljs-keyword">sound</span> = Ti.Media.createSound({ url: <span class="hljs-keyword">file</span>.nativePath, volume:<span class="hljs-number">1</span> });
<span class="hljs-keyword">sound</span>.<span class="hljs-keyword">play</span>();
</code></pre><p>I check that the file exists and it is. Any solution???</p>
<p>Thanks, Roie.</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="November 23rd 2011, 9:11:30 am">November 23rd 2011</span>
				by <span class='authorname'>roie salem</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>applicationdatadirec</span></li>
					
						<li><span class='tagname'>externalstoragedirec</span></li>
					
						<li><span class='tagname'>java.io.ioexception</span></li>
					
						<li><span class='tagname'>status=0x1</span></li>
					
						<li><span class='tagname'>ti.media.createsound</span></li>
					
				</ul>
			

			<section>
				<h5>1 Comment</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>working on the same issue, still waiting for the solution…??</p>
</div>
							<div class="author">
								&mdash; commented <span title="November 23rd 2011, 9:20:38 am">November 23rd 2011</span>
								by <span class='authorname'>Gagan Tiwari</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>1</span> Vote</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-224096">
				
						<section>
							<p>Use ADB shell to check and make sure the file exists in the path, debug message with the file path will help. Also make sure you can play the file in a normal situation (IE on your desktop). </p>
<p>When I got this I was pointing to the wrong file location. Ti is a little touchy on Android with the file paths so you have to make REALLY sure you&#39;re actually pointing to a real place.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 23rd 2011, 12:31:19 pm">November 23rd 2011</span>
								by <span class='authorname'>David Horton</span><br>
								<a class="icon-bg icon-link" href="../../question/128613/play-audio-from-titaniumfilesystemapplicationdatadirectory-dont-work-on-android.html#answer-224096" rel="permalink">permalink</a>
							</div>

							<h5>9 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Hay David,<br>Thank&#39;s for the help, I locate the file and see that I point to his right location, I also copied him to my desktop and play him, the file is fine.<br>I found him in </p>
<p><code>file:&amp;#x2F;&amp;#x2F;&amp;#x2F;data&amp;#x2F;data&amp;#x2F;com.MTF.PhraseBook&amp;#x2F;app_appdata&amp;#x2F;Phrasebook&amp;#x2F;de&amp;#x2F;89.mp3</code> </p>
<p>and this is my path, I write the path to the file url myself and still getting the same error.</p>
<p>Any solution?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 24th 2011, 7:29:00 am">November 24th 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Paste the code you&#39;re using. There are a few ways to play mp3s. I remember having to switch it up to get rid of this error.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 24th 2011, 4:34:26 pm">November 24th 2011</span>
											by <span class='authorname'>David Horton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>You mean this code!?</p>
<pre><code class="hljs">Ti.App.dataDir = Titanium.Filesystem.applicationDataDirectory + Ti.Filesystem.<span class="hljs-keyword">separator</span> + <span class="hljs-string">'Phrasebook/'</span>;
var <span class="hljs-keyword">file</span> = Ti.Filesystem.getFile(Ti.App.dataDir, Ti.App.selectedLang + <span class="hljs-string">'/'</span> + mp3 + <span class="hljs-string">'.mp3'</span>);
var <span class="hljs-keyword">sound</span> = Ti.Media.createSound({ url: <span class="hljs-keyword">file</span>.nativePath, volume:<span class="hljs-number">1</span> });
<span class="hljs-keyword">sound</span>.<span class="hljs-keyword">play</span>();
</code></pre><p>If not please let me know.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 25th 2011, 7:11:08 am">November 25th 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Try doing <del>~var file = Titanium.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, Ti.App.selectedLang, mp3,&quot;.mp3&quot;);</del>~ and remove the first line. Might not work but I got that method from the docs somewhere.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 25th 2011, 7:28:35 am">November 25th 2011</span>
											by <span class='authorname'>David Horton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you David,<br>Still don&#39;t work… :( Here is the full error, maybe it will help…</p>
<pre><code class="hljs">I/<span class="hljs-function"><span class="hljs-title">StagefrightPlayer</span><span class="hljs-params">(   <span class="hljs-number">34</span>)</span></span>: <span class="hljs-function"><span class="hljs-title">setDataSource</span><span class="hljs-params">(<span class="hljs-string">'/data/data/com.CompanyName.AppID/app_appdata/en/69.mp3'</span>)</span></span>
E/<span class="hljs-function"><span class="hljs-title">MediaPlayer</span><span class="hljs-params">(  <span class="hljs-number">396</span>)</span></span>: error (<span class="hljs-number">1</span>, -<span class="hljs-number">2147483648</span>)
W/TiSound (  <span class="hljs-number">396</span>): (kroll$<span class="hljs-number">5</span>: app:<span class="hljs-comment">//main_window/phrases.js) [675,17578] Issue while initializing : </span>
W/TiSound (  <span class="hljs-number">396</span>): java<span class="hljs-class">.io</span><span class="hljs-class">.IOException</span>: Prepare failed.: status=<span class="hljs-number">0</span>x1
W/TiSound (  <span class="hljs-number">396</span>):     at android<span class="hljs-class">.media</span><span class="hljs-class">.MediaPlayer</span><span class="hljs-class">.prepare</span>(Native Method)
</code></pre><p>Any Ideas!?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 27th 2011, 5:48:43 am">November 27th 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Two things you need to look at: 1. does the Android emulator have &#39;sound playback&#39; enabled in AVD manager. #2 try a different Android API version, I&#39;ve found 2.2 to be the most stable as far as the simulator. When you do this, switch it in the AVD manager as well as debug&#x2F;build configuration in Titanium Studio. Good luck!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 27th 2011, 5:34:59 pm">November 27th 2011</span>
											by <span class='authorname'>David Horton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I&#39;m working on 2.2 and the sound doesn&#39;t play on the device and the Emulator, But if I change the path to externalStorageDirectory everything work just fine. Please HELP!!! Thanks in advance!</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 28th 2011, 5:57:22 am">November 28th 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Well you&#39;ve got me stumped…Not sure how you&#39;re planning to use the phone&#39;s application data directory, unless the app lives on the SD card you&#39;re gonna run out of space pretty fast. I suggest you figure out a workaround to keep the files from appearing in the library when you store them on SD card.</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 28th 2011, 4:18:32 pm">November 28th 2011</span>
											by <span class='authorname'>David Horton</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you david, I tried your suggestion about keep the files from appearing and got the solution. Here is the <a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;128819&#x2F;how-to-prevent-from-audio-files-to-appear-in-music-gallery-when-saving-to-externalstoragedirectory-on-android">link</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="November 29th 2011, 10:00:08 am">November 29th 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224082">
				
						<section>
							<p>Try the following as if Sound file is large you should to call createSound with preload option.</p>
<p><code>var sound = Ti.Media.createSound({ url: file.nativePath, volume:1, preload:true});</code></p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 23rd 2011, 9:25:36 am">November 23rd 2011</span>
								by <span class='authorname'>Hemang Kakadia</span><br>
								<a class="icon-bg icon-link" href="../../question/128613/play-audio-from-titaniumfilesystemapplicationdatadirectory-dont-work-on-android.html#answer-224082" rel="permalink">permalink</a>
							</div>

							<h5>1 Comment</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Dear Hemang Kakadia,<br>Thank you for the quick response, I tried your suggestion but no luck.<br>Still getting the same annoying error…</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 23rd 2011, 9:49:48 am">November 23rd 2011</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-224471">
				
						<section>
							<p>Hi </p>
<p>Please try by replacing the file:&#x2F;&#x2F; with the app:&#x2F;&#x2F; might solve the problem</p>
<p>Regards</p>
<p>Nikunj</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="November 29th 2011, 10:15:33 am">November 29th 2011</span>
								by <span class='authorname'>Nikunj Sakhrelia</span><br>
								<a class="icon-bg icon-link" href="../../question/128613/play-audio-from-titaniumfilesystemapplicationdatadirectory-dont-work-on-android.html#answer-224471" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>3 years ago and the same problem… :&#x2F; </p>
<p>Someone has a trick to solution this problem?</p>
</p>
										<div class="author">
											&mdash; commented <span title="November 3rd 2014, 8:12:07 pm">November 3rd 2014</span>
											by <span class='authorname'>Eduardo Silva</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p><a href="http:&#x2F;&#x2F;developer.appcelerator.com&#x2F;question&#x2F;128819&#x2F;how-to-prevent-from-audio-files-to-appear-in-music-gallery-when-saving-to-externalstoragedirectory-on-android">How to prevent from audio files to appear in music gallery when saving to externalStorageDirectory on android</a></p>
</p>
										<div class="author">
											&mdash; commented <span title="November 4th 2014, 6:16:17 am">November 4th 2014</span>
											by <span class='authorname'>roie salem</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
