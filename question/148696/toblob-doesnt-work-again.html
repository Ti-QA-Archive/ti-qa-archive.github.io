<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>toBlob() doesn&#39;t work (AGAIN) » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>toBlob() doesn&#39;t work (AGAIN)</h1>
		</header>
		<section>
			<p>Well, in 3.0.1  all works fine, but now, only on Android,  imageView.toBlob () always returns null.</p>
<p>I tried to &#39;revert&#39; to 3.0.1 but I can&#39;t….</p>
<p>BRrrrrrrr  I think Titanium for Android is a nightmare !</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="February 23rd 2013, 1:24:31 am">February 23rd 2013</span>
				by <span class='authorname'>Avelino Garcia</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>3.0.2</span></li>
					
						<li><span class='tagname'>android</span></li>
					
						<li><span class='tagname'>toblob</span></li>
					
				</ul>
			

			<section>
				<h5>0 Comments</h5>
				
			</section>
		</footer>
		<aside class="vote-box">
			<div class="score"><span>0</span> Votes</div>
			<div class="answers"><span>3</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>3 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article id="answer-257395">
				
						<section>
							<p>I think toBlob() creates problem for android many times so it&#39;s better to use </p>
<p><code>toImage()</code> instead of <code>toBlob()</code>.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 23rd 2013, 2:49:37 am">February 23rd 2013</span>
								by <span class='authorname'>Sarafaraz Babi</span><br>
								<a class="icon-bg icon-link" href="question/148696/toblob-doesnt-work-again#answer-257395" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-257397">
				
						<section>
							<p>Hey Avelino,</p>
<p>Faced the same issue but I found work around.</p>
<pre><code class="hljs"><span class="hljs-variable"><span class="hljs-keyword">var</span> pic</span> = imageView.toImage();
</code></pre><p>Hope it will work for you :)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 23rd 2013, 4:19:25 am">February 23rd 2013</span>
								by <span class='authorname'>Himanshu A</span><br>
								<a class="icon-bg icon-link" href="question/148696/toblob-doesnt-work-again#answer-257397" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-257484">
				
						<section>
							<p>Well, I&#39;ve been working on that problem and I found the solution for dealing with sprites. So I write it down here for someone else help.</p>
<p>This is the code that DOESN&#39;T WORK for android:</p>
<p>you can try it copying it and put it into app.js</p>
<pre><code class="hljs"><span class="hljs-comment">//////////////////  </span>
<span class="hljs-comment">// test blob --&gt; sprite   </span>
<span class="hljs-comment">// author : Avelino Garcia</span>
<span class="hljs-comment">// date   : 2013 02 25  </span>

<span class="hljs-comment">// this code worked ok in 3.0.1  but it doesn't in 3.0.2</span>
<span class="hljs-comment">// always taking about android (on iOS works fine in both versions)</span>

var win = Ti.UI.createWindow({
    <span class="hljs-string">backgroundColor :</span> <span class="hljs-string">'#ffffff'</span>,
});

<span class="hljs-comment">// im1.png is an image of 81 sprites (9x9)  of 111x111 pixels each</span>

var wholeSprite = Ti.UI.createImageView({
<span class="hljs-string">image :</span> <span class="hljs-string">'im1.png'</span>,
<span class="hljs-string">width :</span> <span class="hljs-number">9</span> * <span class="hljs-number">111</span>,
<span class="hljs-string">height :</span> <span class="hljs-number">9</span> * <span class="hljs-number">111</span>
});

<span class="hljs-comment">// here's the problem.  In version 3.0.1 that worked OK. Now in 3.0.3  blobWholeSprite is null</span>
<span class="hljs-comment">// tried to put toImage instead but then, can't do 'imageAsCropped'...</span>
var blobWholeSprite = wholeSprite.toBlob();

<span class="hljs-comment">// try to get the frist sprite (in 0,0)</span>
var oneSpriteImage = blobWholeSprite.imageAsCropped({
<span class="hljs-string">height :</span> <span class="hljs-number">111</span>,
<span class="hljs-string">width :</span> <span class="hljs-number">111</span>,
<span class="hljs-string">x :</span> <span class="hljs-number">111</span> * <span class="hljs-number">0</span>,
<span class="hljs-string">y :</span> <span class="hljs-number">111</span> * <span class="hljs-number">0</span>
});

<span class="hljs-comment">// try to show it with other size</span>
var viewOneSprite = Ti.UI.createImageView({
    <span class="hljs-string">width :</span> <span class="hljs-number">50</span>,
    <span class="hljs-string">height :</span> <span class="hljs-number">50</span>,
    <span class="hljs-string">top :</span> <span class="hljs-number">10</span>,
    <span class="hljs-string">left :</span> <span class="hljs-number">10</span>,
    <span class="hljs-string">image :</span> oneSpriteImage
});
win.add(viewOneSprite);


win.open();

<span class="hljs-comment">/////////////////  END OF (now) BAD CODE</span>
</code></pre><p>This is the workaround founded:</p>
<pre><code class="hljs">/<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
/</span><span class="hljs-regexp">/ test blob --&gt; sprite   
/</span><span class="hljs-regexp">/ author : Avelino Garcia
/</span><span class="hljs-regexp">/ date   : 2013 02 25  

/</span><span class="hljs-regexp">/ this code works ok in 3.0.2  for ANDROID 

var win = Ti.UI.createWindow({
    backgroundColor : '#ffffff',
});

/</span><span class="hljs-regexp">/ im1.png is an image of 81 sprites (9x9)  of 111x111 pixels each
var wholeSpriteFile = Titanium.Filesystem.getFile('im1.png');

var wholeSpriteBlob = wholeSpriteFile.read();

/</span><span class="hljs-regexp">/ try to get the first sprite (in 0,0)
var oneSpriteImage = wholeSpriteBlob.imageAsCropped({
    height : 111,
    width : 111,
    x : 111 * 0,
    y : 111 * 0
});
var oneSpriteView = Ti.UI.createImageView({
    width : 50,
    height : 50,
    top : 10,
    left : 10,
    image : oneSpriteImage
});

win.add(oneSpriteView);

win.open();

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/ END OF (now) GOOD CODE</span>
</code></pre><p>Avelino</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="February 25th 2013, 9:30:00 am">February 25th 2013</span>
								by <span class='authorname'>Avelino Garcia</span><br>
								<a class="icon-bg icon-link" href="question/148696/toblob-doesnt-work-again#answer-257484" rel="permalink">permalink</a>
							</div>

							<h5>0 Comments</h5>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
