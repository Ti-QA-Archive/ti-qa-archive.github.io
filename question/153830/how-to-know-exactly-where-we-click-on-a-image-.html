<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>How to know exactly where we click on a image ? » Community Questions &amp; Answers » Appcelerator Developer Center</title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>How to know exactly where we click on a image ?</h1>
		</header>
		<section>
			<p>Hello,</p>
<p>I have a image of map of USA&#39;s state and I need to know on wich state the person click ? I want to do that on Androïd, iPhone and iPad ? How can I do that ? I was thinking about color… But I don&#39;t have any way to do that… Because I&#39;m sur I&#39;ll have problem with different size of screen.. Anyone has an idea ?</p>
<p>![alt USA] (http:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;commons&#x2F;thumb&#x2F;1&#x2F;1e&#x2F;Map_of_USA_showing_state_names.png&#x2F;800px-Map_of_USA_showing_state_names.png &quot;USA&#39;s state&quot;)</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="June 19th 2013, 12:21:22 pm">June 19th 2013</span>
				by <span class='authorname'>François Coppey</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>alloy</span></li>
					
						<li><span class='tagname'>click</span></li>
					
						<li><span class='tagname'>image</span></li>
					
						<li><span class='tagname'>map</span></li>
					
				</ul>
			

			<section>
				<h5>3 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>@François Coppey     : <strong>+1</strong> for this question and m also intrested in this.</p>
</div>
							<div class="author">
								&mdash; commented <span title="June 19th 2013, 12:40:18 pm">June 19th 2013</span>
								by <span class='authorname'>Dharmik Patel</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>I&#39;m trying this : https:&#x2F;&#x2F;developers.google.com&#x2F;chart&#x2F;image&#x2F;docs&#x2F;gallery&#x2F;new_map_charts</p>
</div>
							<div class="author">
								&mdash; commented <span title="June 19th 2013, 12:50:26 pm">June 19th 2013</span>
								by <span class='authorname'>François Coppey</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Forget Google… It&#39;s using with Flash…. so not working in Apple… And I doesn&#39;t want to use a webview</p>
</div>
							<div class="author">
								&mdash; commented <span title="June 19th 2013, 1:45:43 pm">June 19th 2013</span>
								by <span class='authorname'>François Coppey</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>2</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-264520">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>Many of the touch events you can assign to the imageView or any other view return the coordinates x&amp;y and certainly the ones you will need..</p>
<p>From these two values you can then determine the position the user touched, then reference the location on the image using a simple &quot;close enough&quot; rectangular &quot;hit zone&quot;.</p>
<p>You can get a much more accurate region by using a polygon match but this involves a set of polygon points and a test to find out if the hit was inside or outside the irregular shape.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 19th 2013, 2:20:24 pm">June 19th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/153830/how-to-know-exactly-where-we-click-on-a-image-#answer-264520" rel="permalink">permalink</a>
							</div>

							<h5>8 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>How to detect a point in a polygon;</p>
<ul>
<li><a href="http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Point_in_polygon">Wiki description</a></li>
</ul>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 2:23:31 pm">June 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank you for your answer… But it will be very difficult to do your solution when the size of the screen change… The image will be in a full screen ! So it will be totally different in a iPad, iPhone or Android device… I&#39;m looking for something easier to do that.. I&#39;m sure if I&#39;m going to create polygones in a layer, it&#39;s going to change place when the screen size change and the precision will be bad….. :-(</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 3:05:33 pm">June 19th 2013</span>
											by <span class='authorname'>François Coppey</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>All the values will be relative to the original image, so if the image 1000x800 and you are now showing it at 500x400 then all the points are halved, different scale of main image simply different scale of adjustment factor - really easy.</p>
<p>Even if you adjusted the aspect ratio (you would not though) you then have one scale factor width and another for height.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 3:59:14 pm">June 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Thank&#39;s for your response..</p>
<p>Do you have any exemple about how I can do that in Titanium ? I&#39;m sure to understand how to do that….</p>
<p>Thank you again !!!</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 4:19:29 pm">June 19th 2013</span>
											by <span class='authorname'>François Coppey</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>OK here goes, I have made a very simple proof of concept app for you, to run it, simply create a new default classic app and replace the contents of <strong>app.js</strong> with the code below, it is a fully working example.</p>
<p>One other point - I used your own map (the one you embedded in the question) I rotated it 90 degrees clockwise so Washington is in the top right corner of the new portrait image.  This was done for simplicity to show you what to do.  This is then placed in the root of resources with a file name of <strong>map.png</strong>.</p>
<pre><code class="hljs">var win = Ti.UI.createWindow({  
    backgroundColor: <span class="hljs-string">'#fff'</span>
});

var lbl = Ti.UI.createLabel({
    <span class="hljs-variable">height</span>: Ti.UI.SIZE,
    <span class="hljs-built_in">text</span>: <span class="hljs-string">'State'</span>,
    <span class="hljs-built_in">textAlign</span>: <span class="hljs-string">'center'</span>,
    top: <span class="hljs-number">0</span>,
    <span class="hljs-variable">width</span>: Ti.UI.FILL
});
win.<span class="hljs-built_in">add</span>(lbl);

var states = [
    { name: <span class="hljs-string">'Washington'</span>, x: <span class="hljs-number">414</span>, y: <span class="hljs-number">58</span>, w: <span class="hljs-number">36</span>, h: <span class="hljs-number">82</span> },
    { name: <span class="hljs-string">'Oregon'</span>, x: <span class="hljs-number">354</span>, y: <span class="hljs-number">34</span>, w: <span class="hljs-number">44</span>, h: <span class="hljs-number">96</span> }
];
var <span class="hljs-built_in">scale</span> = <span class="hljs-number">0.5</span>;
<span class="hljs-keyword">if</span> (Ti.Platform.osname === <span class="hljs-string">'ipad'</span>) {
    <span class="hljs-built_in">scale</span> = <span class="hljs-number">1</span>;
}
var img = Ti.UI.createImageView({
    <span class="hljs-variable">height</span>: <span class="hljs-number">800</span> * <span class="hljs-built_in">scale</span>,
    <span class="hljs-built_in">image</span>: <span class="hljs-string">'map.png'</span>,
    <span class="hljs-variable">width</span>: <span class="hljs-number">486</span> * <span class="hljs-built_in">scale</span>
});
img.addEventListener(<span class="hljs-string">'click'</span>, function (e) {
    var intState = <span class="hljs-number">0</span>, intStates = states.length, state = {};
    strNewCaption = <span class="hljs-string">''</span>;
    var scaled = {
        x: e.x / <span class="hljs-built_in">scale</span>,
        y: e.y / <span class="hljs-built_in">scale</span>
    };
    <span class="hljs-keyword">for</span> (intState = <span class="hljs-number">0</span>; intState &lt; intStates; intState = intState  + <span class="hljs-number">1</span>) {
        state = states[intState];
        <span class="hljs-keyword">if</span> (scaled.x &gt;= state.x &amp;&amp; scaled.x &lt;= (state.x + state.w)) {
            <span class="hljs-keyword">if</span> (scaled.y &gt;= state.y &amp;&amp; scaled.y &lt;= (state.y + state.h)) {
                strNewCaption = state.name;
            }
        }
    }
    lbl.setText(strNewCaption);
});
win.<span class="hljs-built_in">add</span>(img);

win.<span class="hljs-built_in">open</span>();
</code></pre><p>You simply expand the states array with each new location and dimensions.</p>
<p>You will not the dimensions are based on the original image pixels and the scale factor adjusts all the checking and image positioning automatically on each click.</p>
<p>Tested and working.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 5:44:31 pm">June 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>I tried what you do and it&#39;s working well…. but not enought for some reasons :</p>
<ul>
<li>The precision is very bad… I&#39;ll had to do a lot of rectangles to take all of the possibility and even more, the precision won&#39;t be enough..</li>
<li>It&#39;s working for iPhone, iPad… but what about iPad mini, iPhone 5, iOS 7 and all of screens for Androïd ?? It&#39;s to difficult to check all of possibility for the scale variable.</li>
</ul>
<p>Is it really impossible to have the color of a pixel when we click ? or create polygon with Titanium without webview ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 10:16:22 pm">June 19th 2013</span>
											by <span class='authorname'>François Coppey</span>
										</div>
									</li>
								
									<li class="comment">
										<p><ul>
<li>The precision was a quick proof-of-concept as stated, it uses rectangles to demonstrate the process and these were not designed to be perfect fits - this was a demonstration after all.</li>
<li>Of course it will work on all the other devices, you do not need to know the resolution ahead of time, you simply determine the scale factor of the image based on the devices physical width and height (or at least the viewable area) - this is normal and simple.</li>
<li>It is very possible to use poly-lines - I provided you a link to show you how to achieve this, you then merge that check into the code I provided - with poly-lines you can be as precise as you need by providing more or less points to make up the shape.</li>
<li>There is no built-in way to determine a colour from a coordinate, but even if there was you have a map full of states containing 5 main colours, but many more states, additionally you have black for the text - so that will tell you nothing and for every main colour you have the anti-alias colours that blend between the two so no luck there - poly-lines are the smartest way to go.</li>
<li>Sounds like you have come from a web background - which is fine, if a webView solves your problem then use it, not a native way to achieve the goal but it may prove to be a faster route for you.</li>
</ul>
<p>Everything I provided, including the fully working example is this is achieved in apps, you have a great starting point if you choose to use it - but you will have to do some work on it yourself of course.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2013, 7:42:37 am">June 20th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Yeah sure you are right !! I thought about that during night and it&#39;s exactly what I need.. Thank you !</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 20th 2013, 10:27:22 am">June 20th 2013</span>
											by <span class='authorname'>François Coppey</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-264514">
				
						<section>
							<p>![alt USA] (http:&#x2F;&#x2F;upload.wikimedia.org&#x2F;wikipedia&#x2F;commons&#x2F;thumb&#x2F;1&#x2F;1e&#x2F;Map_of_USA_showing_state_names.png&#x2F;800px-Map_of_USA_showing_state_names.png)</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="June 19th 2013, 12:22:02 pm">June 19th 2013</span>
								by <span class='authorname'>François Coppey</span><br>
								<a class="icon-bg icon-link" href="question/153830/how-to-know-exactly-where-we-click-on-a-image-#answer-264514" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>Anyone has an idea ?</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 2:13:09 pm">June 19th 2013</span>
											by <span class='authorname'>François Coppey</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Quick tip; next time - please do not create a new answer when your contribution is actually a comment - it confuses thing in the future when trying to work out relevance.  You are NOT being told off.</p>
</p>
										<div class="author">
											&mdash; commented <span title="June 19th 2013, 2:22:29 pm">June 19th 2013</span>
											by <span class='authorname'>Malcolm Hollingsworth</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
