<!doctype html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	
		<title>Canno get response text when error happens on  HttpClient » Community Questions &amp; Answers </title>
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="../../related/favicon.png" rel="shortcut icon" type="image/png">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
	<link href="//d3ilu1xuwhtfe2.cloudfront.net/e8e0ebd/css/style.css" rel="stylesheet" type="text/css">
	<link href="../../related/qa.css" rel="stylesheet" type="text/css">
	<link href="../../related/hybrid.css" rel="stylesheet" type="text/css">
	
	<link href="../../related/overrides.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class='mast'>    <div class='container'>        <div class='row'>            <div class='col-sm-12'>                <div class='masthead'><h1>Titanium Community Questions & Answer Archive</h1><h2>We felt that 6+ years of knowledge should not die so this is the Titanium Community Questions &amp; Answer Archive</h2></div>            </div>        </div>    </div></div>

<main class="container">
	<div class="row">
		<div class="col-sm-12">
			
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">
			<article class="question-container">
	<div class="question">
		<header>
			<h1>Canno get response text when error happens on  HttpClient</h1>
		</header>
		<section>
			<p>On IOS (havent tested yet on android) - when I do a POST through HttpClient, and an error occurs on the service, when onerror  is called, I can&#39;t seem to figure out how to get the response text - it is missing from &quot;this&quot; as well as from the e argument passed to onerror.  </p>
<p>I need this response text because when validation errors occur, the server sends a 406 response with the body being a json of the errors.  I&#39;m positive that a response body is being sent because when doing a curl with the same url and data, an errors json comes back with a 406 status code.</p>
<p>How can I get this text?</p>

		</section>
		<footer>
			<div class="author">
				&mdash; asked <span title="January 18th 2013, 6:03:10 pm">January 18th 2013</span>
				by <span class='authorname'>Dan Oved</span>
			</div>

			
				<ul class="tags">
					
						<li><span class='tagname'>httpclient</span></li>
					
				</ul>
			

			<section>
				<h5>6 Comments</h5>
				
					<ul class="comments">
					
						<li class="comment">
							<div><p>can you post your code please..</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:16:00 pm">January 18th 2013</span>
								by <span class='authorname'>Trevor Ward</span>
							</div>
						</li>
					
						<li class="comment">
							<div><pre><code class="hljs"><span class="hljs-keyword">var</span> data = {
   email : <span class="hljs-string">'asdfasdfas@yahoo.com'</span>
}

<span class="hljs-keyword">var</span> client = Ti.Network.createHTTPClient({
        <span class="hljs-comment">// function called when the response data is available</span>
        onload : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
           Ti.API.info(this.responseText);
        }, 
        <span class="hljs-comment">// function called when an error occurs, including a timeout</span>
        onerror : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
           Ti.API.error(e);
        },
        timeout : <span class="hljs-number">5000</span>  <span class="hljs-comment">// in milliseconds</span>
    });

client.open(<span class="hljs-string">"POST, 'http://localhost:3000/users');

client.send(data);</span>
</code></pre></div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:21:50 pm">January 18th 2013</span>
								by <span class='authorname'>Dan Oved</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>In addition to the code request by Trevor;</p>
<ul>
<li>Your Titanium SDK version</li>
<li>iOS - are you targeting any specific version?</li>
<li>Android - are you targeting any specific version?</li>
</ul>
</div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:22:06 pm">January 18th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>Just testing right now on IOS 6.</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:23:51 pm">January 18th 2013</span>
								by <span class='authorname'>Dan Oved</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>(disregard missing quote next to POST - forgot to add it to this sample)</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:25:01 pm">January 18th 2013</span>
								by <span class='authorname'>Dan Oved</span>
							</div>
						</li>
					
						<li class="comment">
							<div><p>also studio is version 3.0.1.201212181159</p>
</div>
							<div class="author">
								&mdash; commented <span title="January 18th 2013, 6:26:50 pm">January 18th 2013</span>
								by <span class='authorname'>Dan Oved</span>
							</div>
						</li>
					
					</ul>
				
			</section>
		</footer>
		<aside class="vote-box vote-box-answered">
			<div class="score"><span>-1</span> Votes</div>
			<div class="answers"><span>2</span> Answers</div>
		</aside>
	</div>

	<hr>

	<h3>2 Answers</h3>

	
		<ul class="answers">
			
				<li class="answer">
				
					<article class="accepted-answer" id="answer-254895">
						<header>
							<h2><span class="icon-bg icon-check-1"></span>Accepted Answer</h2>
						</header>
				
						<section>
							<p>Hi</p>
<p>Why are you setting a http status code 406, when this is not designed for such situations.  This is likely being the reason the response is being flagged as an error and if it is then you get no response text.</p>
<p>Why are you not using status code 200 which indicates the return of correct data with a json data parcel which contains your apps status code identifying the problem so your app can correctly respond to it.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 18th 2013, 6:27:34 pm">January 18th 2013</span>
								by <span class='authorname'>Malcolm Hollingsworth</span><br>
								<a class="icon-bg icon-link" href="question/147115/canno-get-response-text-when-error-happens-on-httpclient.html#answer-254895" rel="permalink">permalink</a>
							</div>

							<h5>3 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>dont get me started, Malcolm, on poorly designed back end APIs.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 18th 2013, 6:32:23 pm">January 18th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>There was a bug in my server side code that was causing it to return a 406 instead of 422…Fixed the bug and now when it returns a 422 the code works as expected.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 18th 2013, 6:36:10 pm">January 18th 2013</span>
											by <span class='authorname'>Dan Oved</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Meaning onerror gets called, but the response text shows now shows up in this.responseText</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 18th 2013, 6:42:28 pm">January 18th 2013</span>
											by <span class='authorname'>Dan Oved</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box vote-box-answered">
							<div class="score"><span>1</span> Vote</div>
						</aside>
					</article>
				</li>
			
				<li class="answer">
				
					<article id="answer-254894">
				
						<section>
							<p>Couple of things, onerror and onload have nothing to do with the success or failure of the service activity.<br>onerror and onload are determined by the HTTP process.</p>
<p>A successful HTTP connection to the server that results in a failure of the service, will return you through onload with a message from your server if configured to do so.</p>

						</section>
						<footer>
							<div class="author">
								&mdash; answered <span title="January 18th 2013, 6:26:53 pm">January 18th 2013</span>
								by <span class='authorname'>Stephen Feather</span><br>
								<a class="icon-bg icon-link" href="question/147115/canno-get-response-text-when-error-happens-on-httpclient.html#answer-254894" rel="permalink">permalink</a>
							</div>

							<h5>2 Comments</h5>
							
								<ul class="comments">
								
									<li class="comment">
										<p><p>a bad url will return <code>this.responseText</code> as <code>null</code>;</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 18th 2013, 6:30:04 pm">January 18th 2013</span>
											by <span class='authorname'>Stephen Feather</span>
										</div>
									</li>
								
									<li class="comment">
										<p><p>Not entirely true - for example if you successfully connect, but the service call returns a status code of 422, onerror gets called, with this.responseText being the response text from the service call.</p>
</p>
										<div class="author">
											&mdash; commented <span title="January 18th 2013, 6:48:34 pm">January 18th 2013</span>
											by <span class='authorname'>Dan Oved</span>
										</div>
									</li>
								
								</ul>
							
						</footer>
						<aside class="vote-box">
							<div class="score"><span>0</span> Votes</div>
						</aside>
					</article>
				</li>
			
		</ul>
	
</article>

		</div>
		<div class="col-sm-3"></div>
	</div>
	<div class="row"><div class="signoff">The ownership of individual contributions to this community generated content is retained by the authors of their contributions.<br>All trademarks remain the property of the respective owner.</div></div>
</main>


</body>
</html>
